function Gk(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in t)){const l=Object.getOwnPropertyDescriptor(r,o);l&&Object.defineProperty(t,o,l.get?l:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();var Wk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function z1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var LS={exports:{}},fn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Md=Symbol.for("react.element"),Hk=Symbol.for("react.portal"),qk=Symbol.for("react.fragment"),Zk=Symbol.for("react.strict_mode"),Xk=Symbol.for("react.profiler"),Yk=Symbol.for("react.provider"),$k=Symbol.for("react.context"),Kk=Symbol.for("react.forward_ref"),Jk=Symbol.for("react.suspense"),Qk=Symbol.for("react.memo"),eL=Symbol.for("react.lazy"),qw=Symbol.iterator;function tL(t){return t===null||typeof t!="object"?null:(t=qw&&t[qw]||t["@@iterator"],typeof t=="function"?t:null)}var RS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},OS=Object.assign,DS={};function _f(t,e,n){this.props=t,this.context=e,this.refs=DS,this.updater=n||RS}_f.prototype.isReactComponent={};_f.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};_f.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function zS(){}zS.prototype=_f.prototype;function B1(t,e,n){this.props=t,this.context=e,this.refs=DS,this.updater=n||RS}var N1=B1.prototype=new zS;N1.constructor=B1;OS(N1,_f.prototype);N1.isPureReactComponent=!0;var Zw=Array.isArray,BS=Object.prototype.hasOwnProperty,F1={current:null},NS={key:!0,ref:!0,__self:!0,__source:!0};function FS(t,e,n){var r,o={},l=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(l=""+e.key),e)BS.call(e,r)&&!NS.hasOwnProperty(r)&&(o[r]=e[r]);var g=arguments.length-2;if(g===1)o.children=n;else if(1<g){for(var y=Array(g),b=0;b<g;b++)y[b]=arguments[b+2];o.children=y}if(t&&t.defaultProps)for(r in g=t.defaultProps,g)o[r]===void 0&&(o[r]=g[r]);return{$$typeof:Md,type:t,key:l,ref:s,props:o,_owner:F1.current}}function nL(t,e){return{$$typeof:Md,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function U1(t){return typeof t=="object"&&t!==null&&t.$$typeof===Md}function rL(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Xw=/\/+/g;function n_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?rL(""+t.key):e.toString(36)}function Rg(t,e,n,r,o){var l=typeof t;(l==="undefined"||l==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(l){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Md:case Hk:s=!0}}if(s)return s=t,o=o(s),t=r===""?"."+n_(s,0):r,Zw(o)?(n="",t!=null&&(n=t.replace(Xw,"$&/")+"/"),Rg(o,e,n,"",function(b){return b})):o!=null&&(U1(o)&&(o=nL(o,n+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(Xw,"$&/")+"/")+t)),e.push(o)),1;if(s=0,r=r===""?".":r+":",Zw(t))for(var g=0;g<t.length;g++){l=t[g];var y=r+n_(l,g);s+=Rg(l,e,n,y,o)}else if(y=tL(t),typeof y=="function")for(t=y.call(t),g=0;!(l=t.next()).done;)l=l.value,y=r+n_(l,g++),s+=Rg(l,e,n,y,o);else if(l==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function eg(t,e,n){if(t==null)return t;var r=[],o=0;return Rg(t,r,"","",function(l){return e.call(n,l,o++)}),r}function iL(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ki={current:null},Og={transition:null},oL={ReactCurrentDispatcher:Ki,ReactCurrentBatchConfig:Og,ReactCurrentOwner:F1};fn.Children={map:eg,forEach:function(t,e,n){eg(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return eg(t,function(){e++}),e},toArray:function(t){return eg(t,function(e){return e})||[]},only:function(t){if(!U1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fn.Component=_f;fn.Fragment=qk;fn.Profiler=Xk;fn.PureComponent=B1;fn.StrictMode=Zk;fn.Suspense=Jk;fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oL;fn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=OS({},t.props),o=t.key,l=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(l=e.ref,s=F1.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var g=t.type.defaultProps;for(y in e)BS.call(e,y)&&!NS.hasOwnProperty(y)&&(r[y]=e[y]===void 0&&g!==void 0?g[y]:e[y])}var y=arguments.length-2;if(y===1)r.children=n;else if(1<y){g=Array(y);for(var b=0;b<y;b++)g[b]=arguments[b+2];r.children=g}return{$$typeof:Md,type:t.type,key:o,ref:l,props:r,_owner:s}};fn.createContext=function(t){return t={$$typeof:$k,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Yk,_context:t},t.Consumer=t};fn.createElement=FS;fn.createFactory=function(t){var e=FS.bind(null,t);return e.type=t,e};fn.createRef=function(){return{current:null}};fn.forwardRef=function(t){return{$$typeof:Kk,render:t}};fn.isValidElement=U1;fn.lazy=function(t){return{$$typeof:eL,_payload:{_status:-1,_result:t},_init:iL}};fn.memo=function(t,e){return{$$typeof:Qk,type:t,compare:e===void 0?null:e}};fn.startTransition=function(t){var e=Og.transition;Og.transition={};try{t()}finally{Og.transition=e}};fn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};fn.useCallback=function(t,e){return Ki.current.useCallback(t,e)};fn.useContext=function(t){return Ki.current.useContext(t)};fn.useDebugValue=function(){};fn.useDeferredValue=function(t){return Ki.current.useDeferredValue(t)};fn.useEffect=function(t,e){return Ki.current.useEffect(t,e)};fn.useId=function(){return Ki.current.useId()};fn.useImperativeHandle=function(t,e,n){return Ki.current.useImperativeHandle(t,e,n)};fn.useInsertionEffect=function(t,e){return Ki.current.useInsertionEffect(t,e)};fn.useLayoutEffect=function(t,e){return Ki.current.useLayoutEffect(t,e)};fn.useMemo=function(t,e){return Ki.current.useMemo(t,e)};fn.useReducer=function(t,e,n){return Ki.current.useReducer(t,e,n)};fn.useRef=function(t){return Ki.current.useRef(t)};fn.useState=function(t){return Ki.current.useState(t)};fn.useSyncExternalStore=function(t,e,n){return Ki.current.useSyncExternalStore(t,e,n)};fn.useTransition=function(){return Ki.current.useTransition()};fn.version="18.2.0";LS.exports=fn;var Re=LS.exports;const Sn=z1(Re);function Qg(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const j1=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),Yw=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Yw&&parseFloat(Yw[1]);const aL="3.4.14";function ll(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Dg=typeof process!="object"||String(process)!=="[object process]"||process.browser,sL=typeof window<"u"&&typeof window.orientation<"u",$w=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);$w&&parseFloat($w[1]);function Jh(t){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jh(t)}function lL(t,e){if(Jh(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Jh(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function US(t){var e=lL(t,"string");return Jh(e)==="symbol"?e:String(e)}function D(t,e,n){return e=US(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class uL{constructor(e,n){D(this,"name",void 0),D(this,"workerThread",void 0),D(this,"isRunning",!0),D(this,"result",void 0),D(this,"_resolve",()=>{}),D(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,o)=>{this._resolve=r,this._reject=o})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){ll(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ll(this.isRunning),this.isRunning=!1,this._reject(e)}}let r_=class{terminate(){}};const i_=new Map;function cL(t){ll(t.source&&!t.url||!t.source&&t.url);let e=i_.get(t.source||t.url);return e||(t.url&&(e=hL(t.url),i_.set(t.url,e)),t.source&&(e=jS(t.source),i_.set(t.source,e))),ll(e),e}function hL(t){if(!t.startsWith("http"))return t;const e=fL(t);return jS(e)}function jS(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function fL(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function VS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(Kw(t))r.add(t);else if(Kw(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const o in t)VS(t[o],e,r)}}return n===void 0?Array.from(r):[]}function Kw(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const o_=()=>{};class l0{static isSupported(){return typeof Worker<"u"&&Dg||typeof r_<"u"&&!Dg}constructor(e){D(this,"name",void 0),D(this,"source",void 0),D(this,"url",void 0),D(this,"terminated",!1),D(this,"worker",void 0),D(this,"onMessage",void 0),D(this,"onError",void 0),D(this,"_loadableURL","");const{name:n,source:r,url:o}=e;ll(r||o),this.name=n,this.source=r,this.url=o,this.onMessage=o_,this.onError=l=>console.log(l),this.worker=Dg?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=o_,this.onError=o_,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||VS(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=cL({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new r_(r,{eval:!1})}else if(this.source)e=new r_(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class pL{static isSupported(){return l0.isSupported()}constructor(e){D(this,"name","unnamed"),D(this,"source",void 0),D(this,"url",void 0),D(this,"maxConcurrency",1),D(this,"maxMobileConcurrency",1),D(this,"onDebug",()=>{}),D(this,"reuseWorkers",!0),D(this,"props",{}),D(this,"jobQueue",[]),D(this,"idleQueue",[]),D(this,"count",0),D(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(l,s,g)=>l.done(g),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(l,s)=>l.error(s);const o=new Promise(l=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:l}),this));return this._startQueuedJob(),await o}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new uL(n.name,e);e.onMessage=o=>n.onMessage(r,o.type,o.payload),e.onError=o=>n.onError(r,o),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new l0({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return sL?this.maxMobileConcurrency:this.maxConcurrency}}const dL={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class nl{static isSupported(){return l0.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return nl._workerFarm=nl._workerFarm||new nl({}),nl._workerFarm.setProps(e),nl._workerFarm}constructor(e){D(this,"props",void 0),D(this,"workerPools",new Map),this.props={...dL},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:o}=e;let l=this.workerPools.get(n);return l||(l=new pL({name:n,source:r,url:o}),l.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,l)),l}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}D(nl,"_workerFarm",void 0);const mL="latest";function gL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let o=n.workerUrl;if(!o&&t.id==="compression"&&(o=e.workerUrl),e._workerType==="test"&&(o="modules/".concat(t.module,"/dist/").concat(r)),!o){let l=t.version;l==="latest"&&(l=mL);const s=l?"@".concat(l):"";o="https://unpkg.com/@loaders.gl/".concat(t.module).concat(s,"/dist/").concat(r)}return ll(o),o}function yL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:aL;ll(t,"no worker provided");const n=t.version;return!(!e||!n)}function vL(t,e){return!nl.isSupported()||!Dg&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function _L(t,e,n,r,o){const l=t.id,s=gL(t,n),y=nl.getWorkerFarm(n).getWorkerPool({name:l,url:s});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const b=await y.startJob("process-on-worker",xL.bind(null,o));return b.postMessage("process",{input:e,options:n,context:r}),await(await b.result).result}async function xL(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:o,input:l,options:s}=r;try{const g=await t(l,s);e.postMessage("done",{id:o,result:g})}catch(g){const y=g instanceof Error?g.message:"unknown error";e.postMessage("error",{id:o,error:y})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function bL(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),o=new Uint8Array(e);for(let l=0;l<r.length;++l)if(r[l]!==o[l])return!1;return!0}function wL(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(g=>g instanceof ArrayBuffer?new Uint8Array(g):g),o=r.reduce((g,y)=>g+y.byteLength,0),l=new Uint8Array(o);let s=0;for(const g of r)l.set(g,s),s+=g.byteLength;return l.buffer}function EL(t){try{let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return async function*(){const n=new TextDecoder(void 0,e);for await(const r of t)yield typeof r=="string"?r:n.decode(r,{stream:!0})}()}catch(e){return Promise.reject(e)}}async function TL(t){const e=[];for await(const n of t)e.push(n);return wL(...e)}let SL="";const Jw={};function AL(t){for(const e in Jw)if(t.startsWith(e)){const n=Jw[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(SL).concat(t)),t}function PL(t){return t&&typeof t=="object"&&t.isBuffer}function GS(t){if(PL(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function WS(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function IL(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const CL=t=>typeof t=="boolean",jp=t=>typeof t=="function",kd=t=>t!==null&&typeof t=="object",Qw=t=>kd(t)&&t.constructor==={}.constructor,ML=t=>t&&typeof t[Symbol.iterator]=="function",kL=t=>t&&typeof t[Symbol.asyncIterator]=="function",gc=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,yc=t=>typeof Blob<"u"&&t instanceof Blob,LL=t=>t&&typeof t=="object"&&t.isBuffer,RL=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||kd(t)&&jp(t.tee)&&jp(t.cancel)&&jp(t.getReader),OL=t=>kd(t)&&jp(t.read)&&jp(t.pipe)&&CL(t.readable),HS=t=>RL(t)||OL(t),DL=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,zL=/^([-\w.]+\/[-\w.+]+)/;function BL(t){const e=zL.exec(t);return e?e[1]:t}function eE(t){const e=DL.exec(t);return e?e[1]:""}const qS=/\?.*/;function NL(t){const e=t.match(qS);return e&&e[0]}function V1(t){return t.replace(qS,"")}function Hy(t){return gc(t)?t.url:yc(t)?t.name||"":typeof t=="string"?t:""}function G1(t){if(gc(t)){const e=t,n=e.headers.get("content-type")||"",r=V1(e.url);return BL(n)||eE(r)}return yc(t)?t.type||"":typeof t=="string"?eE(t):""}function FL(t){return gc(t)?t.headers["content-length"]||-1:yc(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function ZS(t){if(gc(t))return t;const e={},n=FL(t);n>=0&&(e["content-length"]=String(n));const r=Hy(t),o=G1(t);o&&(e["content-type"]=o);const l=await VL(t);l&&(e["x-first-bytes"]=l),typeof t=="string"&&(t=new TextEncoder().encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:r}),s}async function UL(t){if(!t.ok){const e=await jL(t);throw new Error(e)}}async function jL(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function VL(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const o=new FileReader;o.onload=l=>{var s;return r(l==null||(s=l.target)===null||s===void 0?void 0:s.result)},o.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=GL(n);return"data:base64,".concat(r)}return null}function GL(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function tE(t,e){if(typeof t=="string"){t=AL(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await ZS(t)}function WL(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Ld(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||WL()}const tg=globalThis.window||globalThis.self||globalThis.global,_p=globalThis.process||{},XS=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Ld();function HL(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let qL=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=HL(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function ZL(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function XL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function a_(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const o=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const l=t.width*n,s=t.height*n,g=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(l/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(o,");"),"background-size:".concat(l,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),g]}let ey;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(ey||(ey={}));const YL=10;function nE(t){return typeof t!="string"?t:(t=t.toUpperCase(),ey[t]||ey.WHITE)}function $L(t,e,n){if(!Ld&&typeof t=="string"){if(e){const r=nE(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=nE(n);t="\x1B[".concat(r+YL,"m").concat(t,"\x1B[49m")}}return t}function KL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),o=t;for(const l of r){const s=o[l];typeof s=="function"&&(e.find(g=>l===g)||(o[l]=s.bind(t)))}}function ty(t,e){if(!t)throw new Error(e||"Assertion failed")}function yh(){let t;if(Ld()&&tg.performance){var e,n;t=tg==null||(e=tg.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in _p){var r;const o=_p==null||(r=_p.hrtime)===null||r===void 0?void 0:r.call(_p);t=o[0]*1e3+o[1]/1e6}else t=Date.now();return t}const vh={debug:Ld()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},JL={enabled:!0,level:0};function qo(){}const rE={},iE={once:!0};let W1=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=XS,this._startTs=yh(),this._deltaTs=yh(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new qL("__probe-".concat(this.id,"__"),JL),this.timeStamp("".concat(this.id," started")),KL(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((yh()-this._startTs).toPrecision(10))}getDelta(){return Number((yh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){ty(e,n)}warn(e){return this._getLogFunction(0,e,vh.warn,arguments,iE)}error(e){return this._getLogFunction(0,e,vh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,vh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,vh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,vh.debug||vh.info,arguments,iE)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||qo,r&&[r],{tag:nR(n)}):qo}image(e){let{logLevel:n,priority:r,image:o,message:l="",scale:s=1}=e;return this._shouldLog(n||r)?Ld()?tR({image:o,message:l,scale:s}):eR():qo}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||qo)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const o=oE({logLevel:e,message:n,opts:r}),{collapsed:l}=r;return o.method=(l?console.groupCollapsed:console.group)||console.info,this._getLogFunction(o)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||qo)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=YS(e)}_getLogFunction(e,n,r,o,l){if(this._shouldLog(e)){l=oE({logLevel:e,message:n,args:o,opts:l}),r=r||l.method,ty(r),l.total=this.getTotal(),l.delta=this.getDelta(),this._deltaTs=yh();const s=l.tag||l.message;if(l.once&&s)if(!rE[s])rE[s]=yh();else return qo;return n=QL(this.id,l.message,l),r.bind(console,n,...l.args)}return qo}};W1.VERSION=XS;function YS(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return ty(Number.isFinite(e)&&e>=0),e}function oE(t){const{logLevel:e,message:n}=t;t.logLevel=YS(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const o=typeof t.message;return ty(o==="string"||o==="object"),Object.assign(t,{args:r},t.opts)}function QL(t,e,n){if(typeof e=="string"){const r=n.time?XL(ZL(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=$L(e,n.color,n.background)}return e}function eR(t){return console.warn("removed"),qo}function tR(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const l=new Image;return l.onload=()=>{const s=a_(l,n,r);console.log(...s)},l.src=e,qo}const o=e.nodeName||"";if(o.toLowerCase()==="img")return console.log(...a_(e,n,r)),qo;if(o.toLowerCase()==="canvas"){const l=new Image;return l.onload=()=>console.log(...a_(l,n,r)),l.src=e.toDataURL(),qo}return qo}function nR(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const aE=new W1({id:"loaders.gl"});class rR{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class iR{constructor(){D(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const $S={fetch:null,mimeType:void 0,nothrow:!1,log:new iR,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:j1,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},oR={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function KS(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const JS=()=>{const t=KS();return t.globalOptions=t.globalOptions||{...$S},t.globalOptions};function aR(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],sR(t,n),uR(e,t,r)}function sR(t,e){sE(t,null,$S,oR,e);for(const n of e){const r=t&&t[n.id]||{},o=n.options&&n.options[n.id]||{},l=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};sE(r,n.id,o,l,e)}}function sE(t,e,n,r,o){const l=e||"Top level",s=e?"".concat(e,"."):"";for(const g in t){const y=!e&&kd(t[g]),b=g==="baseUri"&&!e,S=g==="workerUrl"&&e;if(!(g in n)&&!b&&!S){if(g in r)aE.warn("".concat(l," loader option '").concat(s).concat(g,"' no longer supported, use '").concat(r[g],"'"))();else if(!y){const I=lR(g,o);aE.warn("".concat(l," loader option '").concat(s).concat(g,"' not recognized. ").concat(I))()}}}}function lR(t,e){const n=t.toLowerCase();let r="";for(const o of e)for(const l in o.options){if(t===l)return"Did you mean '".concat(o.id,".").concat(l,"'?");const s=l.toLowerCase();(n.startsWith(s)||s.startsWith(n))&&(r=r||"Did you mean '".concat(o.id,".").concat(l,"'?"))}return r}function uR(t,e,n){const o={...t.options||{}};return cR(o,n),o.log===null&&(o.log=new rR),lE(o,JS()),lE(o,e),o}function lE(t,e){for(const n in e)if(n in e){const r=e[n];Qw(r)&&Qw(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function cR(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function H1(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function q1(t){var e,n;Qg(t,"null loader"),Qg(H1(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const QS=()=>{const t=KS();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function hR(t){const e=QS();t=Array.isArray(t)?t:[t];for(const n of t){const r=q1(n);e.find(o=>r===o)||e.unshift(r)}}function fR(){return QS()}const pR=new W1({id:"loaders.gl"}),dR=/\.([^.]+)$/;async function mR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!eA(t))return null;let o=uE(t,e,{...n,nothrow:!0},r);if(o)return o;if(yc(t)&&(t=await t.slice(0,10).arrayBuffer(),o=uE(t,e,n,r)),!o&&!(n!=null&&n.nothrow))throw new Error(tA(t));return o}function uE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!eA(t))return null;if(e&&!Array.isArray(e))return q1(e);let o=[];e&&(o=o.concat(e)),n!=null&&n.ignoreRegisteredLoaders||o.push(...fR()),yR(o);const l=gR(t,o,n,r);if(!l&&!(n!=null&&n.nothrow))throw new Error(tA(t));return l}function gR(t,e,n,r){const o=Hy(t),l=G1(t),s=V1(o)||(r==null?void 0:r.url);let g=null,y="";if(n!=null&&n.mimeType&&(g=s_(e,n==null?void 0:n.mimeType),y="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),g=g||vR(e,s),y=y||(g?"matched url ".concat(s):""),g=g||s_(e,l),y=y||(g?"matched MIME type ".concat(l):""),g=g||xR(e,t),y=y||(g?"matched initial data ".concat(nA(t)):""),g=g||s_(e,n==null?void 0:n.fallbackMimeType),y=y||(g?"matched fallback MIME type ".concat(l):""),y){var b;pR.log(1,"selectLoader selected ".concat((b=g)===null||b===void 0?void 0:b.name,": ").concat(y,"."))}return g}function eA(t){return!(t instanceof Response&&t.status===204)}function tA(t){const e=Hy(t),n=G1(t);let r="No valid loader found (";r+=e?"".concat(WS(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const o=t?nA(t):"";return r+=o?' first bytes: "'.concat(o,'"'):"first bytes: not available",r+=")",r}function yR(t){for(const e of t)q1(e)}function vR(t,e){const n=e&&dR.exec(e),r=n&&n[1];return r?_R(t,r):null}function _R(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function s_(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function xR(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(bR(e,n))return n}else if(ArrayBuffer.isView(e)){if(cE(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&cE(e,0,n))return n;return null}function bR(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function cE(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(o=>wR(t,e,n,o))}function wR(t,e,n,r){if(r instanceof ArrayBuffer)return bL(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const o=u0(t,e,r.length);return r===o;default:return!1}}function nA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?u0(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?u0(t,0,e):""}function u0(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let o="";for(let l=0;l<n;l++)o+=String.fromCharCode(r.getUint8(e+l));return o}const ER=256*1024;function*TR(t,e){const n=(e==null?void 0:e.chunkSize)||ER;let r=0;const o=new TextEncoder;for(;r<t.length;){const l=Math.min(t.length-r,n),s=t.slice(r,r+l);r+=l,yield o.encode(s)}}const SR=256*1024;function AR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=SR}=e;let r=0;for(;r<t.byteLength;){const o=Math.min(t.byteLength-r,n),l=new ArrayBuffer(o),s=new Uint8Array(t,r,o);new Uint8Array(l).set(s),r+=o,yield l}}()}const PR=1024*1024;async function*IR(t,e){const n=(e==null?void 0:e.chunkSize)||PR;let r=0;for(;r<t.size;){const o=r+n,l=await t.slice(r,o).arrayBuffer();r=o,yield l}}function hE(t,e){return j1?CR(t,e):MR(t)}async function*CR(t,e){const n=t.getReader();let r;try{for(;;){const o=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:l,value:s}=await o;if(l)return;yield GS(s)}}catch{n.releaseLock()}}async function*MR(t,e){for await(const n of t)yield GS(n)}function kR(t,e){if(typeof t=="string")return TR(t,e);if(t instanceof ArrayBuffer)return AR(t,e);if(yc(t))return IR(t,e);if(HS(t))return hE(t,e);if(gc(t))return hE(t.body,e);throw new Error("makeIterator")}const rA="Cannot convert supplied data type";function LR(t,e,n){if(e.text&&typeof t=="string")return t;if(LL(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const o=t.byteLength||t.length;return(t.byteOffset!==0||o!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+o)),r}throw new Error(rA)}async function RR(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return LR(t,e);if(yc(t)&&(t=await ZS(t)),gc(t)){const o=t;return await UL(o),e.binary?await o.arrayBuffer():await o.text()}if(HS(t)&&(t=kR(t,n)),ML(t)||kL(t))return TL(t);throw new Error(rA)}function iA(t,e){const n=JS(),r=t||n;return typeof r.fetch=="function"?r.fetch:kd(r.fetch)?o=>tE(o,r):e!=null&&e.fetch?e==null?void 0:e.fetch:tE}function OR(t,e,n){if(n)return n;const r={fetch:iA(e,t),...t};if(r.url){const o=V1(r.url);r.baseUrl=o,r.queryString=NL(r.url),r.filename=WS(o),r.baseUrl=IL(o)}return Array.isArray(r.loaders)||(r.loaders=null),r}function DR(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function Z1(t,e,n,r){ll(!r||typeof r=="object"),e&&!Array.isArray(e)&&!H1(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const o=Hy(t),s=DR(e,r),g=await mR(t,s,n);return g?(n=aR(n,g,s,o),r=OR({url:o,parse:Z1,loaders:s},n,r||null),await zR(g,t,n,r)):null}async function zR(t,e,n,r){if(yL(t),gc(e)){const o=e,{ok:l,redirected:s,status:g,statusText:y,type:b,url:S}=o,I=Object.fromEntries(o.headers.entries());r.response={headers:I,ok:l,redirected:s,status:g,statusText:y,type:b,url:S}}if(e=await RR(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(vL(t,n))return await _L(t,e,n,r,Z1);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw ll(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Qh(t,e,n,r){!Array.isArray(e)&&!H1(e)&&(n=e,e=void 0);const o=iA(n);let l=t;return typeof t=="string"&&(l=await o(t)),yc(t)&&(l=await o(t)),await Z1(l,e,n)}const BR="3.4.14",{_parseImageNode:NR}=globalThis,c0=typeof Image<"u",h0=typeof ImageBitmap<"u",FR=!!NR,f0=j1?!0:FR;function UR(t){switch(t){case"auto":return h0||c0||f0;case"imagebitmap":return h0;case"image":return c0;case"data":return f0;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function jR(){if(h0)return"imagebitmap";if(c0)return"image";if(f0)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function VR(t){const e=WR(t);if(!e)throw new Error("Not an image");return e}function GR(t){switch(VR(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function WR(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const HR=/^data:image\/svg\+xml/,qR=/\.svg((\?|#).*)?$/;function X1(t){return t&&(HR.test(t)||qR.test(t))}function ZR(t,e){if(X1(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(l){throw new Error(l.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return oA(t,e)}function oA(t,e){if(X1(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function aA(t,e,n){const r=ZR(t,n),o=self.URL||self.webkitURL,l=typeof r!="string"&&o.createObjectURL(r);try{return await XR(l||r,e)}finally{l&&o.revokeObjectURL(l)}}async function XR(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,o)=>{try{n.onload=()=>r(n),n.onerror=l=>o(new Error("Could not load image ".concat(t,": ").concat(l)))}catch(l){o(l)}})}const YR={};let fE=!0;async function $R(t,e,n){let r;X1(n)?r=await aA(t,e,n):r=oA(t,n);const o=e&&e.imagebitmap;return await KR(r,o)}async function KR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((JR(e)||!fE)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),fE=!1}return await createImageBitmap(t)}function JR(t){for(const e in t||YR)return!1;return!0}function QR(t){return!rO(t,"ftyp",4)||!(t[8]&96)?null:eO(t)}function eO(t){switch(tO(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function tO(t,e,n){return String.fromCharCode(...t.slice(e,n))}function nO(t){return[...t].map(e=>e.charCodeAt(0))}function rO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=nO(e);for(let o=0;o<r.length;++o)if(r[o]!==t[o+n])return!1;return!0}const ls=!1,Vp=!0;function sA(t){const e=Rd(t);return oO(e)||lO(e)||aO(e)||sO(e)||iO(e)}function iO(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=QR(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function oO(t){const e=Rd(t);return e.byteLength>=24&&e.getUint32(0,ls)===2303741511?{mimeType:"image/png",width:e.getUint32(16,ls),height:e.getUint32(20,ls)}:null}function aO(t){const e=Rd(t);return e.byteLength>=10&&e.getUint32(0,ls)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Vp),height:e.getUint16(8,Vp)}:null}function sO(t){const e=Rd(t);return e.byteLength>=14&&e.getUint16(0,ls)===16973&&e.getUint32(2,Vp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Vp),height:e.getUint32(22,Vp)}:null}function lO(t){const e=Rd(t);if(!(e.byteLength>=3&&e.getUint16(0,ls)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:o}=uO();let l=2;for(;l+9<e.byteLength;){const s=e.getUint16(l,ls);if(o.has(s))return{mimeType:"image/jpeg",height:e.getUint16(l+5,ls),width:e.getUint16(l+7,ls)};if(!r.has(s))return null;l+=2,l+=e.getUint16(l,ls)}return null}function uO(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Rd(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function cO(t,e){const{mimeType:n}=sA(t)||{},r=globalThis._parseImageNode;return Qg(r),await r(t,n)}async function hO(t,e,n){e=e||{};const o=(e.image||{}).type||"auto",{url:l}=n||{},s=fO(o);let g;switch(s){case"imagebitmap":g=await $R(t,e,l);break;case"image":g=await aA(t,e,l);break;case"data":g=await cO(t);break;default:Qg(!1)}return o==="data"&&(g=GR(g)),g}function fO(t){switch(t){case"auto":case"data":return jR();default:return UR(t),t}}const pO=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],dO=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],mO={image:{type:"auto",decode:!0}},Y1={id:"image",module:"images",name:"Images",version:BR,mimeTypes:dO,extensions:pO,parse:hO,tests:[t=>!!sA(new DataView(t))],options:mO};function lA(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function ml(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||lA()}const zg={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},ng=zg.window||zg.self||zg.global,xp=zg.process||{},uA=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";ml();const l_=globalThis;function cA(t){if(!t&&!ml())return"Node";if(lA(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,o=n.indexOf("Trident/")!==-1;return r||o?"IE":l_.chrome?"Chrome":l_.safari?"Safari":l_.mozInnerScreenX?"Firefox":"Unknown"}function gO(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class yO{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";D(this,"storage",void 0),D(this,"id",void 0),D(this,"config",void 0),this.storage=gO(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function vO(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function _O(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function u_(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const o=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const l=t.width*n,s=t.height*n,g=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(l/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(o,");"),"background-size:".concat(l,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),g]}let ny;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(ny||(ny={}));function pE(t){return typeof t=="string"?ny[t.toUpperCase()]||ny.WHITE:t}function xO(t,e,n){return!ml&&typeof t=="string"&&(e&&(e=pE(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=pE(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function bO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const o of r)typeof t[o]=="function"&&(e.find(l=>o===l)||(t[o]=t[o].bind(t)))}function ry(t,e){if(!t)throw new Error(e||"Assertion failed")}function _h(){let t;if(ml&&"performance"in ng){var e,n;t=ng==null||(e=ng.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in xp){var r;const o=xp==null||(r=xp.hrtime)===null||r===void 0?void 0:r.call(xp);t=o[0]*1e3+o[1]/1e6}else t=Date.now();return t}const xh={debug:ml&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},wO={enabled:!0,level:0};function Zo(){}const dE={},mE={once:!0};class $1{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};D(this,"id",void 0),D(this,"VERSION",uA),D(this,"_startTs",_h()),D(this,"_deltaTs",_h()),D(this,"_storage",void 0),D(this,"userData",{}),D(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new yO("__probe-".concat(this.id,"__"),wO),this.timeStamp("".concat(this.id," started")),bO(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((_h()-this._startTs).toPrecision(10))}getDelta(){return Number((_h()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){ry(e,n)}warn(e){return this._getLogFunction(0,e,xh.warn,arguments,mE)}error(e){return this._getLogFunction(0,e,xh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,xh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,xh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,o=new Array(r>2?r-2:0),l=2;l<r;l++)o[l-2]=arguments[l];return this._getLogFunction(e,n,xh.debug||xh.info,arguments,mE)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Zo,r&&[r],{tag:AO(n)}):Zo}image(e){let{logLevel:n,priority:r,image:o,message:l="",scale:s=1}=e;return this._shouldLog(n||r)?ml?SO({image:o,message:l,scale:s}):TO():Zo}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Zo)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const o=gE({logLevel:e,message:n,opts:r}),{collapsed:l}=r;return o.method=(l?console.groupCollapsed:console.group)||console.info,this._getLogFunction(o)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Zo)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=hA(e)}_getLogFunction(e,n,r,o,l){if(this._shouldLog(e)){l=gE({logLevel:e,message:n,args:o,opts:l}),r=r||l.method,ry(r),l.total=this.getTotal(),l.delta=this.getDelta(),this._deltaTs=_h();const s=l.tag||l.message;if(l.once)if(!dE[s])dE[s]=_h();else return Zo;return n=EO(this.id,l.message,l),r.bind(console,n,...l.args)}return Zo}}D($1,"VERSION",uA);function hA(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return ry(Number.isFinite(e)&&e>=0),e}function gE(t){const{logLevel:e,message:n}=t;t.logLevel=hA(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const o=typeof t.message;return ry(o==="string"||o==="object"),Object.assign(t,{args:r},t.opts)}function EO(t,e,n){if(typeof e=="string"){const r=n.time?_O(vO(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=xO(e,n.color,n.background)}return e}function TO(t){return console.warn("removed"),Zo}function SO(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const l=new Image;return l.onload=()=>{const s=u_(l,n,r);console.log(...s)},l.src=e,Zo}const o=e.nodeName||"";if(o.toLowerCase()==="img")return console.log(...u_(e,n,r)),Zo;if(o.toLowerCase()==="canvas"){const l=new Image;return l.onload=()=>console.log(...u_(l,n,r)),l.src=e.toDataURL(),Zo}return Zo}function AO(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Fn=new $1({id:"deck"});let p0={};function PO(t){p0=t}function Zi(t,e,n,r){Fn.level>0&&p0[t]&&p0[t].call(null,e,n,r)}function IO(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const CO={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:IO,parseTextSync:JSON.parse};function MO(){const t="8.9.28",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(Fn.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Fn,_registerLoggers:PO},hR([CO,[Y1,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const kO=MO(),Rn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Rn,"IDENTITY",{get:()=>(Fn.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const cs={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},yE={common:0,meters:1,pixels:2},vE={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Ct=new $1({id:"luma.gl"});function Xi(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const LO="Invalid WebGLRenderingContext",RO="Requires WebGL2";function qy(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function hn(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function OO(t){return hn(t)?t:null}function Zy(t){return Xi(qy(t),LO),t}function Yi(t){return Xi(hn(t),RO),t}const Dp={};function DO(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function zO(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function BO(t,e){Dp[t]=!0,e!==void 0&&DO(e)}function NO(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Dp[r]=!0);while(r!==0);for(r in Dp)if(Dp[r])return delete Dp[r],parseInt(r,10);return 0}}const Od=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const o=new t.VertexAttrib(n);this.attribs[r]=o}this.maxAttrib=0};Od.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Od.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const vc=function(e){const n=this;this.gl=e,NO(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(l){return l===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(l){const s=n.currentVertexArrayObject;s.maxAttrib=Math.max(s.maxAttrib,l);const g=s.attribs[l];return g.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(l){const s=n.currentVertexArrayObject;s.maxAttrib=Math.max(s.maxAttrib,l);const g=s.attribs[l];return g.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(l,s){switch(l){case 34962:n.currentArrayBuffer=s;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=s;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(l,s){const y=n.currentVertexArrayObject.attribs[l];switch(s){case 34975:return y.buffer;case 34338:return y.enabled;case 34339:return y.size;case 34340:return y.stride;case 34341:return y.type;case 34922:return y.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(l,s,g,y,b,S){const I=n.currentVertexArrayObject;I.maxAttrib=Math.max(I.maxAttrib,l);const C=I.attribs[l];return C.buffer=n.currentArrayBuffer,C.size=s,C.type=g,C.normalized=y,C.stride=b,C.offset=S,C.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{zO("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};vc.prototype.VERTEX_ARRAY_BINDING_OES=34229;vc.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Od(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};vc.prototype.createVertexArrayOES=function(){const e=new Od(this);return this.vertexArrayObjects.push(e),e};vc.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};vc.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Od&&e.hasBeenBound&&e.ext===this)};vc.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){BO(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,o=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const l=this.currentVertexArrayObject;if(o===l)return;(!o||l.elementArrayBuffer!==o.elementArrayBuffer)&&r.bindBuffer.call(n,34963,l.elementArrayBuffer);let s=this.currentArrayBuffer;const g=Math.max(o?o.maxAttrib:0,l.maxAttrib);for(let y=0;y<=g;y++){const b=l.attribs[y],S=o?o.attribs[y]:null;if((!o||b.enabled!==S.enabled)&&(b.enabled?r.enableVertexAttribArray.call(n,y):r.disableVertexAttribArray.call(n,y)),b.enabled){let I=!1;(!o||b.buffer!==S.buffer)&&(s!==b.buffer&&(r.bindBuffer.call(n,34962,b.buffer),s=b.buffer),I=!0),(I||b.cached!==S.cached)&&r.vertexAttribPointer.call(n,y,b.size,b.type,b.normalized,b.stride,b.offset)}}this.currentArrayBuffer!==s&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function FO(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const o=e.call(this)||[];return o.indexOf("OES_vertex_array_object")<0&&o.push("OES_vertex_array_object"),o};const n=t.getExtension;t.getExtension=function(o){const l=n.call(this,o);return l||(o!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new vc(this)),this.__OESVertexArrayObject))}}const _E="OES_element_index",xE="WEBGL_draw_buffers",UO="EXT_disjoint_timer_query",jO="EXT_disjoint_timer_query_webgl2",VO="EXT_texture_filter_anisotropic",bE="WEBGL_debug_renderer_info",GO=35723,WO=4352,HO=36795,qO=34047,ZO=37445,XO=37446,Hn=t=>hn(t)?void 0:0,YO={3074:t=>hn(t)?void 0:36064,[GO]:t=>hn(t)?void 0:WO,35977:Hn,32937:Hn,[HO]:(t,e)=>{const n=hn(t)?t.getExtension(jO):t.getExtension(UO);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[ZO]:(t,e)=>{const n=t.getExtension(bE);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[XO]:(t,e)=>{const n=t.getExtension(bE);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[qO]:(t,e)=>{const n=t.luma.extensions[VO];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Hn,35071:Hn,37447:Hn,36063:(t,e)=>{if(!hn(t)){const n=t.getExtension(xE);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Hn,35374:Hn,35377:Hn,34852:t=>{if(!hn(t)){const e=t.getExtension(xE);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(_E)?2147483647:65535,33001:t=>t.getExtension(_E)?16777216:65535,33e3:t=>16777216,37157:Hn,35373:Hn,35657:Hn,36183:Hn,37137:Hn,34045:Hn,35978:Hn,35979:Hn,35968:Hn,35376:Hn,35375:Hn,35659:Hn,37154:Hn,35371:Hn,35658:Hn,35076:Hn,35077:Hn,35380:Hn};function $O(t,e,n){const r=YO[n],o=typeof r=="function"?r(t,e,n):r;return o!==void 0?o:e(n)}const KO="OES_vertex_array_object",fA="ANGLE_instanced_arrays",JO="WEBGL_draw_buffers",QO="EXT_disjoint_timer_query",e3="EXT_texture_filter_anisotropic",t3="VertexArray requires WebGL2 or OES_vertex_array_object extension";function n3(t,e){return{webgl2:hn(t),ext:t.getExtension(e)}}const pA={[KO]:{meta:{suffix:"OES"},createVertexArray:()=>{Xi(!1,t3)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[fA]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Xi(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[JO]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Xi(!1)}},[QO]:{meta:{suffix:"EXT"},createQuery:()=>{Xi(!1)},deleteQuery:()=>{Xi(!1)},beginQuery:()=>{Xi(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},c_={readBuffer:(t,e,n)=>{hn(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:o,ext:l}=n3(t,fA);let s;switch(r){case 35069:s=o?void 0:!1;break;case 35070:s=!o&&!l?0:void 0;break}return s!==void 0?s:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!hn(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,o)=>{if(!hn(t))switch(o){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,o)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:o}=t.luma,l=o[e3];r=l&&l.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:$O,hint(t,e,n,r){return e(n,r)}};function r3(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(FO(t),i3(t),a3(t,pA),o3(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=r3;function i3(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function o3(t,e){let{target:n,target2:r}=e;Object.keys(c_).forEach(o=>{if(typeof c_[o]=="function"){const l=t[o]?t[o].bind(t):()=>{},s=c_[o].bind(null,t,l);n[o]=s,r[o]=s}})}function a3(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&s3(t,{extension:n,target:t.luma,target2:t})}function s3(t,e){let{extension:n,target:r,target2:o}=e;const l=pA[n];Xi(l);const{meta:s={}}=l,{suffix:g=""}=s,y=t.getExtension(n);for(const b of Object.keys(l)){const S="".concat(b).concat(g);let I=null;b==="meta"||typeof t[b]=="function"||(y&&typeof y[S]=="function"?I=function(){return y[S](...arguments)}:typeof l[b]=="function"&&(I=l[b].bind(r))),I&&(r[b]=I,o[b]=I)}}const K1={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Nl=(t,e,n)=>e?t.enable(n):t.disable(n),wE=(t,e,n)=>t.hint(n,e),So=(t,e,n)=>t.pixelStorei(n,e),l3=(t,e)=>{const n=hn(t)?36009:36160;return t.bindFramebuffer(n,e)},u3=(t,e)=>t.bindFramebuffer(36008,e);function bp(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const c3={3042:Nl,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Nl,2885:(t,e)=>t.cullFace(e),2929:Nl,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Nl,35723:wE,36006:l3,2886:(t,e)=>t.frontFace(e),33170:wE,2849:(t,e)=>t.lineWidth(e),32823:Nl,32824:"polygonOffset",10752:"polygonOffset",35977:Nl,32938:"sampleCoverage",32939:"sampleCoverage",3089:Nl,3088:(t,e)=>t.scissor(...e),2960:Nl,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:So,3317:So,37440:So,37441:So,37443:So,3330:So,3332:So,3331:So,36010:u3,3314:So,32878:So,3316:So,3315:So,32877:So,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=bp(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=bp(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=bp(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=bp(e)&&e.length===3?[...e,...e]:e;const[n,r,o,l,s,g]=e;t.stencilFuncSeparate(1028,n,r,o),t.stencilFuncSeparate(1029,l,s,g)},stencilOp:(t,e)=>{e=bp(e)&&e.length===3?[...e,...e]:e;const[n,r,o,l,s,g]=e;t.stencilOpSeparate(1028,n,r,o),t.stencilOpSeparate(1029,l,s,g)},viewport:(t,e)=>t.viewport(...e)};function Sr(t,e,n){return e[t]!==void 0?e[t]:n[t]}const h3={blendEquation:(t,e,n)=>t.blendEquationSeparate(Sr(32777,e,n),Sr(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Sr(32969,e,n),Sr(32968,e,n),Sr(32971,e,n),Sr(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Sr(32824,e,n),Sr(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Sr(32938,e,n),Sr(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Sr(2962,e,n),Sr(2967,e,n),Sr(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Sr(34816,e,n),Sr(36003,e,n),Sr(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Sr(2964,e,n),Sr(2965,e,n),Sr(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Sr(34817,e,n),Sr(34818,e,n),Sr(34819,e,n))},EE={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,o)=>t({32773:new Float32Array([e,n,r,o])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,o)=>t({32969:e,32968:n,32971:r,32970:o}),clearColor:(t,e,n,r,o)=>t({3106:new Float32Array([e,n,r,o])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,o)=>t({3107:[e,n,r,o]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,o)=>t({3088:new Int32Array([e,n,r,o])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,o)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:o}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,o)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:o}),viewport:(t,e,n,r,o)=>t({2978:[e,n,r,o]})},rs=(t,e)=>t.isEnabled(e),TE={3042:rs,2884:rs,2929:rs,3024:rs,32823:rs,32926:rs,32928:rs,3089:rs,2960:rs,35977:rs};function dA(t){for(const e in t)return!1;return!0}function f3(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let o=0;o<t.length;++o)if(t[o]!==e[o])return!1;return!0}return!1}function SE(t,e){const n=t[e].bind(t);t[e]=function(){const o=arguments.length<=0?void 0:arguments[0];return o in t.state.cache?t.state.enable?t.state.cache[o]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function p3(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var l=arguments.length,s=new Array(l),g=0;g<l;g++)s[g]=arguments[g];const{valueChanged:y,oldValue:b}=n(t.state._updateCache,...s);return y&&r(...s),b},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function d3(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class m3{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?y3(e):Object.assign({},K1),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Xi(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];ul(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const o=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const l in e){Xi(l!==void 0);const s=e[l],g=this.cache[l];f3(s,g)||(n=!0,r=g,o&&!(l in o)&&(o[l]=g),this.cache[l]=s)}return{valueChanged:n,oldValue:r}}}function mA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Xi(r!==void 0),!t.state){const{polyfillContext:o}=globalThis;o&&o(t),t.state=new m3(t,{copyState:r}),d3(t);for(const l in EE){const s=EE[l];p3(t,l,s)}SE(t,"getParameter"),SE(t,"isEnabled")}return t.state.enable=n,t}function g3(t){t.state||mA(t,{copyState:!1}),t.state.push()}function AE(t){Xi(t.state),t.state.pop()}function ul(t,e){if(Xi(qy(t),"setParameters requires a WebGL context"),dA(e))return;const n={};for(const o in e){const l=Number(o),s=c3[o];s&&(typeof s=="string"?n[s]=!0:s(t,e[o],l))}const r=t.state&&t.state.cache;if(r)for(const o in n){const l=h3[o];l(t,e,r)}}function y3(t,e){if(e=e||K1,typeof e=="number"){const o=e,l=TE[o];return l?l(t,o):t.getParameter(o)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const o of n){const l=TE[o];r[o]=l?l(t,Number(o)):t.getParameter(Number(o))}return r}function v3(t){ul(t,K1)}function ba(t,e,n){if(dA(e))return n(t);const{nocatch:r=!0}=e;g3(t),ul(t,e);let o;if(r)o=n(t),AE(t);else try{o=n(t)}finally{AE(t)}return o}function ef(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function h_(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=ef(t),o=t.drawingBufferWidth,l=t.drawingBufferHeight;return x3(e,r,o,l,n)}function _3(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function x3(t,e,n,r,o){const l=PE(t[0],e,n);let s=IE(t[1],e,r,o),g=PE(t[0]+1,e,n);const y=g===n-1?g:g-1;g=IE(t[1]+1,e,r,o);let b;return o?(g=g===0?g:g+1,b=s,s=g):b=g===r-1?g:g-1,{x:l,y:s,width:Math.max(y-l+1,1),height:Math.max(b-s+1,1)}}function PE(t,e,n){return Math.min(Math.round(t*e),n-1)}function IE(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const J1=ml(),b3=J1&&typeof document<"u",gA={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function yA(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Xi(J1,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},gA,t);const{width:e,height:n}=t;function r(g){if(t.throwOnError)throw new Error(g);return console.error(g),null}t.onError=r;let o;const{canvas:l}=t,s=S3({canvas:l,width:e,height:n,onError:r});return o=T3(s,t),o?(o=Q1(o,t),A3(o),o):null}function Q1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||P3(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},gA,e);const{manageState:n,debug:r}=e;return n&&mA(t,{copyState:!1,log:function(){for(var o=arguments.length,l=new Array(o),s=0;s<o;s++)l[s]=arguments[s];return Ct.log(1,...l)()}}),J1&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),Ct.level=Math.max(Ct.level,1)):Ct.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function w3(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),o=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),l=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:o||e,renderer:l||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function E3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=_3(e.useDevicePixels);I3(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function T3(t,e){const{onError:n}=e;let r=null;const o=y=>r=y.statusMessage||r;t.addEventListener("webglcontextcreationerror",o,!1);const{webgl1:l=!0,webgl2:s=!0}=e;let g=null;return s&&(g=g||t.getContext("webgl2",e),g=g||t.getContext("experimental-webgl2",e)),l&&(g=g||t.getContext("webgl",e),g=g||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",o,!1),g?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),g):n("Failed to create ".concat(s&&!l?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function S3(t){let{canvas:e,width:n=800,height:r=600,onError:o}=t,l;return typeof e=="string"?(b3&&document.readyState==="complete"||o("createGLContext called on canvas '".concat(e,"' before page was loaded")),l=document.getElementById(e)):e?l=e:(l=document.createElement("canvas"),l.id="lumagl-canvas",l.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",l.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(l,document.body.firstChild)),l}function A3(t){const e=hn(t)?"WebGL2":"WebGL1",n=w3(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",o=t.debug?" debug":"";Ct.info(1,"".concat(e).concat(o," context ").concat(r))()}function P3(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function I3(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,o="height"in n?n.height:t.canvas.clientHeight;(!r||!o)&&(Ct.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,o=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const l=t.luma.canvasSizeInfo;if(l.clientWidth!==r||l.clientHeight!==o||l.devicePixelRatio!==e){let s=e;const g=Math.floor(r*s),y=Math.floor(o*s);t.canvas.width=g,t.canvas.height=y,(t.drawingBufferWidth!==g||t.drawingBufferHeight!==y)&&(Ct.warn("Device pixel ratio clamped")(),s=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/o),t.canvas.width=Math.floor(r*s),t.canvas.height=Math.floor(o*s)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:o,devicePixelRatio:e})}}function CE(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class ME{constructor(e,n){D(this,"name",void 0),D(this,"type",void 0),D(this,"sampleSize",1),D(this,"time",void 0),D(this,"count",void 0),D(this,"samples",void 0),D(this,"lastTiming",void 0),D(this,"lastSampleTime",void 0),D(this,"lastSampleCount",void 0),D(this,"_count",0),D(this,"_time",0),D(this,"_samples",0),D(this,"_startTime",0),D(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=CE(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(CE()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class ex{constructor(e){D(this,"id",void 0),D(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof ME?this.stats[n]=e:this.stats[n]=new ME(n,r)),this.stats[n]}}const Gp="8.5.21",C3="set luma.log.level=1 (or higher) to trace rendering";class M3{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new ex({id:e})),this.stats.get(e)}}const Qu=new M3;if(globalThis.luma&&globalThis.luma.VERSION!==Gp)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Gp));globalThis.luma||(ml()&&Ct.log(1,"luma.gl ".concat(Gp," - ").concat(C3))(),globalThis.luma=globalThis.luma||{VERSION:Gp,version:Gp,log:Ct,stats:Qu,globals:{modules:{},nodeIO:{}}});function k3(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function L3(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function _t(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function f_(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return _t(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function Jl(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const p_={};function uc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";p_[t]=p_[t]||1;const e=p_[t]++;return"".concat(t,"-").concat(e)}function kE(t){return _t(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function tf(t){let e=!0;for(const n in t){e=!1;break}return e}function vA(t,e,n,r){const o="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),l=Object.getPrototypeOf(t);r.forEach(s=>{l.methodName||(l[s]=()=>{throw Ct.removed("Calling removed method ".concat(e,".").concat(s,": "),o)(),new Error(s)})})}const bh="Resource subclass must define virtual methods";let gl=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Zy(e);const{id:r,userData:o={}}=n;this.gl=e,this.gl2=e,this.id=r||uc(this[Symbol.toStringTag]),this.userData=o,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=f_(this.gl,e),_t(e);const o=(this.constructor.PARAMETERS||{})[e];if(o){const l=hn(this.gl);if(!((!("webgl2"in o)||l)&&(!("extension"in o)||this.gl.getExtension(o.extension)))){const g=o.webgl1,y="webgl2"in o?o.webgl2:o.webgl1;return l?y:g}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,o=this.constructor.PARAMETERS||{},l=hn(this.gl),s={},g=n||Object.keys(o);for(const y of g){const b=o[y];if(b&&(!("webgl2"in b)||l)&&(!("extension"in b)||this.gl.getExtension(b.extension))){const I=r?Jl(this.gl,y):y;s[I]=this.getParameter(y,e),r&&b.type==="GLenum"&&(s[I]=Jl(this.gl,s[I]))}}return s}setParameter(e,n){e=f_(this.gl,e),_t(e);const o=(this.constructor.PARAMETERS||{})[e];if(o){const l=hn(this.gl);if(!((!("webgl2"in o)||l)&&(!("extension"in o)||this.gl.getExtension(o.extension))))throw new Error("Parameter not available on this platform");o.type==="GLenum"&&(n=f_(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return vA(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(bh)}_deleteHandle(){throw new Error(bh)}_bindHandle(e){throw new Error(bh)}_getOptsFromHandle(){throw new Error(bh)}_getParameter(e,n){throw new Error(bh)}_setParameter(e,n){throw new Error(bh)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Qu.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Qu.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const o=Qu.get("Memory Usage".concat(r));o.get("GPU Memory").addCount(e),o.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=Qu.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const R3="Failed to deduce GL constant from typed array";function d0(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(R3)}}function nd(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function O3(t){let{data:e,width:n,height:r,bytesPerPixel:o=4,temp:l}=t;const s=n*o;l=l||new Uint8Array(s);for(let g=0;g<r/2;++g){const y=g*s,b=(r-g-1)*s;l.set(e.subarray(y,y+s)),e.copyWithin(y,b,b+s),e.set(l,b)}}function D3(t){let{data:e,width:n,height:r}=t;const o=Math.round(n/2),l=Math.round(r/2),s=new Uint8Array(o*l*4);for(let g=0;g<l;g++)for(let y=0;y<o;y++)for(let b=0;b<4;b++)s[(g*o+y)*4+b]=e[(g*2*n+y*2)*4+b];return{data:s,width:o,height:l}}function m0(t,e,n){const{removedProps:r={},deprecatedProps:o={},replacedProps:l={}}=n;for(const g in r)if(g in e){const b=r[g]?"".concat(t,".").concat(r[g]):"N/A";Ct.removed("".concat(t,".").concat(g),b)()}for(const g in o)if(g in e){const y=o[g];Ct.deprecated("".concat(t,".").concat(g),"".concat(t,".").concat(y))()}let s=null;for(const g in l)if(g in e){const y=l[g];Ct.deprecated("".concat(t,".").concat(g),"".concat(t,".").concat(y))(),s=s||Object.assign({},e),s[y]=e[g],delete s[g]}return s||e}const z3={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},B3={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Mo{static getBytesPerElement(e){return nd(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return _t(e.size),nd(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Mo(z3,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(o=>this._assign(o)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Mo.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Mo.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=m0("Accessor",e,B3),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const LE=10,_A={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},N3={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:_A},F3={removedProps:_A};class gn extends gl{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Mo.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Mo.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=m0("Buffer",e,N3),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=m0("Buffer",e,F3),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Mo(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:o=0}=e,l=e.byteLength||e.length;_t(n);const s=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(s,this.handle),o!==0||l!==void 0?(Yi(this.gl),this.gl.bufferSubData(this.target,r,n,o,l)):this.gl.bufferSubData(s,r,n),this.gl.bindBuffer(s,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:o=0,size:l}=e;const{gl:s}=this;return Yi(s),s.bindBuffer(36662,n.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,r,o,l),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:o=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Yi(this.gl);const l=nd(this.accessor.type||5126,{clamped:!1}),s=this._getAvailableElementCount(n),g=r;let y,b;e?(b=e.length,y=b-g):(y=Math.min(s,o||s),b=g+y);const S=Math.min(s,y);return o=o||S,_t(o<=S),e=e||new l(b),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,o),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?o!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,o):(_t(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(LE,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;_t(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const o=this._getTarget();this.gl.bindBuffer(o,this.handle),this.gl.bufferData(o,r,this.usage),this.gl.bufferSubData(o,n,e),this.gl.bindBuffer(o,null),this.debugData=e.slice(0,LE),this.bytesUsed=r,this._trackAllocatedMemory(r);const l=d0(e);return _t(l),this.setAccessor(new Mo(this.accessor,{type:l})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;_t(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const o=this._getTarget();return this.gl.bindBuffer(o,this.handle),this.gl.bufferData(o,r,n),this.gl.bindBuffer(o,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=nd(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Mo(this.accessor,{type:d0(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return Ct.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Ct.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return Ct.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return Ct.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Mo(this.accessor,e),this}}const tx={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},xA={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},bA={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function U3(t,e){const n=tx[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=hn(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function j3(t,e){const n=tx[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const V3=[9729,9728],RE=globalThis.WebGLBuffer||function(){};class nf extends gl{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:o}=n;let l=!0;return r&&(l=l&&U3(e,r),l=l&&(!o||j3(e,r))),l}constructor(e,n){const{id:r=uc("texture"),handle:o,target:l}=n;super(e,{id:r,handle:o}),this.target=l,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(U=>this.initialize(Object.assign({},e,{pixels:U,data:U}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:o=null,format:l=6408,border:s=0,recreate:g=!1,parameters:y={},pixelStore:b={},textureUnit:S=void 0}=e;n||(n=o);let{width:I,height:C,dataFormat:B,type:G,compressed:W=!1,mipmaps:he=!0}=e;const{depth:H=0}=e;return{width:I,height:C,compressed:W,dataFormat:B,type:G}=this._deduceParameters({format:l,type:G,dataFormat:B,compressed:W,data:n,width:I,height:C}),this.width=I,this.height=C,this.depth=H,this.format=l,this.type=G,this.dataFormat=B,this.border=s,this.textureUnit=S,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),he&&this._isNPOT()&&(Ct.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),he=!1,this._updateForNPOT(y)),this.mipmaps=he,this.setImageData({data:n,width:I,height:C,depth:H,format:l,type:G,dataFormat:B,border:s,mipmaps:he,parameters:b,compressed:W}),he&&this.generateMipmap(),this.setParameters(y),g&&(this.data=n),r&&(this._video={video:n,parameters:y,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:o=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:o}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(Ct.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),ba(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:o=0,format:l=this.format,border:s=this.border,offset:g=0,parameters:y={}}=e;let{data:b=null,type:S=this.type,width:I=this.width,height:C=this.height,dataFormat:B=this.dataFormat,compressed:G=!1}=e;b||(b=r),{type:S,dataFormat:B,compressed:G,width:I,height:C}=this._deduceParameters({format:l,type:S,dataFormat:B,compressed:G,data:b,width:I,height:C});const{gl:W}=this;W.bindTexture(this.target,this.handle);let he=null;({data:b,dataType:he}=this._getDataType({data:b,compressed:G}));let H,U=0;if(ba(this.gl,y,()=>{switch(he){case"null":W.texImage2D(n,o,l,I,C,s,B,S,b);break;case"typed-array":W.texImage2D(n,o,l,I,C,s,B,S,b,g);break;case"buffer":H=Yi(W),H.bindBuffer(35052,b.handle||b),H.texImage2D(n,o,l,I,C,s,B,S,g),H.bindBuffer(35052,null);break;case"browser-object":hn(W)?W.texImage2D(n,o,l,I,C,s,B,S,b):W.texImage2D(n,o,l,B,S,b);break;case"compressed":for(const[K,fe]of b.entries())W.compressedTexImage2D(n,K,fe.format,fe.width,fe.height,s,fe.data),U+=fe.levelSize;break;default:_t(!1,"Unknown image data type")}}),he==="compressed")this._trackAllocatedMemory(U,"Texture");else if(b&&b.byteLength)this._trackAllocatedMemory(b.byteLength,"Texture");else{const K=xA[this.dataFormat]||4,fe=bA[this.type]||1;this._trackAllocatedMemory(this.width*this.height*K*fe,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:o=null,x:l=0,y:s=0,width:g=this.width,height:y=this.height,level:b=0,format:S=this.format,type:I=this.type,dataFormat:C=this.dataFormat,compressed:B=!1,offset:G=0,border:W=this.border,parameters:he={}}=e;if({type:I,dataFormat:C,compressed:B,width:g,height:y}=this._deduceParameters({format:S,type:I,dataFormat:C,compressed:B,data:o,width:g,height:y}),_t(this.depth===0,"texSubImage not supported for 3D textures"),o||(o=r),o&&o.data){const H=o;o=H.data,g=H.shape[0],y=H.shape[1]}o instanceof gn&&(o=o.handle),this.gl.bindTexture(this.target,this.handle),ba(this.gl,he,()=>{if(B)this.gl.compressedTexSubImage2D(n,b,l,s,g,y,S,o);else if(o===null)this.gl.texSubImage2D(n,b,l,s,g,y,C,I,null);else if(ArrayBuffer.isView(o))this.gl.texSubImage2D(n,b,l,s,g,y,C,I,o,G);else if(o instanceof RE){const H=Yi(this.gl);H.bindBuffer(35052,o),H.texSubImage2D(n,b,l,s,g,y,C,I,G),H.bindBuffer(35052,null)}else hn(this.gl)?Yi(this.gl).texSubImage2D(n,b,l,s,g,y,C,I,o):this.gl.texSubImage2D(n,b,l,s,C,I,o)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return Ct.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof gn?{data:n.handle,dataType:"buffer"}:n instanceof RE?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:o,height:l,dataFormat:s,type:g,compressed:y}=e;const b=tx[n];return s=s||b&&b.dataFormat,g=g||b&&b.types[0],y=y||b&&b.compressed,{width:o,height:l}=this._deduceImageSize(r,o,l),{dataFormat:s,type:g,compressed:y,width:o,height:l,format:n,data:r}}_deduceImageSize(e,n,r){let o;return typeof ImageData<"u"&&e instanceof ImageData?o={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?o={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?o={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?o={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?o={width:e.videoWidth,height:e.videoHeight}:e?o={width:n,height:r}:o={width:n>=0?n:1,height:r>=0?r:1},_t(o,"Could not deduced texture size"),_t(n===void 0||o.width===n,"Deduced texture width does not match supplied width"),_t(r===void 0||o.height===r,"Deduced texture height does not match supplied height"),o}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:_t(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return hn(this.gl)||!this.width||!this.height?!1:!kE(this.width)||!kE(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:V3.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let G3="";function W3(t,e){return _t(typeof t=="string"),t=G3+t,new Promise((n,r)=>{try{const o=new Image;o.onload=()=>n(o),o.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),o.crossOrigin=e&&e.crossOrigin||"anonymous",o.src=t}catch(o){r(o)}})}class Do extends nf{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return nf.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Zy(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:W3(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const g0=[34069,34070,34071,34072,34073,34074];class wA extends nf{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Zy(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:o=0,y:l=0,mipmapLevel:s=0}=e;return this._subImage({target:n,data:r,x:o,y:l,mipmapLevel:s})}async setCubeMapImageData(e){let{width:n,height:r,pixels:o,data:l,border:s=0,format:g=6408,type:y=5121}=e;const{gl:b}=this,S=o||l,I=await Promise.all(g0.map(C=>{const B=S[C];return Promise.all(Array.isArray(B)?B:[B])}));this.bind(),g0.forEach((C,B)=>{I[B].length>1&&this.opts.mipmaps!==!1&&Ct.warn("".concat(this.id," has mipmap and multiple LODs."))(),I[B].forEach((G,W)=>{n&&r?b.texImage2D(C,W,g,n,r,s,g,y,G):b.texImage2D(C,W,g,g,y,G)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:o,pixels:l,data:s,border:g=0,format:y=6408,type:b=5121}=e,{gl:S}=this,I=l||s;return this.bind(),I instanceof Promise?I.then(C=>this.setImageDataForFace(Object.assign({},e,{face:n,data:C,pixels:C}))):this.width||this.height?S.texImage2D(n,0,y,r,o,g,y,b,I):S.texImage2D(n,0,y,y,b,I),this}}wA.FACES=g0;class H3 extends nf{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return hn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Yi(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:o,height:l,depth:s=1,border:g=0,format:y,type:b=5121,offset:S=0,data:I,parameters:C={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),ba(this.gl,C,()=>{ArrayBuffer.isView(I)&&this.gl.texImage3D(this.target,n,r,o,l,s,g,y,b,I),I instanceof gn&&(this.gl.bindBuffer(35052,I.handle),this.gl.texImage3D(this.target,n,r,o,l,s,g,y,b,S))}),I&&I.byteLength)this._trackAllocatedMemory(I.byteLength,"Texture");else{const B=xA[this.dataFormat]||4,G=bA[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*B*G,"Texture")}return this.loaded=!0,this}}const qu="EXT_color_buffer_float",OE={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:qu,bpp:2},33327:{gl2:qu,bpp:4},34842:{gl2:qu,bpp:8},33326:{gl2:qu,bpp:4},33328:{gl2:qu,bpp:8},34836:{gl2:qu,bpp:16},35898:{gl2:qu,bpp:4}};function q3(t,e,n){const r=n[e];if(!r)return!1;const o=hn(t)&&r.gl2||r.gl1;return typeof o=="string"?t.getExtension(o):o}class Ch extends gl{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||q3(e,n,OE)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:o=1,samples:l=0}=e;return _t(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),l!==0&&hn(this.gl)?this.gl.renderbufferStorageMultisample(36161,l,n,r,o):this.gl.renderbufferStorage(36161,n,r,o),this.format=n,this.width=r,this.height=o,this.samples=l,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*OE[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const Z3=256,X3=1024,Y3=16384,DE=6144,zE=6145,BE=6146,NE=34041,EA="clear: bad arguments";function nx(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:o=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const l={};e&&(l.framebuffer=e);let s=0;n&&(s|=Y3,n!==!0&&(l.clearColor=n)),r&&(s|=Z3,r!==!0&&(l.clearDepth=r)),o&&(s|=X3,r!==!0&&(l.clearStencil=r)),_t(s!==0,EA),ba(t,l,()=>{t.clear(s)})}function $3(t){let{framebuffer:e=null,buffer:n=DE,drawBuffer:r=0,value:o=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Yi(t),ba(t,{framebuffer:e},()=>{switch(n){case DE:switch(o.constructor){case Int32Array:t.clearBufferiv(n,r,o);break;case Uint32Array:t.clearBufferuiv(n,r,o);break;case Float32Array:default:t.clearBufferfv(n,r,o)}break;case zE:t.clearBufferfv(zE,0,[o]);break;case BE:t.clearBufferiv(BE,0,[o]);break;case NE:const[l,s]=o;t.clearBufferfi(NE,0,l,s);break;default:_t(!1,EA)}})}function K3(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return _t(!1),0}}function Xy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:o=6408}=e;let{sourceAttachment:l=36064,target:s=null,sourceWidth:g,sourceHeight:y,sourceType:b}=e;const{framebuffer:S,deleteFramebuffer:I}=J3(t);_t(S);const{gl:C,handle:B,attachments:G}=S;g=g||S.width,y=y||S.height,l===36064&&B===null&&(l=1028),_t(G[l]),b=b||G[l].type,s=Q3(s,b,o,g,y),b=b||d0(s);const W=C.bindFramebuffer(36160,B);return C.readPixels(n,r,g,y,o,b,s),C.bindFramebuffer(36160,W||null),I&&S.delete(),s}function FE(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Xy(t,{sourceAttachment:e}),{width:o,height:l}=t;for(;l>n;)({data:r,width:o,height:l}=D3({data:r,width:o,height:l}));O3({data:r,width:o,height:l});const s=document.createElement("canvas");s.width=o,s.height=l;const g=s.getContext("2d"),y=g.createImageData(o,l);return y.data.set(r),g.putImageData(y,0,0),s.toDataURL()}function J3(t){return t instanceof ei?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:uD(t),deleteFramebuffer:!0}}function Q3(t,e,n,r,o){if(t)return t;e=e||5121;const l=nd(e,{clamped:!1}),s=K3(n);return new l(r*o*s)}const ur={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function eD(t){const e=new Do(t,{format:6408,type:5126,dataFormat:6408}),n=new ei(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const TA={[ur.WEBGL2]:[!1,!0],[ur.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[ur.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[ur.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[ur.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[ur.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[ur.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[ur.FLOAT_BLEND]:["EXT_float_blend"],[ur.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[ur.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[ur.TEXTURE_FLOAT]:["OES_texture_float",!0],[ur.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[ur.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[ur.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[ur.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[ur.COLOR_ATTACHMENT_RGBA32F]:[eD,"EXT_color_buffer_float"],[ur.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[ur.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[ur.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[ur.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[ur.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[ur.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},tD=2;function nD(t,e){return SA(t,e)}function SA(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>AA(t,n))}function rD(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in TA)t.luma.caps[e]===void 0&&(t.luma.caps[e]=AA(t,e));return t.luma.caps}function AA(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=iD(t,e)),t.luma.caps[e]||Ct.log(tD,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function iD(t,e){const n=TA[e];_t(n,e);let r;const o=hn(t)&&n[1]||n[0];if(typeof o=="function")r=o(t);else if(Array.isArray(o)){r=!0;for(const l of o)r=r&&!!t.getExtension(l)}else typeof o=="string"?r=!!t.getExtension(o):typeof o=="boolean"?r=o:_t(!1);return r}const UE="Multiple render targets not supported";class ei extends gl{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:o}=n;let l=!0;return r&&(l=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),o&&(l=l&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),l}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new ei(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Yi(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Yi(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:o=null,color:l=!0,depth:s=!0,stencil:g=!1,check:y=!0,readBuffer:b=void 0,drawBuffers:S=void 0}=e;if(_t(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,o)for(const I in o){const C=o[I];(Array.isArray(C)?C[0]:C).resize({width:n,height:r})}else o=this._createDefaultAttachments(l,s,g,n,r);this.update({clearAttachments:!0,attachments:o,readBuffer:b,drawBuffers:S}),o&&y&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:o,clearAttachments:l=!1,resizeAttachments:s=!0}=e;this.attach(n,{clearAttachments:l,resizeAttachments:s});const{gl:g}=this,y=g.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),o&&this._setDrawBuffers(o),g.bindFramebuffer(36160,y||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return _t(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&Ct.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const o in this.attachments)this.attachments[o].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o={};n&&Object.keys(this.attachments).forEach(s=>{o[s]=null}),Object.assign(o,e);const l=this.gl.bindFramebuffer(36160,this.handle);for(const s in o){_t(s!==void 0,"Misspelled framebuffer binding point?");const g=Number(s),y=o[g];let b=y;if(!b)this._unattach(g);else if(b instanceof Ch)this._attachRenderbuffer({attachment:g,renderbuffer:b});else if(Array.isArray(y)){const[S,I=0,C=0]=y;b=S,this._attachTexture({attachment:g,texture:S,layer:I,level:C})}else this._attachTexture({attachment:g,texture:b,layer:0,level:0});r&&b&&b.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,l||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(s=>!this.attachments[s]).forEach(s=>{delete this.attachments[s]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(aD(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:o,drawBuffers:l=[]}=e,s=this.gl.bindFramebuffer(36160,this.handle);return(n||r||o)&&nx(this.gl,{color:n,depth:r,stencil:o}),l.forEach((g,y)=>{$3(this.gl,{drawBuffer:y,value:g})}),this.gl.bindFramebuffer(36160,s||null),this}readPixels(){return Ct.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return Ct.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return Ct.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return Ct.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return Ct.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return Ct.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:o=0,width:l,height:s}=e;const g=Yi(this.gl),y=g.bindFramebuffer(36008,this.handle);return r===0&&o===0&&l===void 0&&s===void 0?g.invalidateFramebuffer(36008,n):g.invalidateFramebuffer(36008,n,r,o,l,s),g.bindFramebuffer(36008,y),this}getAttachmentParameter(e,n,r){let o=this._getAttachmentParameterFallback(n);return o===null&&(this.gl.bindFramebuffer(36160,this.handle),o=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&o>1e3&&(o=Jl(this.gl,o)),o}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const o={};for(const l of r){const s=n?Jl(this.gl,l):l;o[s]=this.getAttachmentParameter(e,l,n)}return o}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const o of n){const l=Number(o),s=e?Jl(this.gl,l):l;r[s]=this.getAttachmentParameters(l,e)}return r}show(){return typeof window<"u"&&window.open(FE(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>Ct.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=FE(this,{targetMaxHeight:100});return Ct.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,o,l){let s=null;return e&&(s=s||{},s[36064]=new Do(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:o,height:l,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(s[36064])),n&&r?(s=s||{},s[33306]=new Ch(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:o,height:111}),this.ownResources.push(s[33306])):n?(s=s||{},s[36096]=new Ch(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:o,height:l}),this.ownResources.push(s[36096])):r&&_t(!1),s}_unattach(e){const n=this.attachments[e];n&&(n instanceof Ch?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:o}=this;o.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:o,level:l}=e;const{gl:s}=this;switch(s.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Yi(s).framebufferTextureLayer(36160,n,r.target,l,o);break;case 34067:const y=oD(o);s.framebufferTexture2D(36160,n,y,r.handle,l);break;case 3553:s.framebufferTexture2D(36160,n,3553,r.handle,l);break;default:_t(!1,"Illegal texture type")}s.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=OO(this.gl);n?n.readBuffer(e):_t(e===36064||e===1029,UE),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=Yi(n);if(r)r.drawBuffers(e);else{const o=n.getExtension("WEBGL_draw_buffers");o?o.drawBuffersWEBGL(e):_t(e.length===1&&(e[0]===36064||e[0]===1029),UE)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=rD(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function oD(t){return t<34069?t+34069:t}function aD(t){return(ei.STATUS||{})[t]||"Framebuffer error ".concat(t)}const sD=[36049,36048,33296,33298,33299,33300,33301,33302,33303];ei.ATTACHMENT_PARAMETERS=sD;function lD(t,e){_t(t instanceof Do||t instanceof wA||t instanceof H3);const n=t.constructor,{gl:r,width:o,height:l,format:s,type:g,dataFormat:y,border:b,mipmaps:S}=t,I=Object.assign({width:o,height:l,format:s,type:g,dataFormat:y,border:b,mipmaps:S},e);return new n(r,I)}function uD(t,e){const{gl:n,width:r,height:o,id:l}=t;return new ei(n,Object.assign({},e,{id:"framebuffer-for-".concat(l),width:r,height:o,attachments:{36064:t}}))}function Bg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const cD=35632,hD=35633;function fD(t){switch(t){case cD:return"fragment";case hD:return"vertex";default:return"unknown type"}}function pD(t,e,n,r){const o=t.split(/\r?\n/),l={},s={},g=r||Bg(e)||"(unnamed)",y="".concat(fD(n)," shader ").concat(g);for(let S=0;S<o.length;S++){const I=o[S];if(I.length<=1)continue;const C=I.split(":"),B=C[0],G=parseInt(C[2],10);if(isNaN(G))throw new Error("GLSL compilation error in ".concat(y,": ").concat(t));B!=="WARNING"?l[G]=I:s[G]=I}const b=dD(e);return{shaderName:y,errors:jE(l,b),warnings:jE(s,b)}}function jE(t,e){let n="";for(let r=0;r<e.length;r++){const o=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(o,`
`),t[r+1])){const l=t[r+1],s=l.split(":",3),g=s[0],y=parseInt(s[1],10)||0,b=l.substring(s.join(":").length+1).trim();n+=PA("^^^ ".concat(g,": ").concat(b,`

`),y)}}return n}function dD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),o=String(r.length+e-1).length;return r.map((l,s)=>{const g=String(s+e),y=g.length;return PA(g,o-y)+n+l})}function PA(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function IA(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const mD="Shader: GLSL source code must be a JavaScript string";class rd extends gl{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return _t(!1),"unknown"}}constructor(e,n){Zy(e),_t(typeof n.source=="string",mD);const r=Bg(n.source,null)||n.id||uc("unnamed ".concat(rd.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=Bg(n,null);r&&(this.id=uc(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(rd.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Bg(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:o,errors:l,warnings:s}=pD(r,this.source,this.shaderType,this.id);throw Ct.error("GLSL compilation errors in ".concat(o,`
`).concat(l))(),Ct.warn("GLSL compilation warnings in ".concat(o,`
`).concat(s))(),new Error("GLSL compilation errors in ".concat(o))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class d_ extends rd{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class m_ extends rd{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const gD={5126:Qn.bind(null,"uniform1fv",Ao,1,Oi),35664:Qn.bind(null,"uniform2fv",Ao,2,Oi),35665:Qn.bind(null,"uniform3fv",Ao,3,Oi),35666:Qn.bind(null,"uniform4fv",Ao,4,Oi),5124:Qn.bind(null,"uniform1iv",Fl,1,Oi),35667:Qn.bind(null,"uniform2iv",Fl,2,Oi),35668:Qn.bind(null,"uniform3iv",Fl,3,Oi),35669:Qn.bind(null,"uniform4iv",Fl,4,Oi),35670:Qn.bind(null,"uniform1iv",Fl,1,Oi),35671:Qn.bind(null,"uniform2iv",Fl,2,Oi),35672:Qn.bind(null,"uniform3iv",Fl,3,Oi),35673:Qn.bind(null,"uniform4iv",Fl,4,Oi),35674:Qn.bind(null,"uniformMatrix2fv",Ao,4,$s),35675:Qn.bind(null,"uniformMatrix3fv",Ao,9,$s),35676:Qn.bind(null,"uniformMatrix4fv",Ao,16,$s),35678:pi,35680:pi,5125:Qn.bind(null,"uniform1uiv",rg,1,Oi),36294:Qn.bind(null,"uniform2uiv",rg,2,Oi),36295:Qn.bind(null,"uniform3uiv",rg,3,Oi),36296:Qn.bind(null,"uniform4uiv",rg,4,Oi),35685:Qn.bind(null,"uniformMatrix2x3fv",Ao,6,$s),35686:Qn.bind(null,"uniformMatrix2x4fv",Ao,8,$s),35687:Qn.bind(null,"uniformMatrix3x2fv",Ao,6,$s),35688:Qn.bind(null,"uniformMatrix3x4fv",Ao,12,$s),35689:Qn.bind(null,"uniformMatrix4x2fv",Ao,8,$s),35690:Qn.bind(null,"uniformMatrix4x3fv",Ao,12,$s),35678:pi,35680:pi,35679:pi,35682:pi,36289:pi,36292:pi,36293:pi,36298:pi,36299:pi,36300:pi,36303:pi,36306:pi,36307:pi,36308:pi,36311:pi},yD={},vD={},_D={},VE=[0];function rx(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(VE[0]=t,t=VE);const o=t.length;if(o%e&&Ct.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let l=r[o];l||(l=new n(o),r[o]=l);for(let s=0;s<o;s++)l[s]=t[s];return l}function Ao(t,e){return rx(t,e,Float32Array,yD)}function Fl(t,e){return rx(t,e,Int32Array,vD)}function rg(t,e){return rx(t,e,Uint32Array,_D)}function GE(t,e,n){const r=gD[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function xD(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function bD(t,e,n){for(const r in t){const o=t[r];if((!n||!!n[r])&&!wD(o))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),o),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function wD(t){return Array.isArray(t)||ArrayBuffer.isView(t)?TD(t):isFinite(t)||t===!0||t===!1||t instanceof nf||t instanceof Ch?!0:t instanceof ei?!!t.texture:!1}function ED(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let o=0,l=n.length;o<l;++o)r[o]=n[o]}else t[e]=n.slice();else t[e]=n}function TD(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function pi(){let t=null;return(e,n,r)=>{const o=t!==r;return o&&(e.uniform1i(n,r),t=r),o}}function Qn(t,e,n,r){let o=null,l=null;return(s,g,y)=>{const b=e(y,n),S=b.length;let I=!1;if(o===null)o=new Float32Array(S),l=S,I=!0;else{_t(l===S,"Uniform length cannot change.");for(let C=0;C<S;++C)if(b[C]!==o[C]){I=!0;break}}return I&&(r(s,t,g,b),o.set(b)),I}}function Oi(t,e,n,r){t[e](n,r)}function $s(t,e,n,r){t[e](n,!1,r)}const SD=5120,AD=5121,PD=5122,ID=5123,WE=0,ig=1,CD=2,MD=3,og=4,kD=5,LD=6,Kr=5126,RD=35664,OD=35665,DD=35666,wp=5124,zD=35667,BD=35668,ND=35669,Ep=5125,FD=36294,UD=36295,jD=36296,VD=35670,GD=35671,WD=35672,HD=35673,qD=35674,ZD=35675,XD=35676,YD=35685,$D=35686,KD=35687,JD=35688,QD=35689,ez=35690,y0={[Kr]:[Kr,1,"float"],[RD]:[Kr,2,"vec2"],[OD]:[Kr,3,"vec3"],[DD]:[Kr,4,"vec4"],[wp]:[wp,1,"int"],[zD]:[wp,2,"ivec2"],[BD]:[wp,3,"ivec3"],[ND]:[wp,4,"ivec4"],[Ep]:[Ep,1,"uint"],[FD]:[Ep,2,"uvec2"],[UD]:[Ep,3,"uvec3"],[jD]:[Ep,4,"uvec4"],[VD]:[Kr,1,"bool"],[GD]:[Kr,2,"bvec2"],[WD]:[Kr,3,"bvec3"],[HD]:[Kr,4,"bvec4"],[qD]:[Kr,8,"mat2"],[YD]:[Kr,8,"mat2x3"],[$D]:[Kr,8,"mat2x4"],[ZD]:[Kr,12,"mat3"],[KD]:[Kr,12,"mat3x2"],[JD]:[Kr,12,"mat3x4"],[XD]:[Kr,16,"mat4"],[QD]:[Kr,16,"mat4x2"],[ez]:[Kr,16,"mat4x3"]};function tz(t){switch(t){case WE:return WE;case ig:return ig;case MD:return ig;case CD:return ig;case og:return og;case kD:return og;case LD:return og;default:return _t(!1),0}}function HE(t){const e=y0[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function CA(t,e){switch(t){case SD:case AD:case PD:case ID:t=Kr;break}for(const n in y0){const[r,o,l]=y0[n];if(r===t&&o===e)return{glType:n,name:l}}return null}class nz{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let o=0;o<r;o++){const{name:l,type:s,size:g}=n.getActiveAttrib(e.handle,o),y=n.getAttribLocation(e.handle,l);y>=0&&this._addAttribute(y,l,s,g)}this.attributeInfos.sort((o,l)=>o.location-l.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!hn(n))return;const r=n.getProgramParameter(e.handle,35971);for(let o=0;o<r;o++){const{name:l,type:s,size:g}=n.getTransformFeedbackVarying(e.handle,o);this._addVarying(o,l,s,g)}this.varyingInfos.sort((o,l)=>o.location-l.location)}_addAttribute(e,n,r,o){const{type:l,components:s}=HE(r),g={type:l,size:o*s};this._inferProperties(e,n,g);const y={location:e,name:n,accessor:new Mo(g)};this.attributeInfos.push(y),this.attributeInfosByLocation[e]=y,this.attributeInfosByName[y.name]=y}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,o){const{type:l,components:s}=HE(r),g=new Mo({type:l,size:o*s}),y={location:e,name:n,accessor:g};this.varyingInfos.push(y),this.varyingInfosByName[y.name]=y}}const qE=4,rz=35981,iz=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class MA extends gl{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",iz),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:o,varyings:l,bufferMode:s=rz}=e;return this.hash=n||"",this.vs=typeof r=="string"?new d_(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof o=="string"?new m_(this.gl,{id:"".concat(e.id,"-fs"),source:o}):o,_t(this.vs instanceof d_),_t(this.fs instanceof m_),this.uniforms={},this._textureUniforms={},l&&l.length>0&&(Yi(this.gl),this.varyings=l,this.gl2.transformFeedbackVaryings(this.handle,l,s)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new nz(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:o,offset:l=0,start:s,end:g,isIndexed:y=!1,indexType:b=5123,instanceCount:S=0,isInstanced:I=S>0,vertexArray:C=null,transformFeedback:B,framebuffer:G,parameters:W={},uniforms:he,samplers:H}=e;if((he||H)&&(Ct.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(he||{})),Ct.priority>=n){const U=G?G.id:"default",K="mode=".concat(Jl(this.gl,r)," verts=").concat(o," ")+"instances=".concat(S," indexType=").concat(Jl(this.gl,b)," ")+"isInstanced=".concat(I," isIndexed=").concat(y," ")+"Framebuffer=".concat(U);Ct.log(n,K)()}return _t(C),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||o===0||I&&S===0?!1:(C.bindForDraw(o,S,()=>{if(G!==void 0&&(W=Object.assign({},W,{framebuffer:G})),B){const U=tz(r);B.begin(U)}this._bindTextures(),ba(this.gl,W,()=>{y&&I?this.gl2.drawElementsInstanced(r,o,b,l,S):y&&hn(this.gl)&&!isNaN(s)&&!isNaN(g)?this.gl2.drawRangeElements(r,s,g,o,b,l):y?this.gl.drawElements(r,o,b,l):I?this.gl2.drawArraysInstanced(r,l,o,S):this.gl.drawArrays(r,l,o)}),B&&B.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ct.priority>=2&&bD(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],o=this._uniformSetters[n];if(o){let l=r,s=!1;if(l instanceof ei&&(l=l.texture),l instanceof nf)if(s=this.uniforms[n]!==r,s){o.textureIndex===void 0&&(o.textureIndex=this._textureIndexCounter++);const g=l,{textureIndex:y}=o;g.bind(y),l=y,this._textureUniforms[n]=g}else l=o.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(o(l)||s)&&ED(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const o of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new d_({handle:o});break;case 35632:r.fs=new m_({handle:o});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=uc(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Ct.time(qE,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),Ct.timeEnd(qE,"linkProgram for ".concat(this._getName()))(),e.debug||Ct.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:o}=xD(r.name);let l=e.getUniformLocation(this.handle,o);if(this._uniformSetters[o]=GE(e,l,r),r.size>1)for(let s=0;s<r.size;s++)l=e.getUniformLocation(this.handle,"".concat(o,"[").concat(s,"]")),this._uniformSetters["".concat(o,"[").concat(s,"]")]=GE(e,l,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const oz=34918,az=34919,sz=35007,lz=36795,uz=35976,cz=35887,hz=36202;class iy extends gl{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=hn(e),o=SA(e,ur.TIMER_QUERY);let l=r||o;for(const s of n)switch(s){case"queries":l=l&&r;break;case"timers":l=l&&o;break;default:_t(!1)}return l}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(sz)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?hz:cz)}beginTransformFeedbackQuery(){return this.begin(uz)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,az);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(lz)}getResult(){return this.gl2.getQueryParameter(this.handle,oz)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,o)=>{const l=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(o("Timed out"),this._pollingPromise=null):requestAnimationFrame(l)};requestAnimationFrame(l)}),this._pollingPromise}_createHandle(){return iy.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class kA extends gl{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return hn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Yi(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,tf(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:o,byteSize:l,byteOffset:s}=this._getBufferParams(n);return r<0?(this.unused[e]=o,Ct.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,o,s,l),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,o;return e instanceof gn?o=e:(o=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||o.byteLength-n),{buffer:o,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:o}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,o,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0;const l=n&&n.handle;return!l||o===void 0?this.gl.bindBufferBase(35982,e,l):this.gl.bindBufferRange(35982,e,l,r,o),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let ag=null;function fz(t){return(!ag||ag.byteLength<t)&&(ag=new ArrayBuffer(t)),ag}function pz(t,e){const n=fz(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function dz(t){let{target:e,source:n,start:r=0,count:o=1}=t;const l=n.length,s=o*l;let g=0;for(let y=r;g<l;g++)e[y++]=n[g];for(;g<s;)g<s-g?(e.copyWithin(r+g,r,r+g),g*=2):(e.copyWithin(r+g,r,r+s-g),g=s);return e}const mz="elements must be GL.ELEMENT_ARRAY_BUFFER";class Po extends gl{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?hn(e)||cA()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Po(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Po.MAX_ATTRIBUTES=Po.MAX_ATTRIBUTES||e.getParameter(34921),Po.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Po._setConstantFloatArray(e,n,r);break;case Int32Array:Po._setConstantIntArray(e,n,r);break;case Uint32Array:Po._setConstantUintArray(e,n,r);break;default:_t(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Po.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return _t(!e||e.target===34963,mz),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:o,type:l,stride:s,offset:g,normalized:y,integer:b,divisor:S}=r,{gl:I,gl2:C}=this;return e=Number(e),this.bind(()=>{I.bindBuffer(34962,n.handle),b?(_t(hn(I)),C.vertexAttribIPointer(e,o,l,s,g)):I.vertexAttribPointer(e,o,l,y,s,g),I.enableVertexAttribArray(e),C.vertexAttribDivisor(e,S||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Po.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),o=r.byteLength*e,l=r.length*e;let s=!this.buffer;if(this.buffer=this.buffer||new gn(this.gl,o),s=s||this.buffer.reallocate(o),s=s||!this._compareConstantArrayValues(r,this.bufferValue),s){const g=pz(n.constructor,l);dz({target:g,source:r,start:0,count:l}),this.buffer.subData(g),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:_t(!1)}}static _setConstantIntArray(e,n,r){switch(_t(hn(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:_t(!1)}}static _setConstantUintArray(e,n,r){switch(_t(hn(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:_t(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return _t(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const gz="VertexArray: attributes must be Buffers or constants (i.e. typed array)",yz=/^(.+)__LOCATION_([0-9]+)$/,vz=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class _z{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Po(e),vA(this,"VertexArray","v6.0",vz),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:o,accessor:l}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return o>=0&&(this.values[o]=n,this.accessors[o]=l,this.clearDrawParams(),this.vertexArrayObject.setBuffer(o,n,l)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:o,accessor:l}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return o>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[o]=n,this.accessors[o]=l,this.clearDrawParams(),this.vertexArrayObject.enable(o,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new gn(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof gn&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof gn&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let o;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),o=r()}),o}_resolveLocationAndAccessor(e,n,r,o){const l={location:-1,accessor:null},{location:s,name:g}=this._getAttributeIndex(e);if(!Number.isFinite(s)||s<0)return this.unused[e]=n,Ct.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),l;const y=this._getAttributeInfo(g||s);if(!y)return l;const b=this.accessors[s]||{},S=Mo.resolve(y.accessor,b,r,o),{size:I,type:C}=S;return _t(Number.isFinite(I)&&Number.isFinite(C)),{location:s,accessor:S}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=yz.exec(e),o=r?r[1]:e,l=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(o)+l,name:o}:{location:-1}}_setAttribute(e,n){if(n instanceof gn)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof gn){const r=n[0],o=n[1];this.setBuffer(e,r,o)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof gn){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(gz)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let o=this.values[0];ArrayBuffer.isView(o)&&this._setConstantAttributeZero(o,r);for(let l=1;l<this.vertexArrayObject.MAX_ATTRIBUTES;l++)o=this.values[l],ArrayBuffer.isView(o)&&this._setConstantAttribute(l,o)}_setConstantAttributeZero(e,n){if(Po.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Po.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],o=this.accessors[n];if(!r)return;const{divisor:l}=o,s=l>0;if(e.isInstanced=e.isInstanced||s,r instanceof gn){const g=r;if(s){const y=g.getVertexCount(o);e.instanceCount=Math.min(e.instanceCount,y)}else{const y=g.getVertexCount(o);e.vertexCount=Math.min(e.vertexCount,y)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ct.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function xz(t,e){const{maxElts:n=16,size:r=1}=e;let o="[";for(let s=0;s<t.length&&s<n;++s)s>0&&(o+=",".concat(s%r===0?" ":"")),o+=id(t[s],e);const l=t.length>n?"...":"]";return"".concat(o).concat(l)}function id(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return xz(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const o=t.toPrecision(2);return o.indexOf(".0")===o.length-2?o.slice(0,-1):o}function ZE(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:o=!1}=t;_t(n);const l=".*_.*",s=".*Matrix",g=n._uniformSetters,y={},b=Object.keys(g).sort();let S=0;for(const B of b)!B.match(l)&&!B.match(s)&&g_({table:y,header:e,uniforms:r,uniformName:B,undefinedOnly:o})&&S++;for(const B of b)B.match(s)&&g_({table:y,header:e,uniforms:r,uniformName:B,undefinedOnly:o})&&S++;for(const B of b)y[B]||g_({table:y,header:e,uniforms:r,uniformName:B,undefinedOnly:o})&&S++;let I=0;const C={};if(!o)for(const B in r){const G=r[B];y[B]||(I++,C[B]={Type:"NOT USED: ".concat(G),[e]:id(G)})}return{table:y,count:S,unusedTable:C,unusedCount:I}}function g_(t){let{table:e,header:n,uniforms:r,uniformName:o,undefinedOnly:l}=t;const s=r[o],g=bz(s);return!l||!g?(e[o]={[n]:g?id(s):"N/A","Uniform Type":g?s:"NOT PROVIDED"},!0):!1}function bz(t){return t!=null}function wz(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=XE(e,e.elements,null,n));const o=e.values;for(const l in o){const s=e._getAttributeInfo(l);if(s){let g="".concat(l,": ").concat(s.name);const y=e.accessors[s.location];y&&(g="".concat(l,": ").concat(Ez(s.name,y))),r[g]=XE(e,o[l],y,n)}}return r}function XE(t,e,n,r){const{gl:o}=t;if(!e)return{[r]:"null","Format ":"N/A"};let l="NOT PROVIDED",s=1,g=0,y=0,b,S,I;if(n&&(l=n.type,s=n.size,l=String(l).replace("Array",""),b=l.indexOf("nt")!==-1),e instanceof gn){const C=e,{data:B,changed:G}=C.getDebugData();S=G?"*":"",I=B,y=C.byteLength,g=y/B.BYTES_PER_ELEMENT/s;let W;if(n){const he=n.divisor>0;W="".concat(he?"I ":"P "," ").concat(g," (x").concat(s,"=").concat(y," bytes ").concat(Jl(o,l),")")}else b=!0,W="".concat(y," bytes");return{[r]:"".concat(S).concat(id(I,{size:s,isInteger:b})),"Format ":W}}return I=e,s=e.length,l=String(e.constructor.name).replace("Array",""),b=l.indexOf("nt")!==-1,{[r]:"".concat(id(I,{size:s,isInteger:b})," (constant)"),"Format ":"".concat(s,"x").concat(l," (constant)")}}function Ez(t,e){const{type:n,size:r}=e,o=CA(n,r);return o?"".concat(t," (").concat(o.name,")"):t}function Tz(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const o=YE(r);e["in ".concat(o)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const o=YE(r);e["out ".concat(o)]={[n]:JSON.stringify(r.accessor)}}return e}function YE(t){const{type:e,size:n}=t.accessor,r=CA(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const $E=ml()&&typeof document<"u";let Sz=0;class Az{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=he=>yA(he),onAddHTML:r=null,onInitialize:o=()=>{},onRender:l=()=>{},onFinalize:s=()=>{},onError:g,gl:y=null,glOptions:b={},debug:S=!1,createFramebuffer:I=!1,autoResizeViewport:C=!0,autoResizeDrawingBuffer:B=!0,stats:G=Qu.get("animation-loop-".concat(Sz++))}=e;let{useDevicePixels:W=!0}=e;"useDevicePixelRatio"in e&&(Ct.deprecated("useDevicePixelRatio","useDevicePixels")(),W=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:o,onRender:l,onFinalize:s,onError:g,gl:y,glOptions:b,debug:S,createFramebuffer:I},this.gl=y,this.needsRedraw=null,this.timeline=null,this.stats=G,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:C,autoResizeDrawingBuffer:B,useDevicePixels:W}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return _t(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=iy.isSupported(this.gl,["timers"])?new iy(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return Ct.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=$E?new Promise((e,n)=>{if($E&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):L3(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):k3(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?Q1(this.props.gl,e):this.onCreateContext(e),!qy(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");v3(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:o}=this.gl;return o&&o.clientHeight?r=o.clientWidth/o.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&E3(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new ei(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Dd="vs",ix="fs";function Ro(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const y_={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function Pz(t){const e={};for(const n in t){const r=t[n],o=Iz(r);e[n]=o}return e}function Iz(t){let e=KE(t);return e==="object"?t?"type"in t?Object.assign({},t,y_[t.type]):"value"in t?(e=KE(t.value),Object.assign({type:e},t,y_[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},y_[e])}function KE(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const Cz="vs",Mz="fs";class JE{constructor(e){let{name:n,vs:r,fs:o,dependencies:l=[],uniforms:s,getUniforms:g,deprecations:y=[],defines:b={},inject:S={},vertexShader:I,fragmentShader:C}=e;Ro(typeof n=="string"),this.name=n,this.vs=r||I,this.fs=o||C,this.getModuleUniforms=g,this.dependencies=l,this.deprecations=this._parseDeprecationDefinitions(y),this.defines=b,this.injections=kz(S),s&&(this.uniforms=Pz(s))}getModuleSource(e){let n;switch(e){case Cz:n=this.vs||"";break;case Mz:n=this.fs||"";break;default:Ro(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const o in r){const l=r[o];o in e&&!l.private?(l.validate&&Ro(l.validate(e[o],l),"".concat(this.name,": invalid ").concat(o)),n[o]=e[o]):n[o]=l.value}return n}}function kz(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const o=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[o][n]=r}return e}function Lz(t){return Rz(RA(t))}function Rz(t){const e={},n={};return LA({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,o)=>n[o]-n[r]).map(r=>e[r])}function LA(t){let{modules:e,level:n,moduleMap:r,moduleDepth:o}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const l of e)r[l.name]=l,(o[l.name]===void 0||o[l.name]<n)&&(o[l.name]=n);for(const l of e)l.dependencies&&LA({modules:l.dependencies,level:n+1,moduleMap:r,moduleDepth:o})}function RA(t,e){return t.map(n=>(n instanceof JE||(Ro(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Ro(n.name,"shader module has no name"),n=new JE(n),n.dependencies=RA(n.dependencies)),n))}function Oz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,o=n.indexOf("Trident/")!==-1;return r||o}const Dz=7936,zz=7937,Bz=7938,Nz=35724,ox={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},$u={};Object.keys(ox).forEach(t=>{$u[t]=t});function Fz(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function Uz(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||Dz),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||zz);return{gpuVendor:jz(n,r),vendor:n,renderer:r,version:t.getParameter(Bz),shadingLanguageVersion:t.getParameter(Nz)}}function jz(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const v_={};function QE(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=ox[e];if(Ro(r,e),!Oz(n))return!0;if(e in v_)return v_[e];const o=r[0],l=n.behavior||"enable",s="#extension GL_".concat(o," : ").concat(l,`
void main(void) {}`),g=t.createShader(35633);t.shaderSource(g,s),t.compileShader(g);const y=t.getShaderParameter(g,35713);return t.deleteShader(g),v_[e]=y,y}function Vz(t,e){const n=ox[e];Ro(n,e);const r=Fz(t)&&n[1]||n[0],o=typeof r=="string"?!!t.getExtension(r):r;return Ro(o===!1||o===!0),o}function sg(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Vz(t,n))}function Gz(t){switch(Uz(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function Wz(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return sg(t,$u.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),sg(t,$u.GLSL_DERIVATIVES)&&QE(t,$u.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),sg(t,$u.GLSL_FRAG_DATA)&&QE(t,$u.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),sg(t,$u.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const Hz=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,qz=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,Zz={[Dd]:Hz,[ix]:qz},Ng="__LUMA_INJECT_DECLARATIONS__",e2=/void\s+main\s*\([^)]*\)\s*\{\n?/,t2=/}\n?[^{}]*$/,__=[];function n2(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=e===Dd;for(const l in n){const s=n[l];s.sort((y,b)=>y.order-b.order),__.length=s.length;for(let y=0,b=s.length;y<b;++y)__[y]=s[y].injection;const g="".concat(__.join(`
`),`
`);switch(l){case"vs:#decl":o&&(t=t.replace(Ng,g));break;case"vs:#main-start":o&&(t=t.replace(e2,y=>y+g));break;case"vs:#main-end":o&&(t=t.replace(t2,y=>g+y));break;case"fs:#decl":o||(t=t.replace(Ng,g));break;case"fs:#main-start":o||(t=t.replace(e2,y=>y+g));break;case"fs:#main-end":o||(t=t.replace(t2,y=>g+y));break;default:t=t.replace(l,y=>y+g)}}return t=t.replace(Ng,""),r&&(t=t.replace(/\}\s*$/,l=>l+Zz[e])),t}function v0(t){const e={};return Ro(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function rf(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const OA=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Xz=[...OA,[rf("attribute"),"in $1"],[rf("varying"),"out $1"]],Yz=[...OA,[rf("varying"),"in $1"]],DA=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],$z=[...DA,[rf("in"),"attribute $1"],[rf("out"),"varying $1"]],Kz=[...DA,[rf("in"),"varying $1"]],_0="gl_FragColor",x0=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Jz=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Qz(t,e,n){switch(e){case 300:return n?oy(t,Xz):eB(t);case 100:return n?oy(t,$z):tB(t);default:throw new Error("unknown GLSL version ".concat(e))}}function oy(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function eB(t){t=oy(t,Yz);const e=t.match(x0);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(_0,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(Jz,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(_0,"\\b"),"g"),n)}return t}function tB(t){t=oy(t,Kz);const e=t.match(x0);if(e){const n=e[1];t=t.replace(x0,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),_0)}return t}const nB=`

`.concat(Ng,`

`),zA={[Dd]:"vertex",[ix]:"fragment"},rB=`precision highp float;

`;function iB(t,e){const{vs:n,fs:r}=e,o=Lz(e.modules||[]);return{gl:t,vs:r2(t,Object.assign({},e,{source:n,type:Dd,modules:o})),fs:r2(t,Object.assign({},e,{source:r,type:ix,modules:o})),getUniforms:oB(o)}}function r2(t,e){let{id:n,source:r,type:o,modules:l,defines:s={},hookFunctions:g=[],inject:y={},transpileToGLSL100:b=!1,prologue:S=!0,log:I}=e;Ro(typeof r=="string","shader source must be a string");const C=o===Dd,B=r.split(`
`);let G=100,W="",he=r;B[0].indexOf("#version ")===0?(G=300,W=B[0],he=B.slice(1).join(`
`)):W="#version ".concat(G);const H={};l.forEach(Te=>{Object.assign(H,Te.getDefines())}),Object.assign(H,s);let U=S?"".concat(W,`
`).concat(sB({id:n,source:r,type:o}),`
`).concat(aB({type:o}),`
`).concat(Gz(t),`
`).concat(Wz(t),`
`).concat(lB(H),`
`).concat(C?"":rB,`
`):"".concat(W,`
`);const K=cB(g),fe={},ye={},xe={};for(const Te in y){const De=typeof y[Te]=="string"?{injection:y[Te],order:0}:y[Te],Fe=Te.match(/^(v|f)s:(#)?([\w-]+)$/);if(Fe){const Ve=Fe[2],tt=Fe[3];Ve?tt==="decl"?ye[Te]=[De]:xe[Te]=[De]:fe[Te]=[De]}else xe[Te]=[De]}for(const Te of l){I&&Te.checkDeprecations(he,I);const De=Te.getModuleSource(o,G);U+=De;const Fe=Te.injections[o];for(const Ve in Fe){const tt=Ve.match(/^(v|f)s:#([\w-]+)$/);if(tt){const ft=tt[2]==="decl"?ye:xe;ft[Ve]=ft[Ve]||[],ft[Ve].push(Fe[Ve])}else fe[Ve]=fe[Ve]||[],fe[Ve].push(Fe[Ve])}}return U+=nB,U=n2(U,o,ye),U+=uB(K[o],fe),U+=he,U=n2(U,o,xe),U=Qz(U,b?100:G,C),U}function oB(t){return function(n){const r={};for(const o of t){const l=o.getUniforms(n,r);Object.assign(r,l)}return r}}function aB(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(zA[e].toUpperCase(),`
`)}function sB(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(zA[r],`

`):""}function lB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const o=t[r];(o||Number.isFinite(o))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function uB(t,e){let n="";for(const r in t){const o=t[r];if(n+="void ".concat(o.signature,` {
`),o.header&&(n+="  ".concat(o.header)),e[r]){const l=e[r];l.sort((s,g)=>s.order-g.order);for(const s of l)n+="  ".concat(s.injection,`
`)}o.footer&&(n+="  ".concat(o.footer)),n+=`}
`}return n}function cB(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[o,l]=n.split(":"),s=n.replace(/\(.+/,"");e[o][s]=Object.assign(r,{signature:l})}),e}const hB="void main() {gl_FragColor = vec4(0);}",BA=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,fB=`#version 300 es
`.concat(BA);function NA(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,o,l]=n;if(!e.includes(r)||!o||!l)return null;const s=l.split(";")[0];return{qualifier:r,type:o,name:s}}function FA(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:o}=t;if(!n)return e===300?fB:e>300?"#version ".concat(e,`
`).concat(BA):hB;const l=mB(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(o,`;
void main() {
  `).concat(o," = ").concat(l,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(l,`;
}`)}function pB(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ro(!1),null}}function dB(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ro(!1),null}}function mB(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Ro(!1),null}}const gB=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,yB={name:"fp32",vs:gB,fs:null};function i2(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const ko={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function vB(t,{precision:e=ko.precision}={}){return t=_B(t),"".concat(parseFloat(t.toPrecision(e)))}function of(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Xl(t,e,n){return bB(t,r=>Math.max(e,Math.min(n,r)))}function ay(t,e,n){return of(t)?t.map((r,o)=>ay(r,e[o],n)):n*e+(1-n)*t}function od(t,e,n){const r=ko.EPSILON;n&&(ko.EPSILON=n);try{if(t===e)return!0;if(of(t)&&of(e)){if(t.length!==e.length)return!1;for(let o=0;o<t.length;++o)if(!od(t[o],e[o]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=ko.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{ko.EPSILON=r}}function _B(t){return Math.round(t/ko.EPSILON)*ko.EPSILON}function xB(t){return t.clone?t.clone():new Array(t.length)}function bB(t,e,n){if(of(t)){const r=t;n=n||xB(r);for(let o=0;o<n.length&&o<r.length;++o)n[o]=e(t[o],o,n);return n}return e(t)}function wB(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class UA extends wB(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:of(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(ko)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+vB(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!od(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let o=0;o<this.ELEMENTS;++o){const l=e[o];this[o]=l+r*(n[o]-l)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(ko.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function EB(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Co(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function x_(t,e,n=""){if(ko.debug&&!EB(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class TB extends UA{get x(){return this[0]}set x(e){this[0]=Co(e)}get y(){return this[1]}set y(e){this[1]=Co(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const o=this[r]-e[r];n+=o*o}return Co(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Co(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return i2(e>=0&&e<this.ELEMENTS,"index is out of range"),Co(this[e])}setComponent(e,n){return i2(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var jr=1e-6,af=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function SB(){var t=new af(2);return af!=Float32Array&&(t[0]=0,t[1]=0),t}function ad(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function AB(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function PB(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function IB(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function jA(t,e){return t[0]=-e[0],t[1]=-e[1],t}function VA(t,e,n,r){var o=e[0],l=e[1];return t[0]=o+r*(n[0]-o),t[1]=l+r*(n[1]-l),t}function CB(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[4]*o+n[12],t[1]=n[1]*r+n[5]*o+n[13],t}var MB=AB;(function(){var t=SB();return function(e,n,r,o,l,s){var g,y;for(n||(n=2),r||(r=0),o?y=Math.min(o*n+r,e.length):y=e.length,g=r;g<y;g+=n)t[0]=e[g],t[1]=e[g+1],l(t,t,s),e[g]=t[0],e[g+1]=t[1];return e}})();function kB(t,e,n){const r=e[0],o=e[1],l=n[3]*r+n[7]*o||1;return t[0]=(n[0]*r+n[4]*o)/l,t[1]=(n[1]*r+n[5]*o)/l,t}function GA(t,e,n){const r=e[0],o=e[1],l=e[2],s=n[3]*r+n[7]*o+n[11]*l||1;return t[0]=(n[0]*r+n[4]*o+n[8]*l)/s,t[1]=(n[1]*r+n[5]*o+n[9]*l)/s,t[2]=(n[2]*r+n[6]*o+n[10]*l)/s,t}function LB(t,e,n){const r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o,t[1]=n[1]*r+n[3]*o,t[2]=e[2],t}function RB(){var t=new af(3);return af!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function OB(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function DB(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function zB(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function BB(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function NB(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function FB(t,e,n){var r=e[0],o=e[1],l=e[2],s=n[0],g=n[1],y=n[2];return t[0]=o*y-l*g,t[1]=l*s-r*y,t[2]=r*g-o*s,t}function WA(t,e,n){var r=e[0],o=e[1],l=e[2],s=n[3]*r+n[7]*o+n[11]*l+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*o+n[8]*l+n[12])/s,t[1]=(n[1]*r+n[5]*o+n[9]*l+n[13])/s,t[2]=(n[2]*r+n[6]*o+n[10]*l+n[14])/s,t}function UB(t,e,n){var r=e[0],o=e[1],l=e[2];return t[0]=r*n[0]+o*n[3]+l*n[6],t[1]=r*n[1]+o*n[4]+l*n[7],t[2]=r*n[2]+o*n[5]+l*n[8],t}function jB(t,e,n){var r=n[0],o=n[1],l=n[2],s=n[3],g=e[0],y=e[1],b=e[2],S=o*b-l*y,I=l*g-r*b,C=r*y-o*g,B=o*C-l*I,G=l*S-r*C,W=r*I-o*S,he=s*2;return S*=he,I*=he,C*=he,B*=2,G*=2,W*=2,t[0]=g+S+B,t[1]=y+I+G,t[2]=b+C+W,t}function VB(t,e,n,r){var o=[],l=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],l[0]=o[0],l[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),l[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t}function GB(t,e,n,r){var o=[],l=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],l[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),l[1]=o[1],l[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t}function WB(t,e,n,r){var o=[],l=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],l[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),l[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),l[2]=o[2],t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t}function HB(t,e){var n=t[0],r=t[1],o=t[2],l=e[0],s=e[1],g=e[2],y=Math.sqrt(n*n+r*r+o*o),b=Math.sqrt(l*l+s*s+g*g),S=y*b,I=S&&NB(t,e)/S;return Math.acos(Math.min(Math.max(I,-1),1))}var qB=DB,ZB=zB;(function(){var t=RB();return function(e,n,r,o,l,s){var g,y;for(n||(n=3),r||(r=0),o?y=Math.min(o*n+r,e.length):y=e.length,g=r;g<y;g+=n)t[0]=e[g],t[1]=e[g+1],t[2]=e[g+2],l(t,t,s),e[g]=t[0],e[g+1]=t[1],e[g+2]=t[2];return e}})();const b_=[0,0,0];let lg;class ys extends TB{static get ZERO(){return lg||(lg=new ys(0,0,0),Object.freeze(lg)),lg}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&of(e)?this.copy(e):(ko.debug&&(Co(e),Co(n),Co(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return ko.debug&&(Co(e.x),Co(e.y),Co(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Co(e)}angle(e){return HB(this,e)}cross(e){return FB(this,this,e),this.check()}rotateX({radians:e,origin:n=b_}){return VB(this,this,n,e),this.check()}rotateY({radians:e,origin:n=b_}){return GB(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=b_}){return WB(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return WA(this,this,e),this.check()}transformAsVector(e){return GA(this,this,e),this.check()}transformByMatrix3(e){return UB(this,this,e),this.check()}transformByMatrix2(e){return LB(this,this,e),this.check()}transformByQuaternion(e){return jB(this,this,e),this.check()}}class XB extends UA{toString(){let e="[";if(ko.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Co(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let o=0;o<this.RANK;++o)n[o]=this[r+o];return n}setColumn(e,n){const r=e*this.RANK;for(let o=0;o<this.RANK;++o)this[r+o]=n[o];return this}}function YB(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function $B(t,e){if(t===e){var n=e[1],r=e[2],o=e[3],l=e[6],s=e[7],g=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=l,t[11]=e[14],t[12]=o,t[13]=s,t[14]=g}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function sy(t,e){var n=e[0],r=e[1],o=e[2],l=e[3],s=e[4],g=e[5],y=e[6],b=e[7],S=e[8],I=e[9],C=e[10],B=e[11],G=e[12],W=e[13],he=e[14],H=e[15],U=n*g-r*s,K=n*y-o*s,fe=n*b-l*s,ye=r*y-o*g,xe=r*b-l*g,Te=o*b-l*y,De=S*W-I*G,Fe=S*he-C*G,Ve=S*H-B*G,tt=I*he-C*W,Bt=I*H-B*W,ft=C*H-B*he,wt=U*ft-K*Bt+fe*tt+ye*Ve-xe*Fe+Te*De;return wt?(wt=1/wt,t[0]=(g*ft-y*Bt+b*tt)*wt,t[1]=(o*Bt-r*ft-l*tt)*wt,t[2]=(W*Te-he*xe+H*ye)*wt,t[3]=(C*xe-I*Te-B*ye)*wt,t[4]=(y*Ve-s*ft-b*Fe)*wt,t[5]=(n*ft-o*Ve+l*Fe)*wt,t[6]=(he*fe-G*Te-H*K)*wt,t[7]=(S*Te-C*fe+B*K)*wt,t[8]=(s*Bt-g*Ve+b*De)*wt,t[9]=(r*Ve-n*Bt-l*De)*wt,t[10]=(G*xe-W*fe+H*U)*wt,t[11]=(I*fe-S*xe-B*U)*wt,t[12]=(g*Fe-s*tt-y*De)*wt,t[13]=(n*tt-r*Fe+o*De)*wt,t[14]=(W*K-G*ye-he*U)*wt,t[15]=(S*ye-I*K+C*U)*wt,t):null}function KB(t){var e=t[0],n=t[1],r=t[2],o=t[3],l=t[4],s=t[5],g=t[6],y=t[7],b=t[8],S=t[9],I=t[10],C=t[11],B=t[12],G=t[13],W=t[14],he=t[15],H=e*s-n*l,U=e*g-r*l,K=e*y-o*l,fe=n*g-r*s,ye=n*y-o*s,xe=r*y-o*g,Te=b*G-S*B,De=b*W-I*B,Fe=b*he-C*B,Ve=S*W-I*G,tt=S*he-C*G,Bt=I*he-C*W;return H*Bt-U*tt+K*Ve+fe*Fe-ye*De+xe*Te}function ps(t,e,n){var r=e[0],o=e[1],l=e[2],s=e[3],g=e[4],y=e[5],b=e[6],S=e[7],I=e[8],C=e[9],B=e[10],G=e[11],W=e[12],he=e[13],H=e[14],U=e[15],K=n[0],fe=n[1],ye=n[2],xe=n[3];return t[0]=K*r+fe*g+ye*I+xe*W,t[1]=K*o+fe*y+ye*C+xe*he,t[2]=K*l+fe*b+ye*B+xe*H,t[3]=K*s+fe*S+ye*G+xe*U,K=n[4],fe=n[5],ye=n[6],xe=n[7],t[4]=K*r+fe*g+ye*I+xe*W,t[5]=K*o+fe*y+ye*C+xe*he,t[6]=K*l+fe*b+ye*B+xe*H,t[7]=K*s+fe*S+ye*G+xe*U,K=n[8],fe=n[9],ye=n[10],xe=n[11],t[8]=K*r+fe*g+ye*I+xe*W,t[9]=K*o+fe*y+ye*C+xe*he,t[10]=K*l+fe*b+ye*B+xe*H,t[11]=K*s+fe*S+ye*G+xe*U,K=n[12],fe=n[13],ye=n[14],xe=n[15],t[12]=K*r+fe*g+ye*I+xe*W,t[13]=K*o+fe*y+ye*C+xe*he,t[14]=K*l+fe*b+ye*B+xe*H,t[15]=K*s+fe*S+ye*G+xe*U,t}function sd(t,e,n){var r=n[0],o=n[1],l=n[2],s,g,y,b,S,I,C,B,G,W,he,H;return e===t?(t[12]=e[0]*r+e[4]*o+e[8]*l+e[12],t[13]=e[1]*r+e[5]*o+e[9]*l+e[13],t[14]=e[2]*r+e[6]*o+e[10]*l+e[14],t[15]=e[3]*r+e[7]*o+e[11]*l+e[15]):(s=e[0],g=e[1],y=e[2],b=e[3],S=e[4],I=e[5],C=e[6],B=e[7],G=e[8],W=e[9],he=e[10],H=e[11],t[0]=s,t[1]=g,t[2]=y,t[3]=b,t[4]=S,t[5]=I,t[6]=C,t[7]=B,t[8]=G,t[9]=W,t[10]=he,t[11]=H,t[12]=s*r+S*o+G*l+e[12],t[13]=g*r+I*o+W*l+e[13],t[14]=y*r+C*o+he*l+e[14],t[15]=b*r+B*o+H*l+e[15]),t}function Yy(t,e,n){var r=n[0],o=n[1],l=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*l,t[9]=e[9]*l,t[10]=e[10]*l,t[11]=e[11]*l,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function JB(t,e,n,r){var o=r[0],l=r[1],s=r[2],g=Math.hypot(o,l,s),y,b,S,I,C,B,G,W,he,H,U,K,fe,ye,xe,Te,De,Fe,Ve,tt,Bt,ft,wt,nr;return g<jr?null:(g=1/g,o*=g,l*=g,s*=g,y=Math.sin(n),b=Math.cos(n),S=1-b,I=e[0],C=e[1],B=e[2],G=e[3],W=e[4],he=e[5],H=e[6],U=e[7],K=e[8],fe=e[9],ye=e[10],xe=e[11],Te=o*o*S+b,De=l*o*S+s*y,Fe=s*o*S-l*y,Ve=o*l*S-s*y,tt=l*l*S+b,Bt=s*l*S+o*y,ft=o*s*S+l*y,wt=l*s*S-o*y,nr=s*s*S+b,t[0]=I*Te+W*De+K*Fe,t[1]=C*Te+he*De+fe*Fe,t[2]=B*Te+H*De+ye*Fe,t[3]=G*Te+U*De+xe*Fe,t[4]=I*Ve+W*tt+K*Bt,t[5]=C*Ve+he*tt+fe*Bt,t[6]=B*Ve+H*tt+ye*Bt,t[7]=G*Ve+U*tt+xe*Bt,t[8]=I*ft+W*wt+K*nr,t[9]=C*ft+he*wt+fe*nr,t[10]=B*ft+H*wt+ye*nr,t[11]=G*ft+U*wt+xe*nr,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function HA(t,e,n){var r=Math.sin(n),o=Math.cos(n),l=e[4],s=e[5],g=e[6],y=e[7],b=e[8],S=e[9],I=e[10],C=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=l*o+b*r,t[5]=s*o+S*r,t[6]=g*o+I*r,t[7]=y*o+C*r,t[8]=b*o-l*r,t[9]=S*o-s*r,t[10]=I*o-g*r,t[11]=C*o-y*r,t}function QB(t,e,n){var r=Math.sin(n),o=Math.cos(n),l=e[0],s=e[1],g=e[2],y=e[3],b=e[8],S=e[9],I=e[10],C=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*o-b*r,t[1]=s*o-S*r,t[2]=g*o-I*r,t[3]=y*o-C*r,t[8]=l*r+b*o,t[9]=s*r+S*o,t[10]=g*r+I*o,t[11]=y*r+C*o,t}function qA(t,e,n){var r=Math.sin(n),o=Math.cos(n),l=e[0],s=e[1],g=e[2],y=e[3],b=e[4],S=e[5],I=e[6],C=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*o+b*r,t[1]=s*o+S*r,t[2]=g*o+I*r,t[3]=y*o+C*r,t[4]=b*o-l*r,t[5]=S*o-s*r,t[6]=I*o-g*r,t[7]=C*o-y*r,t}function eN(t,e){var n=e[0],r=e[1],o=e[2],l=e[3],s=n+n,g=r+r,y=o+o,b=n*s,S=r*s,I=r*g,C=o*s,B=o*g,G=o*y,W=l*s,he=l*g,H=l*y;return t[0]=1-I-G,t[1]=S+H,t[2]=C-he,t[3]=0,t[4]=S-H,t[5]=1-b-G,t[6]=B+W,t[7]=0,t[8]=C+he,t[9]=B-W,t[10]=1-b-I,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function tN(t,e,n,r,o,l,s){var g=1/(n-e),y=1/(o-r),b=1/(l-s);return t[0]=l*2*g,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l*2*y,t[6]=0,t[7]=0,t[8]=(n+e)*g,t[9]=(o+r)*y,t[10]=(s+l)*b,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*l*2*b,t[15]=0,t}function nN(t,e,n,r,o){var l=1/Math.tan(e/2),s;return t[0]=l/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,o!=null&&o!==1/0?(s=1/(r-o),t[10]=(o+r)*s,t[14]=2*o*r*s):(t[10]=-1,t[14]=-2*r),t}var ZA=nN;function rN(t,e,n,r,o,l,s){var g=1/(e-n),y=1/(r-o),b=1/(l-s);return t[0]=-2*g,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*b,t[11]=0,t[12]=(e+n)*g,t[13]=(o+r)*y,t[14]=(s+l)*b,t[15]=1,t}var iN=rN;function oN(t,e,n,r){var o,l,s,g,y,b,S,I,C,B,G=e[0],W=e[1],he=e[2],H=r[0],U=r[1],K=r[2],fe=n[0],ye=n[1],xe=n[2];return Math.abs(G-fe)<jr&&Math.abs(W-ye)<jr&&Math.abs(he-xe)<jr?YB(t):(S=G-fe,I=W-ye,C=he-xe,B=1/Math.hypot(S,I,C),S*=B,I*=B,C*=B,o=U*C-K*I,l=K*S-H*C,s=H*I-U*S,B=Math.hypot(o,l,s),B?(B=1/B,o*=B,l*=B,s*=B):(o=0,l=0,s=0),g=I*s-C*l,y=C*o-S*s,b=S*l-I*o,B=Math.hypot(g,y,b),B?(B=1/B,g*=B,y*=B,b*=B):(g=0,y=0,b=0),t[0]=o,t[1]=g,t[2]=S,t[3]=0,t[4]=l,t[5]=y,t[6]=I,t[7]=0,t[8]=s,t[9]=b,t[10]=C,t[11]=0,t[12]=-(o*G+l*W+s*he),t[13]=-(g*G+y*W+b*he),t[14]=-(S*G+I*W+C*he),t[15]=1,t)}function o2(t,e){var n=t[0],r=t[1],o=t[2],l=t[3],s=t[4],g=t[5],y=t[6],b=t[7],S=t[8],I=t[9],C=t[10],B=t[11],G=t[12],W=t[13],he=t[14],H=t[15],U=e[0],K=e[1],fe=e[2],ye=e[3],xe=e[4],Te=e[5],De=e[6],Fe=e[7],Ve=e[8],tt=e[9],Bt=e[10],ft=e[11],wt=e[12],nr=e[13],rr=e[14],Pr=e[15];return Math.abs(n-U)<=jr*Math.max(1,Math.abs(n),Math.abs(U))&&Math.abs(r-K)<=jr*Math.max(1,Math.abs(r),Math.abs(K))&&Math.abs(o-fe)<=jr*Math.max(1,Math.abs(o),Math.abs(fe))&&Math.abs(l-ye)<=jr*Math.max(1,Math.abs(l),Math.abs(ye))&&Math.abs(s-xe)<=jr*Math.max(1,Math.abs(s),Math.abs(xe))&&Math.abs(g-Te)<=jr*Math.max(1,Math.abs(g),Math.abs(Te))&&Math.abs(y-De)<=jr*Math.max(1,Math.abs(y),Math.abs(De))&&Math.abs(b-Fe)<=jr*Math.max(1,Math.abs(b),Math.abs(Fe))&&Math.abs(S-Ve)<=jr*Math.max(1,Math.abs(S),Math.abs(Ve))&&Math.abs(I-tt)<=jr*Math.max(1,Math.abs(I),Math.abs(tt))&&Math.abs(C-Bt)<=jr*Math.max(1,Math.abs(C),Math.abs(Bt))&&Math.abs(B-ft)<=jr*Math.max(1,Math.abs(B),Math.abs(ft))&&Math.abs(G-wt)<=jr*Math.max(1,Math.abs(G),Math.abs(wt))&&Math.abs(W-nr)<=jr*Math.max(1,Math.abs(W),Math.abs(nr))&&Math.abs(he-rr)<=jr*Math.max(1,Math.abs(he),Math.abs(rr))&&Math.abs(H-Pr)<=jr*Math.max(1,Math.abs(H),Math.abs(Pr))}function aN(){var t=new af(4);return af!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function sN(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function zd(t,e,n){var r=e[0],o=e[1],l=e[2],s=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*l+n[12]*s,t[1]=n[1]*r+n[5]*o+n[9]*l+n[13]*s,t[2]=n[2]*r+n[6]*o+n[10]*l+n[14]*s,t[3]=n[3]*r+n[7]*o+n[11]*l+n[15]*s,t}(function(){var t=aN();return function(e,n,r,o,l,s){var g,y;for(n||(n=4),r||(r=0),o?y=Math.min(o*n+r,e.length):y=e.length,g=r;g<y;g+=n)t[0]=e[g],t[1]=e[g+1],t[2]=e[g+2],t[3]=e[g+3],l(t,t,s),e[g]=t[0],e[g+1]=t[1],e[g+2]=t[2],e[g+3]=t[3];return e}})();var b0;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(b0||(b0={}));const lN=45*Math.PI/180,uN=1,w_=.1,E_=500,cN=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class vs extends XB{static get IDENTITY(){return fN()}static get ZERO(){return hN()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return b0}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,o,l,s,g,y,b,S,I,C,B,G,W,he){return this[0]=e,this[1]=n,this[2]=r,this[3]=o,this[4]=l,this[5]=s,this[6]=g,this[7]=y,this[8]=b,this[9]=S,this[10]=I,this[11]=C,this[12]=B,this[13]=G,this[14]=W,this[15]=he,this.check()}setRowMajor(e,n,r,o,l,s,g,y,b,S,I,C,B,G,W,he){return this[0]=e,this[1]=l,this[2]=b,this[3]=B,this[4]=n,this[5]=s,this[6]=S,this[7]=G,this[8]=r,this[9]=g,this[10]=I,this[11]=W,this[12]=o,this[13]=y,this[14]=C,this[15]=he,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(cN)}fromObject(e){return this.check()}fromQuaternion(e){return eN(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:o,top:l,near:s=w_,far:g=E_}=e;return g===1/0?pN(this,n,r,o,l,s):tN(this,n,r,o,l,s,g),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:o=[0,1,0]}=e;return oN(this,n,r,o),this.check()}ortho(e){const{left:n,right:r,bottom:o,top:l,near:s=w_,far:g=E_}=e;return iN(this,n,r,o,l,s,g),this.check()}orthographic(e){const{fovy:n=lN,aspect:r=uN,focalDistance:o=1,near:l=w_,far:s=E_}=e;a2(n);const g=n/2,y=o*Math.tan(g),b=y*r;return this.ortho({left:-b,right:b,bottom:-y,top:y,near:l,far:s})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:o=.1,far:l=500}=e;return a2(n),ZA(this,n,r,o,l),this.check()}determinant(){return KB(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),o=1/r[0],l=1/r[1],s=1/r[2];return e[0]=this[0]*o,e[1]=this[1]*l,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*o,e[5]=this[5]*l,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*o,e[9]=this[9]*l,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),o=1/r[0],l=1/r[1],s=1/r[2];return e[0]=this[0]*o,e[1]=this[1]*l,e[2]=this[2]*s,e[3]=this[4]*o,e[4]=this[5]*l,e[5]=this[6]*s,e[6]=this[8]*o,e[7]=this[9]*l,e[8]=this[10]*s,e}transpose(){return $B(this,this),this.check()}invert(){return sy(this,this),this.check()}multiplyLeft(e){return ps(this,e,this),this.check()}multiplyRight(e){return ps(this,this,e),this.check()}rotateX(e){return HA(this,this,e),this.check()}rotateY(e){return QB(this,this,e),this.check()}rotateZ(e){return qA(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return JB(this,this,e,n),this.check()}scale(e){return Yy(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return sd(this,this,e),this.check()}transform(e,n){return e.length===4?(n=zd(n||[-0,-0,-0,-0],e,this),x_(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let o;switch(r){case 2:o=CB(n||[-0,-0],e,this);break;case 3:o=WA(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return x_(o,e.length),o}transformAsVector(e,n){let r;switch(e.length){case 2:r=kB(n||[-0,-0],e,this);break;case 3:r=GA(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return x_(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let ug,cg;function hN(){return ug||(ug=new vs([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(ug)),ug}function fN(){return cg||(cg=new vs,Object.freeze(cg)),cg}function a2(t){if(t>Math.PI*2)throw Error("expected radians")}function pN(t,e,n,r,o,l){const s=2*l/(n-e),g=2*l/(o-r),y=(n+e)/(n-e),b=(o+r)/(o-r),S=-1,I=-1,C=-2*l;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=g,t[6]=0,t[7]=0,t[8]=y,t[9]=b,t[10]=S,t[11]=I,t[12]=0,t[13]=0,t[14]=C,t[15]=0,t}const dN=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,mN={name:"transform",vs:dN,fs:null};class Bd{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Bd(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:o={},inject:l={},varyings:s=[],bufferMode:g=35981,transpileToGLSL100:y=!1}=e,b=this._getModuleList(e.modules),S=this._getHash(n),I=this._getHash(r),C=b.map(K=>this._getHash(K.name)).sort(),B=s.map(K=>this._getHash(K)),G=Object.keys(o).sort(),W=Object.keys(l).sort(),he=[],H=[];for(const K of G)he.push(this._getHash(K)),he.push(this._getHash(o[K]));for(const K of W)H.push(this._getHash(K)),H.push(this._getHash(l[K]));const U="".concat(S,"/").concat(I,"D").concat(he.join("/"),"M").concat(C.join("/"),"I").concat(H.join("/"),"V").concat(B.join("/"),"H").concat(this.stateHash,"B").concat(g).concat(y?"T":"");if(!this._programCache[U]){const K=iB(this.gl,{vs:n,fs:r,modules:b,inject:l,defines:o,hookFunctions:this._hookFunctions,transpileToGLSL100:y});this._programCache[U]=new MA(this.gl,{hash:U,vs:K.vs,fs:K.fs,varyings:s,bufferMode:g}),this._getUniforms[U]=K.getUniforms||(fe=>{}),this._useCounts[U]=0}return this._useCounts[U]++,this._programCache[U]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let o=0;for(let l=0,s=this._defaultModules.length;l<s;++l){const g=this._defaultModules[l],y=g.name;n[o++]=g,r[y]=!0}for(let l=0,s=e.length;l<s;++l){const g=e[l],y=g.name;r[y]||(n[o++]=g,r[y]=!0)}return n.length=o,n}}const gN={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function yN(t,e,n){const r={};let o=e.indices;for(const l in e.attributes){const s=e.attributes[l],g=vN(l,n);if(l==="indices")o=s;else if(s.constant)r[g]=s.value;else{const y=s.value,b={...s};delete b.value,r[g]=[new gn(t,y),b],_N(l,b)}}if(o){const l=o.value||o;_t(l instanceof Uint16Array||l instanceof Uint32Array,'attribute array for "indices" must be of integer type');const s={size:1,isIndexed:o.isIndexed===void 0?!0:o.isIndexed};r.indices=[new gn(t,{data:l,target:34963}),s]}return r}function vN(t,e){const{attributeMap:n=gN}=e||{};return n&&n[t]||t}function _N(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}_t(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const wh=2,xN=1e4,bN="Model needs drawMode and vertexCount",s2=()=>{},wN={};class Nd{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=uc("model")}=n;_t(qy(e)),this.id=r,this.gl=e,this.id=n.id||uc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Bd.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:o,modules:l,defines:s,inject:g,varyings:y,bufferMode:b,transpileToGLSL100:S}=e;this.programProps={program:n,vs:r,fs:o,modules:l,defines:s,inject:g,varyings:y,bufferMode:b,transpileToGLSL100:S},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},_t(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),bN)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:o,modules:l,defines:s,inject:g,varyings:y,bufferMode:b,transpileToGLSL100:S}=e;this.programProps={program:n,vs:r,fs:o,modules:l,defines:s,inject:g,varyings:y,bufferMode:b,transpileToGLSL100:S},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return _t(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return _t(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=yN(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(tf(e))return this;const n={};for(const r in e){const o=e[r];n[r]=o.getValue?o.getValue():o}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return nx(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:o={},attributes:l={},transformFeedback:s=this.transformFeedback,parameters:g={},vertexArray:y=this.vertexArray}=e;this.setAttributes(l),this.updateModuleSettings(n),this.setUniforms(o);let b;Ct.priority>=wh&&(b=this._logDrawCallStart(wh));const S=this.vertexArray.getDrawParams(),{isIndexed:I=S.isIndexed,indexType:C=S.indexType,indexOffset:B=S.indexOffset,vertexArrayInstanced:G=S.isInstanced}=this.props;G&&!this.isInstanced&&Ct.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:W,instanceCount:he}=this,{onBeforeRender:H=s2,onAfterRender:U=s2}=this.props;H(),this.program.setUniforms(this.uniforms);const K=this.program.draw(Object.assign(wN,e,{logPriority:b,uniforms:null,framebuffer:r,parameters:g,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:y,transformFeedback:s,isIndexed:I,indexType:C,isInstanced:W,instanceCount:he,offset:I?B:0}));return U(),Ct.priority>=wh&&this._logDrawCallEnd(b,y,r),K}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:o=[]}=e;let{parameters:l}=e;r&&this._setFeedbackBuffers(r),n&&(l=Object.assign({},l,{35977:n})),o.forEach(s=>s.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:l}))}finally{o.forEach(s=>s.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ct.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:o,modules:l,inject:s,defines:g,varyings:y,bufferMode:b,transpileToGLSL100:S}=this.programProps;n=this.programManager.get({vs:r,fs:o,modules:l,inject:s,defines:g,varyings:y,bufferMode:b,transpileToGLSL100:S}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}_t(n instanceof MA,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new _z(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof gn&&n.delete()}}_setAnimationProps(e){this.animated&&_t(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(tf(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new kA(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:xN;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),Ct.group(wh,">>> DRAWING MODEL ".concat(this.id),{collapsed:Ct.level<=2})(),e}_logDrawCallEnd(e,n,r,o){if(e===void 0)return;const l=wz({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:s,unusedTable:g,unusedCount:y}=ZE({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:b,count:S}=ZE({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});S>0&&Ct.log("MISSING UNIFORMS",Object.keys(b))(),y>0&&Ct.log("UNUSED UNIFORMS",Object.keys(g))();const I=Tz(this.vertexArray.configuration);Ct.table(e,l)(),Ct.table(e,s)(),Ct.table(e+1,I)(),o&&o.log({logLevel:wh,message:"Rendered to ".concat(o.id)}),Ct.groupEnd(wh)()}}class EN{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:o}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:o}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof gn?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&_t(hn(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const o in this.feedbackMap){const l=this.feedbackMap[o];o in n&&(r[l]=o)}Object.assign(r,e.feedbackBuffers);for(const o in r){const l=r[o];if(typeof l=="string"){const s=n[l],{byteLength:g,usage:y,accessor:b}=s;r[o]=this._createNewBuffer(o,{byteLength:g,usage:y,accessor:b})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:o}=r;e.transformFeedback=new kA(this.gl,{program:o,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),o=this._getNextIndex();this.bindings[o]=this._updateBinding(this.bindings[o],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const o in this.feedbackMap){const l=this.feedbackMap[o];n[o]=e.feedbackBuffers[l],r[l]=e.sourceBuffers[o],_t(r[l]instanceof gn)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new gn(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const TN="transform_uSampler_",ly="transform_uSize_",l2="transform_position";function SN(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:o}=t,s=Object.keys(n).length,g=null;const y={};let b=e,S={};if(s>0||r){const I=b.split(`
`),C=I.slice();if(I.forEach((B,G,W)=>{if(s>0){const he=MN(B,n);if(he){const{updatedLine:H,inject:U}=he;C[G]=H,S=v0([S,U]),Object.assign(y,he.samplerTextureMap),s--}}r&&!g&&(g=CN(B,r))}),r){_t(o);const B="".concat(ly).concat(r),G="uniform vec2 ".concat(B,`;
`),W="     vec2 ".concat(l2," = transform_getPos(").concat(B,`);
     gl_Position = vec4(`).concat(l2,`, 0, 1.);
`);S=v0([S,{"vs:#decl":G,"vs:#main-start":W}])}b=C.join(`
`)}return{vs:b,targetTextureType:g,inject:S,samplerTextureMap:y}}function AN(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const o={};let l,s;n&&({width:l,height:s}=r,o["".concat(ly).concat(n)]=[l,s]);for(const g in e)({width:l,height:s}=e[g]),o["".concat(ly).concat(g)]=[l,s];return o}function PN(t){return NA(t,["attribute","in"])}function IN(t){const e="".concat(TN).concat(t),n="".concat(ly).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function CN(t,e){const n=NA(t,["varying","out"]);return n&&n.name===e?n.type:null}function MN(t,e){const n={},r=PN(t);if(!r)return null;const{type:o,name:l}=r;if(l&&e[l]){const s="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:g,sizeName:y,uniformDeclerations:b}=IN(l),S=pB(o),I="  ".concat(o," ").concat(l," = transform_getInput(").concat(g,", ").concat(y,").").concat(S,`;
`);return n[g]=l,{updatedLine:s,inject:{"vs:#decl":b,"vs:#main-start":I},samplerTextureMap:n}}return null}const kN={10241:9728,10240:9728,10242:33071,10243:33071},LN="transform_output";class RN{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:o,targetTexture:l}=this.bindings[this.currentIndex],s=Object.assign({},n,e.attributes),g=Object.assign({},e.uniforms),y=Object.assign({},e.parameters);let b=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){s.transform_elementID=this.elementIDBuffer;for(const I in this.samplerTextureMap){const C=this.samplerTextureMap[I];g[I]=r[C]}this._setSourceTextureParameters();const S=AN({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:l});Object.assign(g,S)}return this.hasTargetTexture&&(b=!1,y.viewport=[0,0,o.width,o.height]),{attributes:s,framebuffer:o,uniforms:g,discard:b,parameters:y}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=Xy(n);if(!e)return r;const o=r.constructor,l=dB(this.targetTextureType),s=new o(r.length*l/4);let g=0;for(let y=0;y<r.length;y+=4)for(let b=0;b<l;b++)s[g++]=r[y+b];return s}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof Do)return r;const o=n[r];return o?(this._targetRefTexName=r,this._createNewTexture(o)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:o}=e,l=this._createTargetTexture({sourceTextures:r,textureOrReference:o});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:l}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,o,l)=>{l[o]=o}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new gn(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),o=this._getNextIndex();this.bindings[o]=this._updateBinding(this.bindings[o],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:o,targetTexture:l}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,o),Object.assign(e.sourceBuffers,r),l){e.targetTexture=l;const{width:s,height:g}=l,{framebuffer:y}=e;y?(y.update({attachments:{36064:l},resizeAttachments:!1}),y.resize({width:s,height:g})):e.framebuffer=new ei(this.gl,{id:"transform-framebuffer",width:s,height:g,attachments:{36064:l}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(kN)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=lD(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:o,uniforms:l,targetTextureType:s,inject:g,samplerTextureMap:y}=SN({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),b=v0([e.inject||{},g]);this.targetTextureType=s,this.samplerTextureMap=y;const S=e._fs||FA({version:IA(o),input:this.targetTextureVarying,inputType:s,output:LN}),I=this.hasSourceTextures||this.targetTextureVarying?[mN].concat(e.modules||[]):e.modules;return{vs:o,fs:S,modules:I,uniforms:l,inject:b}}}class ax{static isSupported(e){return hn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();_t(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const o=r.getData(e);if(o)return o}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Nd(n,Object.assign({},e,{fs:e.fs||FA({version:IA(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const o of r)n=o.updateModelProps(n);return n}_buildResourceTransforms(e,n){ON(n)&&(this.bufferTransform=new EN(e,n)),DN(n)&&(this.textureTransform=new RN(e,n)),_t(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const o of r)n=Object.assign(n,o.getDrawOptions(n));return n}}function ON(t){return!!(!tf(t.feedbackBuffers)||!tf(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function DN(t){return!!(!tf(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}let zN=1,BN=1;class XA{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:o=1,repeat:l=1}=e,s=zN++,g={time:0,delay:n,duration:r,rate:o,repeat:l};return this._setChannelTime(g,this.time),this.channels.set(s,g),s}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const o of n)this._setChannelTime(o,this.time);const r=this.animations.values();for(const o of r){const{animation:l,channel:s}=o;l.setTime(this.getTime(s))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=BN++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,o=e.duration*e.repeat;r>=o?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const NN=[255,255,255],FN=1;let UN=0;class jN{constructor(e={}){D(this,"id",void 0),D(this,"color",void 0),D(this,"intensity",void 0),D(this,"type","ambient");const{color:n=NN}=e,{intensity:r=FN}=e;this.id=e.id||"ambient-".concat(UN++),this.color=n,this.intensity=r}}const VN=[255,255,255],GN=1,WN=[0,0,-1];let HN=0;class u2{constructor(e={}){D(this,"id",void 0),D(this,"color",void 0),D(this,"intensity",void 0),D(this,"type","directional"),D(this,"direction",void 0),D(this,"shadow",void 0);const{color:n=VN}=e,{intensity:r=GN}=e,{direction:o=WN}=e,{_shadow:l=!1}=e;this.id=e.id||"directional-".concat(HN++),this.color=n,this.intensity=r,this.type="directional",this.direction=new ys(o).normalize().toArray(),this.shadow=l}getProjectedLight(e){return this}}class qN{constructor(e,n={id:"pass"}){D(this,"id",void 0),D(this,"gl",void 0),D(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class sx extends qN{constructor(...e){super(...e),D(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return ul(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:o,views:l,onViewportActive:s,clearStack:g=!0,clearCanvas:y=!0}=e;e.pass=e.pass||"unknown";const b=this.gl;y&&XN(b,n),g&&(this._lastRenderIndex=-1);const S=[];for(const I of o){const C=l&&l[I.id];s==null||s(I);const B=this._getDrawLayerParams(I,e),G=I.subViewports||[I];for(const W of G){const he=this._drawLayersInViewport(b,{target:n,moduleParameters:r,viewport:W,view:C,pass:e.pass,layers:e.layers},B);S.push(he)}}return S}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:o=!1,layerFilter:l,cullRect:s,effects:g,moduleParameters:y},b=!1){const S=[],I=YA(this._lastRenderIndex+1),C={layer:n[0],viewport:e,isPicking:o,renderPass:r,cullRect:s},B={};for(let G=0;G<n.length;G++){const W=n[G],he=this._shouldDrawLayer(W,C,l,B),H={shouldDrawLayer:he};he&&!b&&(H.layerRenderIndex=I(W,he),H.moduleParameters=this._getModuleParameters(W,g,r,y),H.layerParameters=this.getLayerParameters(W,G,e)),S[G]=H}return S}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:o,target:l,viewport:s,view:g},y){const b=ZN(e,{moduleParameters:r,target:l,viewport:s});if(g&&g.props.clear){const I=g.props.clear===!0?{color:!0,depth:!0}:g.props.clear;ba(e,{scissorTest:!0,scissor:b},()=>nx(e,I))}const S={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};ul(e,{viewport:b});for(let I=0;I<n.length;I++){const C=n[I],{shouldDrawLayer:B,layerRenderIndex:G,moduleParameters:W,layerParameters:he}=y[I];if(B&&C.props.pickable&&S.pickableCount++,C.isComposite)S.compositeCount++;else if(B){S.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,G),W.viewport=s;try{C._drawLayer({moduleParameters:W,uniforms:{layerIndex:G},parameters:he})}catch(H){C.raiseError(H,"drawing ".concat(C," to ").concat(o))}}}return S}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,o){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let s=e.parent;for(;s;){if(!s.props.visible||!s.filterSubLayer(n))return!1;n.layer=s,s=s.parent}if(r){const g=n.layer.id;if(g in o||(o[g]=r(n)),!o[g])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,o){var l;const s=Object.assign(Object.create(((l=e.internalState)===null||l===void 0?void 0:l.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:ef(this.gl)});if(n)for(const y of n){var g;Object.assign(s,(g=y.getModuleParameters)===null||g===void 0?void 0:g.call(y,e))}return Object.assign(s,this.getModuleParameters(e,n),o)}}function YA(t=0,e={}){const n={},r=(o,l)=>{const s=o.props._offset,g=o.id,y=o.parent&&o.parent.id;let b;if(y&&!(y in e)&&r(o.parent,!1),y in n){const S=n[y]=n[y]||YA(e[y],e);b=S(o,l),n[g]=S}else Number.isFinite(s)?(b=s+(e[y]||0),n[g]=null):b=t;return l&&b>=t&&(t=b+1),e[g]=b,b};return r}function ZN(t,{moduleParameters:e,target:n,viewport:r}){const o=n&&n.id!=="default-framebuffer",l=e&&e.devicePixelRatio||ef(t),s=o?n.height:t.drawingBufferHeight,g=r;return[g.x*l,s-(g.y+g.height)*l,g.width*l,g.height*l]}function XN(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;ul(t,{viewport:[0,0,n,r]}),t.clear(16640)}class YN extends sx{constructor(e,n){super(e,n),D(this,"shadowMap",void 0),D(this,"depthBuffer",void 0),D(this,"fbo",void 0),this.shadowMap=new Do(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Ch(e,{format:33189,width:1,height:1}),this.fbo=new ei(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;ba(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],o=ef(this.gl),l=r.width*o,s=r.height*o;(l!==n.width||s!==n.height)&&n.resize({width:l,height:s}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const $A="#define SMOOTH_EDGE_RADIUS 0.5",$N=`
`.concat($A,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),KN=`
`.concat($A,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),JN={name:"geometry",vs:$N,fs:KN},QN=Object.keys(Rn).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Rn[t],";")).join(""),eF=Object.keys(cs).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(cs[t],";")).join(""),tF=Object.keys(yE).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(yE[t],";")).join(""),nF="".concat(QN,`
`).concat(eF,`
`).concat(tF,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function rF(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Fd(t){let e={},n;return r=>{for(const o in r)if(!rF(r[o],e[o])){n=t(r),e=r;break}return n}}const c2=[0,0,0,0],iF=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],KA=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],oF=[0,0,0],JA=[0,0,0],aF=Fd(uF);function QA(t,e,n=JA){n.length<3&&(n=[n[0],n[1],0]);let r=n,o,l=!0;switch(e===Rn.LNGLAT_OFFSETS||e===Rn.METER_OFFSETS?o=n:o=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case cs.WEB_MERCATOR:(e===Rn.LNGLAT||e===Rn.CARTESIAN)&&(o=[0,0,0],l=!1);break;case cs.WEB_MERCATOR_AUTO_OFFSET:e===Rn.LNGLAT?r=o:e===Rn.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],o=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case cs.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case cs.GLOBE:l=!1,o=null;break;default:l=!1}return{geospatialOrigin:o,shaderCoordinateOrigin:r,offsetMode:l}}function sF(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:o}=t;let{viewMatrix:l,viewProjectionMatrix:s}=t,g=c2,y=c2,b=t.cameraPosition;const{geospatialOrigin:S,shaderCoordinateOrigin:I,offsetMode:C}=QA(t,e,n);return C&&(y=t.projectPosition(S||I),b=[b[0]-y[0],b[1]-y[1],b[2]-y[2]],y[3]=1,g=zd([],y,s),l=r||l,s=ps([],o,l),s=ps([],s,iF)),{viewMatrix:l,viewProjectionMatrix:s,projectionCenter:g,originCommon:y,cameraPosCommon:b,shaderCoordinateOrigin:I,geospatialOrigin:S}}function lF({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Rn.DEFAULT,coordinateOrigin:o=JA,autoWrapLongitude:l=!1}){r===Rn.DEFAULT&&(r=t.isGeospatial?Rn.LNGLAT:Rn.CARTESIAN);const s=aF({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:o});return s.project_uWrapLongitude=l,s.project_uModelMatrix=n||KA,s}function uF({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:o,viewProjectionMatrix:l,originCommon:s,cameraPosCommon:g,shaderCoordinateOrigin:y,geospatialOrigin:b}=sF(t,n,r),S=t.getDistanceScales(),I=[t.width*e,t.height*e],C=zd([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,B={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:y,project_uCommonOrigin:s.slice(0,3),project_uCenter:o,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:I,project_uDevicePixelRatio:e,project_uFocalDistance:C,project_uCommonUnitsPerMeter:S.unitsPerMeter,project_uCommonUnitsPerWorldUnit:S.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:oF,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:l,project_uModelMatrix:KA,project_uCameraPosition:g};if(b){const G=t.getDistanceScales(b);switch(n){case Rn.METER_OFFSETS:B.project_uCommonUnitsPerWorldUnit=G.unitsPerMeter,B.project_uCommonUnitsPerWorldUnit2=G.unitsPerMeter2;break;case Rn.LNGLAT:case Rn.LNGLAT_OFFSETS:t._pseudoMeters||(B.project_uCommonUnitsPerMeter=G.unitsPerMeter),B.project_uCommonUnitsPerWorldUnit=G.unitsPerDegree,B.project_uCommonUnitsPerWorldUnit2=G.unitsPerDegree2;break;case Rn.CARTESIAN:B.project_uCommonUnitsPerWorldUnit=[1,1,G.unitsPerMeter[2]],B.project_uCommonUnitsPerWorldUnit2=[0,0,G.unitsPerMeter2[2]];break}}return B}const cF={};function hF(t=cF){return"viewport"in t?lF(t):{}}const eP={name:"project",dependencies:[yB,JN],vs:nF,getUniforms:hF};function Fg(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Gh(t,e){const n=zd([],e,t);return sN(n,n,1/n[3]),n}function h2(t,e){const n=t%e;return n<0?e+n:n}function fF(t,e,n){return n*e+(1-n)*t}function w0(t,e,n){return t<e?e:t>n?n:t}function pF(t){return Math.log(t)*Math.LOG2E}const lx=Math.log2||pF;function cl(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const xa=Math.PI,tP=xa/4,Ko=xa/180,E0=180/xa,sf=512,uy=4003e4,hg=85.051129,nP=1.5;function T0(t){return Math.pow(2,t)}function rP(t){return lx(t)}function hs(t){const[e,n]=t;cl(Number.isFinite(e)),cl(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Ko,o=n*Ko,l=sf*(r+xa)/(2*xa),s=sf*(xa+Math.log(Math.tan(tP+o*.5)))/(2*xa);return[l,s]}function ds(t){const[e,n]=t,r=e/sf*(2*xa)-xa,o=2*(Math.atan(Math.exp(n/sf*(2*xa)-xa))-tP);return[r*E0,o*E0]}function dF(t){const{latitude:e}=t;cl(Number.isFinite(e));const n=Math.cos(e*Ko);return rP(uy*n)-9}function T_(t){const e=Math.cos(t*Ko);return sf/uy/e}function cy(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;cl(Number.isFinite(e)&&Number.isFinite(n));const o=sf,l=Math.cos(e*Ko),s=o/360,g=s/l,y=o/uy/l,b={unitsPerMeter:[y,y,y],metersPerUnit:[1/y,1/y,1/y],unitsPerDegree:[s,g,y],degreesPerUnit:[1/s,1/g,1/y]};if(r){const S=Ko*Math.tan(e*Ko)/l,I=s*S/2,C=o/uy*S,B=C/g*y;b.unitsPerDegree2=[0,I,C],b.unitsPerMeter2=[B,0,B]}return b}function iP(t,e){const[n,r,o]=t,[l,s,g]=e,{unitsPerMeter:y,unitsPerMeter2:b}=cy({longitude:n,latitude:r,highPrecision:!0}),S=hs(t);S[0]+=l*(y[0]+b[0]*s),S[1]+=s*(y[1]+b[1]*s);const I=ds(S),C=(o||0)+(g||0);return Number.isFinite(o)||Number.isFinite(g)?[I[0],I[1],C]:I}function oP(t){const{height:e,pitch:n,bearing:r,altitude:o,scale:l,center:s}=t,g=Fg();sd(g,g,[0,0,-o]),HA(g,g,-n*Ko),qA(g,g,r*Ko);const y=l/e;return Yy(g,g,[y,y,y]),s&&sd(g,g,BB([],s)),g}function aP(t){const{width:e,height:n,altitude:r,pitch:o=0,offset:l,center:s,scale:g,nearZMultiplier:y=1,farZMultiplier:b=1}=t;let{fovy:S=lf(nP)}=t;r!==void 0&&(S=lf(r));const I=S*Ko,C=o*Ko,B=ux(S);let G=B;s&&(G+=s[2]*g/Math.cos(C)/n);const W=I*(.5+(l?l[1]:0)/n),he=Math.sin(W)*G/Math.sin(w0(Math.PI/2-C-W,.01,Math.PI-.01)),H=Math.sin(C)*he+G,U=G*10,K=Math.min(H*b,U);return{fov:I,aspect:e/n,focalDistance:B,near:y,far:K}}function mF(t){const{fov:e,aspect:n,near:r,far:o}=aP(t);return ZA([],e,n,r,o)}function lf(t){return 2*Math.atan(.5/t)*E0}function ux(t){return .5/Math.tan(.5*t*Ko)}function cx(t,e){const[n,r,o=0]=t;return cl(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o)),Gh(e,[n,r,o,1])}function ld(t,e,n=0){const[r,o,l]=t;if(cl(Number.isFinite(r)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(l))return Gh(e,[r,o,l,1]);const s=Gh(e,[r,o,0,1]),g=Gh(e,[r,o,1,1]),y=s[2],b=g[2],S=y===b?0:((n||0)-y)/(b-y);return VA([],s,g,S)}function sP(t){const{width:e,height:n,bounds:r,minExtent:o=0,maxZoom:l=24,offset:s=[0,0]}=t,[[g,y],[b,S]]=r,I=gF(t.padding),C=hs([g,w0(S,-hg,hg)]),B=hs([b,w0(y,-hg,hg)]),G=[Math.max(Math.abs(B[0]-C[0]),o),Math.max(Math.abs(B[1]-C[1]),o)],W=[e-I.left-I.right-Math.abs(s[0])*2,n-I.top-I.bottom-Math.abs(s[1])*2];cl(W[0]>0&&W[1]>0);const he=W[0]/G[0],H=W[1]/G[1],U=(I.right-I.left)/2/he,K=(I.top-I.bottom)/2/H,fe=[(B[0]+C[0])/2+U,(B[1]+C[1])/2+K],ye=ds(fe),xe=Math.min(l,lx(Math.abs(Math.min(he,H))));return cl(Number.isFinite(xe)),{longitude:ye[0],latitude:ye[1],zoom:xe}}function gF(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(cl(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const f2=Math.PI/180;function lP(t,e=0){const{width:n,height:r,unproject:o}=t,l={targetZ:e},s=o([0,r],l),g=o([n,r],l);let y,b;const S=t.fovy?.5*t.fovy*f2:Math.atan(.5/t.altitude),I=(90-t.pitch)*f2;return S>I-.01?(y=p2(t,0,e),b=p2(t,n,e)):(y=o([0,0],l),b=o([n,0],l)),[s,g,b,y]}function p2(t,e,n){const{pixelUnprojectionMatrix:r}=t,o=Gh(r,[e,0,1,1]),l=Gh(r,[e,t.height,1,1]),g=(n*t.distanceScales.unitsPerMeter[2]-o[2])/(l[2]-o[2]),y=VA([],o,l,g),b=ds(y);return b.push(n),b}let ic=class S0{constructor(e={width:1,height:1}){D(this,"latitude",void 0),D(this,"longitude",void 0),D(this,"zoom",void 0),D(this,"pitch",void 0),D(this,"bearing",void 0),D(this,"altitude",void 0),D(this,"fovy",void 0),D(this,"meterOffset",void 0),D(this,"center",void 0),D(this,"width",void 0),D(this,"height",void 0),D(this,"scale",void 0),D(this,"distanceScales",void 0),D(this,"viewMatrix",void 0),D(this,"projectionMatrix",void 0),D(this,"viewProjectionMatrix",void 0),D(this,"pixelProjectionMatrix",void 0),D(this,"pixelUnprojectionMatrix",void 0),D(this,"equals",H=>H instanceof S0?H.width===this.width&&H.height===this.height&&o2(H.projectionMatrix,this.projectionMatrix)&&o2(H.viewMatrix,this.viewMatrix):!1),D(this,"project",(H,U={})=>{const{topLeft:K=!0}=U,fe=this.projectPosition(H),ye=cx(fe,this.pixelProjectionMatrix),[xe,Te]=ye,De=K?Te:this.height-Te;return H.length===2?[xe,De]:[xe,De,ye[2]]}),D(this,"unproject",(H,U={})=>{const{topLeft:K=!0,targetZ:fe=void 0}=U,[ye,xe,Te]=H,De=K?xe:this.height-xe,Fe=fe&&fe*this.distanceScales.unitsPerMeter[2],Ve=ld([ye,De,Te],this.pixelUnprojectionMatrix,Fe),[tt,Bt,ft]=this.unprojectPosition(Ve);return Number.isFinite(Te)?[tt,Bt,ft]:Number.isFinite(fe)?[tt,Bt,fe]:[tt,Bt]}),D(this,"projectPosition",H=>{const[U,K]=hs(H),fe=(H[2]||0)*this.distanceScales.unitsPerMeter[2];return[U,K,fe]}),D(this,"unprojectPosition",H=>{const[U,K]=ds(H),fe=(H[2]||0)*this.distanceScales.metersPerUnit[2];return[U,K,fe]});let{width:n,height:r,altitude:o=null,fovy:l=null}=e;const{latitude:s=0,longitude:g=0,zoom:y=0,pitch:b=0,bearing:S=0,position:I=null,nearZMultiplier:C=.02,farZMultiplier:B=1.01}=e;n=n||1,r=r||1,l===null&&o===null?(o=nP,l=lf(o)):l===null?l=lf(o):o===null&&(o=ux(l));const G=T0(y);o=Math.max(.75,o);const W=cy({longitude:g,latitude:s}),he=hs([g,s]);he.push(0),I&&OB(he,he,ZB([],I,W.unitsPerMeter)),this.projectionMatrix=mF({width:n,height:r,scale:G,center:he,pitch:b,fovy:l,nearZMultiplier:C,farZMultiplier:B}),this.viewMatrix=oP({height:r,scale:G,center:he,pitch:b,bearing:S,altitude:o}),this.width=n,this.height=r,this.scale=G,this.latitude=s,this.longitude=g,this.zoom=y,this.pitch=b,this.bearing=S,this.altitude=o,this.fovy=l,this.center=he,this.meterOffset=I||[0,0,0],this.distanceScales=W,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:e,height:n,projectionMatrix:r,viewMatrix:o}=this,l=Fg();ps(l,l,r),ps(l,l,o),this.viewProjectionMatrix=l;const s=Fg();Yy(s,s,[e/2,-n/2,1]),sd(s,s,[1,-1,0]),ps(s,s,l);const g=sy(Fg(),s);if(!g)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=s,this.pixelUnprojectionMatrix=g}projectFlat(e){return hs(e)}unprojectFlat(e){return ds(e)}getMapCenterByLngLatPosition({lngLat:e,pos:n}){const r=ld(n,this.pixelUnprojectionMatrix),o=hs(e),l=ad([],o,jA([],r)),s=ad([],this.center,l);return ds(s)}fitBounds(e,n={}){const{width:r,height:o}=this,{longitude:l,latitude:s,zoom:g}=sP(Object.assign({width:r,height:o,bounds:e},n));return new S0({width:r,height:o,longitude:l,latitude:s,zoom:g})}getBounds(e){const n=this.getBoundingRegion(e),r=Math.min(...n.map(g=>g[0])),o=Math.max(...n.map(g=>g[0])),l=Math.min(...n.map(g=>g[1])),s=Math.max(...n.map(g=>g[1]));return[[r,l],[o,s]]}getBoundingRegion(e={}){return lP(this,e.z||0)}getLocationAtPoint({lngLat:e,pos:n}){return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}};const d2=512;function uP(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:o,latitude:l,zoom:s,bearing:g=0}=t;(o<-180||o>180)&&(o=h2(o+180,360)-180),(g<-180||g>180)&&(g=h2(g+180,360)-180);const y=lx(n/d2);if(s<=y)s=y,l=0;else{const b=n/2/Math.pow(2,s),S=ds([0,b])[1];if(l<S)l=S;else{const I=ds([0,d2-b])[1];l>I&&(l=I)}}return{width:e,height:n,longitude:o,latitude:l,zoom:s,pitch:r,bearing:g}}const cP=.01,yF=["longitude","latitude","zoom"],hP={curve:1.414,speed:1.2};function vF(t,e,n,r){const{startZoom:o,startCenterXY:l,uDelta:s,w0:g,u1:y,S:b,rho:S,rho2:I,r0:C}=fP(t,e,r);if(y<cP){const fe={};for(const ye of yF){const xe=t[ye],Te=e[ye];fe[ye]=fF(xe,Te,n)}return fe}const B=n*b,G=Math.cosh(C)/Math.cosh(C+S*B),W=g*((Math.cosh(C)*Math.tanh(C+S*B)-Math.sinh(C))/I)/y,he=1/G,H=o+rP(he),U=PB([],s,W);ad(U,U,l);const K=ds(U);return{longitude:K[0],latitude:K[1],zoom:H}}function _F(t,e,n){const r={...hP,...n},{screenSpeed:o,speed:l,maxDuration:s}=r,{S:g,rho:y}=fP(t,e,r),b=1e3*g;let S;return Number.isFinite(o)?S=b/(o/y):S=b/l,Number.isFinite(s)&&S>s?0:S}function fP(t,e,n){n=Object.assign({},hP,n);const r=n.curve,o=t.zoom,l=[t.longitude,t.latitude],s=T0(o),g=e.zoom,y=[e.longitude,e.latitude],b=T0(g-o),S=hs(l),I=hs(y),C=MB([],I,S),B=Math.max(t.width,t.height),G=B/b,W=IB(C)*s,he=Math.max(W,cP),H=r*r,U=(G*G-B*B+H*H*he*he)/(2*B*H*he),K=(G*G-B*B-H*H*he*he)/(2*G*H*he),fe=Math.log(Math.sqrt(U*U+1)-U),ye=Math.log(Math.sqrt(K*K+1)-K),xe=(ye-fe)/r;return{startZoom:o,startCenterXY:S,uDelta:C,w0:B,u1:W,S:xe,rho:r,rho2:H,r0:fe,r1:ye}}const xF=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,bF=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,wF=Fd(PF),EF=Fd(IF),TF=[0,0,0,1],SF=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function AF(t,e){const[n,r,o]=t,l=ld([n,r,o],e);return Number.isFinite(o)?l:[l[0],l[1],0]}function PF({viewport:t,center:e}){return new vs(t.viewProjectionMatrix).invert().transform(e)}function IF({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,o=t.isGeospatial?void 0:1,l=[[0,0,o],[t.width,0,o],[0,t.height,o],[t.width,t.height,o],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(s=>AF(s,r));for(const s of e){const g=s.clone().translate(new ys(t.center).negate()),y=l.map(S=>g.transform(S)),b=new vs().ortho({left:Math.min(...y.map(S=>S[0])),right:Math.max(...y.map(S=>S[0])),bottom:Math.min(...y.map(S=>S[1])),top:Math.max(...y.map(S=>S[1])),near:Math.min(...y.map(S=>-S[2])),far:Math.max(...y.map(S=>-S[2]))});n.push(b.multiplyRight(s))}return n}function CF(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||TF,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},o=wF({viewport:t.viewport,center:e.project_uCenter}),l=[],s=EF({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let g=0;g<t.shadowMatrices.length;g++){const y=s[g],b=y.clone().translate(new ys(t.viewport.center).negate());e.project_uCoordinateSystem===Rn.LNGLAT&&e.project_uProjectionMode===cs.WEB_MERCATOR?(s[g]=b,l[g]=o):(s[g]=y.clone().multiplyRight(SF),l[g]=b.transform(o))}for(let g=0;g<s.length;g++)r["shadow_uViewProjectionMatrices[".concat(g,"]")]=s[g],r["shadow_uProjectCenters[".concat(g,"]")]=l[g],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(g)]=t.shadowMaps[g]:r["shadow_uShadowMap".concat(g)]=t.dummyShadowMap;return r}const S_={name:"shadow",dependencies:[eP],vs:xF,fs:bF,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?CF(t,e):{}},MF={color:[255,255,255],intensity:1},m2=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],kF=[0,0,0,200/255];class pP{constructor(e={}){D(this,"id","lighting-effect"),D(this,"props",void 0),D(this,"shadowColor",kF),D(this,"shadow",void 0),D(this,"ambientLight",void 0),D(this,"directionalLights",void 0),D(this,"pointLights",void 0),D(this,"shadowPasses",[]),D(this,"shadowMaps",[]),D(this,"dummyShadowMap",null),D(this,"programManager",void 0),D(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:o,onViewportActive:l,views:s}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Bd.getDefaultProgramManager(e),S_&&this.programManager.addDefaultModule(S_)),this.dummyShadowMap||(this.dummyShadowMap=new Do(e,{width:1,height:1}));for(let g=0;g<this.shadowPasses.length;g++)this.shadowPasses[g].render({layers:n,layerFilter:r,viewports:o,onViewportActive:l,views:s,moduleParameters:{shadowLightId:g,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(S_),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new vs().lookAt({eye:new ys(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new YN(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new jN(MF),this.directionalLights.push(new u2(m2[0]),new u2(m2[1])))}}class LF{constructor(e={}){D(this,"_pool",[]),D(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:o,padding:l=0,copy:s=!1,initialize:g=!1,maxCount:y}){const b=o||e&&e.constructor||Float32Array,S=n*r+l;if(ArrayBuffer.isView(e)){if(S<=e.length)return e;if(S*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new b(e.buffer,0,S)}let I=1/0;y&&(I=y*r+l);const C=this._allocate(b,S,g,I);return e&&s?C.set(e):g||C.fill(0,0,4),this._release(e),C}release(e){this._release(e)}_allocate(e,n,r,o){let l=Math.max(Math.ceil(n*this.opts.overAlloc),1);l>o&&(l=o);const s=this._pool,g=e.BYTES_PER_ELEMENT*l,y=s.findIndex(b=>b.byteLength>=g);if(y>=0){const b=new e(s.splice(y,1)[0],0,l);return r&&b.fill(0),b}return new e(l)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:o}=r,l=n.findIndex(s=>s.byteLength>=o);l<0?n.push(r):(l>0||n.length<this.opts.poolSize)&&n.splice(l,0,r),n.length>this.opts.poolSize&&n.shift()}}const ud=new LF;function zp(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function RF(t){return[t[12],t[13],t[14]]}function OF(t){return{left:Eh(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Eh(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Eh(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Eh(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Eh(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Eh(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const g2=new ys;function Eh(t,e,n,r){g2.set(t,e,n);const o=g2.len();return{distance:r/o,normal:new ys(-t/o,-e/o,-n/o)}}function DF(t){return t-Math.fround(t)}let Tp;function A_(t,e){const{size:n=1,startIndex:r=0}=e,o=e.endIndex!==void 0?e.endIndex:t.length,l=(o-r)/n;Tp=ud.allocate(Tp,l,{type:Float32Array,size:n*2});let s=r,g=0;for(;s<o;){for(let y=0;y<n;y++){const b=t[s++];Tp[g+y]=b,Tp[g+y+n]=DF(b)}g+=n*2}return Tp.subarray(0,l*n*2)}function zF(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const BF=Math.PI/180,NF=zp(),y2=[0,0,0],FF={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function UF({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:o,padding:l,near:s,far:g}){const y=t/e,b=n?new vs().orthographic({fovy:r,aspect:y,focalDistance:o,near:s,far:g}):new vs().perspective({fovy:r,aspect:y,near:s,far:g});if(l){const{left:S=0,right:I=0,top:C=0,bottom:B=0}=l,G=Xl((S+t-I)/2,0,t)-t/2,W=Xl((C+e-B)/2,0,e)-e/2;b[8]-=G*2/t,b[9]+=W*2/e}return b}class xf{constructor(e={}){D(this,"id",void 0),D(this,"x",void 0),D(this,"y",void 0),D(this,"width",void 0),D(this,"height",void 0),D(this,"padding",void 0),D(this,"isGeospatial",void 0),D(this,"zoom",void 0),D(this,"focalDistance",void 0),D(this,"position",void 0),D(this,"modelMatrix",void 0),D(this,"distanceScales",void 0),D(this,"scale",void 0),D(this,"center",void 0),D(this,"cameraPosition",void 0),D(this,"projectionMatrix",void 0),D(this,"viewMatrix",void 0),D(this,"viewMatrixUncentered",void 0),D(this,"viewMatrixInverse",void 0),D(this,"viewProjectionMatrix",void 0),D(this,"pixelProjectionMatrix",void 0),D(this,"pixelUnprojectionMatrix",void 0),D(this,"resolution",void 0),D(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||FF,this.focalDistance=e.focalDistance||1,this.position=e.position||y2,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?cs.WEB_MERCATOR:cs.WEB_MERCATOR_AUTO_OFFSET:cs.IDENTITY}equals(e){return e instanceof xf?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&od(e.projectionMatrix,this.projectionMatrix)&&od(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),o=cx(r,this.pixelProjectionMatrix),[l,s]=o,g=n?s:this.height-s;return e.length===2?[l,g]:[l,g,o[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[o,l,s]=e,g=n?l:this.height-l,y=r&&r*this.distanceScales.unitsPerMeter[2],b=ld([o,g,s],this.pixelUnprojectionMatrix,y),[S,I,C]=this.unprojectPosition(b);return Number.isFinite(s)?[S,I,C]:Number.isFinite(r)?[S,I,r]:[S,I]}projectPosition(e){const[n,r]=this.projectFlat(e),o=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,o]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),o=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,o]}projectFlat(e){if(this.isGeospatial){const n=hs(e);return n[1]=Xl(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?ds(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),o=this.unproject([this.width,0],n),l=this.unproject([0,this.height],n),s=this.unproject([this.width,this.height],n);return[Math.min(r[0],o[0],l[0],s[0]),Math.min(r[1],o[1],l[1],s[1]),Math.max(r[0],o[0],l[0],s[0]),Math.max(r[1],o[1],l[1],s[1])]}getDistanceScales(e){return e?cy({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:o=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+o}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,OF(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=dF({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||cy({latitude:r,longitude:n}));const o=Math.pow(2,this.zoom);this.scale=o;const{position:l,modelMatrix:s}=e;let g=y2;if(l&&(g=s?new vs(s).transformAsVector(l,[]):l),this.isGeospatial){const y=this.projectPosition([n,r,0]);this.center=new ys(g).scale(this.distanceScales.unitsPerMeter).add(y)}else this.center=this.projectPosition(g)}_initMatrices(e){const{viewMatrix:n=NF,projectionMatrix:r=null,orthographic:o=!1,fovyRadians:l,fovy:s=75,near:g=.1,far:y=1e3,padding:b=null,focalDistance:S=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new vs().multiplyRight(n).translate(new ys(this.center).negate()),this.projectionMatrix=r||UF({width:this.width,height:this.height,orthographic:o,fovyRadians:l||s*BF,focalDistance:S,padding:b,near:g,far:y});const I=zp();ps(I,I,this.projectionMatrix),ps(I,I,this.viewMatrix),this.viewProjectionMatrix=I,this.viewMatrixInverse=sy([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=RF(this.viewMatrixInverse);const C=zp(),B=zp();Yy(C,C,[this.width/2,-this.height/2,1]),sd(C,C,[1,-1,0]),ps(B,C,this.viewProjectionMatrix),this.pixelProjectionMatrix=B,this.pixelUnprojectionMatrix=sy(zp(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Fn.warn("Pixel project matrix not invertible")()}}D(xf,"displayName","Viewport");class uf extends xf{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:o=0,pitch:l=0,bearing:s=0,nearZMultiplier:g=.1,farZMultiplier:y=1.01,nearZ:b,farZ:S,orthographic:I=!1,projectionMatrix:C,repeat:B=!1,worldOffset:G=0,position:W,padding:he,legacyMeterSizes:H=!1}=e;let{width:U,height:K,altitude:fe=1.5}=e;const ye=Math.pow(2,o);U=U||1,K=K||1;let xe,Te=null;if(C)fe=C[5]/2,xe=lf(fe);else{e.fovy?(xe=e.fovy,fe=ux(xe)):xe=lf(fe);let Fe;if(he){const{top:Ve=0,bottom:tt=0}=he;Fe=[0,Xl((Ve+K-tt)/2,0,K)-K/2]}Te=aP({width:U,height:K,scale:ye,center:W&&[0,0,W[2]*T_(n)],offset:Fe,pitch:l,fovy:xe,nearZMultiplier:g,farZMultiplier:y}),Number.isFinite(b)&&(Te.near=b),Number.isFinite(S)&&(Te.far=S)}let De=oP({height:K,pitch:l,bearing:s,scale:ye,altitude:fe});G&&(De=new vs().translate([512*G,0,0]).multiplyLeft(De)),super({...e,width:U,height:K,viewMatrix:De,longitude:r,latitude:n,zoom:o,...Te,fovy:xe,focalDistance:fe}),D(this,"longitude",void 0),D(this,"latitude",void 0),D(this,"pitch",void 0),D(this,"bearing",void 0),D(this,"altitude",void 0),D(this,"fovy",void 0),D(this,"orthographic",void 0),D(this,"_subViewports",void 0),D(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=o,this.pitch=l,this.bearing=s,this.altitude=fe,this.fovy=xe,this.orthographic=I,this._subViewports=B?[]:null,this._pseudoMeters=H,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let o=n;o<=r;o++){const l=o?new uf({...this,worldOffset:o}):this;this._subViewports.push(l)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),o=(e[2]||0)*T_(e[1]);return[n,r,o]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),o=(e[2]||0)/T_(r);return[n,r,o]}addMetersToLngLat(e,n){return iP(e,n)}panByPosition(e,n){const r=ld(n,this.pixelUnprojectionMatrix),o=this.projectFlat(e),l=ad([],o,jA([],r)),s=ad([],this.center,l),[g,y]=this.unprojectFlat(s);return{longitude:g,latitude:y}}getBounds(e={}){const n=lP(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:o}=this,{longitude:l,latitude:s,zoom:g}=sP({width:r,height:o,bounds:e,...n});return new uf({width:r,height:o,longitude:l,latitude:s,zoom:g})}}D(uf,"displayName","WebMercatorViewport");const v2=[0,0,0];function P_(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof uf){const[o,l,s=0]=t,g=e.getDistanceScales([o,l]);r[2]=s*g.unitsPerMeter[2]}return r}function jF(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:o,fromCoordinateSystem:l,fromCoordinateOrigin:s}=t;return o===Rn.DEFAULT&&(o=e.isGeospatial?Rn.LNGLAT:Rn.CARTESIAN),l===void 0&&(l=o),s===void 0&&(s=r),{viewport:e,coordinateSystem:o,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:l,fromCoordinateOrigin:s}}function dP(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:o,offsetMode:l}){let[s,g,y=0]=t;switch(n&&([s,g,y]=zd([],[s,g,y,1],n)),r){case Rn.LNGLAT:return P_([s,g,y],e,l);case Rn.LNGLAT_OFFSETS:return P_([s+o[0],g+o[1],y+(o[2]||0)],e,l);case Rn.METER_OFFSETS:return P_(iP(o,[s,g,y]),e,l);case Rn.CARTESIAN:default:return e.isGeospatial?[s+o[0],g+o[1],y+o[2]]:e.projectPosition([s,g,y])}}function VF(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:o,modelMatrix:l,fromCoordinateSystem:s,fromCoordinateOrigin:g}=jF(e),{autoOffset:y=!0}=e,{geospatialOrigin:b=v2,shaderCoordinateOrigin:S=v2,offsetMode:I=!1}=y?QA(n,r,o):{},C=dP(t,{viewport:n,modelMatrix:l,coordinateSystem:s,coordinateOrigin:g,offsetMode:I});if(I){const B=n.projectPosition(b||S);qB(C,C,B)}return C}const _2={blendFunc:[1,0,32771,0],blendEquation:32774};class mP extends sx{constructor(...e){super(...e),D(this,"pickZ",void 0),D(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:o,onViewportActive:l,pickingFBO:s,deviceRect:{x:g,y,width:b,height:S},cullRect:I,effects:C,pass:B="picking",pickZ:G,moduleParameters:W}){const he=this.gl;this.pickZ=G;const H=this._resetColorEncoder(G),U=ba(he,{scissorTest:!0,scissor:[g,y,b,S],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],..._2,blend:!G},()=>super.render({target:s,layers:e,layerFilter:n,views:r,viewports:o,onViewportActive:l,cullRect:I,effects:C==null?void 0:C.filter(fe=>fe.useInPicking),pass:B,isPicking:!0,moduleParameters:W}));return this._colorEncoderState=null,{decodePickingColor:H&&WF.bind(null,H),stats:U}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const o={...e.props.parameters},{pickable:l,operation:s}=e.props;return this._colorEncoderState?l&&s.includes("draw")&&(Object.assign(o,_2),o.blend=!0,o.blendColor=GF(this._colorEncoderState,e,r)):o.blend=!1,s.includes("terrain")&&(o.blend=!1),o}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function GF(t,e,n){const{byLayer:r,byAlpha:o}=t;let l,s=r.get(e);return s?(s.viewports.push(n),l=s.a):(l=r.size+1,l<=255?(s={a:l,layer:e,viewports:[n]},r.set(e,s),o[l]=s):(Fn.warn("Too many pickable layers, only picking the first 255")(),l=0)),[0,0,0,l/255]}function WF(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Ih={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},hy=Symbol.for("component"),oc=Symbol.for("propTypes"),I_=Symbol.for("deprecatedProps"),Wh=Symbol.for("asyncPropDefaults"),cc=Symbol.for("asyncPropOriginal"),Yl=Symbol.for("asyncPropResolved");function gP(t,e=()=>!0){return Array.isArray(t)?yP(t,e,[]):e(t)?[t]:[]}function yP(t,e,n){let r=-1;for(;++r<t.length;){const o=t[r];Array.isArray(o)?yP(o,e,n):e(o)&&n.push(o)}return n}function HF({target:t,source:e,start:n=0,count:r=1}){const o=e.length,l=r*o;let s=0;for(let g=n;s<o;s++)t[g++]=e[s];for(;s<l;)s<l-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+l-s),s=l);return t}class qF{constructor(e,n,r){D(this,"id",void 0),D(this,"context",void 0),D(this,"isLoaded",void 0),D(this,"persistent",void 0),D(this,"_loadCount",0),D(this,"_subscribers",new Set),D(this,"_data",void 0),D(this,"_loader",void 0),D(this,"_error",void 0),D(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let o=e;typeof e=="string"&&(o=Qh(e)),o instanceof Promise?(this.isLoaded=!1,this._loader=o.then(l=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=l)}).catch(l=>{this._loadCount===r&&(this.isLoaded=!0,this._error=l||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const l of this._subscribers)l.onChange(this.getData())}}class ZF{constructor({gl:e,protocol:n}){D(this,"protocol",void 0),D(this,"_context",void 0),D(this,"_resources",void 0),D(this,"_consumers",void 0),D(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:o=!0}){let l=this._resources[e];l?l.setData(n,r):(l=new qF(e,n,this._context),this._resources[e]=l),l.persistent=o}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const o=n[r],l=this._resources[o.resourceId];l&&l.unsubscribe(o)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:o="default"}){const{_resources:l,protocol:s}=this;e.startsWith(s)&&(e=e.replace(s,""),l[e]||this.add({resourceId:e,data:null,persistent:!1}));const g=l[e];if(this._track(r,o,g,n),g)return g.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,o){const l=this._consumers,s=l[e]=l[e]||{},g=s[n]||{},y=g.resourceId&&this._resources[g.resourceId];y&&(y.unsubscribe(g),this.prune()),r&&(s[n]=g,g.onChange=o,g.resourceId=r.id,r.subscribe(g))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const XF=[eP],YF=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function $F(t){const e=Bd.getDefaultProgramManager(t);for(const n of XF)e.addDefaultModule(n);for(const n of YF)e.addShaderHook(n);return e}const KF="layerManager.setLayers",JF="layerManager.activateViewport";class QF{constructor(e,{deck:n,stats:r,viewport:o,timeline:l}={}){D(this,"layers",void 0),D(this,"context",void 0),D(this,"resourceManager",void 0),D(this,"_lastRenderedLayers",[]),D(this,"_needsRedraw",!1),D(this,"_needsUpdate",!1),D(this,"_nextLayers",null),D(this,"_debug",!1),D(this,"activateViewport",s=>{Zi(JF,this,s),s&&(this.context.viewport=s)}),this.layers=[],this.resourceManager=new ZF({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&$F(e),stats:r||new ex({id:"deck.gl"}),viewport:o||new xf({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:l||new XA,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const o=r.getNeedsRedraw(e);n=n||o}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Zi(KF,this,n,e),this._lastRenderedLayers=e;const r=gP(e,Boolean);for(const o of r)o.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const s of e)r[s.id]?Fn.warn("Multiple old layers with same id ".concat(s.id))():r[s.id]=s;const o=[];this._updateSublayersRecursively(n,r,o),this._finalizeOldLayers(r);let l=!1;for(const s of o)if(s.hasUniformTransition()){l="Uniform transition in ".concat(s);break}this._needsUpdate=l,this.layers=o}_updateSublayersRecursively(e,n,r){for(const o of e){o.context=this.context;const l=n[o.id];l===null&&Fn.warn("Multiple new layers with same id ".concat(o.id))(),n[o.id]=null;let s=null;try{this._debug&&l!==o&&o.validateProps(),l?(this._transferLayerState(l,o),this._updateLayer(o)):this._initializeLayer(o),r.push(o),s=o.isComposite?o.getSubLayers():null}catch(g){this._handleError("matching",g,o)}s&&this._updateSublayersRecursively(s,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Ih.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Ih.MATCHED,n!==e&&(e.lifecycle=Ih.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Ih.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Ih.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function fs(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!fs(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),o=Object.keys(e);if(r.length!==o.length)return!1;for(const l of r)if(!e.hasOwnProperty(l)||!fs(t[l],e[l],n-1))return!1;return!0}return!1}class e4{constructor(e){D(this,"width",void 0),D(this,"height",void 0),D(this,"views",void 0),D(this,"viewState",void 0),D(this,"controllers",void 0),D(this,"timeline",void 0),D(this,"_viewports",void 0),D(this,"_viewportMap",void 0),D(this,"_isUpdating",void 0),D(this,"_needsRedraw",void 0),D(this,"_needsUpdate",void 0),D(this,"_eventManager",void 0),D(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),o={x:e[0],y:e[1]};for(let l=r.length-1;l>=0;--l){const s=r[l];if(s.containsPixel(o)){const g=e.slice();return g[0]-=s.x,g[1]-=s.y,s.unproject(g,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=gP(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!fs(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Fn.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:l=>{var s;return(s=this.getView(e.id))===null||s===void 0?void 0:s.makeViewport({viewState:l,width:this.width,height:this.height})}})}_updateController(e,n,r,o){const l=e.controller;if(l&&r){const s={...n,...l,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!o||o.constructor!==l.type)&&(o=this._createController(e,s)),o&&o.setProps(s),o}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let o=e.length;o--;){const l=e[o],s=this.getViewState(l),g=l.makeViewport({viewState:s,width:this.width,height:this.height});let y=n[l.id];const b=!!l.controller;b&&!y&&(r=!0),(r||!b)&&y&&(y.finalize(),y=null),this.controllers[l.id]=this._updateController(l,s,g,y),g&&this._viewports.unshift(g)}for(const o in n){const l=n[o];l&&!this.controllers[o]&&l.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,o)=>!e[o].equals(n[o]))}}const t4=/([0-9]+\.?[0-9]*)(%|px)/;function Ul(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=t4.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function jl(t,e){return t.relative?Math.round(t.position*e):t.position}function mi(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class cf{constructor(e){D(this,"id",void 0),D(this,"viewportInstance",void 0),D(this,"_x",void 0),D(this,"_y",void 0),D(this,"_width",void 0),D(this,"_height",void 0),D(this,"_padding",void 0),D(this,"props",void 0);const{id:n,x:r=0,y:o=0,width:l="100%",height:s="100%",padding:g=null,viewportInstance:y}=e||{};mi(!y||y instanceof xf),this.viewportInstance=y,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Ul(r),this._y=Ul(o),this._width=Ul(l),this._height=Ul(s),this._padding=g&&{left:Ul(g.left||0),right:Ul(g.right||0),top:Ul(g.top||0),bottom:Ul(g.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&fs(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const o=this.getDimensions({width:e,height:n});return!o.height||!o.width?null:new this.ViewportType({...r,...this.props,...o})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:jl(this._x,e),y:jl(this._y,n),width:jl(this._width,e),height:jl(this._height,n)};return this._padding&&(r.padding={left:jl(this._padding.left,e),top:jl(this._padding.top,n),right:jl(this._padding.right,e),bottom:jl(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class Ud{constructor(e){D(this,"_inProgress",void 0),D(this,"_handle",void 0),D(this,"_timeline",void 0),D(this,"time",void 0),D(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:o}=this;this._handle=r.addChannel({delay:r.getTime(),duration:o.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const x2=()=>{},A0={BREAK:1,SNAP_TO_END:2,IGNORE:3},n4=t=>t,r4=A0.BREAK;let i4=class{constructor(e){D(this,"getControllerState",void 0),D(this,"props",void 0),D(this,"propsInTransition",void 0),D(this,"transition",void 0),D(this,"onViewStateChange",void 0),D(this,"onStateChange",void 0),D(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:o,startProps:l,endProps:s,duration:g,easing:y}}=n,b=y(r/g),S=o.interpolateProps(l,s,b);this.propsInTransition=this.getControllerState({...this.props,...S}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Ud(e.timeline),this.onViewStateChange=e.onViewStateChange||x2,this.onStateChange=e.onStateChange||x2}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let o=r;if(this.transition.inProgress){const{interruption:l,endProps:s}=this.transition.settings;o={...r,...l===A0.SNAP_TO_END?s:this.propsInTransition||r}}this._triggerTransition(o,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===A0.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),o=this.getControllerState(n).shortestPathFrom(r),l=n.transitionInterpolator,s=l.getDuration?l.getDuration(e,n):n.transitionDuration;if(s===0)return;const g=l.initializeProps(e,o);this.propsInTransition={};const y={duration:s,easing:n.transitionEasing||n4,interpolator:l,interruption:n.transitionInterruption||r4,startProps:g.start,endProps:g.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(y),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}},o4=class{constructor(e){D(this,"_propsToCompare",void 0),D(this,"_propsToExtract",void 0),D(this,"_requiredProps",void 0);const{compare:n,extract:r,required:o}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=o}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!od(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},o={};for(const l of this._propsToExtract)(l in e||l in n)&&(r[l]=e[l],o[l]=n[l]);return this._checkRequiredProps(r),this._checkRequiredProps(o),{start:r,end:o}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];mi(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}};const a4=["longitude","latitude","zoom","bearing","pitch"],s4=["longitude","latitude","zoom"];let vP=class extends o4{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:a4,required:s4},super(r.transitionProps),D(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:o,around:l}=this.opts;if(o&&l){const s=o(e),g=o(n),y=s.unproject(l);r.start.around=l,Object.assign(r.end,{around:g.project(y),aroundPosition:y,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const o={};for(const l of this._propsToExtract)o[l]=ay(e[l]||0,n[l]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const l=this.opts.makeViewport({...n,...o});Object.assign(o,l.panByPosition(n.aroundPosition,ay(e.around,n.around,r)))}return o}};const Vl={transitionDuration:0},l4=300,fg=t=>1-(1-t)*(1-t),Th={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Zu={};class u4{constructor(e){D(this,"props",void 0),D(this,"state",{}),D(this,"transitionManager",void 0),D(this,"eventManager",void 0),D(this,"onViewStateChange",void 0),D(this,"onStateChange",void 0),D(this,"makeViewport",void 0),D(this,"_controllerState",void 0),D(this,"_events",{}),D(this,"_interactionState",{isDragging:!1}),D(this,"_customEvents",[]),D(this,"_eventStartBlocked",null),D(this,"_panMove",!1),D(this,"invertPan",!1),D(this,"dragMode","rotate"),D(this,"inertia",0),D(this,"scrollZoom",!0),D(this,"dragPan",!0),D(this,"dragRotate",!0),D(this,"doubleClickZoom",!0),D(this,"touchZoom",!0),D(this,"touchRotate",!1),D(this,"keyboard",!0),this.transitionManager=new i4({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:o}=e;return[o.x-n,o.y-r]}isPointInBounds(e,n){const{width:r,height:o}=this.props;if(n&&n.handled)return!1;const l=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=o;return l&&n&&n.stopPropagation(),l}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?l4:0;const{scrollZoom:r=!0,dragPan:o=!0,dragRotate:l=!0,doubleClickZoom:s=!0,touchZoom:g=!0,touchRotate:y=!1,keyboard:b=!0}=e,S=!!this.onViewStateChange;this.toggleEvents(Th.WHEEL,S&&r),this.toggleEvents(Th.PAN,S),this.toggleEvents(Th.PINCH,S&&(g||y)),this.toggleEvents(Th.TRIPLE_PAN,S&&y),this.toggleEvents(Th.DOUBLE_TAP,S&&s),this.toggleEvents(Th.KEYBOARD,S&&b),this.scrollZoom=r,this.dragPan=o,this.dragRotate=l,this.doubleClickZoom=s,this.touchZoom=g,this.touchRotate=y,this.keyboard=b}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const o={...e.getViewportProps(),...n},l=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),l){const s=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:o,interactionState:this._interactionState,oldViewState:s})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const o=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(o,Vl,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Vl,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),o=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],l=this.controllerState.pan({pos:o}).panEnd();this.updateViewport(l,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:fg},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Vl,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),o=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],l=this.controllerState.rotate({pos:o}).rotateEnd();this.updateViewport(l,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:fg},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:r=.01,smooth:o=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:l}=e;let s=2/(1+Math.exp(-Math.abs(l*r)));l<0&&s!==0&&(s=1/s);const g=this.controllerState.zoom({pos:n,scale:s});return this.updateViewport(g,{...this._getTransitionProps({around:n}),transitionDuration:o?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Vl,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Vl,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),o=[r[0],r[1]+=e.velocityY*n/2],l=this.controllerState.rotate({pos:o});this.updateViewport(l,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:fg},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Zu._startPinchRotation=e.rotation,Zu._lastPinchEvent=e,this.updateViewport(r,Vl,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,o=this.getCenter(e);n=n.zoom({pos:o,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Zu._startPinchRotation-r})}return this.updateViewport(n,Vl,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Zu._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Zu;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const o=this.getCenter(e);let l=this.controllerState.rotateEnd();const s=Math.log2(e.scale),g=(s-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),y=Math.pow(2,s+g*n/2);l=l.zoom({pos:o,scale:y}).zoomEnd(),this.updateViewport(l,{...this._getTransitionProps({around:o}),transitionDuration:n,transitionEasing:fg},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const o=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(o,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Zu._startPinchRotation=null,Zu._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),o=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(o,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:o,rotateSpeedX:l,rotateSpeedY:s}=this.keyboard===!0?{}:this.keyboard,{controllerState:g}=this;let y;const b={};switch(e.srcEvent.code){case"Minus":y=n?g.zoomOut(r).zoomOut(r):g.zoomOut(r),b.isZooming=!0;break;case"Equal":y=n?g.zoomIn(r).zoomIn(r):g.zoomIn(r),b.isZooming=!0;break;case"ArrowLeft":n?(y=g.rotateLeft(l),b.isRotating=!0):(y=g.moveLeft(o),b.isPanning=!0);break;case"ArrowRight":n?(y=g.rotateRight(l),b.isRotating=!0):(y=g.moveRight(o),b.isPanning=!0);break;case"ArrowUp":n?(y=g.rotateUp(s),b.isRotating=!0):(y=g.moveUp(o),b.isPanning=!0);break;case"ArrowDown":n?(y=g.rotateDown(s),b.isRotating=!0):(y=g.moveDown(o),b.isPanning=!0);break;default:return!1}return this.updateViewport(y,this._getTransitionProps(),b),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Vl:e?{...n,transitionInterpolator:new vP({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class c4{constructor(e,n){D(this,"_viewportProps",void 0),D(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const b2=5,h4=1.2;let f4=class extends c4{constructor(e){const{width:n,height:r,latitude:o,longitude:l,zoom:s,bearing:g=0,pitch:y=0,altitude:b=1.5,position:S=[0,0,0],maxZoom:I=20,minZoom:C=0,maxPitch:B=60,minPitch:G=0,startPanLngLat:W,startZoomLngLat:he,startRotatePos:H,startBearing:U,startPitch:K,startZoom:fe,normalize:ye=!0}=e;mi(Number.isFinite(l)),mi(Number.isFinite(o)),mi(Number.isFinite(s)),super({width:n,height:r,latitude:o,longitude:l,zoom:s,bearing:g,pitch:y,altitude:b,maxZoom:I,minZoom:C,maxPitch:B,minPitch:G,normalize:ye,position:S},{startPanLngLat:W,startZoomLngLat:he,startRotatePos:H,startBearing:U,startPitch:K,startZoom:fe}),D(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const l=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(l)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:o,startBearing:l,startPitch:s}=this.getState();if(!o||l===void 0||s===void 0)return this;let g;return e?g=this._getNewRotation(e,o,s,l):g={bearing:l+n,pitch:s+r},this._getUpdatedState(g)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:o,startZoomLngLat:l}=this.getState();if(l||(o=this.getViewportProps().zoom,l=this._unproject(n)||this._unproject(e)),!l)return this;const{maxZoom:s,minZoom:g}=this.getViewportProps();let y=o+Math.log2(r);y=Xl(y,g,s);const b=this.makeViewport({...this.getViewportProps(),zoom:y});return this._getUpdatedState({zoom:y,...b.panByPosition(l,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:o,longitude:l}=r;return Math.abs(o-n.bearing)>180&&(r.bearing=o<0?o+360:o-360),Math.abs(l-n.longitude)>180&&(r.longitude=l<0?l+360:l-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:o}=e;e.zoom=Xl(o,r,n);const{maxPitch:l,minPitch:s,pitch:g}=e;e.pitch=Xl(g,s,l);const{normalize:y=!0}=e;return y&&Object.assign(e,uP(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,o){const l=e[0]-n[0],s=e[1]-n[1],g=e[1],y=n[1],{width:b,height:S}=this.getViewportProps(),I=l/b;let C=0;s>0?Math.abs(S-y)>b2&&(C=s/(y-S)*h4):s<0&&y>b2&&(C=1-g/y),C=Xl(C,-1,1);const{minPitch:B,maxPitch:G}=this.getViewportProps(),W=o+180*I;let he=r;return C>0?he=r+C*(G-r):C<0&&(he=r-C*(B-r)),{pitch:he,bearing:W}}},p4=class extends u4{constructor(...e){super(...e),D(this,"ControllerState",f4),D(this,"transition",{transitionDuration:300,transitionInterpolator:new vP({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),D(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}};class _P extends cf{get ViewportType(){return uf}get ControllerType(){return p4}}D(_P,"displayName","MapView");const d4=new pP;function m4(t,e){var n,r;const o=(n=t.order)!==null&&n!==void 0?n:1/0,l=(r=e.order)!==null&&r!==void 0?r:1/0;return o-l}class g4{constructor(){D(this,"effects",void 0),D(this,"_resolvedEffects",[]),D(this,"_defaultEffects",[]),D(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(o=>m4(o,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(fs(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const o of this.effects)n[o.id]=o;const r=[];for(const o of e){const l=n[o.id];l&&l!==o?l.setProps?(l.setProps(o.props),r.push(l)):(l.cleanup(),r.push(o)):r.push(o),delete n[o.id]}for(const o in n)n[o].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(o=>o instanceof pP)||this._resolvedEffects.push(d4),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class y4 extends sx{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const v4="deckRenderer.renderLayers";class _4{constructor(e){D(this,"gl",void 0),D(this,"layerFilter",void 0),D(this,"drawPickingColors",void 0),D(this,"drawLayersPass",void 0),D(this,"pickLayersPass",void 0),D(this,"renderCount",void 0),D(this,"_needsRedraw",void 0),D(this,"renderBuffers",void 0),D(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new y4(e),this.pickLayersPass=new mP(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||ei.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const o=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,l=n.render({...r,target:o});r.effects&&this._postRender(r.effects,r),this.renderCount++,Zi(v4,this,l,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new ei(this.gl),new ei(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,o={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const l of e)if(l.postRender){if(l.id===this.lastPostProcessEffect){o.target=n.target,l.postRender(this.gl,o);break}const s=l.postRender(this.gl,o);o.inputBuffer=s,o.swapBuffer=s===r[0]?r[1]:r[0]}}}const x4={pickedColor:null,pickedObjectIndex:-1};function b4({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:o,deviceRect:l}){const{x:s,y:g,width:y,height:b}=l;let S=o*o,I=-1,C=0;for(let B=0;B<b;B++){const G=B+g-r,W=G*G;if(W>S)C+=4*y;else for(let he=0;he<y;he++){if(t[C+3]-1>=0){const U=he+s-n,K=U*U+W;K<=S&&(S=K,I=C)}C+=4}}if(I>=0){const B=t.slice(I,I+4),G=e(B);if(G){const W=Math.floor(I/4/y),he=I/4-W*y;return{...G,pickedColor:B,pickedX:s+he,pickedY:g+W}}Fn.error("Picked non-existent layer. Is picking buffer corrupt?")()}return x4}function w4({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const l=t.slice(r,r+4),s=l.join(",");if(!n.has(s)){const g=e(l);g?n.set(s,{...g,color:l}):Fn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function xP({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:o,z:l}){let s=e[0];e.length>1&&(s=T4((t==null?void 0:t.pickedViewports)||e,{x:r,y:o}));let g;if(s){const y=[r-s.x,o-s.y];l!==void 0&&(y[2]=l),g=s.unproject(y)}return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:r,y:o,pixel:[r,o],coordinate:g,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function E4(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:o}=t,{pickedColor:l,pickedLayer:s,pickedObjectIndex:g}=e,y=s?[s]:[];if(r==="hover"){const I=n.index,C=n.layerId,B=s?s.props.id:null;if(B!==C||g!==I){if(B!==C){const G=o.find(W=>W.props.id===C);G&&y.unshift(G)}n.layerId=B,n.index=g,n.info=null}}const b=xP(t),S=new Map;return S.set(null,b),y.forEach(I=>{let C={...b};I===s&&(C.color=l,C.index=g,C.picked=!0),C=bP({layer:I,info:C,mode:r});const B=C.layer;I===s&&r==="hover"&&(n.info=C),S.set(B.id,C),r==="hover"&&B.updateAutoHighlight(C)}),S}function bP({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function T4(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class S4{constructor(e){D(this,"gl",void 0),D(this,"pickingFBO",void 0),D(this,"depthFBO",void 0),D(this,"pickLayersPass",void 0),D(this,"layerFilter",void 0),D(this,"lastPickedInfo",void 0),D(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new mP(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:o},l=this.lastPickedInfo.info){const s=l&&l.layer&&l.layer.id,g=l&&l.viewport&&l.viewport.id,y=s?r.find(C=>C.id===s):null,b=g&&o.find(C=>C.id===g)||o[0],S=b&&b.unproject([e-b.x,n-b.y]);return{...l,...{x:e,y:n,viewport:b,coordinate:S,layer:y}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new ei(r),ei.isSupported(r,{colorBufferFloat:!0}))){const o=new ei(r);o.attach({36064:new Do(r,{format:hn(r)?34836:6408,type:5126})}),this.depthFBO=o}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:o,y:l,radius:s=0,depth:g=1,mode:y="query",unproject3D:b,onViewportActive:S,effects:I}){const C=this._getPickable(e),B=ef(this.gl);if(!C)return{result:[],emptyInfo:xP({viewports:r,x:o,y:l,pixelRatio:B})};this._resizeBuffer();const G=h_(this.gl,[o,l],!0),W=[G.x+Math.floor(G.width/2),G.y+Math.floor(G.height/2)],he=Math.round(s*B),{width:H,height:U}=this.pickingFBO,K=this._getPickingRect({deviceX:W[0],deviceY:W[1],deviceRadius:he,deviceWidth:H,deviceHeight:U}),fe={x:o-s,y:l-s,width:s*2+1,height:s*2+1};let ye;const xe=[],Te=new Set;for(let De=0;De<g;De++){let Fe;if(K){const tt=this._drawAndSample({layers:C,views:n,viewports:r,onViewportActive:S,deviceRect:K,cullRect:fe,effects:I,pass:"picking:".concat(y)});Fe=b4({...tt,deviceX:W[0],deviceY:W[1],deviceRadius:he,deviceRect:K})}else Fe={pickedColor:null,pickedObjectIndex:-1};let Ve;if(Fe.pickedLayer&&b&&this.depthFBO){const{pickedColors:tt}=this._drawAndSample({layers:[Fe.pickedLayer],views:n,viewports:r,onViewportActive:S,deviceRect:{x:Fe.pickedX,y:Fe.pickedY,width:1,height:1},cullRect:fe,effects:I,pass:"picking:".concat(y,":z")},!0);tt[3]&&(Ve=tt[0])}Fe.pickedLayer&&De+1<g&&(Te.add(Fe.pickedLayer),Fe.pickedLayer.disablePickingIndex(Fe.pickedObjectIndex)),ye=E4({pickInfo:Fe,lastPickedInfo:this.lastPickedInfo,mode:y,layers:C,viewports:r,x:o,y:l,z:Ve,pixelRatio:B});for(const tt of ye.values())tt.layer&&xe.push(tt);if(!Fe.pickedColor)break}for(const De of Te)De.restorePickingColors();return{result:xe,emptyInfo:ye.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:o,y:l,width:s=1,height:g=1,mode:y="query",maxObjects:b=null,onViewportActive:S,effects:I}){const C=this._getPickable(e);if(!C)return[];this._resizeBuffer();const B=ef(this.gl),G=h_(this.gl,[o,l],!0),W=G.x,he=G.y+G.height,H=h_(this.gl,[o+s,l+g],!0),U=H.x+H.width,K=H.y,fe={x:W,y:K,width:U-W,height:he-K},ye=this._drawAndSample({layers:C,views:n,viewports:r,onViewportActive:S,deviceRect:fe,cullRect:{x:o,y:l,width:s,height:g},effects:I,pass:"picking:".concat(y)}),xe=w4(ye),Te=new Map,De=Number.isFinite(b);for(let Fe=0;Fe<xe.length&&!(De&&b&&Te.size>=b);Fe++){const Ve=xe[Fe];let tt={color:Ve.pickedColor,layer:null,index:Ve.pickedObjectIndex,picked:!0,x:o,y:l,pixelRatio:B};tt=bP({layer:Ve.pickedLayer,info:tt,mode:y}),Te.has(tt.object)||Te.set(tt.object,tt)}return Array.from(Te.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:o,deviceRect:l,cullRect:s,effects:g,pass:y},b=!1){const S=b?this.depthFBO:this.pickingFBO,I={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:o,pickingFBO:S,deviceRect:l,cullRect:s,effects:g,pass:y,pickZ:b,preRenderStats:{}};for(const U of g)U.useInPicking&&(I.preRenderStats[U.id]=U.preRender(this.gl,I));const{decodePickingColor:C}=this.pickLayersPass.render(I),{x:B,y:G,width:W,height:he}=l,H=new(b?Float32Array:Uint8Array)(W*he*4);return Xy(S,{sourceX:B,sourceY:G,sourceWidth:W,sourceHeight:he,target:H}),{pickedColors:H,decodePickingColor:C}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:o,deviceHeight:l}){const s=Math.max(0,e-r),g=Math.max(0,n-r),y=Math.min(o,e+r+1)-s,b=Math.min(l,n+r+1)-g;return y<=0||b<=0?null:{x:s,y:g,width:y,height:b}}}const A4={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class P4{constructor(e){D(this,"el",null),D(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,A4),n.appendChild(this.el))}setTooltip(e,n,r){const o=this.el;if(o){if(typeof e=="string")o.innerText=e;else if(e)e.text&&(o.innerText=e.text),e.html&&(o.innerHTML=e.html),e.className&&(o.className=e.className);else{this.isVisible=!1,o.style.display="none";return}this.isVisible=!0,o.style.display="block",o.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(o.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var wP={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,o){var l=["","webkit","Moz","MS","ms","o"],s=n.createElement("div"),g="function",y=Math.round,b=Math.abs,S=Date.now;function I(q,Q,pe){return setTimeout(K(q,pe),Q)}function C(q,Q,pe){return Array.isArray(q)?(B(q,pe[Q],pe),!0):!1}function B(q,Q,pe){var Se;if(q)if(q.forEach)q.forEach(Q,pe);else if(q.length!==o)for(Se=0;Se<q.length;)Q.call(pe,q[Se],Se,q),Se++;else for(Se in q)q.hasOwnProperty(Se)&&Q.call(pe,q[Se],Se,q)}function G(q,Q,pe){var Se="DEPRECATED METHOD: "+Q+`
`+pe+` AT 
`;return function(){var Ge=new Error("get-stack-trace"),ht=Ge&&Ge.stack?Ge.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",tn=e.console&&(e.console.warn||e.console.log);return tn&&tn.call(e.console,Se,ht),q.apply(this,arguments)}}var W;typeof Object.assign!="function"?W=function(Q){if(Q===o||Q===null)throw new TypeError("Cannot convert undefined or null to object");for(var pe=Object(Q),Se=1;Se<arguments.length;Se++){var Ge=arguments[Se];if(Ge!==o&&Ge!==null)for(var ht in Ge)Ge.hasOwnProperty(ht)&&(pe[ht]=Ge[ht])}return pe}:W=Object.assign;var he=G(function(Q,pe,Se){for(var Ge=Object.keys(pe),ht=0;ht<Ge.length;)(!Se||Se&&Q[Ge[ht]]===o)&&(Q[Ge[ht]]=pe[Ge[ht]]),ht++;return Q},"extend","Use `assign`."),H=G(function(Q,pe){return he(Q,pe,!0)},"merge","Use `assign`.");function U(q,Q,pe){var Se=Q.prototype,Ge;Ge=q.prototype=Object.create(Se),Ge.constructor=q,Ge._super=Se,pe&&W(Ge,pe)}function K(q,Q){return function(){return q.apply(Q,arguments)}}function fe(q,Q){return typeof q==g?q.apply(Q&&Q[0]||o,Q):q}function ye(q,Q){return q===o?Q:q}function xe(q,Q,pe){B(Ve(Q),function(Se){q.addEventListener(Se,pe,!1)})}function Te(q,Q,pe){B(Ve(Q),function(Se){q.removeEventListener(Se,pe,!1)})}function De(q,Q){for(;q;){if(q==Q)return!0;q=q.parentNode}return!1}function Fe(q,Q){return q.indexOf(Q)>-1}function Ve(q){return q.trim().split(/\s+/g)}function tt(q,Q,pe){if(q.indexOf&&!pe)return q.indexOf(Q);for(var Se=0;Se<q.length;){if(pe&&q[Se][pe]==Q||!pe&&q[Se]===Q)return Se;Se++}return-1}function Bt(q){return Array.prototype.slice.call(q,0)}function ft(q,Q,pe){for(var Se=[],Ge=[],ht=0;ht<q.length;){var tn=Q?q[ht][Q]:q[ht];tt(Ge,tn)<0&&Se.push(q[ht]),Ge[ht]=tn,ht++}return pe&&(Q?Se=Se.sort(function(Cr,Br){return Cr[Q]>Br[Q]}):Se=Se.sort()),Se}function wt(q,Q){for(var pe,Se,Ge=Q[0].toUpperCase()+Q.slice(1),ht=0;ht<l.length;){if(pe=l[ht],Se=pe?pe+Ge:Q,Se in q)return Se;ht++}return o}var nr=1;function rr(){return nr++}function Pr(q){var Q=q.ownerDocument||q;return Q.defaultView||Q.parentWindow||e}var ut=/mobile|tablet|ip(ad|hone|od)|android/i,Mt="ontouchstart"in e,Ot=wt(e,"PointerEvent")!==o,Qt=Mt&&ut.test(navigator.userAgent),en="touch",vi="pen",Ir="mouse",_i="kinect",Fi=25,an=1,Wr=2,Dt=4,Dn=8,go=1,Hr=2,Vt=4,xi=8,hr=16,Zn=Hr|Vt,yo=xi|hr,bi=Zn|yo,Aa=["x","y"],qr=["clientX","clientY"];function _r(q,Q){var pe=this;this.manager=q,this.callback=Q,this.element=q.element,this.target=q.options.inputTarget,this.domHandler=function(Se){fe(q.options.enable,[q])&&pe.handler(Se)},this.init()}_r.prototype={handler:function(){},init:function(){this.evEl&&xe(this.element,this.evEl,this.domHandler),this.evTarget&&xe(this.target,this.evTarget,this.domHandler),this.evWin&&xe(Pr(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Te(this.element,this.evEl,this.domHandler),this.evTarget&&Te(this.target,this.evTarget,this.domHandler),this.evWin&&Te(Pr(this.element),this.evWin,this.domHandler)}};function Pa(q){var Q,pe=q.options.inputClass;return pe?Q=pe:Ot?Q=Fo:Qt?Q=de:Mt?Q=_e:Q=ra,new Q(q,wi)}function wi(q,Q,pe){var Se=pe.pointers.length,Ge=pe.changedPointers.length,ht=Q&an&&Se-Ge===0,tn=Q&(Dt|Dn)&&Se-Ge===0;pe.isFirst=!!ht,pe.isFinal=!!tn,ht&&(q.session={}),pe.eventType=Q,Ei(q,pe),q.emit("hammer.input",pe),q.recognize(pe),q.session.prevInput=pe}function Ei(q,Q){var pe=q.session,Se=Q.pointers,Ge=Se.length;pe.firstInput||(pe.firstInput=xs(Q)),Ge>1&&!pe.firstMultiple?pe.firstMultiple=xs(Q):Ge===1&&(pe.firstMultiple=!1);var ht=pe.firstInput,tn=pe.firstMultiple,or=tn?tn.center:ht.center,Cr=Q.center=bs(Se);Q.timeStamp=S(),Q.deltaTime=Q.timeStamp-ht.timeStamp,Q.angle=Ma(or,Cr),Q.distance=vo(or,Cr),ta(pe,Q),Q.offsetDirection=Ca(Q.deltaX,Q.deltaY);var Br=Ia(Q.deltaTime,Q.deltaX,Q.deltaY);Q.overallVelocityX=Br.x,Q.overallVelocityY=Br.y,Q.overallVelocity=b(Br.x)>b(Br.y)?Br.x:Br.y,Q.scale=tn?ws(tn.pointers,Se):1,Q.rotation=tn?ka(tn.pointers,Se):0,Q.maxPointers=pe.prevInput?Q.pointers.length>pe.prevInput.maxPointers?Q.pointers.length:pe.prevInput.maxPointers:Q.pointers.length,Ui(pe,Q);var to=q.element;De(Q.srcEvent.target,to)&&(to=Q.srcEvent.target),Q.target=to}function ta(q,Q){var pe=Q.center,Se=q.offsetDelta||{},Ge=q.prevDelta||{},ht=q.prevInput||{};(Q.eventType===an||ht.eventType===Dt)&&(Ge=q.prevDelta={x:ht.deltaX||0,y:ht.deltaY||0},Se=q.offsetDelta={x:pe.x,y:pe.y}),Q.deltaX=Ge.x+(pe.x-Se.x),Q.deltaY=Ge.y+(pe.y-Se.y)}function Ui(q,Q){var pe=q.lastInterval||Q,Se=Q.timeStamp-pe.timeStamp,Ge,ht,tn,or;if(Q.eventType!=Dn&&(Se>Fi||pe.velocity===o)){var Cr=Q.deltaX-pe.deltaX,Br=Q.deltaY-pe.deltaY,to=Ia(Se,Cr,Br);ht=to.x,tn=to.y,Ge=b(to.x)>b(to.y)?to.x:to.y,or=Ca(Cr,Br),q.lastInterval=Q}else Ge=pe.velocity,ht=pe.velocityX,tn=pe.velocityY,or=pe.direction;Q.velocity=Ge,Q.velocityX=ht,Q.velocityY=tn,Q.direction=or}function xs(q){for(var Q=[],pe=0;pe<q.pointers.length;)Q[pe]={clientX:y(q.pointers[pe].clientX),clientY:y(q.pointers[pe].clientY)},pe++;return{timeStamp:S(),pointers:Q,center:bs(Q),deltaX:q.deltaX,deltaY:q.deltaY}}function bs(q){var Q=q.length;if(Q===1)return{x:y(q[0].clientX),y:y(q[0].clientY)};for(var pe=0,Se=0,Ge=0;Ge<Q;)pe+=q[Ge].clientX,Se+=q[Ge].clientY,Ge++;return{x:y(pe/Q),y:y(Se/Q)}}function Ia(q,Q,pe){return{x:Q/q||0,y:pe/q||0}}function Ca(q,Q){return q===Q?go:b(q)>=b(Q)?q<0?Hr:Vt:Q<0?xi:hr}function vo(q,Q,pe){pe||(pe=Aa);var Se=Q[pe[0]]-q[pe[0]],Ge=Q[pe[1]]-q[pe[1]];return Math.sqrt(Se*Se+Ge*Ge)}function Ma(q,Q,pe){pe||(pe=Aa);var Se=Q[pe[0]]-q[pe[0]],Ge=Q[pe[1]]-q[pe[1]];return Math.atan2(Ge,Se)*180/Math.PI}function ka(q,Q){return Ma(Q[1],Q[0],qr)+Ma(q[1],q[0],qr)}function ws(q,Q){return vo(Q[0],Q[1],qr)/vo(q[0],q[1],qr)}var na={mousedown:an,mousemove:Wr,mouseup:Dt},Es="mousedown",Ts="mousemove mouseup";function ra(){this.evEl=Es,this.evWin=Ts,this.pressed=!1,_r.apply(this,arguments)}U(ra,_r,{handler:function(Q){var pe=na[Q.type];pe&an&&Q.button===0&&(this.pressed=!0),pe&Wr&&Q.which!==1&&(pe=Dt),this.pressed&&(pe&Dt&&(this.pressed=!1),this.callback(this.manager,pe,{pointers:[Q],changedPointers:[Q],pointerType:Ir,srcEvent:Q}))}});var _l={pointerdown:an,pointermove:Wr,pointerup:Dt,pointercancel:Dn,pointerout:Dn},ia={2:en,3:vi,4:Ir,5:_i},Qi="pointerdown",eo="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Qi="MSPointerDown",eo="MSPointerMove MSPointerUp MSPointerCancel");function Fo(){this.evEl=Qi,this.evWin=eo,_r.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}U(Fo,_r,{handler:function(Q){var pe=this.store,Se=!1,Ge=Q.type.toLowerCase().replace("ms",""),ht=_l[Ge],tn=ia[Q.pointerType]||Q.pointerType,or=tn==en,Cr=tt(pe,Q.pointerId,"pointerId");ht&an&&(Q.button===0||or)?Cr<0&&(pe.push(Q),Cr=pe.length-1):ht&(Dt|Dn)&&(Se=!0),!(Cr<0)&&(pe[Cr]=Q,this.callback(this.manager,ht,{pointers:pe,changedPointers:[Q],pointerType:tn,srcEvent:Q}),Se&&pe.splice(Cr,1))}});var Ss={touchstart:an,touchmove:Wr,touchend:Dt,touchcancel:Dn},zn="touchstart",O="touchstart touchmove touchend touchcancel";function N(){this.evTarget=zn,this.evWin=O,this.started=!1,_r.apply(this,arguments)}U(N,_r,{handler:function(Q){var pe=Ss[Q.type];if(pe===an&&(this.started=!0),!!this.started){var Se=j.call(this,Q,pe);pe&(Dt|Dn)&&Se[0].length-Se[1].length===0&&(this.started=!1),this.callback(this.manager,pe,{pointers:Se[0],changedPointers:Se[1],pointerType:en,srcEvent:Q})}}});function j(q,Q){var pe=Bt(q.touches),Se=Bt(q.changedTouches);return Q&(Dt|Dn)&&(pe=ft(pe.concat(Se),"identifier",!0)),[pe,Se]}var J={touchstart:an,touchmove:Wr,touchend:Dt,touchcancel:Dn},ie="touchstart touchmove touchend touchcancel";function de(){this.evTarget=ie,this.targetIds={},_r.apply(this,arguments)}U(de,_r,{handler:function(Q){var pe=J[Q.type],Se=me.call(this,Q,pe);Se&&this.callback(this.manager,pe,{pointers:Se[0],changedPointers:Se[1],pointerType:en,srcEvent:Q})}});function me(q,Q){var pe=Bt(q.touches),Se=this.targetIds;if(Q&(an|Wr)&&pe.length===1)return Se[pe[0].identifier]=!0,[pe,pe];var Ge,ht,tn=Bt(q.changedTouches),or=[],Cr=this.target;if(ht=pe.filter(function(Br){return De(Br.target,Cr)}),Q===an)for(Ge=0;Ge<ht.length;)Se[ht[Ge].identifier]=!0,Ge++;for(Ge=0;Ge<tn.length;)Se[tn[Ge].identifier]&&or.push(tn[Ge]),Q&(Dt|Dn)&&delete Se[tn[Ge].identifier],Ge++;if(or.length)return[ft(ht.concat(or),"identifier",!0),or]}var X=2500,ae=25;function _e(){_r.apply(this,arguments);var q=K(this.handler,this);this.touch=new de(this.manager,q),this.mouse=new ra(this.manager,q),this.primaryTouch=null,this.lastTouches=[]}U(_e,_r,{handler:function(Q,pe,Se){var Ge=Se.pointerType==en,ht=Se.pointerType==Ir;if(!(ht&&Se.sourceCapabilities&&Se.sourceCapabilities.firesTouchEvents)){if(Ge)Be.call(this,pe,Se);else if(ht&&Me.call(this,Se))return;this.callback(Q,pe,Se)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Be(q,Q){q&an?(this.primaryTouch=Q.changedPointers[0].identifier,Ue.call(this,Q)):q&(Dt|Dn)&&Ue.call(this,Q)}function Ue(q){var Q=q.changedPointers[0];if(Q.identifier===this.primaryTouch){var pe={x:Q.clientX,y:Q.clientY};this.lastTouches.push(pe);var Se=this.lastTouches,Ge=function(){var ht=Se.indexOf(pe);ht>-1&&Se.splice(ht,1)};setTimeout(Ge,X)}}function Me(q){for(var Q=q.srcEvent.clientX,pe=q.srcEvent.clientY,Se=0;Se<this.lastTouches.length;Se++){var Ge=this.lastTouches[Se],ht=Math.abs(Q-Ge.x),tn=Math.abs(pe-Ge.y);if(ht<=ae&&tn<=ae)return!0}return!1}var Ne=wt(s.style,"touchAction"),at=Ne!==o,rt="compute",Le="auto",Je="manipulation",qe="none",Ze="pan-x",kt="pan-y",$e=Gt();function Ht(q,Q){this.manager=q,this.set(Q)}Ht.prototype={set:function(q){q==rt&&(q=this.compute()),at&&this.manager.element.style&&$e[q]&&(this.manager.element.style[Ne]=q),this.actions=q.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var q=[];return B(this.manager.recognizers,function(Q){fe(Q.options.enable,[Q])&&(q=q.concat(Q.getTouchAction()))}),pn(q.join(" "))},preventDefaults:function(q){var Q=q.srcEvent,pe=q.offsetDirection;if(this.manager.session.prevented){Q.preventDefault();return}var Se=this.actions,Ge=Fe(Se,qe)&&!$e[qe],ht=Fe(Se,kt)&&!$e[kt],tn=Fe(Se,Ze)&&!$e[Ze];if(Ge){var or=q.pointers.length===1,Cr=q.distance<2,Br=q.deltaTime<250;if(or&&Cr&&Br)return}if(!(tn&&ht)&&(Ge||ht&&pe&Zn||tn&&pe&yo))return this.preventSrc(Q)},preventSrc:function(q){this.manager.session.prevented=!0,q.preventDefault()}};function pn(q){if(Fe(q,qe))return qe;var Q=Fe(q,Ze),pe=Fe(q,kt);return Q&&pe?qe:Q||pe?Q?Ze:kt:Fe(q,Je)?Je:Le}function Gt(){if(!at)return!1;var q={},Q=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(pe){q[pe]=Q?e.CSS.supports("touch-action",pe):!0}),q}var $t=1,Lt=2,Xn=4,Xt=8,dn=Xt,on=16,Rt=32;function Wt(q){this.options=W({},this.defaults,q||{}),this.id=rr(),this.manager=null,this.options.enable=ye(this.options.enable,!0),this.state=$t,this.simultaneous={},this.requireFail=[]}Wt.prototype={defaults:{},set:function(q){return W(this.options,q),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(q){if(C(q,"recognizeWith",this))return this;var Q=this.simultaneous;return q=Un(q,this),Q[q.id]||(Q[q.id]=q,q.recognizeWith(this)),this},dropRecognizeWith:function(q){return C(q,"dropRecognizeWith",this)?this:(q=Un(q,this),delete this.simultaneous[q.id],this)},requireFailure:function(q){if(C(q,"requireFailure",this))return this;var Q=this.requireFail;return q=Un(q,this),tt(Q,q)===-1&&(Q.push(q),q.requireFailure(this)),this},dropRequireFailure:function(q){if(C(q,"dropRequireFailure",this))return this;q=Un(q,this);var Q=tt(this.requireFail,q);return Q>-1&&this.requireFail.splice(Q,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(q){return!!this.simultaneous[q.id]},emit:function(q){var Q=this,pe=this.state;function Se(Ge){Q.manager.emit(Ge,q)}pe<Xt&&Se(Q.options.event+zr(pe)),Se(Q.options.event),q.additionalEvent&&Se(q.additionalEvent),pe>=Xt&&Se(Q.options.event+zr(pe))},tryEmit:function(q){if(this.canEmit())return this.emit(q);this.state=Rt},canEmit:function(){for(var q=0;q<this.requireFail.length;){if(!(this.requireFail[q].state&(Rt|$t)))return!1;q++}return!0},recognize:function(q){var Q=W({},q);if(!fe(this.options.enable,[this,Q])){this.reset(),this.state=Rt;return}this.state&(dn|on|Rt)&&(this.state=$t),this.state=this.process(Q),this.state&(Lt|Xn|Xt|on)&&this.tryEmit(Q)},process:function(q){},getTouchAction:function(){},reset:function(){}};function zr(q){return q&on?"cancel":q&Xt?"end":q&Xn?"move":q&Lt?"start":""}function La(q){return q==hr?"down":q==xi?"up":q==Hr?"left":q==Vt?"right":""}function Un(q,Q){var pe=Q.manager;return pe?pe.get(q):q}function Pn(){Wt.apply(this,arguments)}U(Pn,Wt,{defaults:{pointers:1},attrTest:function(q){var Q=this.options.pointers;return Q===0||q.pointers.length===Q},process:function(q){var Q=this.state,pe=q.eventType,Se=Q&(Lt|Xn),Ge=this.attrTest(q);return Se&&(pe&Dn||!Ge)?Q|on:Se||Ge?pe&Dt?Q|Xt:Q&Lt?Q|Xn:Lt:Rt}});function Ra(){Pn.apply(this,arguments),this.pX=null,this.pY=null}U(Ra,Pn,{defaults:{event:"pan",threshold:10,pointers:1,direction:bi},getTouchAction:function(){var q=this.options.direction,Q=[];return q&Zn&&Q.push(kt),q&yo&&Q.push(Ze),Q},directionTest:function(q){var Q=this.options,pe=!0,Se=q.distance,Ge=q.direction,ht=q.deltaX,tn=q.deltaY;return Ge&Q.direction||(Q.direction&Zn?(Ge=ht===0?go:ht<0?Hr:Vt,pe=ht!=this.pX,Se=Math.abs(q.deltaX)):(Ge=tn===0?go:tn<0?xi:hr,pe=tn!=this.pY,Se=Math.abs(q.deltaY))),q.direction=Ge,pe&&Se>Q.threshold&&Ge&Q.direction},attrTest:function(q){return Pn.prototype.attrTest.call(this,q)&&(this.state&Lt||!(this.state&Lt)&&this.directionTest(q))},emit:function(q){this.pX=q.deltaX,this.pY=q.deltaY;var Q=La(q.direction);Q&&(q.additionalEvent=this.options.event+Q),this._super.emit.call(this,q)}});function oa(){Pn.apply(this,arguments)}U(oa,Pn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[qe]},attrTest:function(q){return this._super.attrTest.call(this,q)&&(Math.abs(q.scale-1)>this.options.threshold||this.state&Lt)},emit:function(q){if(q.scale!==1){var Q=q.scale<1?"in":"out";q.additionalEvent=this.options.event+Q}this._super.emit.call(this,q)}});function In(){Wt.apply(this,arguments),this._timer=null,this._input=null}U(In,Wt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Le]},process:function(q){var Q=this.options,pe=q.pointers.length===Q.pointers,Se=q.distance<Q.threshold,Ge=q.deltaTime>Q.time;if(this._input=q,!Se||!pe||q.eventType&(Dt|Dn)&&!Ge)this.reset();else if(q.eventType&an)this.reset(),this._timer=I(function(){this.state=dn,this.tryEmit()},Q.time,this);else if(q.eventType&Dt)return dn;return Rt},reset:function(){clearTimeout(this._timer)},emit:function(q){this.state===dn&&(q&&q.eventType&Dt?this.manager.emit(this.options.event+"up",q):(this._input.timeStamp=S(),this.manager.emit(this.options.event,this._input)))}});function aa(){Pn.apply(this,arguments)}U(aa,Pn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[qe]},attrTest:function(q){return this._super.attrTest.call(this,q)&&(Math.abs(q.rotation)>this.options.threshold||this.state&Lt)}});function xr(){Pn.apply(this,arguments)}U(xr,Pn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Zn|yo,pointers:1},getTouchAction:function(){return Ra.prototype.getTouchAction.call(this)},attrTest:function(q){var Q=this.options.direction,pe;return Q&(Zn|yo)?pe=q.overallVelocity:Q&Zn?pe=q.overallVelocityX:Q&yo&&(pe=q.overallVelocityY),this._super.attrTest.call(this,q)&&Q&q.offsetDirection&&q.distance>this.options.threshold&&q.maxPointers==this.options.pointers&&b(pe)>this.options.velocity&&q.eventType&Dt},emit:function(q){var Q=La(q.offsetDirection);Q&&this.manager.emit(this.options.event+Q,q),this.manager.emit(this.options.event,q)}});function jn(){Wt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}U(jn,Wt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Je]},process:function(q){var Q=this.options,pe=q.pointers.length===Q.pointers,Se=q.distance<Q.threshold,Ge=q.deltaTime<Q.time;if(this.reset(),q.eventType&an&&this.count===0)return this.failTimeout();if(Se&&Ge&&pe){if(q.eventType!=Dt)return this.failTimeout();var ht=this.pTime?q.timeStamp-this.pTime<Q.interval:!0,tn=!this.pCenter||vo(this.pCenter,q.center)<Q.posThreshold;this.pTime=q.timeStamp,this.pCenter=q.center,!tn||!ht?this.count=1:this.count+=1,this._input=q;var or=this.count%Q.taps;if(or===0)return this.hasRequireFailures()?(this._timer=I(function(){this.state=dn,this.tryEmit()},Q.interval,this),Lt):dn}return Rt},failTimeout:function(){return this._timer=I(function(){this.state=Rt},this.options.interval,this),Rt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==dn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ir(q,Q){return Q=Q||{},Q.recognizers=ye(Q.recognizers,ir.defaults.preset),new Zr(q,Q)}ir.VERSION="2.0.7",ir.defaults={domEvents:!1,touchAction:rt,enable:!0,inputTarget:null,inputClass:null,preset:[[aa,{enable:!1}],[oa,{enable:!1},["rotate"]],[xr,{direction:Zn}],[Ra,{direction:Zn},["swipe"]],[jn],[jn,{event:"doubletap",taps:2},["tap"]],[In]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var bn=1,Ti=2;function Zr(q,Q){this.options=W({},ir.defaults,Q||{}),this.options.inputTarget=this.options.inputTarget||q,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=q,this.input=Pa(this),this.touchAction=new Ht(this,this.options.touchAction),yu(this,!0),B(this.options.recognizers,function(pe){var Se=this.add(new pe[0](pe[1]));pe[2]&&Se.recognizeWith(pe[2]),pe[3]&&Se.requireFailure(pe[3])},this)}Zr.prototype={set:function(q){return W(this.options,q),q.touchAction&&this.touchAction.update(),q.inputTarget&&(this.input.destroy(),this.input.target=q.inputTarget,this.input.init()),this},stop:function(q){this.session.stopped=q?Ti:bn},recognize:function(q){var Q=this.session;if(!Q.stopped){this.touchAction.preventDefaults(q);var pe,Se=this.recognizers,Ge=Q.curRecognizer;(!Ge||Ge&&Ge.state&dn)&&(Ge=Q.curRecognizer=null);for(var ht=0;ht<Se.length;)pe=Se[ht],Q.stopped!==Ti&&(!Ge||pe==Ge||pe.canRecognizeWith(Ge))?pe.recognize(q):pe.reset(),!Ge&&pe.state&(Lt|Xn|Xt)&&(Ge=Q.curRecognizer=pe),ht++}},get:function(q){if(q instanceof Wt)return q;for(var Q=this.recognizers,pe=0;pe<Q.length;pe++)if(Q[pe].options.event==q)return Q[pe];return null},add:function(q){if(C(q,"add",this))return this;var Q=this.get(q.options.event);return Q&&this.remove(Q),this.recognizers.push(q),q.manager=this,this.touchAction.update(),q},remove:function(q){if(C(q,"remove",this))return this;if(q=this.get(q),q){var Q=this.recognizers,pe=tt(Q,q);pe!==-1&&(Q.splice(pe,1),this.touchAction.update())}return this},on:function(q,Q){if(q!==o&&Q!==o){var pe=this.handlers;return B(Ve(q),function(Se){pe[Se]=pe[Se]||[],pe[Se].push(Q)}),this}},off:function(q,Q){if(q!==o){var pe=this.handlers;return B(Ve(q),function(Se){Q?pe[Se]&&pe[Se].splice(tt(pe[Se],Q),1):delete pe[Se]}),this}},emit:function(q,Q){this.options.domEvents&&Si(q,Q);var pe=this.handlers[q]&&this.handlers[q].slice();if(!(!pe||!pe.length)){Q.type=q,Q.preventDefault=function(){Q.srcEvent.preventDefault()};for(var Se=0;Se<pe.length;)pe[Se](Q),Se++}},destroy:function(){this.element&&yu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function yu(q,Q){var pe=q.element;if(pe.style){var Se;B(q.options.cssProps,function(Ge,ht){Se=wt(pe.style,ht),Q?(q.oldCssProps[Se]=pe.style[Se],pe.style[Se]=Ge):pe.style[Se]=q.oldCssProps[Se]||""}),Q||(q.oldCssProps={})}}function Si(q,Q){var pe=n.createEvent("Event");pe.initEvent(q,!0,!0),pe.gesture=Q,Q.target.dispatchEvent(pe)}W(ir,{INPUT_START:an,INPUT_MOVE:Wr,INPUT_END:Dt,INPUT_CANCEL:Dn,STATE_POSSIBLE:$t,STATE_BEGAN:Lt,STATE_CHANGED:Xn,STATE_ENDED:Xt,STATE_RECOGNIZED:dn,STATE_CANCELLED:on,STATE_FAILED:Rt,DIRECTION_NONE:go,DIRECTION_LEFT:Hr,DIRECTION_RIGHT:Vt,DIRECTION_UP:xi,DIRECTION_DOWN:hr,DIRECTION_HORIZONTAL:Zn,DIRECTION_VERTICAL:yo,DIRECTION_ALL:bi,Manager:Zr,Input:_r,TouchAction:Ht,TouchInput:de,MouseInput:ra,PointerEventInput:Fo,TouchMouseInput:_e,SingleTouchInput:N,Recognizer:Wt,AttrRecognizer:Pn,Tap:jn,Pan:Ra,Swipe:xr,Pinch:oa,Rotate:aa,Press:In,on:xe,off:Te,each:B,merge:H,extend:he,assign:W,inherit:U,bindFn:K,prefixed:wt});var Tf=typeof e<"u"?e:typeof self<"u"?self:{};Tf.Hammer=ir,typeof o=="function"&&o.amd?o(function(){return ir}):t.exports?t.exports=ir:e[r]=ir})(window,document,"Hammer")})(wP);var jd=wP.exports;const I4=z1(jd),is=Gk({__proto__:null,default:I4},[jd]),EP=1,TP=2,P0=4,C4={mousedown:EP,mousemove:TP,mouseup:P0};function M4(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function k4(t){const e=t.prototype.handler;t.prototype.handler=function(r){const o=this.store;r.button>0&&r.type==="pointerdown"&&(M4(o,l=>l.pointerId===r.pointerId)||o.push(r)),e.call(this,r)}}function L4(t){t.prototype.handler=function(n){let r=C4[n.type];r&EP&&n.button>=0&&(this.pressed=!0),r&TP&&n.which===0&&(r=P0),this.pressed&&(r&P0&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}k4(jd.PointerEventInput);L4(jd.MouseInput);const R4=jd.Manager;class $y{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const O4=is?[[is.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[is.Rotate,{enable:!1}],[is.Pinch,{enable:!1}],[is.Swipe,{enable:!1}],[is.Pan,{threshold:0,enable:!1}],[is.Press,{enable:!1}],[is.Tap,{event:"doubletap",taps:2,enable:!1}],[is.Tap,{event:"anytap",enable:!1}],[is.Tap,{enable:!1}]]:null,w2={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},D4={doubletap:["tap"]},z4={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},hx={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},B4={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},E2={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},N4=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Mh=typeof window<"u"?window:global;let I0=!1;try{const t={get passive(){return I0=!0,!0}};Mh.addEventListener("test",null,t),Mh.removeEventListener("test",null)}catch{I0=!1}const F4=N4.indexOf("firefox")!==-1,{WHEEL_EVENTS:U4}=hx,T2="wheel",S2=4.000244140625,j4=40,V4=.25;class G4 extends $y{constructor(e,n,r){super(e,n,r),this.handleEvent=o=>{if(!this.options.enable)return;let l=o.deltaY;Mh.WheelEvent&&(F4&&o.deltaMode===Mh.WheelEvent.DOM_DELTA_PIXEL&&(l/=Mh.devicePixelRatio),o.deltaMode===Mh.WheelEvent.DOM_DELTA_LINE&&(l*=j4)),l!==0&&l%S2===0&&(l=Math.floor(l/S2)),o.shiftKey&&l&&(l=l*V4),this.callback({type:T2,center:{x:o.clientX,y:o.clientY},delta:-l,srcEvent:o,pointerType:"mouse",target:o.target})},this.events=(this.options.events||[]).concat(U4),this.events.forEach(o=>e.addEventListener(o,this.handleEvent,I0?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===T2&&(this.options.enable=n)}}const{MOUSE_EVENTS:W4}=hx,A2="pointermove",P2="pointerover",I2="pointerout",C2="pointerenter",M2="pointerleave";class H4 extends $y{constructor(e,n,r){super(e,n,r),this.handleEvent=l=>{this.handleOverEvent(l),this.handleOutEvent(l),this.handleEnterEvent(l),this.handleLeaveEvent(l),this.handleMoveEvent(l)},this.pressed=!1;const{enable:o}=this.options;this.enableMoveEvent=o,this.enableLeaveEvent=o,this.enableEnterEvent=o,this.enableOutEvent=o,this.enableOverEvent=o,this.events=(this.options.events||[]).concat(W4),this.events.forEach(l=>e.addEventListener(l,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===A2&&(this.enableMoveEvent=n),e===P2&&(this.enableOverEvent=n),e===I2&&(this.enableOutEvent=n),e===C2&&(this.enableEnterEvent=n),e===M2&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(P2,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(I2,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(C2,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(M2,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(A2,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:q4}=hx,k2="keydown",L2="keyup";class Z4 extends $y{constructor(e,n,r){super(e,n,r),this.handleEvent=o=>{const l=o.target||o.srcElement;l.tagName==="INPUT"&&l.type==="text"||l.tagName==="TEXTAREA"||(this.enableDownEvent&&o.type==="keydown"&&this.callback({type:k2,srcEvent:o,key:o.key,target:o.target}),this.enableUpEvent&&o.type==="keyup"&&this.callback({type:L2,srcEvent:o,key:o.key,target:o.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(q4),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(o=>e.addEventListener(o,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===k2&&(this.enableDownEvent=n),e===L2&&(this.enableUpEvent=n)}}const R2="contextmenu";class X4 extends $y{constructor(e,n,r){super(e,n,r),this.handleEvent=o=>{this.options.enable&&this.callback({type:R2,center:{x:o.clientX,y:o.clientY},srcEvent:o,pointerType:"mouse",target:o.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===R2&&(this.options.enable=n)}}const C0=1,fy=2,M0=4,Y4={pointerdown:C0,pointermove:fy,pointerup:M0,mousedown:C0,mousemove:fy,mouseup:M0},$4=1,K4=2,J4=3,Q4=0,e5=1,t5=2,n5=1,r5=2,i5=4;function o5(t){const e=Y4[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:o}=t.srcEvent;let l=!1,s=!1,g=!1;return e===M0||e===fy&&!Number.isFinite(n)?(l=o===$4,s=o===K4,g=o===J4):e===fy?(l=!!(n&n5),s=!!(n&i5),g=!!(n&r5)):e===C0&&(l=r===Q4,s=r===e5,g=r===t5),{leftButton:l,middleButton:s,rightButton:g}}function a5(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),o=r.width/e.offsetWidth||1,l=r.height/e.offsetHeight||1,s={x:(n.x-r.left-e.clientLeft)/o,y:(n.y-r.top-e.clientTop)/l};return{center:n,offsetCenter:s}}const C_={srcElement:"root",priority:0};class s5{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let o=n.srcEvent.target;for(;o&&o!==r.rootElement;){if(this._emit(r,o),r.handled)return;o=o.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,o=!1,l=!1){const{handlers:s,handlersByElement:g}=this;let y=C_;typeof r=="string"||r&&r.addEventListener?y={...C_,srcElement:r}:r&&(y={...C_,...r});let b=g.get(y.srcElement);b||(b=[],g.set(y.srcElement,b));const S={type:e,handler:n,srcElement:y.srcElement,priority:y.priority};o&&(S.once=!0),l&&(S.passive=!0),s.push(S),this._active=this._active||!S.passive;let I=b.length-1;for(;I>=0&&!(b[I].priority>=S.priority);)I--;b.splice(I+1,0,S)}remove(e,n){const{handlers:r,handlersByElement:o}=this;for(let l=r.length-1;l>=0;l--){const s=r[l];if(s.type===e&&s.handler===n){r.splice(l,1);const g=o.get(s.srcElement);g.splice(g.indexOf(s),1),g.length===0&&o.delete(s.srcElement)}}this._active=r.some(l=>!l.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let o=!1;const l=()=>{e.handled=!0},s=()=>{e.handled=!0,o=!0},g=[];for(let y=0;y<r.length;y++){const{type:b,handler:S,once:I}=r[y];if(S({...e,type:b,stopPropagation:l,stopImmediatePropagation:s}),I&&g.push(r[y]),o)break}for(let y=0;y<g.length;y++){const{type:b,handler:S}=g[y];this.remove(b,S)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...o5(e),...a5(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const l5={events:null,recognizers:null,recognizerOptions:{},Manager:R4,touchAction:"none",tabIndex:0};class SP{constructor(e=null,n){this._onBasicInput=o=>{const{srcEvent:l}=o,s=z4[l.type];s&&this.manager.emit(s,o)},this._onOtherEvent=o=>{this.manager.emit(o.type,o)},this.options={...l5,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||O4}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(w2).forEach(o=>{const l=this.manager.get(o);l&&w2[o].forEach(s=>{l.recognizeWith(s)})});for(const o in n.recognizerOptions){const l=this.manager.get(o);if(l){const s=n.recognizerOptions[o];delete s.enable,l.set(s)}}this.wheelInput=new G4(e,this._onOtherEvent,{enable:!1}),this.moveInput=new H4(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Z4(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new X4(e,this._onOtherEvent,{enable:!1});for(const[o,l]of this.events)l.isEmpty()||(this._toggleRecognizer(l.recognizerName,!0),this.manager.on(o,l.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const o=r.get(e);if(o&&o.options.enable!==n){o.set({enable:n});const l=D4[e];l&&!this.options.recognizers&&l.forEach(s=>{const g=r.get(s);n?(g.requireFailure(e),o.dropRequireFailure(s)):g.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,o,l){if(typeof e!="string"){r=n;for(const S in e)this._addEventHandler(S,e[S],r,o,l);return}const{manager:s,events:g}=this,y=E2[e]||e;let b=g.get(y);b||(b=new s5(this),g.set(y,b),b.recognizerName=B4[y]||y,s&&s.on(y,b.handleEvent)),b.add(e,n,r,o,l),b.isEmpty()||this._toggleRecognizer(b.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const s in e)this._removeEventHandler(s,e[s]);return}const{events:r}=this,o=E2[e]||e,l=r.get(o);if(l&&(l.remove(e,n),l.isEmpty())){const{recognizerName:s}=l;let g=!1;for(const y of r.values())if(y.recognizerName===s&&!y.isEmpty()){g=!0;break}g||this._toggleRecognizer(s,!1)}}}function Xu(){}const u5=({isDragging:t})=>t?"grabbing":"grab",AP={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Xu,onResize:Xu,onViewStateChange:Xu,onInteractionStateChange:Xu,onBeforeRender:Xu,onAfterRender:Xu,onLoad:Xu,onError:t=>Fn.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:u5,getTooltip:null,debug:!1,drawPickingColors:!1};class Ky{constructor(e){D(this,"props",void 0),D(this,"width",0),D(this,"height",0),D(this,"userData",{}),D(this,"canvas",null),D(this,"viewManager",null),D(this,"layerManager",null),D(this,"effectManager",null),D(this,"deckRenderer",null),D(this,"deckPicker",null),D(this,"eventManager",null),D(this,"tooltip",null),D(this,"metrics",void 0),D(this,"animationLoop",void 0),D(this,"stats",void 0),D(this,"viewState",void 0),D(this,"cursorState",void 0),D(this,"_needsRedraw",void 0),D(this,"_pickRequest",void 0),D(this,"_lastPointerDownInfo",null),D(this,"_metricsCounter",void 0),D(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const o=n.offsetCenter;if(!o)return;r.x=o.x,r.y=o.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),D(this,"_onEvent",n=>{const r=vE[n.type],o=n.offsetCenter;if(!r||!o||!this.layerManager)return;const l=this.layerManager.getLayers(),s=this.deckPicker.getLastPickedObject({x:o.x,y:o.y,layers:l,viewports:this.getViewports(o)},this._lastPointerDownInfo),{layer:g}=s,y=g&&(g[r.handler]||g.props[r.handler]),b=this.props[r.handler];let S=!1;y&&(S=y.call(g,s,n)),!S&&b&&b(s,n)}),D(this,"_onPointerDown",n=>{const r=n.offsetCenter,o=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=o.result[0]||o.emptyInfo}),this.props={...AP,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Fn.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),cA()==="IE"&&Fn.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new ex({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&ud.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,o,l,s,g,y;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(o=this.effectManager)===null||o===void 0||o.finalize(),this.effectManager=null,(l=this.deckRenderer)===null||l===void 0||l.finalize(),this.deckRenderer=null,(s=this.deckPicker)===null||s===void 0||s.finalize(),this.deckPicker=null,(g=this.eventManager)===null||g===void 0||g.destroy(),this.eventManager=null,(y=this.tooltip)===null||y===void 0||y.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var b;(b=this.canvas.parentElement)===null||b===void 0||b.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Fn.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Fn.removed("onLayerClick","onClick")(),e.initialViewState&&!fs(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),o=this.layerManager.needsRedraw(e),l=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return n=n||r||o||l||s,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return mi(this.viewManager),this.viewManager.views}getViewports(e){return mi(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){mi(this.deckPicker);const{stats:o}=this;o.get("Pick Count").incrementCount(),o.get(n).timeStart();const l=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return o.get(n).timeEnd(),l}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),mi(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const l=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=l}if(r||r===0){var o;const l=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((o=e.style)===null||o===void 0?void 0:o.position)||"absolute",this.canvas.style.height=l}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const o=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,l=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(o!==this.width||l!==this.height){var s,g;this.width=o,this.height=l,(s=this.viewManager)===null||s===void 0||s.setProps({width:o,height:l}),(g=this.layerManager)===null||g===void 0||g.activateViewport(this.getViewports()[0]),this.props.onResize({width:o,height:l})}}_createAnimationLoop(e){const{width:n,height:r,gl:o,glOptions:l,debug:s,onError:g,onBeforeRender:y,onAfterRender:b,useDevicePixels:S}=e;return new Az({width:n,height:r,useDevicePixels:S,autoResizeDrawingBuffer:!o,autoResizeViewport:!1,gl:o,onCreateContext:I=>yA({...l,...I,canvas:this.canvas,debug:s,onContextLost:()=>this._onContextLost()}),onInitialize:I=>this._setGLContext(I.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:y,onAfterRender:b,onError:g})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new _P({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:o}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let l=o,s=!1;for(const g of r){var n;l=g,s=((n=g.layer)===null||n===void 0?void 0:n.onHover(g,e.event))||s}if(!s&&this.props.onHover&&this.props.onHover(l,e.event),this.props.getTooltip&&this.tooltip){const g=this.props.getTooltip(l);this.tooltip.setTooltip(g,l.x,l.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,Q1(e,{enable:!0,copyState:!0})),this.tooltip=new P4(this.canvas),ul(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new XA;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new SP(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const o in vE)this.eventManager.on(o,this._onEvent);this.viewManager=new e4({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new QF(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new g4,this.deckRenderer=new _4(e),this.deckPicker=new S4(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;ul(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Fn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=Qu.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}D(Ky,"defaultProps",AP);D(Ky,"VERSION",kO);class M_{constructor(e,n){D(this,"opts",void 0),D(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:o}=n;let l=r;if(r&&r.length!==o){l=new Float32Array(o);const s=n.elementOffset||0;for(let g=0;g<o;++g)l[g]=r[s+g]}return l}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function c5(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function Ug(t){return t.stride||t.size*t.bytesPerElement}function PP(t,e){e.offset&&Fn.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Ug(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,o=e.elementOffset||0,l=r*n+o*t.bytesPerElement+(t.offset||0);return{...e,offset:l,stride:n}}function h5(t,e){const n=PP(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class f5{constructor(e,n,r){D(this,"gl",void 0),D(this,"id",void 0),D(this,"size",void 0),D(this,"settings",void 0),D(this,"value",void 0),D(this,"doublePrecision",void 0),D(this,"_buffer",void 0),D(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const o=n.logicalType||n.type,l=o===5130;let{defaultValue:s}=n;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0);let g;l?g=5126:!o&&n.isIndexed?g=e&&nD(e,ur.ELEMENT_INDEX_UINT32)?5125:5123:g=o||5126;let y=c5(o||g||5126);this.doublePrecision=l,l&&n.fp64===!1&&(y=Float32Array),this.value=null,this.settings={...n,defaultType:y,defaultValue:s,logicalType:o,type:g,size:this.size,bytesPerElement:y.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new gn(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Ug(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),ud.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},o=this.value instanceof Float64Array,l=h5(this.getAccessor(),n||{});return r[e]=new M_(this,l.high),r["".concat(e,"64Low")]=o?new M_(this,l.low):new Float32Array(this.size),r}if(n){const r=PP(this.getAccessor(),n);return{[e]:new M_(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:o}=this,l=r*o;if(n&&l&&n.length>=l){const s=new Array(o).fill(1/0),g=new Array(o).fill(-1/0);for(let y=0;y<l;)for(let b=0;b<o;b++){const S=n[y++];S<s[b]&&(s[b]=S),S>g[b]&&(g[b]=S)}e=[s,g]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof gn?r={buffer:e}:r=e;const o={...this.settings,...r};if(n.bufferAccessor=o,n.bounds=null,r.constant){let l=r.value;if(l=this._normalizeValue(l,[],0),this.settings.normalized&&(l=this.normalizeConstant(l)),!(!n.constant||!this._areValuesEqual(l,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=l}else if(r.buffer){const l=r.buffer;n.externalBuffer=l,n.constant=!1,this.value=r.value||null;const s=r.value instanceof Float64Array;o.type=r.type||l.accessor.type,o.bytesPerElement=l.accessor.BYTES_PER_ELEMENT*(s?2:1),o.stride=Ug(o)}else if(r.value){this._checkExternalBuffer(r);let l=r.value;n.externalBuffer=null,n.constant=!1,this.value=l,o.bytesPerElement=l.BYTES_PER_ELEMENT,o.stride=Ug(o);const{buffer:s,byteOffset:g}=this;this.doublePrecision&&l instanceof Float64Array&&(l=A_(l,o));const y=l.byteLength+g+o.stride*2;s.byteLength<y&&s.reallocate(y),s.setAccessor(null),s.subData({data:l,offset:g}),o.type=r.type||s.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:o}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?A_(n,{size:this.size,startIndex:r,endIndex:o}):n.subarray(r,o),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,o=r.allocatedValue,l=ud.allocate(o,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=l;const{buffer:s,byteOffset:g}=this;return s.byteLength<l.byteLength+g&&(s.reallocate(l.byteLength+g),n&&o&&s.subData({data:o instanceof Float64Array?A_(o,this):o,offset:g})),r.allocatedValue=l,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let o=!1;if(this.doublePrecision&&(o=n.BYTES_PER_ELEMENT<4),o)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&Fn.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:o,size:l}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let s=l;for(;--s>=0;)n[r+s]=o[s];return n}switch(l){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:o[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:o[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:o[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:o[0];break;default:let s=l;for(;--s>=0;)n[r+s]=Number.isFinite(e[s])?e[s]:o[s]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let o=0;o<r;o++)if(e[o]!==n[o])return!1;return!0}}const O2=[],D2=[];function p5(t,e=0,n=1/0){let r=O2;const o={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(D2.length=t.length,r=D2):r=O2,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),o.index=e-1),{iterable:r,objectInfo:o}}function IP(t){return t&&t[Symbol.asyncIterator]}function d5(t,e){const{size:n,stride:r,offset:o,startIndices:l,nested:s}=e,g=t.BYTES_PER_ELEMENT,y=r?r/g:n,b=o?o/g:0,S=Math.floor((t.length-b)/y);return(I,{index:C,target:B})=>{if(!l){const H=C*y+b;for(let U=0;U<n;U++)B[U]=t[H+U];return B}const G=l[C],W=l[C+1]||S;let he;if(s){he=new Array(W-G);for(let H=G;H<W;H++){const U=H*y+b;B=new Array(n);for(let K=0;K<n;K++)B[K]=t[U+K];he[H-G]=B}}else if(y===n)he=t.subarray(G*n+b,W*n+b);else{he=new t.constructor((W-G)*n);let H=0;for(let U=G;U<W;U++){const K=U*y+b;for(let fe=0;fe<n;fe++)he[H++]=t[K+fe]}}return he}}const m5=[],jg=[[0,1/0]];function g5(t,e){if(t===jg||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let o=0;for(let l=0;l<r;l++){const s=t[l];s[1]<e[0]?(n.push(s),o=l+1):s[0]>e[1]?n.push(s):e=[Math.min(s[0],e[0]),Math.max(s[1],e[1])]}return n.splice(o,0,e),n}function k_(t){const{source:e,target:n,start:r=0,size:o,getData:l}=t,s=t.end||n.length,g=e.length,y=s-r;if(g>y){n.set(e.subarray(0,y),r);return}if(n.set(e,r),!l)return;let b=g;for(;b<y;){const S=l(b,e);for(let I=0;I<o;I++)n[r+b]=S[I]||0,b++}}function y5({source:t,target:e,size:n,getData:r,sourceStartIndices:o,targetStartIndices:l}){if(!Array.isArray(l))return k_({source:t,target:e,size:n,getData:r}),e;let s=0,g=0;const y=r&&((S,I)=>r(S+g,I)),b=Math.min(o.length,l.length);for(let S=1;S<b;S++){const I=o[S]*n,C=l[S]*n;k_({source:t.subarray(s,I),target:e,start:g,end:C,size:n,getData:y}),s=I,g=C}return g<e.length&&k_({source:[],target:e,start:g,size:n,getData:y}),e}const v5={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function CP(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...v5[n],...e,...t,type:n}}function MP(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function kP(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function LP(t){t.push(t.shift())}function fx(t,e){const{doublePrecision:n,settings:r,value:o,size:l}=t,s=n&&o instanceof Float64Array?2:1;return(r.noAlloc?o.length:e*l)*s}function RP({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:o,getData:l=s=>s}){const s=n.doublePrecision&&n.value instanceof Float64Array?2:1,g=n.size*s,y=n.byteOffset,b=n.startIndices,S=o&&b,I=fx(n,e),C=n.isConstant;if(!S&&r>=I)return;const B=C?n.value:n.getBuffer().getData({srcByteOffset:y});if(n.settings.normalized&&!C){const H=l;l=(U,K)=>n.normalizeConstant(H(U,K))}const G=C?(H,U)=>l(B,U):(H,U)=>l(B.subarray(H,H+g),U),W=t.getData({length:r}),he=new Float32Array(I);y5({source:W,target:he,sourceStartIndices:o,targetStartIndices:b,size:g,getData:G}),t.byteLength<he.byteLength+y&&t.reallocate(he.byteLength+y),t.subData({data:he,offset:y})}class px extends f5{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:jg}),D(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,o=Array.isArray(n)?e[n.find(l=>e[l])]:e[n];return CP(o,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:o=1/0}=n;this.state.updateRanges=g5(this.state.updateRanges,[r,o])}else this.state.updateRanges=jg}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=m5}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==jg),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:o}){if(!this.needsUpdate())return!1;const{state:{updateRanges:l},settings:{update:s,noAlloc:g}}=this;let y=!0;if(s){for(const[b,S]of l)s.call(o,this,{data:n,startRow:b,endRow:S,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[b,S]of l){const I=Number.isFinite(b)?this.getVertexOffset(b):0,C=Number.isFinite(S)?this.getVertexOffset(S):g||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:I,endOffset:C})}this._checkAttributeArray()}else y=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),y}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:o}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(o.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),o.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const s=e;mi(ArrayBuffer.isView(s.value),"invalid ".concat(o.accessor));const g=!!s.size&&s.size!==this.size;return r.binaryAccessor=d5(s.value,{size:s.size||this.size,stride:s.stride,offset:s.offset,startIndices:n,nested:g}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:o,props:l,numInstances:s}){if(e.constant)return;const{settings:g,state:y,value:b,size:S,startIndices:I}=e,{accessor:C,transform:B}=g,G=y.binaryAccessor||(typeof C=="function"?C:l[C]);mi(typeof G=="function",'accessor "'.concat(C,'" is not a function'));let W=e.getVertexOffset(r);const{iterable:he,objectInfo:H}=p5(n,r,o);for(const U of he){H.index++;let K=G(U,H);if(B&&(K=B.call(this,K)),I){const fe=(H.index<I.length-1?I[H.index+1]:s)-I[H.index];if(K&&Array.isArray(K[0])){let ye=W;for(const xe of K)e._normalizeValue(xe,b,ye),ye+=S}else K&&K.length>S?b.set(K,W):(e._normalizeValue(K,H.target,0),HF({target:b,source:H.target,start:W,count:fe}));W+=fe*S}else e._normalizeValue(K,b,W),W+=S}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class _5{constructor({gl:e,attribute:n,timeline:r}){D(this,"gl",void 0),D(this,"type","interpolation"),D(this,"attributeInTransition",void 0),D(this,"settings",void 0),D(this,"attribute",void 0),D(this,"transition",void 0),D(this,"currentStartIndices",void 0),D(this,"currentLength",void 0),D(this,"transform",void 0),D(this,"buffers",void 0),this.gl=e,this.transition=new Ud(r),this.attribute=n,this.attributeInTransition=new px(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=b5(e,n);const o={byteLength:0,usage:35050};this.buffers=[new gn(e,o),new gn(e,o)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:o,attribute:l}=this;LP(o);const s={numInstances:n,attribute:l,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const g of o)RP({buffer:g,...s});this.currentStartIndices=l.startIndices,this.currentLength=fx(l,n),this.attributeInTransition.setData({buffer:o[1],value:l.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/l.size),sourceBuffers:{aFrom:o[0],aTo:MP(r,l)},feedbackBuffers:{vCurrent:o[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:o}=this.transition;let l=o/n;r&&(l=r(l)),this.transform.run({uniforms:{time:l}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const x5=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function b5(t,e){const n=kP(e.size);return new ax(t,{vs:x5,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class w5{constructor({gl:e,attribute:n,timeline:r}){D(this,"gl",void 0),D(this,"type","spring"),D(this,"attributeInTransition",void 0),D(this,"settings",void 0),D(this,"attribute",void 0),D(this,"transition",void 0),D(this,"currentStartIndices",void 0),D(this,"currentLength",void 0),D(this,"texture",void 0),D(this,"framebuffer",void 0),D(this,"transform",void 0),D(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Ud(r),this.attribute=n,this.attributeInTransition=new px(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=T5(e),this.framebuffer=S5(e,this.texture),this.transform=E5(e,n,this.framebuffer);const o={byteLength:0,usage:35050};this.buffers=[new gn(e,o),new gn(e,o),new gn(e,o)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:o,attribute:l}=this,s={numInstances:n,attribute:l,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const g of o)RP({buffer:g,...s});this.settings=e,this.currentStartIndices=l.startIndices,this.currentLength=fx(l,n),this.attributeInTransition.setData({buffer:o[1],value:l.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/l.size),sourceBuffers:{aTo:MP(r,l)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:o}=this;if(!o.update())return!1;const s=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:s.stiffness,damping:s.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),LP(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),Xy(r)[0]>0||o.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function E5(t,e,n){const r=kP(e.size);return new ax(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function T5(t){return new Do(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function S5(t,e){return new ei(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const A5={interpolation:_5,spring:w5};class P5{constructor(e,{id:n,timeline:r}){D(this,"id",void 0),D(this,"isSupported",void 0),D(this,"gl",void 0),D(this,"timeline",void 0),D(this,"transitions",void 0),D(this,"needsRedraw",void 0),D(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=ax.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const o in e){const l=e[o],s=l.getTransitionSetting(n);s&&this._updateAttribute(o,l,s)}for(const o in this.transitions){const l=e[o];(!l||!l.getTransitionSetting(n))&&this._removeTransition(o)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const o=this.transitions[e];let l=!o||o.type!==r.type;if(l){if(!this.isSupported){Fn.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}o&&this._removeTransition(e);const s=A5[r.type];s?this.transitions[e]=new s({attribute:n,timeline:this.timeline,gl:this.gl}):(Fn.error("unsupported transition type '".concat(r.type,"'"))(),l=!1)}(l||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const z2="attributeManager.invalidate",I5="attributeManager.updateStart",C5="attributeManager.updateEnd",M5="attribute.updateStart",k5="attribute.allocate",L5="attribute.updateEnd";class R5{constructor(e,{id:n="attribute-manager",stats:r,timeline:o}={}){D(this,"id",void 0),D(this,"gl",void 0),D(this,"attributes",void 0),D(this,"updateTriggers",void 0),D(this,"needsRedraw",void 0),D(this,"userData",void 0),D(this,"stats",void 0),D(this,"attributeTransitionManager",void 0),D(this,"mergeBoundsMemoized",Fd(zF)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new P5(e,{id:"".concat(n,"-transitions"),timeline:o}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Zi(z2,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Zi(z2,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:o,props:l={},buffers:s={},context:g={}}){let y=!1;Zi(I5,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const b in this.attributes){const S=this.attributes[b],I=S.settings.accessor;S.startIndices=r,S.numInstances=n,l[b]&&Fn.removed("props.".concat(b),"data.attributes.".concat(b))(),S.setExternalBuffer(s[b])||S.setBinaryValue(typeof I=="string"?s[I]:void 0,e.startIndices)||typeof I=="string"&&!s[I]&&S.setConstantValue(l[I])||S.needsUpdate()&&(y=!0,this._updateAttribute({attribute:S,numInstances:n,data:e,props:l,context:g})),this.needsRedraw=this.needsRedraw||S.needsRedraw()}y&&Zi(C5,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:o})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var o;return(o=this.attributes[r])===null||o===void 0?void 0:o.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,o={...r.getAttributes()};for(const l in n){const s=n[l];s.needsRedraw(e)&&!r.hasAttribute(l)&&(o[l]=s)}return o}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const o in e)n[o]||Object.assign(r,e[o].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const o=e[r];this.attributes[r]=this._createAttribute(r,o,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const o={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new px(this.gl,o)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(o=>{e[o]||(e[o]=[]),e[o].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:o}=this,l=o[e];return l&&l.forEach(s=>{const g=r[s];g&&g.setNeedsUpdate(g.id,n)}),l}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Zi(M5,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Zi(k5,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Zi(L5,n,r))}}class O5 extends Ud{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:o,easing:l}}=this,s=l(e/o);this._value=ay(n,r,s)}}const B2=1e-5;function N2(t,e,n,r,o){const l=e-t,g=(n-e)*o,y=-l*r;return g+y+l+e}function D5(t,e,n,r,o){if(Array.isArray(n)){const l=[];for(let s=0;s<n.length;s++)l[s]=N2(t[s],e[s],n[s],r,o);return l}return N2(t,e,n,r,o)}function F2(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const o=t[r]-e[r];n+=o*o}return Math.sqrt(n)}return Math.abs(t-e)}class z5 extends Ud{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:o}=this.settings,{_prevValue:l=e,_currValue:s=e}=this;let g=D5(l,s,n,r,o);const y=F2(g,n),b=F2(g,s);y<B2&&b<B2&&(g=n,this.end()),this._prevValue=s,this._currValue=g}}const B5={interpolation:O5,spring:z5};class N5{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,o){const{transitions:l}=this;if(l.has(e)){const y=l.get(e),{value:b=y.settings.fromValue}=y;n=b,this.remove(e)}if(o=CP(o),!o)return;const s=B5[o.type];if(!s){Fn.error("unsupported transition type '".concat(o.type,"'"))();return}const g=new s(this.timeline);g.start({...o,fromValue:n,toValue:r}),l.set(e,g)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function F5(t){const e=t[oc];for(const n in e){const r=e[n],{validate:o}=r;if(o&&!o(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function U5(t,e){const n=OP({newProps:t,oldProps:e,propTypes:t[oc],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=V5(t,e);let o=!1;return r||(o=G5(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:o,extensionsChanged:W5(t,e),transitionsChanged:j5(t,e)}}function j5(t,e){if(!t.transitions)return!1;const n={},r=t[oc];let o=!1;for(const l in t.transitions){const s=r[l],g=s&&s.type;(g==="number"||g==="color"||g==="array")&&k0(t[l],e[l],s)&&(n[l]=!0,o=!0)}return o?n:!1}function OP({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:o="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(o," changed shallowly");for(const l of Object.keys(t))if(!(l in n)){if(!(l in e))return"".concat(o,".").concat(l," added");const s=k0(t[l],e[l],r[l]);if(s)return"".concat(o,".").concat(l," ").concat(s)}for(const l of Object.keys(e))if(!(l in n)){if(!(l in t))return"".concat(o,".").concat(l," dropped");if(!Object.hasOwnProperty.call(t,l)){const s=k0(t[l],e[l],r[l]);if(s)return"".concat(o,".").concat(l," ").concat(s)}}return!1}function k0(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function V5(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:o}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&o&&(n=o(t.data,e.data)||n),n}function G5(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&U2(t,e,"all"))return{all:!0};const n={};let r=!1;for(const o in t.updateTriggers)o!=="all"&&U2(t,e,o)&&(n[o]=!0,r=!0);return r?n:!1}function W5(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let o=0;o<r.length;o++)if(!r[o].equals(n[o]))return!0;return!1}function U2(t,e,n){let r=t.updateTriggers[n];r=r??{};let o=e.updateTriggers[n];return o=o??{},OP({oldProps:o,newProps:r,triggerName:n})}const H5="count(): argument not an object",q5="count(): argument not a container";function Z5(t){if(!Y5(t))throw new Error(H5);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(X5(t))return Object.keys(t).length;throw new Error(q5)}function X5(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function Y5(t){return t!==null&&typeof t=="object"}function $5(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(o=>o.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const o in e.inject)r[o]=(r[o]||"")+e.inject[o];n.inject=r}return n}const K5={10241:9987,10240:9729,10242:33071,10243:33071},L0={};function J5(t,e,n,r){if(n instanceof Do)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let o=null;n.compressed&&(o={10241:n.data.length>1?9985:9729});const l=new Do(e,{...n,parameters:{...K5,...o,...r}});return L0[l.id]=t,l}function Q5(t,e){!e||!(e instanceof Do)||L0[e.id]===t&&(e.delete(),delete L0[e.id])}const e6={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||R0(t)&&(t.length===3||t.length===4)},equal(t,e,n){return fs(t,e,1)}},accessor:{validate(t,e){const n=py(t);return n==="function"||n===py(e.value)},equal(t,e,n){return typeof e=="function"?!0:fs(t,e,1)}},array:{validate(t,e){return e.optional&&!t||R0(t)},equal(t,e,n){const{compare:r}=n,o=Number.isInteger(r)?r:r?1:0;return r?fs(t,e,o):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,o=Number.isInteger(r)?r:r?1:0;return r?fs(t,e,o):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:J5(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{Q5(n.id,t)}}};function t6(t){const e={},n={},r={};for(const[o,l]of Object.entries(t)){const s=l==null?void 0:l.deprecatedFor;if(s)r[o]=Array.isArray(s)?s:[s];else{const g=n6(o,l);e[o]=g,n[o]=g.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function n6(t,e){switch(py(e)){case"object":return Sp(t,e);case"array":return Sp(t,{type:"array",value:e,compare:!1});case"boolean":return Sp(t,{type:"boolean",value:e});case"number":return Sp(t,{type:"number",value:e});case"function":return Sp(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Sp(t,e){return"type"in e?{name:t,...e6[e.type],...e}:"value"in e?{name:t,type:py(e.value),...e}:{name:t,type:"object",value:e}}function R0(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function py(t){return R0(t)?"array":t===null?"null":typeof t}function r6(t,e){let n;for(let l=e.length-1;l>=0;l--){const s=e[l];"extensions"in s&&(n=s.extensions)}const r=O0(t.constructor,n),o=Object.create(r);o[hy]=t,o[cc]={},o[Yl]={};for(let l=0;l<e.length;++l){const s=e[l];for(const g in s)o[g]=s[g]}return Object.freeze(o),o}const i6="_mergedDefaultProps";function O0(t,e){let n=i6;if(e)for(const o of e){const l=o.constructor;l&&(n+=":".concat(l.extensionName||l.name))}const r=DP(t,n);return r||(t[n]=o6(t,e||[]))}function o6(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),o=O0(r),l=DP(t,"defaultProps")||{},s=t6(l),g=Object.assign(Object.create(null),o,s.defaultProps),y=Object.assign(Object.create(null),o==null?void 0:o[oc],s.propTypes),b=Object.assign(Object.create(null),o==null?void 0:o[I_],s.deprecatedProps);for(const S of e){const I=O0(S.constructor);I&&(Object.assign(g,I),Object.assign(y,I[oc]),Object.assign(b,I[I_]))}return a6(g,t),l6(g,y),s6(g,b),g[oc]=y,g[I_]=b,e.length===0&&!dx(t,"_propTypes")&&(t._propTypes=y),g}function a6(t,e){const n=c6(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function s6(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const o="".concat(this.id,": ").concat(n);for(const l of e[n])dx(this,l)||(this[l]=r);Fn.deprecated(o,e[n].join("/"))()}})}function l6(t,e){const n={},r={};for(const o in e){const l=e[o],{name:s,value:g}=l;l.async&&(n[s]=g,r[s]=u6(s))}t[Wh]=n,t[cc]={},Object.defineProperties(t,r)}function u6(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||IP(e)?this[cc][t]=e:this[Yl][t]=e},get(){if(this[Yl]){if(t in this[Yl])return this[Yl][t]||this[Wh][t];if(t in this[cc]){const e=this[hy]&&this[hy].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Wh][t]}}return this[Wh][t]}}}function dx(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function DP(t,e){return dx(t,e)&&t[e]}function c6(t){const e=t.componentName;return e||Fn.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let h6=0;class mx{constructor(...e){D(this,"id",void 0),D(this,"props",void 0),D(this,"count",void 0),this.props=r6(this,e),this.id=this.props.id,this.count=h6++}clone(e){const{props:n}=this,r={};for(const o in n[Wh])o in n[Yl]?r[o]=n[Yl][o]:o in n[cc]&&(r[o]=n[cc][o]);return new this.constructor({...n,...r,...e})}}D(mx,"componentName","Component");D(mx,"defaultProps",{});const f6=Object.freeze({});class p6{constructor(e){D(this,"component",void 0),D(this,"onAsyncPropUpdated",void 0),D(this,"asyncProps",void 0),D(this,"oldProps",void 0),D(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||f6}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[hy]||this.component;const n=e[Yl]||{},r=e[cc]||e,o=e[Wh]||{};for(const l in n){const s=n[l];this._createAsyncPropData(l,o[l]),this._updateAsyncProp(l,s),n[l]=this.getAsyncProp(l)}for(const l in r){const s=r[l];this._createAsyncPropData(l,o[l]),this._updateAsyncProp(l,s)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(IP(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const o=this.asyncProps[e];o&&r>=o.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),o.resolvedValue=n,o.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const o=r.pendingLoadCount;n.then(l=>{this.component&&(l=this._postProcessValue(r,l),this._setAsyncPropValue(e,l,o),this._onResolve(e,l))}).catch(l=>{this._onError(e,l)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const o=r.pendingLoadCount;let l=[],s=0;for await(const g of n){if(!this.component)return;const{dataTransform:y}=this.component.props;y?l=y(g,l):l=l.concat(g),Object.defineProperty(l,"__diff",{enumerable:!1,value:[{startRow:s,endRow:l.length}]}),s=l.length,this._setAsyncPropValue(e,l,o)}this._onResolve(e,l)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const o=this.component&&this.component.props[oc];this.asyncProps[e]={type:o&&o[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class d6 extends p6{constructor({attributeManager:e,layer:n}){super(n),D(this,"attributeManager",void 0),D(this,"needsRedraw",void 0),D(this,"needsUpdate",void 0),D(this,"subLayers",void 0),D(this,"usesPickingColorCache",void 0),D(this,"hasPickingBuffer",void 0),D(this,"changeFlags",void 0),D(this,"viewport",void 0),D(this,"uniformTransitions",void 0),D(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,o=r==null?void 0:r.props.fetch;return o?o(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const o=r.props.onDataLoad;e==="data"&&o&&o(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const m6="layer.changeFlag",g6="layer.initialize",y6="layer.update",v6="layer.finalize",_6="layer.matched",j2=2**24-1,x6=Object.freeze([]),b6=Fd(({oldViewport:t,viewport:e})=>t.equals(e));let os=new Uint8ClampedArray(0);const w6={data:{type:"data",value:x6,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:o,signal:l})=>{const{resourceManager:s}=n.context;if(o=o||n.getLoadOptions(),r=r||n.props.loaders,l){var g;o={...o,fetch:{...(g=o)===null||g===void 0?void 0:g.fetch,signal:l}}}let y=s.contains(t);return!y&&!o&&(s.add({resourceId:t,data:Qh(t,r),persistent:!1}),y=!0),y?s.subscribe({resourceId:t,onChange:b=>{var S;return(S=n.internalState)===null||S===void 0?void 0:S.reloadAsyncProp(e,b)},consumerId:n.id,requestId:e}):Qh(t,r,o)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Rn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class _c extends mx{constructor(...e){super(...e),D(this,"internalState",null),D(this,"lifecycle",Ih.NO_STATE),D(this,"context",void 0),D(this,"state",void 0),D(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){mi(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=dP(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[o,l,s]=cx(r,n.pixelProjectionMatrix);return e.length===2?[o,l]:[o,l,s]}unproject(e){return mi(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){mi(this.internalState);const r=this.internalState.viewport||this.context.viewport;return VF(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Rn.DEFAULT||e===Rn.LNGLAT||e===Rn.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){mi(e instanceof Uint8Array);const[n,r,o]=e;return n+r*256+o*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Z5(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=$5(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const o of r)n.invalidateAll(o);else n.invalidateAll();if(n){const{props:o}=e,l=this.internalState.hasPickingBuffer,s=Number.isInteger(o.highlightedObjectIndex)||o.pickable||o.extensions.some(g=>g.getNeedsPickingBuffer.call(this,g));if(l!==s){this.internalState.hasPickingBuffer=s;const{pickingColors:g,instancePickingColors:y}=n.attributes,b=g||y;b&&(s&&b.constant&&(b.constant=!1,n.invalidate(b.id)),!b.value&&!s&&(b.constant=!0,b.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:o}=e;return o>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[o]),e}raiseError(e,n){var r,o;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(o=this.props).onError)!==null&&r!==void 0&&r.call(o,e))){var l,s;(l=this.context)===null||l===void 0||(s=l.onError)===null||s===void 0||s.call(l,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!b6({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),o=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:o,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const l=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(l)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const o in n)Object.defineProperty(r,o,{value:n[o]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(os.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>j2&&Fn.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),os=ud.allocate(os,n,{size:3,copy:!0,maxCount:Math.max(n,j2)});const o=Math.floor(os.length/3),l=[];for(let s=r;s<o;s++)this.encodePickingColor(s,l),os[s*3+0]=l[0],os[s*3+1]=l[1],os[s*3+2]=l[2]}e.value=os.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),o=e.userData.excludeAttributes||{},l=r.getShaderAttributes(n,o);e.setAttributes(l)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:o}=this.getAttributeManager().attributes,l=r||o,s=l&&n.attributes&&n.attributes[l.id];if(s&&s.value){const g=s.value,y=this.encodePickingColor(e);for(let b=0;b<n.length;b++){const S=l.getVertexOffset(b);g[S]===y[0]&&g[S+1]===y[1]&&g[S+2]===y[2]&&this._disablePickingIndex(b)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,o=n||r;if(!o)return;const l=o.getVertexOffset(e),s=o.getVertexOffset(e+1);o.buffer.subData({data:new Uint8Array(s-l),offset:l})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==os.buffer&&(r.value=os.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){mi(!this.internalState),mi(Number.isFinite(this.props.coordinateSystem)),Zi(g6,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new d6({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Fn.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new N5(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Zi(_6,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Zi(y6,this,e),!e)return;const n=this.props,r=this.context,o=this.internalState,l=r.viewport,s=this._updateUniformTransition();o.propsInTransition=s,r.viewport=o.viewport||l,this.props=s;try{const g=this._getUpdateParams(),y=this.getModels();if(r.gl)this.updateState(g);else try{this.updateState(g)}catch{}for(const S of this.props.extensions)S.updateState.call(this,g,S);const b=this.getModels()[0]!==y[0];this._postUpdate(g,b)}finally{r.viewport=l,this.props=n,this._clearChangeFlags(),o.needsUpdate=!1,o.resetOldProps()}}_finalize(){Zi(v6,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const o=this.props,l=this.context;this.props=this.internalState.propsInTransition||o;const s=this.props.opacity;n.opacity=Math.pow(s,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:g}=this.props,y=g&&g(n)||[0,0];ul(l.gl,{polygonOffset:y}),ba(l.gl,r,()=>{const b={moduleParameters:e,uniforms:n,parameters:r,context:l};for(const S of this.props.extensions)S.draw.call(this,b,S);this.draw(b)})}finally{this.props=o}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const o in e)if(e[o]){let l=!1;switch(o){case"dataChanged":const s=e[o],g=n[o];s&&Array.isArray(g)&&(n.dataChanged=Array.isArray(s)?g.concat(s):s,l=!0);default:n[o]||(n[o]=e[o],l=!0)}l&&Zi(m6,this,o,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=U5(e,n);if(r.updateTriggersChanged)for(const l in r.updateTriggersChanged)r.updateTriggersChanged[l]&&this.invalidateAttribute(l);if(r.transitionsChanged)for(const l in r.transitionsChanged){var o;this.internalState.uniformTransitions.add(l,n[l],e[l],(o=e.transitions)===null||o===void 0?void 0:o[l])}return this.setChangeFlags(r)}validateProps(){F5(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new R5(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:o}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:l}=this.state;l==null||l.setInstanceCount(this.getNumInstances());const{autoHighlight:s,highlightedObjectIndex:g,highlightColor:y}=r;if(n||o.autoHighlight!==s||o.highlightedObjectIndex!==g||o.highlightColor!==y){const b={};s||(b.pickingSelectedColor=null),Array.isArray(y)&&(b.pickingHighlightColor=y),(n||g!==o.highlightedObjectIndex)&&(b.pickingSelectedColor=Number.isFinite(g)&&g>=0?this.encodePickingColor(g):null),this.setModuleParameters(b)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),o=r?r.getNeedsRedraw(e):!1;if(n=n||o,n)for(const l of this.props.extensions)l.onNeedsRedraw.call(this,l);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}D(_c,"defaultProps",w6);D(_c,"layerName","Layer");const E6=typeof window<"u"?Re.useLayoutEffect:Re.useEffect,T6=E6;function dy(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const S6={position:"absolute",zIndex:-1};function zP(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>zP(n,e));if(Jy(t)){if(A6(t))return e.style=S6,Re.cloneElement(t,e);if(P6(t))return Re.cloneElement(t,e)}return t}function Jy(t){return t&&typeof t=="object"&&"type"in t||!1}function A6(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function P6(t){const e=t.type;return e&&e.deckGLViewProps}function D0(t){if(typeof t=="function")return Re.createElement(cf,{},t);if(Array.isArray(t))return t.map(D0);if(Jy(t)){if(t.type===Re.Fragment)return D0(t.props.children);if(dy(t.type,cf))return t}return t}function I6({children:t,layers:e=[],views:n=null}){const r=[],o=[],l={};return Re.Children.forEach(D0(t),s=>{if(Jy(s)){const g=s.type;if(dy(g,_c)){const y=C6(g,s.props);o.push(y)}else r.push(s);if(dy(g,cf)&&g!==cf&&s.props.id){const y=new g(s.props);l[y.id]=y}}else s&&r.push(s)}),Object.keys(l).length>0&&(Array.isArray(n)?n.forEach(s=>{l[s.id]=s}):n&&(l[n.id]=n),n=Object.values(l)),e=o.length>0?[...o,...e]:e,{layers:e,children:r,views:n}}function C6(t,e){const n={},r=t.defaultProps||{};for(const o in e)r[o]!==e[o]&&(n[o]=e[o]);return new t(n)}function M6({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const o={},l=r.views[0].id;for(const s of t){let g=l,y=s;Jy(s)&&dy(s.type,cf)&&(g=s.props.id||l,y=s.props.children);const b=r.getViewport(g),S=r.getViewState(g);if(b){S.padding=b.padding;const{x:I,y:C,width:B,height:G}=b;y=zP(y,{x:I,y:C,width:B,height:G,viewport:b,viewState:S}),o[g]||(o[g]={viewport:b,children:[]}),o[g].children.push(y)}}return Object.keys(o).map(s=>{const{viewport:g,children:y}=o[s],{x:b,y:S,width:I,height:C}=g,B={position:"absolute",left:b,top:S,width:I,height:C},G="view-".concat(s),W=Re.createElement("div",{key:G,id:G,style:B},...y);if(n){const he={viewport:g,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:H=>{H.viewId=s,e._onViewStateChange(H)}};return Re.createElement(n,{key:G,value:he},W)}return W})}const k6={mixBlendMode:null};function L6({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},o={left:0,top:0};if(n)for(const l in n)l in k6?o[l]=n[l]:r[l]=n[l];return{containerStyle:r,canvasStyle:o}}function R6(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function BP(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function O6(t,e,n){const r=new e({...n,_customRender:o=>{t.redrawReason=o;const l=r.getViewports();t.lastRenderedViewports!==l?t.forceUpdate():BP(t)}});return r}const NP=Re.forwardRef((t,e)=>{const[n,r]=Re.useState(0),l=Re.useRef({control:null,version:n,forceUpdate:()=>r(ye=>ye+1)}).current,s=Re.useRef(null),g=Re.useRef(null),y=Re.useMemo(()=>I6(t),[t.layers,t.views,t.children]);let b=!0;const S=ye=>{var xe;return b&&t.viewState?(l.viewStateUpdateRequested=ye,null):(l.viewStateUpdateRequested=null,(xe=t.onViewStateChange)===null||xe===void 0?void 0:xe.call(t,ye))},I=ye=>{if(b)l.interactionStateUpdateRequested=ye;else{var xe;l.interactionStateUpdateRequested=null,(xe=t.onInteractionStateChange)===null||xe===void 0||xe.call(t,ye)}},C=Re.useMemo(()=>{const ye={...t,style:null,width:"100%",height:"100%",parent:s.current,canvas:g.current,layers:y.layers,views:y.views,onViewStateChange:S,onInteractionStateChange:I};return delete ye._customRender,l.deck&&l.deck.setProps(ye),ye},[t]);Re.useEffect(()=>{const ye=t.Deck||Ky;return l.deck=O6(l,ye,{...C,parent:s.current,canvas:g.current}),()=>{var xe;return(xe=l.deck)===null||xe===void 0?void 0:xe.finalize()}},[]),T6(()=>{BP(l);const{viewStateUpdateRequested:ye,interactionStateUpdateRequested:xe}=l;ye&&S(ye),xe&&I(xe)}),Re.useImperativeHandle(e,()=>R6(l),[]);const B=l.deck&&l.deck.isInitialized?l.deck.getViewports():void 0,{ContextProvider:G,width:W,height:he,id:H,style:U}=t,{containerStyle:K,canvasStyle:fe}=Re.useMemo(()=>L6({width:W,height:he,style:U}),[W,he,U]);if(!l.viewStateUpdateRequested&&l.lastRenderedViewports===B||l.version!==n){l.lastRenderedViewports=B,l.version=n;const ye=M6({children:y.children,deck:l.deck,ContextProvider:G}),xe=Re.createElement("canvas",{key:"canvas",id:H||"deckgl-overlay",ref:g,style:fe});l.control=Re.createElement("div",{id:"".concat(H||"deckgl","-wrapper"),ref:s,style:K},[xe,ye])}return b=!1,l.control});NP.defaultProps=Ky.defaultProps;const D6=NP;var FP={exports:{}},Bo={},UP={exports:{}},jP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ut,Mt){var Ot=ut.length;ut.push(Mt);e:for(;0<Ot;){var Qt=Ot-1>>>1,en=ut[Qt];if(0<o(en,Mt))ut[Qt]=Mt,ut[Ot]=en,Ot=Qt;else break e}}function n(ut){return ut.length===0?null:ut[0]}function r(ut){if(ut.length===0)return null;var Mt=ut[0],Ot=ut.pop();if(Ot!==Mt){ut[0]=Ot;e:for(var Qt=0,en=ut.length,vi=en>>>1;Qt<vi;){var Ir=2*(Qt+1)-1,_i=ut[Ir],Fi=Ir+1,an=ut[Fi];if(0>o(_i,Ot))Fi<en&&0>o(an,_i)?(ut[Qt]=an,ut[Fi]=Ot,Qt=Fi):(ut[Qt]=_i,ut[Ir]=Ot,Qt=Ir);else if(Fi<en&&0>o(an,Ot))ut[Qt]=an,ut[Fi]=Ot,Qt=Fi;else break e}}return Mt}function o(ut,Mt){var Ot=ut.sortIndex-Mt.sortIndex;return Ot!==0?Ot:ut.id-Mt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var s=Date,g=s.now();t.unstable_now=function(){return s.now()-g}}var y=[],b=[],S=1,I=null,C=3,B=!1,G=!1,W=!1,he=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function K(ut){for(var Mt=n(b);Mt!==null;){if(Mt.callback===null)r(b);else if(Mt.startTime<=ut)r(b),Mt.sortIndex=Mt.expirationTime,e(y,Mt);else break;Mt=n(b)}}function fe(ut){if(W=!1,K(ut),!G)if(n(y)!==null)G=!0,rr(ye);else{var Mt=n(b);Mt!==null&&Pr(fe,Mt.startTime-ut)}}function ye(ut,Mt){G=!1,W&&(W=!1,H(De),De=-1),B=!0;var Ot=C;try{for(K(Mt),I=n(y);I!==null&&(!(I.expirationTime>Mt)||ut&&!tt());){var Qt=I.callback;if(typeof Qt=="function"){I.callback=null,C=I.priorityLevel;var en=Qt(I.expirationTime<=Mt);Mt=t.unstable_now(),typeof en=="function"?I.callback=en:I===n(y)&&r(y),K(Mt)}else r(y);I=n(y)}if(I!==null)var vi=!0;else{var Ir=n(b);Ir!==null&&Pr(fe,Ir.startTime-Mt),vi=!1}return vi}finally{I=null,C=Ot,B=!1}}var xe=!1,Te=null,De=-1,Fe=5,Ve=-1;function tt(){return!(t.unstable_now()-Ve<Fe)}function Bt(){if(Te!==null){var ut=t.unstable_now();Ve=ut;var Mt=!0;try{Mt=Te(!0,ut)}finally{Mt?ft():(xe=!1,Te=null)}}else xe=!1}var ft;if(typeof U=="function")ft=function(){U(Bt)};else if(typeof MessageChannel<"u"){var wt=new MessageChannel,nr=wt.port2;wt.port1.onmessage=Bt,ft=function(){nr.postMessage(null)}}else ft=function(){he(Bt,0)};function rr(ut){Te=ut,xe||(xe=!0,ft())}function Pr(ut,Mt){De=he(function(){ut(t.unstable_now())},Mt)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ut){ut.callback=null},t.unstable_continueExecution=function(){G||B||(G=!0,rr(ye))},t.unstable_forceFrameRate=function(ut){0>ut||125<ut?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Fe=0<ut?Math.floor(1e3/ut):5},t.unstable_getCurrentPriorityLevel=function(){return C},t.unstable_getFirstCallbackNode=function(){return n(y)},t.unstable_next=function(ut){switch(C){case 1:case 2:case 3:var Mt=3;break;default:Mt=C}var Ot=C;C=Mt;try{return ut()}finally{C=Ot}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ut,Mt){switch(ut){case 1:case 2:case 3:case 4:case 5:break;default:ut=3}var Ot=C;C=ut;try{return Mt()}finally{C=Ot}},t.unstable_scheduleCallback=function(ut,Mt,Ot){var Qt=t.unstable_now();switch(typeof Ot=="object"&&Ot!==null?(Ot=Ot.delay,Ot=typeof Ot=="number"&&0<Ot?Qt+Ot:Qt):Ot=Qt,ut){case 1:var en=-1;break;case 2:en=250;break;case 5:en=1073741823;break;case 4:en=1e4;break;default:en=5e3}return en=Ot+en,ut={id:S++,callback:Mt,priorityLevel:ut,startTime:Ot,expirationTime:en,sortIndex:-1},Ot>Qt?(ut.sortIndex=Ot,e(b,ut),n(y)===null&&ut===n(b)&&(W?(H(De),De=-1):W=!0,Pr(fe,Ot-Qt))):(ut.sortIndex=en,e(y,ut),G||B||(G=!0,rr(ye))),ut},t.unstable_shouldYield=tt,t.unstable_wrapCallback=function(ut){var Mt=C;return function(){var Ot=C;C=Mt;try{return ut.apply(this,arguments)}finally{C=Ot}}}})(jP);UP.exports=jP;var z6=UP.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VP=Re,zo=z6;function Ke(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var GP=new Set,cd={};function xc(t,e){hf(t,e),hf(t+"Capture",e)}function hf(t,e){for(cd[t]=e,t=0;t<e.length;t++)GP.add(e[t])}var hl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),z0=Object.prototype.hasOwnProperty,B6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,V2={},G2={};function N6(t){return z0.call(G2,t)?!0:z0.call(V2,t)?!1:B6.test(t)?G2[t]=!0:(V2[t]=!0,!1)}function F6(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function U6(t,e,n,r){if(e===null||typeof e>"u"||F6(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ji(t,e,n,r,o,l,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=l,this.removeEmptyString=s}var yi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){yi[t]=new Ji(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];yi[e]=new Ji(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){yi[t]=new Ji(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){yi[t]=new Ji(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){yi[t]=new Ji(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){yi[t]=new Ji(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){yi[t]=new Ji(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){yi[t]=new Ji(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){yi[t]=new Ji(t,5,!1,t.toLowerCase(),null,!1,!1)});var gx=/[\-:]([a-z])/g;function yx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(gx,yx);yi[e]=new Ji(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(gx,yx);yi[e]=new Ji(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(gx,yx);yi[e]=new Ji(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){yi[t]=new Ji(t,1,!1,t.toLowerCase(),null,!1,!1)});yi.xlinkHref=new Ji("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){yi[t]=new Ji(t,1,!1,t.toLowerCase(),null,!0,!0)});function vx(t,e,n,r){var o=yi.hasOwnProperty(e)?yi[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(U6(e,n,o,r)&&(n=null),r||o===null?N6(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var yl=VP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,pg=Symbol.for("react.element"),kh=Symbol.for("react.portal"),Lh=Symbol.for("react.fragment"),_x=Symbol.for("react.strict_mode"),B0=Symbol.for("react.profiler"),WP=Symbol.for("react.provider"),HP=Symbol.for("react.context"),xx=Symbol.for("react.forward_ref"),N0=Symbol.for("react.suspense"),F0=Symbol.for("react.suspense_list"),bx=Symbol.for("react.memo"),Wl=Symbol.for("react.lazy"),qP=Symbol.for("react.offscreen"),W2=Symbol.iterator;function Ap(t){return t===null||typeof t!="object"?null:(t=W2&&t[W2]||t["@@iterator"],typeof t=="function"?t:null)}var vr=Object.assign,L_;function Bp(t){if(L_===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);L_=e&&e[1]||""}return`
`+L_+t}var R_=!1;function O_(t,e){if(!t||R_)return"";R_=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(b){var r=b}Reflect.construct(t,[],e)}else{try{e.call()}catch(b){r=b}t.call(e.prototype)}else{try{throw Error()}catch(b){r=b}t()}}catch(b){if(b&&r&&typeof b.stack=="string"){for(var o=b.stack.split(`
`),l=r.stack.split(`
`),s=o.length-1,g=l.length-1;1<=s&&0<=g&&o[s]!==l[g];)g--;for(;1<=s&&0<=g;s--,g--)if(o[s]!==l[g]){if(s!==1||g!==1)do if(s--,g--,0>g||o[s]!==l[g]){var y=`
`+o[s].replace(" at new "," at ");return t.displayName&&y.includes("<anonymous>")&&(y=y.replace("<anonymous>",t.displayName)),y}while(1<=s&&0<=g);break}}}finally{R_=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Bp(t):""}function j6(t){switch(t.tag){case 5:return Bp(t.type);case 16:return Bp("Lazy");case 13:return Bp("Suspense");case 19:return Bp("SuspenseList");case 0:case 2:case 15:return t=O_(t.type,!1),t;case 11:return t=O_(t.type.render,!1),t;case 1:return t=O_(t.type,!0),t;default:return""}}function U0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Lh:return"Fragment";case kh:return"Portal";case B0:return"Profiler";case _x:return"StrictMode";case N0:return"Suspense";case F0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case HP:return(t.displayName||"Context")+".Consumer";case WP:return(t._context.displayName||"Context")+".Provider";case xx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case bx:return e=t.displayName||null,e!==null?e:U0(t.type)||"Memo";case Wl:e=t._payload,t=t._init;try{return U0(t(e))}catch{}}return null}function V6(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U0(e);case 8:return e===_x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function su(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ZP(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function G6(t){var e=ZP(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,l=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(s){r=""+s,l.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function dg(t){t._valueTracker||(t._valueTracker=G6(t))}function XP(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ZP(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function my(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function j0(t,e){var n=e.checked;return vr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function H2(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=su(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function YP(t,e){e=e.checked,e!=null&&vx(t,"checked",e,!1)}function V0(t,e){YP(t,e);var n=su(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?G0(t,e.type,n):e.hasOwnProperty("defaultValue")&&G0(t,e.type,su(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function q2(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function G0(t,e,n){(e!=="number"||my(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Np=Array.isArray;function Hh(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+su(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function W0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ke(91));return vr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Z2(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Ke(92));if(Np(n)){if(1<n.length)throw Error(Ke(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:su(n)}}function $P(t,e){var n=su(e.value),r=su(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function X2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function KP(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function H0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?KP(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var mg,JP=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(mg=mg||document.createElement("div"),mg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function hd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Wp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},W6=["Webkit","ms","Moz","O"];Object.keys(Wp).forEach(function(t){W6.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Wp[e]=Wp[t]})});function QP(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Wp.hasOwnProperty(t)&&Wp[t]?(""+e).trim():e+"px"}function eI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=QP(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var H6=vr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function q0(t,e){if(e){if(H6[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ke(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ke(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ke(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ke(62))}}function Z0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var X0=null;function wx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Y0=null,qh=null,Zh=null;function Y2(t){if(t=Wd(t)){if(typeof Y0!="function")throw Error(Ke(280));var e=t.stateNode;e&&(e=rv(e),Y0(t.stateNode,t.type,e))}}function tI(t){qh?Zh?Zh.push(t):Zh=[t]:qh=t}function nI(){if(qh){var t=qh,e=Zh;if(Zh=qh=null,Y2(t),e)for(t=0;t<e.length;t++)Y2(e[t])}}function rI(t,e){return t(e)}function iI(){}var D_=!1;function oI(t,e,n){if(D_)return t(e,n);D_=!0;try{return rI(t,e,n)}finally{D_=!1,(qh!==null||Zh!==null)&&(iI(),nI())}}function fd(t,e){var n=t.stateNode;if(n===null)return null;var r=rv(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Ke(231,e,typeof n));return n}var $0=!1;if(hl)try{var Pp={};Object.defineProperty(Pp,"passive",{get:function(){$0=!0}}),window.addEventListener("test",Pp,Pp),window.removeEventListener("test",Pp,Pp)}catch{$0=!1}function q6(t,e,n,r,o,l,s,g,y){var b=Array.prototype.slice.call(arguments,3);try{e.apply(n,b)}catch(S){this.onError(S)}}var Hp=!1,gy=null,yy=!1,K0=null,Z6={onError:function(t){Hp=!0,gy=t}};function X6(t,e,n,r,o,l,s,g,y){Hp=!1,gy=null,q6.apply(Z6,arguments)}function Y6(t,e,n,r,o,l,s,g,y){if(X6.apply(this,arguments),Hp){if(Hp){var b=gy;Hp=!1,gy=null}else throw Error(Ke(198));yy||(yy=!0,K0=b)}}function bc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function aI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function $2(t){if(bc(t)!==t)throw Error(Ke(188))}function $6(t){var e=t.alternate;if(!e){if(e=bc(t),e===null)throw Error(Ke(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var l=o.alternate;if(l===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===l.child){for(l=o.child;l;){if(l===n)return $2(o),t;if(l===r)return $2(o),e;l=l.sibling}throw Error(Ke(188))}if(n.return!==r.return)n=o,r=l;else{for(var s=!1,g=o.child;g;){if(g===n){s=!0,n=o,r=l;break}if(g===r){s=!0,r=o,n=l;break}g=g.sibling}if(!s){for(g=l.child;g;){if(g===n){s=!0,n=l,r=o;break}if(g===r){s=!0,r=l,n=o;break}g=g.sibling}if(!s)throw Error(Ke(189))}}if(n.alternate!==r)throw Error(Ke(190))}if(n.tag!==3)throw Error(Ke(188));return n.stateNode.current===n?t:e}function sI(t){return t=$6(t),t!==null?lI(t):null}function lI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lI(t);if(e!==null)return e;t=t.sibling}return null}var uI=zo.unstable_scheduleCallback,K2=zo.unstable_cancelCallback,K6=zo.unstable_shouldYield,J6=zo.unstable_requestPaint,Dr=zo.unstable_now,Q6=zo.unstable_getCurrentPriorityLevel,Ex=zo.unstable_ImmediatePriority,cI=zo.unstable_UserBlockingPriority,vy=zo.unstable_NormalPriority,eU=zo.unstable_LowPriority,hI=zo.unstable_IdlePriority,Qy=null,ms=null;function tU(t){if(ms&&typeof ms.onCommitFiberRoot=="function")try{ms.onCommitFiberRoot(Qy,t,void 0,(t.current.flags&128)===128)}catch{}}var wa=Math.clz32?Math.clz32:iU,nU=Math.log,rU=Math.LN2;function iU(t){return t>>>=0,t===0?32:31-(nU(t)/rU|0)|0}var gg=64,yg=4194304;function Fp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function _y(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,l=t.pingedLanes,s=n&268435455;if(s!==0){var g=s&~o;g!==0?r=Fp(g):(l&=s,l!==0&&(r=Fp(l)))}else s=n&~o,s!==0?r=Fp(s):l!==0&&(r=Fp(l));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,l=e&-e,o>=l||o===16&&(l&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-wa(e),o=1<<n,r|=t[n],e&=~o;return r}function oU(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function aU(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,l=t.pendingLanes;0<l;){var s=31-wa(l),g=1<<s,y=o[s];y===-1?(!(g&n)||g&r)&&(o[s]=oU(g,e)):y<=e&&(t.expiredLanes|=g),l&=~g}}function J0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function fI(){var t=gg;return gg<<=1,!(gg&4194240)&&(gg=64),t}function z_(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-wa(e),t[e]=n}function sU(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-wa(n),l=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~l}}function Tx(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-wa(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var On=0;function pI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var dI,Sx,mI,gI,yI,Q0=!1,vg=[],Ql=null,eu=null,tu=null,pd=new Map,dd=new Map,ql=[],lU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function J2(t,e){switch(t){case"focusin":case"focusout":Ql=null;break;case"dragenter":case"dragleave":eu=null;break;case"mouseover":case"mouseout":tu=null;break;case"pointerover":case"pointerout":pd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":dd.delete(e.pointerId)}}function Ip(t,e,n,r,o,l){return t===null||t.nativeEvent!==l?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[o]},e!==null&&(e=Wd(e),e!==null&&Sx(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function uU(t,e,n,r,o){switch(e){case"focusin":return Ql=Ip(Ql,t,e,n,r,o),!0;case"dragenter":return eu=Ip(eu,t,e,n,r,o),!0;case"mouseover":return tu=Ip(tu,t,e,n,r,o),!0;case"pointerover":var l=o.pointerId;return pd.set(l,Ip(pd.get(l)||null,t,e,n,r,o)),!0;case"gotpointercapture":return l=o.pointerId,dd.set(l,Ip(dd.get(l)||null,t,e,n,r,o)),!0}return!1}function vI(t){var e=ec(t.target);if(e!==null){var n=bc(e);if(n!==null){if(e=n.tag,e===13){if(e=aI(n),e!==null){t.blockedOn=e,yI(t.priority,function(){mI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Vg(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=e1(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);X0=r,n.target.dispatchEvent(r),X0=null}else return e=Wd(n),e!==null&&Sx(e),t.blockedOn=n,!1;e.shift()}return!0}function Q2(t,e,n){Vg(t)&&n.delete(e)}function cU(){Q0=!1,Ql!==null&&Vg(Ql)&&(Ql=null),eu!==null&&Vg(eu)&&(eu=null),tu!==null&&Vg(tu)&&(tu=null),pd.forEach(Q2),dd.forEach(Q2)}function Cp(t,e){t.blockedOn===e&&(t.blockedOn=null,Q0||(Q0=!0,zo.unstable_scheduleCallback(zo.unstable_NormalPriority,cU)))}function md(t){function e(o){return Cp(o,t)}if(0<vg.length){Cp(vg[0],t);for(var n=1;n<vg.length;n++){var r=vg[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ql!==null&&Cp(Ql,t),eu!==null&&Cp(eu,t),tu!==null&&Cp(tu,t),pd.forEach(e),dd.forEach(e),n=0;n<ql.length;n++)r=ql[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ql.length&&(n=ql[0],n.blockedOn===null);)vI(n),n.blockedOn===null&&ql.shift()}var Xh=yl.ReactCurrentBatchConfig,xy=!0;function hU(t,e,n,r){var o=On,l=Xh.transition;Xh.transition=null;try{On=1,Ax(t,e,n,r)}finally{On=o,Xh.transition=l}}function fU(t,e,n,r){var o=On,l=Xh.transition;Xh.transition=null;try{On=4,Ax(t,e,n,r)}finally{On=o,Xh.transition=l}}function Ax(t,e,n,r){if(xy){var o=e1(t,e,n,r);if(o===null)q_(t,e,r,by,n),J2(t,r);else if(uU(o,t,e,n,r))r.stopPropagation();else if(J2(t,r),e&4&&-1<lU.indexOf(t)){for(;o!==null;){var l=Wd(o);if(l!==null&&dI(l),l=e1(t,e,n,r),l===null&&q_(t,e,r,by,n),l===o)break;o=l}o!==null&&r.stopPropagation()}else q_(t,e,r,null,n)}}var by=null;function e1(t,e,n,r){if(by=null,t=wx(r),t=ec(t),t!==null)if(e=bc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=aI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return by=t,null}function _I(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Q6()){case Ex:return 1;case cI:return 4;case vy:case eU:return 16;case hI:return 536870912;default:return 16}default:return 16}}var $l=null,Px=null,Gg=null;function xI(){if(Gg)return Gg;var t,e=Px,n=e.length,r,o="value"in $l?$l.value:$l.textContent,l=o.length;for(t=0;t<n&&e[t]===o[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===o[l-r];r++);return Gg=o.slice(t,1<r?1-r:void 0)}function Wg(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function _g(){return!0}function eT(){return!1}function No(t){function e(n,r,o,l,s){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=l,this.target=s,this.currentTarget=null;for(var g in t)t.hasOwnProperty(g)&&(n=t[g],this[g]=n?n(l):l[g]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?_g:eT,this.isPropagationStopped=eT,this}return vr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_g)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_g)},persist:function(){},isPersistent:_g}),e}var bf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ix=No(bf),Gd=vr({},bf,{view:0,detail:0}),pU=No(Gd),B_,N_,Mp,ev=vr({},Gd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Mp&&(Mp&&t.type==="mousemove"?(B_=t.screenX-Mp.screenX,N_=t.screenY-Mp.screenY):N_=B_=0,Mp=t),B_)},movementY:function(t){return"movementY"in t?t.movementY:N_}}),tT=No(ev),dU=vr({},ev,{dataTransfer:0}),mU=No(dU),gU=vr({},Gd,{relatedTarget:0}),F_=No(gU),yU=vr({},bf,{animationName:0,elapsedTime:0,pseudoElement:0}),vU=No(yU),_U=vr({},bf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),xU=No(_U),bU=vr({},bf,{data:0}),nT=No(bU),wU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},EU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},TU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function SU(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=TU[t])?!!e[t]:!1}function Cx(){return SU}var AU=vr({},Gd,{key:function(t){if(t.key){var e=wU[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Wg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?EU[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cx,charCode:function(t){return t.type==="keypress"?Wg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Wg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),PU=No(AU),IU=vr({},ev,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rT=No(IU),CU=vr({},Gd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cx}),MU=No(CU),kU=vr({},bf,{propertyName:0,elapsedTime:0,pseudoElement:0}),LU=No(kU),RU=vr({},ev,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),OU=No(RU),DU=[9,13,27,32],Mx=hl&&"CompositionEvent"in window,qp=null;hl&&"documentMode"in document&&(qp=document.documentMode);var zU=hl&&"TextEvent"in window&&!qp,bI=hl&&(!Mx||qp&&8<qp&&11>=qp),iT=String.fromCharCode(32),oT=!1;function wI(t,e){switch(t){case"keyup":return DU.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function EI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Rh=!1;function BU(t,e){switch(t){case"compositionend":return EI(e);case"keypress":return e.which!==32?null:(oT=!0,iT);case"textInput":return t=e.data,t===iT&&oT?null:t;default:return null}}function NU(t,e){if(Rh)return t==="compositionend"||!Mx&&wI(t,e)?(t=xI(),Gg=Px=$l=null,Rh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return bI&&e.locale!=="ko"?null:e.data;default:return null}}var FU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function aT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!FU[t.type]:e==="textarea"}function TI(t,e,n,r){tI(r),e=wy(e,"onChange"),0<e.length&&(n=new Ix("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Zp=null,gd=null;function UU(t){DI(t,0)}function tv(t){var e=zh(t);if(XP(e))return t}function jU(t,e){if(t==="change")return e}var SI=!1;if(hl){var U_;if(hl){var j_="oninput"in document;if(!j_){var sT=document.createElement("div");sT.setAttribute("oninput","return;"),j_=typeof sT.oninput=="function"}U_=j_}else U_=!1;SI=U_&&(!document.documentMode||9<document.documentMode)}function lT(){Zp&&(Zp.detachEvent("onpropertychange",AI),gd=Zp=null)}function AI(t){if(t.propertyName==="value"&&tv(gd)){var e=[];TI(e,gd,t,wx(t)),oI(UU,e)}}function VU(t,e,n){t==="focusin"?(lT(),Zp=e,gd=n,Zp.attachEvent("onpropertychange",AI)):t==="focusout"&&lT()}function GU(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return tv(gd)}function WU(t,e){if(t==="click")return tv(e)}function HU(t,e){if(t==="input"||t==="change")return tv(e)}function qU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ta=typeof Object.is=="function"?Object.is:qU;function yd(t,e){if(Ta(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!z0.call(e,o)||!Ta(t[o],e[o]))return!1}return!0}function uT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function cT(t,e){var n=uT(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=uT(n)}}function PI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?PI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function II(){for(var t=window,e=my();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=my(t.document)}return e}function kx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function ZU(t){var e=II(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&PI(n.ownerDocument.documentElement,n)){if(r!==null&&kx(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,l=Math.min(r.start,o);r=r.end===void 0?l:Math.min(r.end,o),!t.extend&&l>r&&(o=r,r=l,l=o),o=cT(n,l);var s=cT(n,r);o&&s&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),l>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var XU=hl&&"documentMode"in document&&11>=document.documentMode,Oh=null,t1=null,Xp=null,n1=!1;function hT(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;n1||Oh==null||Oh!==my(r)||(r=Oh,"selectionStart"in r&&kx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Xp&&yd(Xp,r)||(Xp=r,r=wy(t1,"onSelect"),0<r.length&&(e=new Ix("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Oh)))}function xg(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Dh={animationend:xg("Animation","AnimationEnd"),animationiteration:xg("Animation","AnimationIteration"),animationstart:xg("Animation","AnimationStart"),transitionend:xg("Transition","TransitionEnd")},V_={},CI={};hl&&(CI=document.createElement("div").style,"AnimationEvent"in window||(delete Dh.animationend.animation,delete Dh.animationiteration.animation,delete Dh.animationstart.animation),"TransitionEvent"in window||delete Dh.transitionend.transition);function nv(t){if(V_[t])return V_[t];if(!Dh[t])return t;var e=Dh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in CI)return V_[t]=e[n];return t}var MI=nv("animationend"),kI=nv("animationiteration"),LI=nv("animationstart"),RI=nv("transitionend"),OI=new Map,fT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cu(t,e){OI.set(t,e),xc(e,[t])}for(var G_=0;G_<fT.length;G_++){var W_=fT[G_],YU=W_.toLowerCase(),$U=W_[0].toUpperCase()+W_.slice(1);cu(YU,"on"+$U)}cu(MI,"onAnimationEnd");cu(kI,"onAnimationIteration");cu(LI,"onAnimationStart");cu("dblclick","onDoubleClick");cu("focusin","onFocus");cu("focusout","onBlur");cu(RI,"onTransitionEnd");hf("onMouseEnter",["mouseout","mouseover"]);hf("onMouseLeave",["mouseout","mouseover"]);hf("onPointerEnter",["pointerout","pointerover"]);hf("onPointerLeave",["pointerout","pointerover"]);xc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xc("onBeforeInput",["compositionend","keypress","textInput","paste"]);xc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Up="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KU=new Set("cancel close invalid load scroll toggle".split(" ").concat(Up));function pT(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Y6(r,e,void 0,t),t.currentTarget=null}function DI(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var l=void 0;if(e)for(var s=r.length-1;0<=s;s--){var g=r[s],y=g.instance,b=g.currentTarget;if(g=g.listener,y!==l&&o.isPropagationStopped())break e;pT(o,g,b),l=y}else for(s=0;s<r.length;s++){if(g=r[s],y=g.instance,b=g.currentTarget,g=g.listener,y!==l&&o.isPropagationStopped())break e;pT(o,g,b),l=y}}}if(yy)throw t=K0,yy=!1,K0=null,t}function er(t,e){var n=e[s1];n===void 0&&(n=e[s1]=new Set);var r=t+"__bubble";n.has(r)||(zI(e,t,2,!1),n.add(r))}function H_(t,e,n){var r=0;e&&(r|=4),zI(n,t,r,e)}var bg="_reactListening"+Math.random().toString(36).slice(2);function vd(t){if(!t[bg]){t[bg]=!0,GP.forEach(function(n){n!=="selectionchange"&&(KU.has(n)||H_(n,!1,t),H_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[bg]||(e[bg]=!0,H_("selectionchange",!1,e))}}function zI(t,e,n,r){switch(_I(e)){case 1:var o=hU;break;case 4:o=fU;break;default:o=Ax}n=o.bind(null,e,n,t),o=void 0,!$0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function q_(t,e,n,r,o){var l=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var g=r.stateNode.containerInfo;if(g===o||g.nodeType===8&&g.parentNode===o)break;if(s===4)for(s=r.return;s!==null;){var y=s.tag;if((y===3||y===4)&&(y=s.stateNode.containerInfo,y===o||y.nodeType===8&&y.parentNode===o))return;s=s.return}for(;g!==null;){if(s=ec(g),s===null)return;if(y=s.tag,y===5||y===6){r=l=s;continue e}g=g.parentNode}}r=r.return}oI(function(){var b=l,S=wx(n),I=[];e:{var C=OI.get(t);if(C!==void 0){var B=Ix,G=t;switch(t){case"keypress":if(Wg(n)===0)break e;case"keydown":case"keyup":B=PU;break;case"focusin":G="focus",B=F_;break;case"focusout":G="blur",B=F_;break;case"beforeblur":case"afterblur":B=F_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":B=tT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":B=mU;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":B=MU;break;case MI:case kI:case LI:B=vU;break;case RI:B=LU;break;case"scroll":B=pU;break;case"wheel":B=OU;break;case"copy":case"cut":case"paste":B=xU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":B=rT}var W=(e&4)!==0,he=!W&&t==="scroll",H=W?C!==null?C+"Capture":null:C;W=[];for(var U=b,K;U!==null;){K=U;var fe=K.stateNode;if(K.tag===5&&fe!==null&&(K=fe,H!==null&&(fe=fd(U,H),fe!=null&&W.push(_d(U,fe,K)))),he)break;U=U.return}0<W.length&&(C=new B(C,G,null,n,S),I.push({event:C,listeners:W}))}}if(!(e&7)){e:{if(C=t==="mouseover"||t==="pointerover",B=t==="mouseout"||t==="pointerout",C&&n!==X0&&(G=n.relatedTarget||n.fromElement)&&(ec(G)||G[fl]))break e;if((B||C)&&(C=S.window===S?S:(C=S.ownerDocument)?C.defaultView||C.parentWindow:window,B?(G=n.relatedTarget||n.toElement,B=b,G=G?ec(G):null,G!==null&&(he=bc(G),G!==he||G.tag!==5&&G.tag!==6)&&(G=null)):(B=null,G=b),B!==G)){if(W=tT,fe="onMouseLeave",H="onMouseEnter",U="mouse",(t==="pointerout"||t==="pointerover")&&(W=rT,fe="onPointerLeave",H="onPointerEnter",U="pointer"),he=B==null?C:zh(B),K=G==null?C:zh(G),C=new W(fe,U+"leave",B,n,S),C.target=he,C.relatedTarget=K,fe=null,ec(S)===b&&(W=new W(H,U+"enter",G,n,S),W.target=K,W.relatedTarget=he,fe=W),he=fe,B&&G)t:{for(W=B,H=G,U=0,K=W;K;K=Sh(K))U++;for(K=0,fe=H;fe;fe=Sh(fe))K++;for(;0<U-K;)W=Sh(W),U--;for(;0<K-U;)H=Sh(H),K--;for(;U--;){if(W===H||H!==null&&W===H.alternate)break t;W=Sh(W),H=Sh(H)}W=null}else W=null;B!==null&&dT(I,C,B,W,!1),G!==null&&he!==null&&dT(I,he,G,W,!0)}}e:{if(C=b?zh(b):window,B=C.nodeName&&C.nodeName.toLowerCase(),B==="select"||B==="input"&&C.type==="file")var ye=jU;else if(aT(C))if(SI)ye=HU;else{ye=GU;var xe=VU}else(B=C.nodeName)&&B.toLowerCase()==="input"&&(C.type==="checkbox"||C.type==="radio")&&(ye=WU);if(ye&&(ye=ye(t,b))){TI(I,ye,n,S);break e}xe&&xe(t,C,b),t==="focusout"&&(xe=C._wrapperState)&&xe.controlled&&C.type==="number"&&G0(C,"number",C.value)}switch(xe=b?zh(b):window,t){case"focusin":(aT(xe)||xe.contentEditable==="true")&&(Oh=xe,t1=b,Xp=null);break;case"focusout":Xp=t1=Oh=null;break;case"mousedown":n1=!0;break;case"contextmenu":case"mouseup":case"dragend":n1=!1,hT(I,n,S);break;case"selectionchange":if(XU)break;case"keydown":case"keyup":hT(I,n,S)}var Te;if(Mx)e:{switch(t){case"compositionstart":var De="onCompositionStart";break e;case"compositionend":De="onCompositionEnd";break e;case"compositionupdate":De="onCompositionUpdate";break e}De=void 0}else Rh?wI(t,n)&&(De="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(De="onCompositionStart");De&&(bI&&n.locale!=="ko"&&(Rh||De!=="onCompositionStart"?De==="onCompositionEnd"&&Rh&&(Te=xI()):($l=S,Px="value"in $l?$l.value:$l.textContent,Rh=!0)),xe=wy(b,De),0<xe.length&&(De=new nT(De,t,null,n,S),I.push({event:De,listeners:xe}),Te?De.data=Te:(Te=EI(n),Te!==null&&(De.data=Te)))),(Te=zU?BU(t,n):NU(t,n))&&(b=wy(b,"onBeforeInput"),0<b.length&&(S=new nT("onBeforeInput","beforeinput",null,n,S),I.push({event:S,listeners:b}),S.data=Te))}DI(I,e)})}function _d(t,e,n){return{instance:t,listener:e,currentTarget:n}}function wy(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,l=o.stateNode;o.tag===5&&l!==null&&(o=l,l=fd(t,n),l!=null&&r.unshift(_d(t,l,o)),l=fd(t,e),l!=null&&r.push(_d(t,l,o))),t=t.return}return r}function Sh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function dT(t,e,n,r,o){for(var l=e._reactName,s=[];n!==null&&n!==r;){var g=n,y=g.alternate,b=g.stateNode;if(y!==null&&y===r)break;g.tag===5&&b!==null&&(g=b,o?(y=fd(n,l),y!=null&&s.unshift(_d(n,y,g))):o||(y=fd(n,l),y!=null&&s.push(_d(n,y,g)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var JU=/\r\n?/g,QU=/\u0000|\uFFFD/g;function mT(t){return(typeof t=="string"?t:""+t).replace(JU,`
`).replace(QU,"")}function wg(t,e,n){if(e=mT(e),mT(t)!==e&&n)throw Error(Ke(425))}function Ey(){}var r1=null,i1=null;function o1(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var a1=typeof setTimeout=="function"?setTimeout:void 0,ej=typeof clearTimeout=="function"?clearTimeout:void 0,gT=typeof Promise=="function"?Promise:void 0,tj=typeof queueMicrotask=="function"?queueMicrotask:typeof gT<"u"?function(t){return gT.resolve(null).then(t).catch(nj)}:a1;function nj(t){setTimeout(function(){throw t})}function Z_(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),md(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);md(e)}function nu(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function yT(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var wf=Math.random().toString(36).slice(2),us="__reactFiber$"+wf,xd="__reactProps$"+wf,fl="__reactContainer$"+wf,s1="__reactEvents$"+wf,rj="__reactListeners$"+wf,ij="__reactHandles$"+wf;function ec(t){var e=t[us];if(e)return e;for(var n=t.parentNode;n;){if(e=n[fl]||n[us]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=yT(t);t!==null;){if(n=t[us])return n;t=yT(t)}return e}t=n,n=t.parentNode}return null}function Wd(t){return t=t[us]||t[fl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function zh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ke(33))}function rv(t){return t[xd]||null}var l1=[],Bh=-1;function hu(t){return{current:t}}function tr(t){0>Bh||(t.current=l1[Bh],l1[Bh]=null,Bh--)}function qn(t,e){Bh++,l1[Bh]=t.current,t.current=e}var lu={},Ni=hu(lu),fo=hu(!1),hc=lu;function ff(t,e){var n=t.type.contextTypes;if(!n)return lu;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},l;for(l in n)o[l]=e[l];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function po(t){return t=t.childContextTypes,t!=null}function Ty(){tr(fo),tr(Ni)}function vT(t,e,n){if(Ni.current!==lu)throw Error(Ke(168));qn(Ni,e),qn(fo,n)}function BI(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(Ke(108,V6(t)||"Unknown",o));return vr({},n,r)}function Sy(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||lu,hc=Ni.current,qn(Ni,t),qn(fo,fo.current),!0}function _T(t,e,n){var r=t.stateNode;if(!r)throw Error(Ke(169));n?(t=BI(t,e,hc),r.__reactInternalMemoizedMergedChildContext=t,tr(fo),tr(Ni),qn(Ni,t)):tr(fo),qn(fo,n)}var tl=null,iv=!1,X_=!1;function NI(t){tl===null?tl=[t]:tl.push(t)}function oj(t){iv=!0,NI(t)}function fu(){if(!X_&&tl!==null){X_=!0;var t=0,e=On;try{var n=tl;for(On=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}tl=null,iv=!1}catch(o){throw tl!==null&&(tl=tl.slice(t+1)),uI(Ex,fu),o}finally{On=e,X_=!1}}return null}var Nh=[],Fh=0,Ay=null,Py=0,Xo=[],Yo=0,fc=null,il=1,ol="";function Ku(t,e){Nh[Fh++]=Py,Nh[Fh++]=Ay,Ay=t,Py=e}function FI(t,e,n){Xo[Yo++]=il,Xo[Yo++]=ol,Xo[Yo++]=fc,fc=t;var r=il;t=ol;var o=32-wa(r)-1;r&=~(1<<o),n+=1;var l=32-wa(e)+o;if(30<l){var s=o-o%5;l=(r&(1<<s)-1).toString(32),r>>=s,o-=s,il=1<<32-wa(e)+o|n<<o|r,ol=l+t}else il=1<<l|n<<o|r,ol=t}function Lx(t){t.return!==null&&(Ku(t,1),FI(t,1,0))}function Rx(t){for(;t===Ay;)Ay=Nh[--Fh],Nh[Fh]=null,Py=Nh[--Fh],Nh[Fh]=null;for(;t===fc;)fc=Xo[--Yo],Xo[Yo]=null,ol=Xo[--Yo],Xo[Yo]=null,il=Xo[--Yo],Xo[Yo]=null}var Oo=null,Lo=null,cr=!1,_a=null;function UI(t,e){var n=$o(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function xT(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Oo=t,Lo=nu(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Oo=t,Lo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=fc!==null?{id:il,overflow:ol}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=$o(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Oo=t,Lo=null,!0):!1;default:return!1}}function u1(t){return(t.mode&1)!==0&&(t.flags&128)===0}function c1(t){if(cr){var e=Lo;if(e){var n=e;if(!xT(t,e)){if(u1(t))throw Error(Ke(418));e=nu(n.nextSibling);var r=Oo;e&&xT(t,e)?UI(r,n):(t.flags=t.flags&-4097|2,cr=!1,Oo=t)}}else{if(u1(t))throw Error(Ke(418));t.flags=t.flags&-4097|2,cr=!1,Oo=t}}}function bT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Oo=t}function Eg(t){if(t!==Oo)return!1;if(!cr)return bT(t),cr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!o1(t.type,t.memoizedProps)),e&&(e=Lo)){if(u1(t))throw jI(),Error(Ke(418));for(;e;)UI(t,e),e=nu(e.nextSibling)}if(bT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ke(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Lo=nu(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Lo=null}}else Lo=Oo?nu(t.stateNode.nextSibling):null;return!0}function jI(){for(var t=Lo;t;)t=nu(t.nextSibling)}function pf(){Lo=Oo=null,cr=!1}function Ox(t){_a===null?_a=[t]:_a.push(t)}var aj=yl.ReactCurrentBatchConfig;function ma(t,e){if(t&&t.defaultProps){e=vr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Iy=hu(null),Cy=null,Uh=null,Dx=null;function zx(){Dx=Uh=Cy=null}function Bx(t){var e=Iy.current;tr(Iy),t._currentValue=e}function h1(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Yh(t,e){Cy=t,Dx=Uh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ho=!0),t.firstContext=null)}function Qo(t){var e=t._currentValue;if(Dx!==t)if(t={context:t,memoizedValue:e,next:null},Uh===null){if(Cy===null)throw Error(Ke(308));Uh=t,Cy.dependencies={lanes:0,firstContext:t}}else Uh=Uh.next=t;return e}var tc=null;function Nx(t){tc===null?tc=[t]:tc.push(t)}function VI(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,Nx(e)):(n.next=o.next,o.next=n),e.interleaved=n,pl(t,r)}function pl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Hl=!1;function Fx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function GI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function sl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ru(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,xn&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,pl(t,n)}return o=r.interleaved,o===null?(e.next=e,Nx(r)):(e.next=o.next,o.next=e),r.interleaved=e,pl(t,n)}function Hg(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Tx(t,n)}}function wT(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?o=l=s:l=l.next=s,n=n.next}while(n!==null);l===null?o=l=e:l=l.next=e}else o=l=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:l,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function My(t,e,n,r){var o=t.updateQueue;Hl=!1;var l=o.firstBaseUpdate,s=o.lastBaseUpdate,g=o.shared.pending;if(g!==null){o.shared.pending=null;var y=g,b=y.next;y.next=null,s===null?l=b:s.next=b,s=y;var S=t.alternate;S!==null&&(S=S.updateQueue,g=S.lastBaseUpdate,g!==s&&(g===null?S.firstBaseUpdate=b:g.next=b,S.lastBaseUpdate=y))}if(l!==null){var I=o.baseState;s=0,S=b=y=null,g=l;do{var C=g.lane,B=g.eventTime;if((r&C)===C){S!==null&&(S=S.next={eventTime:B,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var G=t,W=g;switch(C=e,B=n,W.tag){case 1:if(G=W.payload,typeof G=="function"){I=G.call(B,I,C);break e}I=G;break e;case 3:G.flags=G.flags&-65537|128;case 0:if(G=W.payload,C=typeof G=="function"?G.call(B,I,C):G,C==null)break e;I=vr({},I,C);break e;case 2:Hl=!0}}g.callback!==null&&g.lane!==0&&(t.flags|=64,C=o.effects,C===null?o.effects=[g]:C.push(g))}else B={eventTime:B,lane:C,tag:g.tag,payload:g.payload,callback:g.callback,next:null},S===null?(b=S=B,y=I):S=S.next=B,s|=C;if(g=g.next,g===null){if(g=o.shared.pending,g===null)break;C=g,g=C.next,C.next=null,o.lastBaseUpdate=C,o.shared.pending=null}}while(1);if(S===null&&(y=I),o.baseState=y,o.firstBaseUpdate=b,o.lastBaseUpdate=S,e=o.shared.interleaved,e!==null){o=e;do s|=o.lane,o=o.next;while(o!==e)}else l===null&&(o.shared.lanes=0);dc|=s,t.lanes=s,t.memoizedState=I}}function ET(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(Ke(191,o));o.call(r)}}}var WI=new VP.Component().refs;function f1(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:vr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ov={isMounted:function(t){return(t=t._reactInternals)?bc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=$i(),o=ou(t),l=sl(r,o);l.payload=e,n!=null&&(l.callback=n),e=ru(t,l,o),e!==null&&(Ea(e,t,o,r),Hg(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=$i(),o=ou(t),l=sl(r,o);l.tag=1,l.payload=e,n!=null&&(l.callback=n),e=ru(t,l,o),e!==null&&(Ea(e,t,o,r),Hg(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=$i(),r=ou(t),o=sl(n,r);o.tag=2,e!=null&&(o.callback=e),e=ru(t,o,r),e!==null&&(Ea(e,t,r,n),Hg(e,t,r))}};function TT(t,e,n,r,o,l,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,l,s):e.prototype&&e.prototype.isPureReactComponent?!yd(n,r)||!yd(o,l):!0}function HI(t,e,n){var r=!1,o=lu,l=e.contextType;return typeof l=="object"&&l!==null?l=Qo(l):(o=po(e)?hc:Ni.current,r=e.contextTypes,l=(r=r!=null)?ff(t,o):lu),e=new e(n,l),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ov,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=l),e}function ST(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ov.enqueueReplaceState(e,e.state,null)}function p1(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs=WI,Fx(t);var l=e.contextType;typeof l=="object"&&l!==null?o.context=Qo(l):(l=po(e)?hc:Ni.current,o.context=ff(t,l)),o.state=t.memoizedState,l=e.getDerivedStateFromProps,typeof l=="function"&&(f1(t,e,l,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&ov.enqueueReplaceState(o,o.state,null),My(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function kp(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ke(309));var r=n.stateNode}if(!r)throw Error(Ke(147,t));var o=r,l=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===l?e.ref:(e=function(s){var g=o.refs;g===WI&&(g=o.refs={}),s===null?delete g[l]:g[l]=s},e._stringRef=l,e)}if(typeof t!="string")throw Error(Ke(284));if(!n._owner)throw Error(Ke(290,t))}return t}function Tg(t,e){throw t=Object.prototype.toString.call(e),Error(Ke(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function AT(t){var e=t._init;return e(t._payload)}function qI(t){function e(H,U){if(t){var K=H.deletions;K===null?(H.deletions=[U],H.flags|=16):K.push(U)}}function n(H,U){if(!t)return null;for(;U!==null;)e(H,U),U=U.sibling;return null}function r(H,U){for(H=new Map;U!==null;)U.key!==null?H.set(U.key,U):H.set(U.index,U),U=U.sibling;return H}function o(H,U){return H=au(H,U),H.index=0,H.sibling=null,H}function l(H,U,K){return H.index=K,t?(K=H.alternate,K!==null?(K=K.index,K<U?(H.flags|=2,U):K):(H.flags|=2,U)):(H.flags|=1048576,U)}function s(H){return t&&H.alternate===null&&(H.flags|=2),H}function g(H,U,K,fe){return U===null||U.tag!==6?(U=t0(K,H.mode,fe),U.return=H,U):(U=o(U,K),U.return=H,U)}function y(H,U,K,fe){var ye=K.type;return ye===Lh?S(H,U,K.props.children,fe,K.key):U!==null&&(U.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===Wl&&AT(ye)===U.type)?(fe=o(U,K.props),fe.ref=kp(H,U,K),fe.return=H,fe):(fe=Kg(K.type,K.key,K.props,null,H.mode,fe),fe.ref=kp(H,U,K),fe.return=H,fe)}function b(H,U,K,fe){return U===null||U.tag!==4||U.stateNode.containerInfo!==K.containerInfo||U.stateNode.implementation!==K.implementation?(U=n0(K,H.mode,fe),U.return=H,U):(U=o(U,K.children||[]),U.return=H,U)}function S(H,U,K,fe,ye){return U===null||U.tag!==7?(U=sc(K,H.mode,fe,ye),U.return=H,U):(U=o(U,K),U.return=H,U)}function I(H,U,K){if(typeof U=="string"&&U!==""||typeof U=="number")return U=t0(""+U,H.mode,K),U.return=H,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case pg:return K=Kg(U.type,U.key,U.props,null,H.mode,K),K.ref=kp(H,null,U),K.return=H,K;case kh:return U=n0(U,H.mode,K),U.return=H,U;case Wl:var fe=U._init;return I(H,fe(U._payload),K)}if(Np(U)||Ap(U))return U=sc(U,H.mode,K,null),U.return=H,U;Tg(H,U)}return null}function C(H,U,K,fe){var ye=U!==null?U.key:null;if(typeof K=="string"&&K!==""||typeof K=="number")return ye!==null?null:g(H,U,""+K,fe);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case pg:return K.key===ye?y(H,U,K,fe):null;case kh:return K.key===ye?b(H,U,K,fe):null;case Wl:return ye=K._init,C(H,U,ye(K._payload),fe)}if(Np(K)||Ap(K))return ye!==null?null:S(H,U,K,fe,null);Tg(H,K)}return null}function B(H,U,K,fe,ye){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return H=H.get(K)||null,g(U,H,""+fe,ye);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case pg:return H=H.get(fe.key===null?K:fe.key)||null,y(U,H,fe,ye);case kh:return H=H.get(fe.key===null?K:fe.key)||null,b(U,H,fe,ye);case Wl:var xe=fe._init;return B(H,U,K,xe(fe._payload),ye)}if(Np(fe)||Ap(fe))return H=H.get(K)||null,S(U,H,fe,ye,null);Tg(U,fe)}return null}function G(H,U,K,fe){for(var ye=null,xe=null,Te=U,De=U=0,Fe=null;Te!==null&&De<K.length;De++){Te.index>De?(Fe=Te,Te=null):Fe=Te.sibling;var Ve=C(H,Te,K[De],fe);if(Ve===null){Te===null&&(Te=Fe);break}t&&Te&&Ve.alternate===null&&e(H,Te),U=l(Ve,U,De),xe===null?ye=Ve:xe.sibling=Ve,xe=Ve,Te=Fe}if(De===K.length)return n(H,Te),cr&&Ku(H,De),ye;if(Te===null){for(;De<K.length;De++)Te=I(H,K[De],fe),Te!==null&&(U=l(Te,U,De),xe===null?ye=Te:xe.sibling=Te,xe=Te);return cr&&Ku(H,De),ye}for(Te=r(H,Te);De<K.length;De++)Fe=B(Te,H,De,K[De],fe),Fe!==null&&(t&&Fe.alternate!==null&&Te.delete(Fe.key===null?De:Fe.key),U=l(Fe,U,De),xe===null?ye=Fe:xe.sibling=Fe,xe=Fe);return t&&Te.forEach(function(tt){return e(H,tt)}),cr&&Ku(H,De),ye}function W(H,U,K,fe){var ye=Ap(K);if(typeof ye!="function")throw Error(Ke(150));if(K=ye.call(K),K==null)throw Error(Ke(151));for(var xe=ye=null,Te=U,De=U=0,Fe=null,Ve=K.next();Te!==null&&!Ve.done;De++,Ve=K.next()){Te.index>De?(Fe=Te,Te=null):Fe=Te.sibling;var tt=C(H,Te,Ve.value,fe);if(tt===null){Te===null&&(Te=Fe);break}t&&Te&&tt.alternate===null&&e(H,Te),U=l(tt,U,De),xe===null?ye=tt:xe.sibling=tt,xe=tt,Te=Fe}if(Ve.done)return n(H,Te),cr&&Ku(H,De),ye;if(Te===null){for(;!Ve.done;De++,Ve=K.next())Ve=I(H,Ve.value,fe),Ve!==null&&(U=l(Ve,U,De),xe===null?ye=Ve:xe.sibling=Ve,xe=Ve);return cr&&Ku(H,De),ye}for(Te=r(H,Te);!Ve.done;De++,Ve=K.next())Ve=B(Te,H,De,Ve.value,fe),Ve!==null&&(t&&Ve.alternate!==null&&Te.delete(Ve.key===null?De:Ve.key),U=l(Ve,U,De),xe===null?ye=Ve:xe.sibling=Ve,xe=Ve);return t&&Te.forEach(function(Bt){return e(H,Bt)}),cr&&Ku(H,De),ye}function he(H,U,K,fe){if(typeof K=="object"&&K!==null&&K.type===Lh&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case pg:e:{for(var ye=K.key,xe=U;xe!==null;){if(xe.key===ye){if(ye=K.type,ye===Lh){if(xe.tag===7){n(H,xe.sibling),U=o(xe,K.props.children),U.return=H,H=U;break e}}else if(xe.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===Wl&&AT(ye)===xe.type){n(H,xe.sibling),U=o(xe,K.props),U.ref=kp(H,xe,K),U.return=H,H=U;break e}n(H,xe);break}else e(H,xe);xe=xe.sibling}K.type===Lh?(U=sc(K.props.children,H.mode,fe,K.key),U.return=H,H=U):(fe=Kg(K.type,K.key,K.props,null,H.mode,fe),fe.ref=kp(H,U,K),fe.return=H,H=fe)}return s(H);case kh:e:{for(xe=K.key;U!==null;){if(U.key===xe)if(U.tag===4&&U.stateNode.containerInfo===K.containerInfo&&U.stateNode.implementation===K.implementation){n(H,U.sibling),U=o(U,K.children||[]),U.return=H,H=U;break e}else{n(H,U);break}else e(H,U);U=U.sibling}U=n0(K,H.mode,fe),U.return=H,H=U}return s(H);case Wl:return xe=K._init,he(H,U,xe(K._payload),fe)}if(Np(K))return G(H,U,K,fe);if(Ap(K))return W(H,U,K,fe);Tg(H,K)}return typeof K=="string"&&K!==""||typeof K=="number"?(K=""+K,U!==null&&U.tag===6?(n(H,U.sibling),U=o(U,K),U.return=H,H=U):(n(H,U),U=t0(K,H.mode,fe),U.return=H,H=U),s(H)):n(H,U)}return he}var df=qI(!0),ZI=qI(!1),Hd={},gs=hu(Hd),bd=hu(Hd),wd=hu(Hd);function nc(t){if(t===Hd)throw Error(Ke(174));return t}function Ux(t,e){switch(qn(wd,e),qn(bd,t),qn(gs,Hd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:H0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=H0(e,t)}tr(gs),qn(gs,e)}function mf(){tr(gs),tr(bd),tr(wd)}function XI(t){nc(wd.current);var e=nc(gs.current),n=H0(e,t.type);e!==n&&(qn(bd,t),qn(gs,n))}function jx(t){bd.current===t&&(tr(gs),tr(bd))}var gr=hu(0);function ky(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Y_=[];function Vx(){for(var t=0;t<Y_.length;t++)Y_[t]._workInProgressVersionPrimary=null;Y_.length=0}var qg=yl.ReactCurrentDispatcher,$_=yl.ReactCurrentBatchConfig,pc=0,yr=null,Jr=null,si=null,Ly=!1,Yp=!1,Ed=0,sj=0;function Di(){throw Error(Ke(321))}function Gx(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ta(t[n],e[n]))return!1;return!0}function Wx(t,e,n,r,o,l){if(pc=l,yr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,qg.current=t===null||t.memoizedState===null?hj:fj,t=n(r,o),Yp){l=0;do{if(Yp=!1,Ed=0,25<=l)throw Error(Ke(301));l+=1,si=Jr=null,e.updateQueue=null,qg.current=pj,t=n(r,o)}while(Yp)}if(qg.current=Ry,e=Jr!==null&&Jr.next!==null,pc=0,si=Jr=yr=null,Ly=!1,e)throw Error(Ke(300));return t}function Hx(){var t=Ed!==0;return Ed=0,t}function ss(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return si===null?yr.memoizedState=si=t:si=si.next=t,si}function ea(){if(Jr===null){var t=yr.alternate;t=t!==null?t.memoizedState:null}else t=Jr.next;var e=si===null?yr.memoizedState:si.next;if(e!==null)si=e,Jr=t;else{if(t===null)throw Error(Ke(310));Jr=t,t={memoizedState:Jr.memoizedState,baseState:Jr.baseState,baseQueue:Jr.baseQueue,queue:Jr.queue,next:null},si===null?yr.memoizedState=si=t:si=si.next=t}return si}function Td(t,e){return typeof e=="function"?e(t):e}function K_(t){var e=ea(),n=e.queue;if(n===null)throw Error(Ke(311));n.lastRenderedReducer=t;var r=Jr,o=r.baseQueue,l=n.pending;if(l!==null){if(o!==null){var s=o.next;o.next=l.next,l.next=s}r.baseQueue=o=l,n.pending=null}if(o!==null){l=o.next,r=r.baseState;var g=s=null,y=null,b=l;do{var S=b.lane;if((pc&S)===S)y!==null&&(y=y.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),r=b.hasEagerState?b.eagerState:t(r,b.action);else{var I={lane:S,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};y===null?(g=y=I,s=r):y=y.next=I,yr.lanes|=S,dc|=S}b=b.next}while(b!==null&&b!==l);y===null?s=r:y.next=g,Ta(r,e.memoizedState)||(ho=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=y,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do l=o.lane,yr.lanes|=l,dc|=l,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function J_(t){var e=ea(),n=e.queue;if(n===null)throw Error(Ke(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,l=e.memoizedState;if(o!==null){n.pending=null;var s=o=o.next;do l=t(l,s.action),s=s.next;while(s!==o);Ta(l,e.memoizedState)||(ho=!0),e.memoizedState=l,e.baseQueue===null&&(e.baseState=l),n.lastRenderedState=l}return[l,r]}function YI(){}function $I(t,e){var n=yr,r=ea(),o=e(),l=!Ta(r.memoizedState,o);if(l&&(r.memoizedState=o,ho=!0),r=r.queue,qx(QI.bind(null,n,r,t),[t]),r.getSnapshot!==e||l||si!==null&&si.memoizedState.tag&1){if(n.flags|=2048,Sd(9,JI.bind(null,n,r,o,e),void 0,null),li===null)throw Error(Ke(349));pc&30||KI(n,e,o)}return o}function KI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=yr.updateQueue,e===null?(e={lastEffect:null,stores:null},yr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function JI(t,e,n,r){e.value=n,e.getSnapshot=r,eC(e)&&tC(t)}function QI(t,e,n){return n(function(){eC(e)&&tC(t)})}function eC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ta(t,n)}catch{return!0}}function tC(t){var e=pl(t,1);e!==null&&Ea(e,t,1,-1)}function PT(t){var e=ss();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Td,lastRenderedState:t},e.queue=t,t=t.dispatch=cj.bind(null,yr,t),[e.memoizedState,t]}function Sd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=yr.updateQueue,e===null?(e={lastEffect:null,stores:null},yr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function nC(){return ea().memoizedState}function Zg(t,e,n,r){var o=ss();yr.flags|=t,o.memoizedState=Sd(1|e,n,void 0,r===void 0?null:r)}function av(t,e,n,r){var o=ea();r=r===void 0?null:r;var l=void 0;if(Jr!==null){var s=Jr.memoizedState;if(l=s.destroy,r!==null&&Gx(r,s.deps)){o.memoizedState=Sd(e,n,l,r);return}}yr.flags|=t,o.memoizedState=Sd(1|e,n,l,r)}function IT(t,e){return Zg(8390656,8,t,e)}function qx(t,e){return av(2048,8,t,e)}function rC(t,e){return av(4,2,t,e)}function iC(t,e){return av(4,4,t,e)}function oC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function aC(t,e,n){return n=n!=null?n.concat([t]):null,av(4,4,oC.bind(null,e,t),n)}function Zx(){}function sC(t,e){var n=ea();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Gx(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function lC(t,e){var n=ea();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Gx(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function uC(t,e,n){return pc&21?(Ta(n,e)||(n=fI(),yr.lanes|=n,dc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ho=!0),t.memoizedState=n)}function lj(t,e){var n=On;On=n!==0&&4>n?n:4,t(!0);var r=$_.transition;$_.transition={};try{t(!1),e()}finally{On=n,$_.transition=r}}function cC(){return ea().memoizedState}function uj(t,e,n){var r=ou(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},hC(t))fC(e,n);else if(n=VI(t,e,n,r),n!==null){var o=$i();Ea(n,t,r,o),pC(n,e,r)}}function cj(t,e,n){var r=ou(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(hC(t))fC(e,o);else{var l=t.alternate;if(t.lanes===0&&(l===null||l.lanes===0)&&(l=e.lastRenderedReducer,l!==null))try{var s=e.lastRenderedState,g=l(s,n);if(o.hasEagerState=!0,o.eagerState=g,Ta(g,s)){var y=e.interleaved;y===null?(o.next=o,Nx(e)):(o.next=y.next,y.next=o),e.interleaved=o;return}}catch{}finally{}n=VI(t,e,o,r),n!==null&&(o=$i(),Ea(n,t,r,o),pC(n,e,r))}}function hC(t){var e=t.alternate;return t===yr||e!==null&&e===yr}function fC(t,e){Yp=Ly=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function pC(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Tx(t,n)}}var Ry={readContext:Qo,useCallback:Di,useContext:Di,useEffect:Di,useImperativeHandle:Di,useInsertionEffect:Di,useLayoutEffect:Di,useMemo:Di,useReducer:Di,useRef:Di,useState:Di,useDebugValue:Di,useDeferredValue:Di,useTransition:Di,useMutableSource:Di,useSyncExternalStore:Di,useId:Di,unstable_isNewReconciler:!1},hj={readContext:Qo,useCallback:function(t,e){return ss().memoizedState=[t,e===void 0?null:e],t},useContext:Qo,useEffect:IT,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Zg(4194308,4,oC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Zg(4194308,4,t,e)},useInsertionEffect:function(t,e){return Zg(4,2,t,e)},useMemo:function(t,e){var n=ss();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ss();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=uj.bind(null,yr,t),[r.memoizedState,t]},useRef:function(t){var e=ss();return t={current:t},e.memoizedState=t},useState:PT,useDebugValue:Zx,useDeferredValue:function(t){return ss().memoizedState=t},useTransition:function(){var t=PT(!1),e=t[0];return t=lj.bind(null,t[1]),ss().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=yr,o=ss();if(cr){if(n===void 0)throw Error(Ke(407));n=n()}else{if(n=e(),li===null)throw Error(Ke(349));pc&30||KI(r,e,n)}o.memoizedState=n;var l={value:n,getSnapshot:e};return o.queue=l,IT(QI.bind(null,r,l,t),[t]),r.flags|=2048,Sd(9,JI.bind(null,r,l,n,e),void 0,null),n},useId:function(){var t=ss(),e=li.identifierPrefix;if(cr){var n=ol,r=il;n=(r&~(1<<32-wa(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ed++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=sj++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fj={readContext:Qo,useCallback:sC,useContext:Qo,useEffect:qx,useImperativeHandle:aC,useInsertionEffect:rC,useLayoutEffect:iC,useMemo:lC,useReducer:K_,useRef:nC,useState:function(){return K_(Td)},useDebugValue:Zx,useDeferredValue:function(t){var e=ea();return uC(e,Jr.memoizedState,t)},useTransition:function(){var t=K_(Td)[0],e=ea().memoizedState;return[t,e]},useMutableSource:YI,useSyncExternalStore:$I,useId:cC,unstable_isNewReconciler:!1},pj={readContext:Qo,useCallback:sC,useContext:Qo,useEffect:qx,useImperativeHandle:aC,useInsertionEffect:rC,useLayoutEffect:iC,useMemo:lC,useReducer:J_,useRef:nC,useState:function(){return J_(Td)},useDebugValue:Zx,useDeferredValue:function(t){var e=ea();return Jr===null?e.memoizedState=t:uC(e,Jr.memoizedState,t)},useTransition:function(){var t=J_(Td)[0],e=ea().memoizedState;return[t,e]},useMutableSource:YI,useSyncExternalStore:$I,useId:cC,unstable_isNewReconciler:!1};function gf(t,e){try{var n="",r=e;do n+=j6(r),r=r.return;while(r);var o=n}catch(l){o=`
Error generating stack: `+l.message+`
`+l.stack}return{value:t,source:e,stack:o,digest:null}}function Q_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function d1(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var dj=typeof WeakMap=="function"?WeakMap:Map;function dC(t,e,n){n=sl(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Dy||(Dy=!0,T1=r),d1(t,e)},n}function mC(t,e,n){n=sl(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){d1(t,e)}}var l=t.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){d1(t,e),typeof r!="function"&&(iu===null?iu=new Set([this]):iu.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function CT(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new dj;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=Ij.bind(null,t,e,n),e.then(t,t))}function MT(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function kT(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=sl(-1,1),e.tag=2,ru(n,e,1))),n.lanes|=1),t)}var mj=yl.ReactCurrentOwner,ho=!1;function qi(t,e,n,r){e.child=t===null?ZI(e,null,n,r):df(e,t.child,n,r)}function LT(t,e,n,r,o){n=n.render;var l=e.ref;return Yh(e,o),r=Wx(t,e,n,r,l,o),n=Hx(),t!==null&&!ho?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,dl(t,e,o)):(cr&&n&&Lx(e),e.flags|=1,qi(t,e,r,o),e.child)}function RT(t,e,n,r,o){if(t===null){var l=n.type;return typeof l=="function"&&!tb(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=l,gC(t,e,l,r,o)):(t=Kg(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(l=t.child,!(t.lanes&o)){var s=l.memoizedProps;if(n=n.compare,n=n!==null?n:yd,n(s,r)&&t.ref===e.ref)return dl(t,e,o)}return e.flags|=1,t=au(l,r),t.ref=e.ref,t.return=e,e.child=t}function gC(t,e,n,r,o){if(t!==null){var l=t.memoizedProps;if(yd(l,r)&&t.ref===e.ref)if(ho=!1,e.pendingProps=r=l,(t.lanes&o)!==0)t.flags&131072&&(ho=!0);else return e.lanes=t.lanes,dl(t,e,o)}return m1(t,e,n,r,o)}function yC(t,e,n){var r=e.pendingProps,o=r.children,l=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qn(Vh,Io),Io|=n;else{if(!(n&1073741824))return t=l!==null?l.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,qn(Vh,Io),Io|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,qn(Vh,Io),Io|=r}else l!==null?(r=l.baseLanes|n,e.memoizedState=null):r=n,qn(Vh,Io),Io|=r;return qi(t,e,o,n),e.child}function vC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function m1(t,e,n,r,o){var l=po(n)?hc:Ni.current;return l=ff(e,l),Yh(e,o),n=Wx(t,e,n,r,l,o),r=Hx(),t!==null&&!ho?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,dl(t,e,o)):(cr&&r&&Lx(e),e.flags|=1,qi(t,e,n,o),e.child)}function OT(t,e,n,r,o){if(po(n)){var l=!0;Sy(e)}else l=!1;if(Yh(e,o),e.stateNode===null)Xg(t,e),HI(e,n,r),p1(e,n,r,o),r=!0;else if(t===null){var s=e.stateNode,g=e.memoizedProps;s.props=g;var y=s.context,b=n.contextType;typeof b=="object"&&b!==null?b=Qo(b):(b=po(n)?hc:Ni.current,b=ff(e,b));var S=n.getDerivedStateFromProps,I=typeof S=="function"||typeof s.getSnapshotBeforeUpdate=="function";I||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(g!==r||y!==b)&&ST(e,s,r,b),Hl=!1;var C=e.memoizedState;s.state=C,My(e,r,s,o),y=e.memoizedState,g!==r||C!==y||fo.current||Hl?(typeof S=="function"&&(f1(e,n,S,r),y=e.memoizedState),(g=Hl||TT(e,n,g,r,C,y,b))?(I||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=y),s.props=r,s.state=y,s.context=b,r=g):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,GI(t,e),g=e.memoizedProps,b=e.type===e.elementType?g:ma(e.type,g),s.props=b,I=e.pendingProps,C=s.context,y=n.contextType,typeof y=="object"&&y!==null?y=Qo(y):(y=po(n)?hc:Ni.current,y=ff(e,y));var B=n.getDerivedStateFromProps;(S=typeof B=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(g!==I||C!==y)&&ST(e,s,r,y),Hl=!1,C=e.memoizedState,s.state=C,My(e,r,s,o);var G=e.memoizedState;g!==I||C!==G||fo.current||Hl?(typeof B=="function"&&(f1(e,n,B,r),G=e.memoizedState),(b=Hl||TT(e,n,b,r,C,G,y)||!1)?(S||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,G,y),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,G,y)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||g===t.memoizedProps&&C===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||g===t.memoizedProps&&C===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=G),s.props=r,s.state=G,s.context=y,r=b):(typeof s.componentDidUpdate!="function"||g===t.memoizedProps&&C===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||g===t.memoizedProps&&C===t.memoizedState||(e.flags|=1024),r=!1)}return g1(t,e,n,r,l,o)}function g1(t,e,n,r,o,l){vC(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return o&&_T(e,n,!1),dl(t,e,l);r=e.stateNode,mj.current=e;var g=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=df(e,t.child,null,l),e.child=df(e,null,g,l)):qi(t,e,g,l),e.memoizedState=r.state,o&&_T(e,n,!0),e.child}function _C(t){var e=t.stateNode;e.pendingContext?vT(t,e.pendingContext,e.pendingContext!==e.context):e.context&&vT(t,e.context,!1),Ux(t,e.containerInfo)}function DT(t,e,n,r,o){return pf(),Ox(o),e.flags|=256,qi(t,e,n,r),e.child}var y1={dehydrated:null,treeContext:null,retryLane:0};function v1(t){return{baseLanes:t,cachePool:null,transitions:null}}function xC(t,e,n){var r=e.pendingProps,o=gr.current,l=!1,s=(e.flags&128)!==0,g;if((g=s)||(g=t!==null&&t.memoizedState===null?!1:(o&2)!==0),g?(l=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),qn(gr,o&1),t===null)return c1(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,l?(r=e.mode,l=e.child,s={mode:"hidden",children:s},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=s):l=uv(s,r,0,null),t=sc(t,r,n,null),l.return=e,t.return=e,l.sibling=t,e.child=l,e.child.memoizedState=v1(n),e.memoizedState=y1,t):Xx(e,s));if(o=t.memoizedState,o!==null&&(g=o.dehydrated,g!==null))return gj(t,e,s,r,g,o,n);if(l){l=r.fallback,s=e.mode,o=t.child,g=o.sibling;var y={mode:"hidden",children:r.children};return!(s&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=y,e.deletions=null):(r=au(o,y),r.subtreeFlags=o.subtreeFlags&14680064),g!==null?l=au(g,l):(l=sc(l,s,n,null),l.flags|=2),l.return=e,r.return=e,r.sibling=l,e.child=r,r=l,l=e.child,s=t.child.memoizedState,s=s===null?v1(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},l.memoizedState=s,l.childLanes=t.childLanes&~n,e.memoizedState=y1,r}return l=t.child,t=l.sibling,r=au(l,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Xx(t,e){return e=uv({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Sg(t,e,n,r){return r!==null&&Ox(r),df(e,t.child,null,n),t=Xx(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function gj(t,e,n,r,o,l,s){if(n)return e.flags&256?(e.flags&=-257,r=Q_(Error(Ke(422))),Sg(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(l=r.fallback,o=e.mode,r=uv({mode:"visible",children:r.children},o,0,null),l=sc(l,o,s,null),l.flags|=2,r.return=e,l.return=e,r.sibling=l,e.child=r,e.mode&1&&df(e,t.child,null,s),e.child.memoizedState=v1(s),e.memoizedState=y1,l);if(!(e.mode&1))return Sg(t,e,s,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var g=r.dgst;return r=g,l=Error(Ke(419)),r=Q_(l,r,void 0),Sg(t,e,s,r)}if(g=(s&t.childLanes)!==0,ho||g){if(r=li,r!==null){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|s)?0:o,o!==0&&o!==l.retryLane&&(l.retryLane=o,pl(t,o),Ea(r,t,o,-1))}return eb(),r=Q_(Error(Ke(421))),Sg(t,e,s,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=Cj.bind(null,t),o._reactRetry=e,null):(t=l.treeContext,Lo=nu(o.nextSibling),Oo=e,cr=!0,_a=null,t!==null&&(Xo[Yo++]=il,Xo[Yo++]=ol,Xo[Yo++]=fc,il=t.id,ol=t.overflow,fc=e),e=Xx(e,r.children),e.flags|=4096,e)}function zT(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),h1(t.return,e,n)}function e0(t,e,n,r,o){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(l.isBackwards=e,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=o)}function bC(t,e,n){var r=e.pendingProps,o=r.revealOrder,l=r.tail;if(qi(t,e,r.children,n),r=gr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&zT(t,n,e);else if(t.tag===19)zT(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(qn(gr,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&ky(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),e0(e,!1,o,n,l);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&ky(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}e0(e,!0,n,null,l);break;case"together":e0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Xg(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function dl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),dc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ke(153));if(e.child!==null){for(t=e.child,n=au(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=au(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function yj(t,e,n){switch(e.tag){case 3:_C(e),pf();break;case 5:XI(e);break;case 1:po(e.type)&&Sy(e);break;case 4:Ux(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;qn(Iy,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(qn(gr,gr.current&1),e.flags|=128,null):n&e.child.childLanes?xC(t,e,n):(qn(gr,gr.current&1),t=dl(t,e,n),t!==null?t.sibling:null);qn(gr,gr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return bC(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),qn(gr,gr.current),r)break;return null;case 22:case 23:return e.lanes=0,yC(t,e,n)}return dl(t,e,n)}var wC,_1,EC,TC;wC=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};_1=function(){};EC=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,nc(gs.current);var l=null;switch(n){case"input":o=j0(t,o),r=j0(t,r),l=[];break;case"select":o=vr({},o,{value:void 0}),r=vr({},r,{value:void 0}),l=[];break;case"textarea":o=W0(t,o),r=W0(t,r),l=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ey)}q0(n,r);var s;n=null;for(b in o)if(!r.hasOwnProperty(b)&&o.hasOwnProperty(b)&&o[b]!=null)if(b==="style"){var g=o[b];for(s in g)g.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(cd.hasOwnProperty(b)?l||(l=[]):(l=l||[]).push(b,null));for(b in r){var y=r[b];if(g=o!=null?o[b]:void 0,r.hasOwnProperty(b)&&y!==g&&(y!=null||g!=null))if(b==="style")if(g){for(s in g)!g.hasOwnProperty(s)||y&&y.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in y)y.hasOwnProperty(s)&&g[s]!==y[s]&&(n||(n={}),n[s]=y[s])}else n||(l||(l=[]),l.push(b,n)),n=y;else b==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,g=g?g.__html:void 0,y!=null&&g!==y&&(l=l||[]).push(b,y)):b==="children"?typeof y!="string"&&typeof y!="number"||(l=l||[]).push(b,""+y):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(cd.hasOwnProperty(b)?(y!=null&&b==="onScroll"&&er("scroll",t),l||g===y||(l=[])):(l=l||[]).push(b,y))}n&&(l=l||[]).push("style",n);var b=l;(e.updateQueue=b)&&(e.flags|=4)}};TC=function(t,e,n,r){n!==r&&(e.flags|=4)};function Lp(t,e){if(!cr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function zi(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function vj(t,e,n){var r=e.pendingProps;switch(Rx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zi(e),null;case 1:return po(e.type)&&Ty(),zi(e),null;case 3:return r=e.stateNode,mf(),tr(fo),tr(Ni),Vx(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Eg(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,_a!==null&&(P1(_a),_a=null))),_1(t,e),zi(e),null;case 5:jx(e);var o=nc(wd.current);if(n=e.type,t!==null&&e.stateNode!=null)EC(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Ke(166));return zi(e),null}if(t=nc(gs.current),Eg(e)){r=e.stateNode,n=e.type;var l=e.memoizedProps;switch(r[us]=e,r[xd]=l,t=(e.mode&1)!==0,n){case"dialog":er("cancel",r),er("close",r);break;case"iframe":case"object":case"embed":er("load",r);break;case"video":case"audio":for(o=0;o<Up.length;o++)er(Up[o],r);break;case"source":er("error",r);break;case"img":case"image":case"link":er("error",r),er("load",r);break;case"details":er("toggle",r);break;case"input":H2(r,l),er("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},er("invalid",r);break;case"textarea":Z2(r,l),er("invalid",r)}q0(n,l),o=null;for(var s in l)if(l.hasOwnProperty(s)){var g=l[s];s==="children"?typeof g=="string"?r.textContent!==g&&(l.suppressHydrationWarning!==!0&&wg(r.textContent,g,t),o=["children",g]):typeof g=="number"&&r.textContent!==""+g&&(l.suppressHydrationWarning!==!0&&wg(r.textContent,g,t),o=["children",""+g]):cd.hasOwnProperty(s)&&g!=null&&s==="onScroll"&&er("scroll",r)}switch(n){case"input":dg(r),q2(r,l,!0);break;case"textarea":dg(r),X2(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=Ey)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=KP(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[us]=e,t[xd]=r,wC(t,e,!1,!1),e.stateNode=t;e:{switch(s=Z0(n,r),n){case"dialog":er("cancel",t),er("close",t),o=r;break;case"iframe":case"object":case"embed":er("load",t),o=r;break;case"video":case"audio":for(o=0;o<Up.length;o++)er(Up[o],t);o=r;break;case"source":er("error",t),o=r;break;case"img":case"image":case"link":er("error",t),er("load",t),o=r;break;case"details":er("toggle",t),o=r;break;case"input":H2(t,r),o=j0(t,r),er("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=vr({},r,{value:void 0}),er("invalid",t);break;case"textarea":Z2(t,r),o=W0(t,r),er("invalid",t);break;default:o=r}q0(n,o),g=o;for(l in g)if(g.hasOwnProperty(l)){var y=g[l];l==="style"?eI(t,y):l==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,y!=null&&JP(t,y)):l==="children"?typeof y=="string"?(n!=="textarea"||y!=="")&&hd(t,y):typeof y=="number"&&hd(t,""+y):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(cd.hasOwnProperty(l)?y!=null&&l==="onScroll"&&er("scroll",t):y!=null&&vx(t,l,y,s))}switch(n){case"input":dg(t),q2(t,r,!1);break;case"textarea":dg(t),X2(t);break;case"option":r.value!=null&&t.setAttribute("value",""+su(r.value));break;case"select":t.multiple=!!r.multiple,l=r.value,l!=null?Hh(t,!!r.multiple,l,!1):r.defaultValue!=null&&Hh(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=Ey)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zi(e),null;case 6:if(t&&e.stateNode!=null)TC(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Ke(166));if(n=nc(wd.current),nc(gs.current),Eg(e)){if(r=e.stateNode,n=e.memoizedProps,r[us]=e,(l=r.nodeValue!==n)&&(t=Oo,t!==null))switch(t.tag){case 3:wg(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&wg(r.nodeValue,n,(t.mode&1)!==0)}l&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[us]=e,e.stateNode=r}return zi(e),null;case 13:if(tr(gr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(cr&&Lo!==null&&e.mode&1&&!(e.flags&128))jI(),pf(),e.flags|=98560,l=!1;else if(l=Eg(e),r!==null&&r.dehydrated!==null){if(t===null){if(!l)throw Error(Ke(318));if(l=e.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(Ke(317));l[us]=e}else pf(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zi(e),l=!1}else _a!==null&&(P1(_a),_a=null),l=!0;if(!l)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||gr.current&1?Qr===0&&(Qr=3):eb())),e.updateQueue!==null&&(e.flags|=4),zi(e),null);case 4:return mf(),_1(t,e),t===null&&vd(e.stateNode.containerInfo),zi(e),null;case 10:return Bx(e.type._context),zi(e),null;case 17:return po(e.type)&&Ty(),zi(e),null;case 19:if(tr(gr),l=e.memoizedState,l===null)return zi(e),null;if(r=(e.flags&128)!==0,s=l.rendering,s===null)if(r)Lp(l,!1);else{if(Qr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=ky(t),s!==null){for(e.flags|=128,Lp(l,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)l=n,t=r,l.flags&=14680066,s=l.alternate,s===null?(l.childLanes=0,l.lanes=t,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,l.type=s.type,t=s.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return qn(gr,gr.current&1|2),e.child}t=t.sibling}l.tail!==null&&Dr()>yf&&(e.flags|=128,r=!0,Lp(l,!1),e.lanes=4194304)}else{if(!r)if(t=ky(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Lp(l,!0),l.tail===null&&l.tailMode==="hidden"&&!s.alternate&&!cr)return zi(e),null}else 2*Dr()-l.renderingStartTime>yf&&n!==1073741824&&(e.flags|=128,r=!0,Lp(l,!1),e.lanes=4194304);l.isBackwards?(s.sibling=e.child,e.child=s):(n=l.last,n!==null?n.sibling=s:e.child=s,l.last=s)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=Dr(),e.sibling=null,n=gr.current,qn(gr,r?n&1|2:n&1),e):(zi(e),null);case 22:case 23:return Qx(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Io&1073741824&&(zi(e),e.subtreeFlags&6&&(e.flags|=8192)):zi(e),null;case 24:return null;case 25:return null}throw Error(Ke(156,e.tag))}function _j(t,e){switch(Rx(e),e.tag){case 1:return po(e.type)&&Ty(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return mf(),tr(fo),tr(Ni),Vx(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return jx(e),null;case 13:if(tr(gr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ke(340));pf()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return tr(gr),null;case 4:return mf(),null;case 10:return Bx(e.type._context),null;case 22:case 23:return Qx(),null;case 24:return null;default:return null}}var Ag=!1,Bi=!1,xj=typeof WeakSet=="function"?WeakSet:Set,xt=null;function jh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ar(t,e,r)}else n.current=null}function x1(t,e,n){try{n()}catch(r){Ar(t,e,r)}}var BT=!1;function bj(t,e){if(r1=xy,t=II(),kx(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var s=0,g=-1,y=-1,b=0,S=0,I=t,C=null;t:for(;;){for(var B;I!==n||o!==0&&I.nodeType!==3||(g=s+o),I!==l||r!==0&&I.nodeType!==3||(y=s+r),I.nodeType===3&&(s+=I.nodeValue.length),(B=I.firstChild)!==null;)C=I,I=B;for(;;){if(I===t)break t;if(C===n&&++b===o&&(g=s),C===l&&++S===r&&(y=s),(B=I.nextSibling)!==null)break;I=C,C=I.parentNode}I=B}n=g===-1||y===-1?null:{start:g,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(i1={focusedElem:t,selectionRange:n},xy=!1,xt=e;xt!==null;)if(e=xt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,xt=t;else for(;xt!==null;){e=xt;try{var G=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(G!==null){var W=G.memoizedProps,he=G.memoizedState,H=e.stateNode,U=H.getSnapshotBeforeUpdate(e.elementType===e.type?W:ma(e.type,W),he);H.__reactInternalSnapshotBeforeUpdate=U}break;case 3:var K=e.stateNode.containerInfo;K.nodeType===1?K.textContent="":K.nodeType===9&&K.documentElement&&K.removeChild(K.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ke(163))}}catch(fe){Ar(e,e.return,fe)}if(t=e.sibling,t!==null){t.return=e.return,xt=t;break}xt=e.return}return G=BT,BT=!1,G}function $p(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var l=o.destroy;o.destroy=void 0,l!==void 0&&x1(e,n,l)}o=o.next}while(o!==r)}}function sv(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function b1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function SC(t){var e=t.alternate;e!==null&&(t.alternate=null,SC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[us],delete e[xd],delete e[s1],delete e[rj],delete e[ij])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function AC(t){return t.tag===5||t.tag===3||t.tag===4}function NT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||AC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function w1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ey));else if(r!==4&&(t=t.child,t!==null))for(w1(t,e,n),t=t.sibling;t!==null;)w1(t,e,n),t=t.sibling}function E1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(E1(t,e,n),t=t.sibling;t!==null;)E1(t,e,n),t=t.sibling}var di=null,ya=!1;function Gl(t,e,n){for(n=n.child;n!==null;)PC(t,e,n),n=n.sibling}function PC(t,e,n){if(ms&&typeof ms.onCommitFiberUnmount=="function")try{ms.onCommitFiberUnmount(Qy,n)}catch{}switch(n.tag){case 5:Bi||jh(n,e);case 6:var r=di,o=ya;di=null,Gl(t,e,n),di=r,ya=o,di!==null&&(ya?(t=di,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):di.removeChild(n.stateNode));break;case 18:di!==null&&(ya?(t=di,n=n.stateNode,t.nodeType===8?Z_(t.parentNode,n):t.nodeType===1&&Z_(t,n),md(t)):Z_(di,n.stateNode));break;case 4:r=di,o=ya,di=n.stateNode.containerInfo,ya=!0,Gl(t,e,n),di=r,ya=o;break;case 0:case 11:case 14:case 15:if(!Bi&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var l=o,s=l.destroy;l=l.tag,s!==void 0&&(l&2||l&4)&&x1(n,e,s),o=o.next}while(o!==r)}Gl(t,e,n);break;case 1:if(!Bi&&(jh(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(g){Ar(n,e,g)}Gl(t,e,n);break;case 21:Gl(t,e,n);break;case 22:n.mode&1?(Bi=(r=Bi)||n.memoizedState!==null,Gl(t,e,n),Bi=r):Gl(t,e,n);break;default:Gl(t,e,n)}}function FT(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new xj),e.forEach(function(r){var o=Mj.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function da(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var l=t,s=e,g=s;e:for(;g!==null;){switch(g.tag){case 5:di=g.stateNode,ya=!1;break e;case 3:di=g.stateNode.containerInfo,ya=!0;break e;case 4:di=g.stateNode.containerInfo,ya=!0;break e}g=g.return}if(di===null)throw Error(Ke(160));PC(l,s,o),di=null,ya=!1;var y=o.alternate;y!==null&&(y.return=null),o.return=null}catch(b){Ar(o,e,b)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)IC(e,t),e=e.sibling}function IC(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(da(e,t),as(t),r&4){try{$p(3,t,t.return),sv(3,t)}catch(W){Ar(t,t.return,W)}try{$p(5,t,t.return)}catch(W){Ar(t,t.return,W)}}break;case 1:da(e,t),as(t),r&512&&n!==null&&jh(n,n.return);break;case 5:if(da(e,t),as(t),r&512&&n!==null&&jh(n,n.return),t.flags&32){var o=t.stateNode;try{hd(o,"")}catch(W){Ar(t,t.return,W)}}if(r&4&&(o=t.stateNode,o!=null)){var l=t.memoizedProps,s=n!==null?n.memoizedProps:l,g=t.type,y=t.updateQueue;if(t.updateQueue=null,y!==null)try{g==="input"&&l.type==="radio"&&l.name!=null&&YP(o,l),Z0(g,s);var b=Z0(g,l);for(s=0;s<y.length;s+=2){var S=y[s],I=y[s+1];S==="style"?eI(o,I):S==="dangerouslySetInnerHTML"?JP(o,I):S==="children"?hd(o,I):vx(o,S,I,b)}switch(g){case"input":V0(o,l);break;case"textarea":$P(o,l);break;case"select":var C=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!l.multiple;var B=l.value;B!=null?Hh(o,!!l.multiple,B,!1):C!==!!l.multiple&&(l.defaultValue!=null?Hh(o,!!l.multiple,l.defaultValue,!0):Hh(o,!!l.multiple,l.multiple?[]:"",!1))}o[xd]=l}catch(W){Ar(t,t.return,W)}}break;case 6:if(da(e,t),as(t),r&4){if(t.stateNode===null)throw Error(Ke(162));o=t.stateNode,l=t.memoizedProps;try{o.nodeValue=l}catch(W){Ar(t,t.return,W)}}break;case 3:if(da(e,t),as(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{md(e.containerInfo)}catch(W){Ar(t,t.return,W)}break;case 4:da(e,t),as(t);break;case 13:da(e,t),as(t),o=t.child,o.flags&8192&&(l=o.memoizedState!==null,o.stateNode.isHidden=l,!l||o.alternate!==null&&o.alternate.memoizedState!==null||(Kx=Dr())),r&4&&FT(t);break;case 22:if(S=n!==null&&n.memoizedState!==null,t.mode&1?(Bi=(b=Bi)||S,da(e,t),Bi=b):da(e,t),as(t),r&8192){if(b=t.memoizedState!==null,(t.stateNode.isHidden=b)&&!S&&t.mode&1)for(xt=t,S=t.child;S!==null;){for(I=xt=S;xt!==null;){switch(C=xt,B=C.child,C.tag){case 0:case 11:case 14:case 15:$p(4,C,C.return);break;case 1:jh(C,C.return);var G=C.stateNode;if(typeof G.componentWillUnmount=="function"){r=C,n=C.return;try{e=r,G.props=e.memoizedProps,G.state=e.memoizedState,G.componentWillUnmount()}catch(W){Ar(r,n,W)}}break;case 5:jh(C,C.return);break;case 22:if(C.memoizedState!==null){jT(I);continue}}B!==null?(B.return=C,xt=B):jT(I)}S=S.sibling}e:for(S=null,I=t;;){if(I.tag===5){if(S===null){S=I;try{o=I.stateNode,b?(l=o.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(g=I.stateNode,y=I.memoizedProps.style,s=y!=null&&y.hasOwnProperty("display")?y.display:null,g.style.display=QP("display",s))}catch(W){Ar(t,t.return,W)}}}else if(I.tag===6){if(S===null)try{I.stateNode.nodeValue=b?"":I.memoizedProps}catch(W){Ar(t,t.return,W)}}else if((I.tag!==22&&I.tag!==23||I.memoizedState===null||I===t)&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===t)break e;for(;I.sibling===null;){if(I.return===null||I.return===t)break e;S===I&&(S=null),I=I.return}S===I&&(S=null),I.sibling.return=I.return,I=I.sibling}}break;case 19:da(e,t),as(t),r&4&&FT(t);break;case 21:break;default:da(e,t),as(t)}}function as(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(AC(n)){var r=n;break e}n=n.return}throw Error(Ke(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(hd(o,""),r.flags&=-33);var l=NT(t);E1(t,l,o);break;case 3:case 4:var s=r.stateNode.containerInfo,g=NT(t);w1(t,g,s);break;default:throw Error(Ke(161))}}catch(y){Ar(t,t.return,y)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function wj(t,e,n){xt=t,CC(t)}function CC(t,e,n){for(var r=(t.mode&1)!==0;xt!==null;){var o=xt,l=o.child;if(o.tag===22&&r){var s=o.memoizedState!==null||Ag;if(!s){var g=o.alternate,y=g!==null&&g.memoizedState!==null||Bi;g=Ag;var b=Bi;if(Ag=s,(Bi=y)&&!b)for(xt=o;xt!==null;)s=xt,y=s.child,s.tag===22&&s.memoizedState!==null?VT(o):y!==null?(y.return=s,xt=y):VT(o);for(;l!==null;)xt=l,CC(l),l=l.sibling;xt=o,Ag=g,Bi=b}UT(t)}else o.subtreeFlags&8772&&l!==null?(l.return=o,xt=l):UT(t)}}function UT(t){for(;xt!==null;){var e=xt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Bi||sv(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Bi)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:ma(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=e.updateQueue;l!==null&&ET(e,l,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ET(e,s,n)}break;case 5:var g=e.stateNode;if(n===null&&e.flags&4){n=g;var y=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":y.autoFocus&&n.focus();break;case"img":y.src&&(n.src=y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var b=e.alternate;if(b!==null){var S=b.memoizedState;if(S!==null){var I=S.dehydrated;I!==null&&md(I)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ke(163))}Bi||e.flags&512&&b1(e)}catch(C){Ar(e,e.return,C)}}if(e===t){xt=null;break}if(n=e.sibling,n!==null){n.return=e.return,xt=n;break}xt=e.return}}function jT(t){for(;xt!==null;){var e=xt;if(e===t){xt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,xt=n;break}xt=e.return}}function VT(t){for(;xt!==null;){var e=xt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{sv(4,e)}catch(y){Ar(e,n,y)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(y){Ar(e,o,y)}}var l=e.return;try{b1(e)}catch(y){Ar(e,l,y)}break;case 5:var s=e.return;try{b1(e)}catch(y){Ar(e,s,y)}}}catch(y){Ar(e,e.return,y)}if(e===t){xt=null;break}var g=e.sibling;if(g!==null){g.return=e.return,xt=g;break}xt=e.return}}var Ej=Math.ceil,Oy=yl.ReactCurrentDispatcher,Yx=yl.ReactCurrentOwner,Jo=yl.ReactCurrentBatchConfig,xn=0,li=null,Vr=null,gi=0,Io=0,Vh=hu(0),Qr=0,Ad=null,dc=0,lv=0,$x=0,Kp=null,co=null,Kx=0,yf=1/0,Js=null,Dy=!1,T1=null,iu=null,Pg=!1,Kl=null,zy=0,Jp=0,S1=null,Yg=-1,$g=0;function $i(){return xn&6?Dr():Yg!==-1?Yg:Yg=Dr()}function ou(t){return t.mode&1?xn&2&&gi!==0?gi&-gi:aj.transition!==null?($g===0&&($g=fI()),$g):(t=On,t!==0||(t=window.event,t=t===void 0?16:_I(t.type)),t):1}function Ea(t,e,n,r){if(50<Jp)throw Jp=0,S1=null,Error(Ke(185));Vd(t,n,r),(!(xn&2)||t!==li)&&(t===li&&(!(xn&2)&&(lv|=n),Qr===4&&Zl(t,gi)),mo(t,r),n===1&&xn===0&&!(e.mode&1)&&(yf=Dr()+500,iv&&fu()))}function mo(t,e){var n=t.callbackNode;aU(t,e);var r=_y(t,t===li?gi:0);if(r===0)n!==null&&K2(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&K2(n),e===1)t.tag===0?oj(GT.bind(null,t)):NI(GT.bind(null,t)),tj(function(){!(xn&6)&&fu()}),n=null;else{switch(pI(r)){case 1:n=Ex;break;case 4:n=cI;break;case 16:n=vy;break;case 536870912:n=hI;break;default:n=vy}n=BC(n,MC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function MC(t,e){if(Yg=-1,$g=0,xn&6)throw Error(Ke(327));var n=t.callbackNode;if($h()&&t.callbackNode!==n)return null;var r=_y(t,t===li?gi:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=By(t,r);else{e=r;var o=xn;xn|=2;var l=LC();(li!==t||gi!==e)&&(Js=null,yf=Dr()+500,ac(t,e));do try{Aj();break}catch(g){kC(t,g)}while(1);zx(),Oy.current=l,xn=o,Vr!==null?e=0:(li=null,gi=0,e=Qr)}if(e!==0){if(e===2&&(o=J0(t),o!==0&&(r=o,e=A1(t,o))),e===1)throw n=Ad,ac(t,0),Zl(t,r),mo(t,Dr()),n;if(e===6)Zl(t,r);else{if(o=t.current.alternate,!(r&30)&&!Tj(o)&&(e=By(t,r),e===2&&(l=J0(t),l!==0&&(r=l,e=A1(t,l))),e===1))throw n=Ad,ac(t,0),Zl(t,r),mo(t,Dr()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(Ke(345));case 2:Ju(t,co,Js);break;case 3:if(Zl(t,r),(r&130023424)===r&&(e=Kx+500-Dr(),10<e)){if(_y(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){$i(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=a1(Ju.bind(null,t,co,Js),e);break}Ju(t,co,Js);break;case 4:if(Zl(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var s=31-wa(r);l=1<<s,s=e[s],s>o&&(o=s),r&=~l}if(r=o,r=Dr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ej(r/1960))-r,10<r){t.timeoutHandle=a1(Ju.bind(null,t,co,Js),r);break}Ju(t,co,Js);break;case 5:Ju(t,co,Js);break;default:throw Error(Ke(329))}}}return mo(t,Dr()),t.callbackNode===n?MC.bind(null,t):null}function A1(t,e){var n=Kp;return t.current.memoizedState.isDehydrated&&(ac(t,e).flags|=256),t=By(t,e),t!==2&&(e=co,co=n,e!==null&&P1(e)),t}function P1(t){co===null?co=t:co.push.apply(co,t)}function Tj(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],l=o.getSnapshot;o=o.value;try{if(!Ta(l(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zl(t,e){for(e&=~$x,e&=~lv,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-wa(e),r=1<<n;t[n]=-1,e&=~r}}function GT(t){if(xn&6)throw Error(Ke(327));$h();var e=_y(t,0);if(!(e&1))return mo(t,Dr()),null;var n=By(t,e);if(t.tag!==0&&n===2){var r=J0(t);r!==0&&(e=r,n=A1(t,r))}if(n===1)throw n=Ad,ac(t,0),Zl(t,e),mo(t,Dr()),n;if(n===6)throw Error(Ke(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ju(t,co,Js),mo(t,Dr()),null}function Jx(t,e){var n=xn;xn|=1;try{return t(e)}finally{xn=n,xn===0&&(yf=Dr()+500,iv&&fu())}}function mc(t){Kl!==null&&Kl.tag===0&&!(xn&6)&&$h();var e=xn;xn|=1;var n=Jo.transition,r=On;try{if(Jo.transition=null,On=1,t)return t()}finally{On=r,Jo.transition=n,xn=e,!(xn&6)&&fu()}}function Qx(){Io=Vh.current,tr(Vh)}function ac(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,ej(n)),Vr!==null)for(n=Vr.return;n!==null;){var r=n;switch(Rx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ty();break;case 3:mf(),tr(fo),tr(Ni),Vx();break;case 5:jx(r);break;case 4:mf();break;case 13:tr(gr);break;case 19:tr(gr);break;case 10:Bx(r.type._context);break;case 22:case 23:Qx()}n=n.return}if(li=t,Vr=t=au(t.current,null),gi=Io=e,Qr=0,Ad=null,$x=lv=dc=0,co=Kp=null,tc!==null){for(e=0;e<tc.length;e++)if(n=tc[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,l=n.pending;if(l!==null){var s=l.next;l.next=o,r.next=s}n.pending=r}tc=null}return t}function kC(t,e){do{var n=Vr;try{if(zx(),qg.current=Ry,Ly){for(var r=yr.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Ly=!1}if(pc=0,si=Jr=yr=null,Yp=!1,Ed=0,Yx.current=null,n===null||n.return===null){Qr=1,Ad=e,Vr=null;break}e:{var l=t,s=n.return,g=n,y=e;if(e=gi,g.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){var b=y,S=g,I=S.tag;if(!(S.mode&1)&&(I===0||I===11||I===15)){var C=S.alternate;C?(S.updateQueue=C.updateQueue,S.memoizedState=C.memoizedState,S.lanes=C.lanes):(S.updateQueue=null,S.memoizedState=null)}var B=MT(s);if(B!==null){B.flags&=-257,kT(B,s,g,l,e),B.mode&1&&CT(l,b,e),e=B,y=b;var G=e.updateQueue;if(G===null){var W=new Set;W.add(y),e.updateQueue=W}else G.add(y);break e}else{if(!(e&1)){CT(l,b,e),eb();break e}y=Error(Ke(426))}}else if(cr&&g.mode&1){var he=MT(s);if(he!==null){!(he.flags&65536)&&(he.flags|=256),kT(he,s,g,l,e),Ox(gf(y,g));break e}}l=y=gf(y,g),Qr!==4&&(Qr=2),Kp===null?Kp=[l]:Kp.push(l),l=s;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e;var H=dC(l,y,e);wT(l,H);break e;case 1:g=y;var U=l.type,K=l.stateNode;if(!(l.flags&128)&&(typeof U.getDerivedStateFromError=="function"||K!==null&&typeof K.componentDidCatch=="function"&&(iu===null||!iu.has(K)))){l.flags|=65536,e&=-e,l.lanes|=e;var fe=mC(l,g,e);wT(l,fe);break e}}l=l.return}while(l!==null)}OC(n)}catch(ye){e=ye,Vr===n&&n!==null&&(Vr=n=n.return);continue}break}while(1)}function LC(){var t=Oy.current;return Oy.current=Ry,t===null?Ry:t}function eb(){(Qr===0||Qr===3||Qr===2)&&(Qr=4),li===null||!(dc&268435455)&&!(lv&268435455)||Zl(li,gi)}function By(t,e){var n=xn;xn|=2;var r=LC();(li!==t||gi!==e)&&(Js=null,ac(t,e));do try{Sj();break}catch(o){kC(t,o)}while(1);if(zx(),xn=n,Oy.current=r,Vr!==null)throw Error(Ke(261));return li=null,gi=0,Qr}function Sj(){for(;Vr!==null;)RC(Vr)}function Aj(){for(;Vr!==null&&!K6();)RC(Vr)}function RC(t){var e=zC(t.alternate,t,Io);t.memoizedProps=t.pendingProps,e===null?OC(t):Vr=e,Yx.current=null}function OC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=_j(n,e),n!==null){n.flags&=32767,Vr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qr=6,Vr=null;return}}else if(n=vj(n,e,Io),n!==null){Vr=n;return}if(e=e.sibling,e!==null){Vr=e;return}Vr=e=t}while(e!==null);Qr===0&&(Qr=5)}function Ju(t,e,n){var r=On,o=Jo.transition;try{Jo.transition=null,On=1,Pj(t,e,n,r)}finally{Jo.transition=o,On=r}return null}function Pj(t,e,n,r){do $h();while(Kl!==null);if(xn&6)throw Error(Ke(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Ke(177));t.callbackNode=null,t.callbackPriority=0;var l=n.lanes|n.childLanes;if(sU(t,l),t===li&&(Vr=li=null,gi=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Pg||(Pg=!0,BC(vy,function(){return $h(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Jo.transition,Jo.transition=null;var s=On;On=1;var g=xn;xn|=4,Yx.current=null,bj(t,n),IC(n,t),ZU(i1),xy=!!r1,i1=r1=null,t.current=n,wj(n),J6(),xn=g,On=s,Jo.transition=l}else t.current=n;if(Pg&&(Pg=!1,Kl=t,zy=o),l=t.pendingLanes,l===0&&(iu=null),tU(n.stateNode),mo(t,Dr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Dy)throw Dy=!1,t=T1,T1=null,t;return zy&1&&t.tag!==0&&$h(),l=t.pendingLanes,l&1?t===S1?Jp++:(Jp=0,S1=t):Jp=0,fu(),null}function $h(){if(Kl!==null){var t=pI(zy),e=Jo.transition,n=On;try{if(Jo.transition=null,On=16>t?16:t,Kl===null)var r=!1;else{if(t=Kl,Kl=null,zy=0,xn&6)throw Error(Ke(331));var o=xn;for(xn|=4,xt=t.current;xt!==null;){var l=xt,s=l.child;if(xt.flags&16){var g=l.deletions;if(g!==null){for(var y=0;y<g.length;y++){var b=g[y];for(xt=b;xt!==null;){var S=xt;switch(S.tag){case 0:case 11:case 15:$p(8,S,l)}var I=S.child;if(I!==null)I.return=S,xt=I;else for(;xt!==null;){S=xt;var C=S.sibling,B=S.return;if(SC(S),S===b){xt=null;break}if(C!==null){C.return=B,xt=C;break}xt=B}}}var G=l.alternate;if(G!==null){var W=G.child;if(W!==null){G.child=null;do{var he=W.sibling;W.sibling=null,W=he}while(W!==null)}}xt=l}}if(l.subtreeFlags&2064&&s!==null)s.return=l,xt=s;else e:for(;xt!==null;){if(l=xt,l.flags&2048)switch(l.tag){case 0:case 11:case 15:$p(9,l,l.return)}var H=l.sibling;if(H!==null){H.return=l.return,xt=H;break e}xt=l.return}}var U=t.current;for(xt=U;xt!==null;){s=xt;var K=s.child;if(s.subtreeFlags&2064&&K!==null)K.return=s,xt=K;else e:for(s=U;xt!==null;){if(g=xt,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:sv(9,g)}}catch(ye){Ar(g,g.return,ye)}if(g===s){xt=null;break e}var fe=g.sibling;if(fe!==null){fe.return=g.return,xt=fe;break e}xt=g.return}}if(xn=o,fu(),ms&&typeof ms.onPostCommitFiberRoot=="function")try{ms.onPostCommitFiberRoot(Qy,t)}catch{}r=!0}return r}finally{On=n,Jo.transition=e}}return!1}function WT(t,e,n){e=gf(n,e),e=dC(t,e,1),t=ru(t,e,1),e=$i(),t!==null&&(Vd(t,1,e),mo(t,e))}function Ar(t,e,n){if(t.tag===3)WT(t,t,n);else for(;e!==null;){if(e.tag===3){WT(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(iu===null||!iu.has(r))){t=gf(n,t),t=mC(e,t,1),e=ru(e,t,1),t=$i(),e!==null&&(Vd(e,1,t),mo(e,t));break}}e=e.return}}function Ij(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=$i(),t.pingedLanes|=t.suspendedLanes&n,li===t&&(gi&n)===n&&(Qr===4||Qr===3&&(gi&130023424)===gi&&500>Dr()-Kx?ac(t,0):$x|=n),mo(t,e)}function DC(t,e){e===0&&(t.mode&1?(e=yg,yg<<=1,!(yg&130023424)&&(yg=4194304)):e=1);var n=$i();t=pl(t,e),t!==null&&(Vd(t,e,n),mo(t,n))}function Cj(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),DC(t,n)}function Mj(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Ke(314))}r!==null&&r.delete(e),DC(t,n)}var zC;zC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||fo.current)ho=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ho=!1,yj(t,e,n);ho=!!(t.flags&131072)}else ho=!1,cr&&e.flags&1048576&&FI(e,Py,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Xg(t,e),t=e.pendingProps;var o=ff(e,Ni.current);Yh(e,n),o=Wx(null,e,r,t,o,n);var l=Hx();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,po(r)?(l=!0,Sy(e)):l=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Fx(e),o.updater=ov,e.stateNode=o,o._reactInternals=e,p1(e,r,t,n),e=g1(null,e,r,!0,l,n)):(e.tag=0,cr&&l&&Lx(e),qi(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Xg(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=Lj(r),t=ma(r,t),o){case 0:e=m1(null,e,r,t,n);break e;case 1:e=OT(null,e,r,t,n);break e;case 11:e=LT(null,e,r,t,n);break e;case 14:e=RT(null,e,r,ma(r.type,t),n);break e}throw Error(Ke(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:ma(r,o),m1(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:ma(r,o),OT(t,e,r,o,n);case 3:e:{if(_C(e),t===null)throw Error(Ke(387));r=e.pendingProps,l=e.memoizedState,o=l.element,GI(t,e),My(e,r,null,n);var s=e.memoizedState;if(r=s.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=l,e.memoizedState=l,e.flags&256){o=gf(Error(Ke(423)),e),e=DT(t,e,r,n,o);break e}else if(r!==o){o=gf(Error(Ke(424)),e),e=DT(t,e,r,n,o);break e}else for(Lo=nu(e.stateNode.containerInfo.firstChild),Oo=e,cr=!0,_a=null,n=ZI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(pf(),r===o){e=dl(t,e,n);break e}qi(t,e,r,n)}e=e.child}return e;case 5:return XI(e),t===null&&c1(e),r=e.type,o=e.pendingProps,l=t!==null?t.memoizedProps:null,s=o.children,o1(r,o)?s=null:l!==null&&o1(r,l)&&(e.flags|=32),vC(t,e),qi(t,e,s,n),e.child;case 6:return t===null&&c1(e),null;case 13:return xC(t,e,n);case 4:return Ux(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=df(e,null,r,n):qi(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:ma(r,o),LT(t,e,r,o,n);case 7:return qi(t,e,e.pendingProps,n),e.child;case 8:return qi(t,e,e.pendingProps.children,n),e.child;case 12:return qi(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,l=e.memoizedProps,s=o.value,qn(Iy,r._currentValue),r._currentValue=s,l!==null)if(Ta(l.value,s)){if(l.children===o.children&&!fo.current){e=dl(t,e,n);break e}}else for(l=e.child,l!==null&&(l.return=e);l!==null;){var g=l.dependencies;if(g!==null){s=l.child;for(var y=g.firstContext;y!==null;){if(y.context===r){if(l.tag===1){y=sl(-1,n&-n),y.tag=2;var b=l.updateQueue;if(b!==null){b=b.shared;var S=b.pending;S===null?y.next=y:(y.next=S.next,S.next=y),b.pending=y}}l.lanes|=n,y=l.alternate,y!==null&&(y.lanes|=n),h1(l.return,n,e),g.lanes|=n;break}y=y.next}}else if(l.tag===10)s=l.type===e.type?null:l.child;else if(l.tag===18){if(s=l.return,s===null)throw Error(Ke(341));s.lanes|=n,g=s.alternate,g!==null&&(g.lanes|=n),h1(s,n,e),s=l.sibling}else s=l.child;if(s!==null)s.return=l;else for(s=l;s!==null;){if(s===e){s=null;break}if(l=s.sibling,l!==null){l.return=s.return,s=l;break}s=s.return}l=s}qi(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,Yh(e,n),o=Qo(o),r=r(o),e.flags|=1,qi(t,e,r,n),e.child;case 14:return r=e.type,o=ma(r,e.pendingProps),o=ma(r.type,o),RT(t,e,r,o,n);case 15:return gC(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:ma(r,o),Xg(t,e),e.tag=1,po(r)?(t=!0,Sy(e)):t=!1,Yh(e,n),HI(e,r,o),p1(e,r,o,n),g1(null,e,r,!0,t,n);case 19:return bC(t,e,n);case 22:return yC(t,e,n)}throw Error(Ke(156,e.tag))};function BC(t,e){return uI(t,e)}function kj(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $o(t,e,n,r){return new kj(t,e,n,r)}function tb(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Lj(t){if(typeof t=="function")return tb(t)?1:0;if(t!=null){if(t=t.$$typeof,t===xx)return 11;if(t===bx)return 14}return 2}function au(t,e){var n=t.alternate;return n===null?(n=$o(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Kg(t,e,n,r,o,l){var s=2;if(r=t,typeof t=="function")tb(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case Lh:return sc(n.children,o,l,e);case _x:s=8,o|=8;break;case B0:return t=$o(12,n,e,o|2),t.elementType=B0,t.lanes=l,t;case N0:return t=$o(13,n,e,o),t.elementType=N0,t.lanes=l,t;case F0:return t=$o(19,n,e,o),t.elementType=F0,t.lanes=l,t;case qP:return uv(n,o,l,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case WP:s=10;break e;case HP:s=9;break e;case xx:s=11;break e;case bx:s=14;break e;case Wl:s=16,r=null;break e}throw Error(Ke(130,t==null?t:typeof t,""))}return e=$o(s,n,e,o),e.elementType=t,e.type=r,e.lanes=l,e}function sc(t,e,n,r){return t=$o(7,t,r,e),t.lanes=n,t}function uv(t,e,n,r){return t=$o(22,t,r,e),t.elementType=qP,t.lanes=n,t.stateNode={isHidden:!1},t}function t0(t,e,n){return t=$o(6,t,null,e),t.lanes=n,t}function n0(t,e,n){return e=$o(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Rj(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=z_(0),this.expirationTimes=z_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z_(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function nb(t,e,n,r,o,l,s,g,y){return t=new Rj(t,e,n,g,y),e===1?(e=1,l===!0&&(e|=8)):e=0,l=$o(3,null,null,e),t.current=l,l.stateNode=t,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fx(l),t}function Oj(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:kh,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function NC(t){if(!t)return lu;t=t._reactInternals;e:{if(bc(t)!==t||t.tag!==1)throw Error(Ke(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(po(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ke(171))}if(t.tag===1){var n=t.type;if(po(n))return BI(t,n,e)}return e}function FC(t,e,n,r,o,l,s,g,y){return t=nb(n,r,!0,t,o,l,s,g,y),t.context=NC(null),n=t.current,r=$i(),o=ou(n),l=sl(r,o),l.callback=e??null,ru(n,l,o),t.current.lanes=o,Vd(t,o,r),mo(t,r),t}function cv(t,e,n,r){var o=e.current,l=$i(),s=ou(o);return n=NC(n),e.context===null?e.context=n:e.pendingContext=n,e=sl(l,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ru(o,e,s),t!==null&&(Ea(t,o,s,l),Hg(t,o,s)),s}function Ny(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function HT(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function rb(t,e){HT(t,e),(t=t.alternate)&&HT(t,e)}function Dj(){return null}var UC=typeof reportError=="function"?reportError:function(t){console.error(t)};function ib(t){this._internalRoot=t}hv.prototype.render=ib.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ke(409));cv(t,e,null,null)};hv.prototype.unmount=ib.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;mc(function(){cv(null,t,null,null)}),e[fl]=null}};function hv(t){this._internalRoot=t}hv.prototype.unstable_scheduleHydration=function(t){if(t){var e=gI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ql.length&&e!==0&&e<ql[n].priority;n++);ql.splice(n,0,t),n===0&&vI(t)}};function ob(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function fv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function qT(){}function zj(t,e,n,r,o){if(o){if(typeof r=="function"){var l=r;r=function(){var b=Ny(s);l.call(b)}}var s=FC(e,r,t,0,null,!1,!1,"",qT);return t._reactRootContainer=s,t[fl]=s.current,vd(t.nodeType===8?t.parentNode:t),mc(),s}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var g=r;r=function(){var b=Ny(y);g.call(b)}}var y=nb(t,0,!1,null,null,!1,!1,"",qT);return t._reactRootContainer=y,t[fl]=y.current,vd(t.nodeType===8?t.parentNode:t),mc(function(){cv(e,y,n,r)}),y}function pv(t,e,n,r,o){var l=n._reactRootContainer;if(l){var s=l;if(typeof o=="function"){var g=o;o=function(){var y=Ny(s);g.call(y)}}cv(e,s,t,o)}else s=zj(n,e,t,o,r);return Ny(s)}dI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Fp(e.pendingLanes);n!==0&&(Tx(e,n|1),mo(e,Dr()),!(xn&6)&&(yf=Dr()+500,fu()))}break;case 13:mc(function(){var r=pl(t,1);if(r!==null){var o=$i();Ea(r,t,1,o)}}),rb(t,1)}};Sx=function(t){if(t.tag===13){var e=pl(t,134217728);if(e!==null){var n=$i();Ea(e,t,134217728,n)}rb(t,134217728)}};mI=function(t){if(t.tag===13){var e=ou(t),n=pl(t,e);if(n!==null){var r=$i();Ea(n,t,e,r)}rb(t,e)}};gI=function(){return On};yI=function(t,e){var n=On;try{return On=t,e()}finally{On=n}};Y0=function(t,e,n){switch(e){case"input":if(V0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=rv(r);if(!o)throw Error(Ke(90));XP(r),V0(r,o)}}}break;case"textarea":$P(t,n);break;case"select":e=n.value,e!=null&&Hh(t,!!n.multiple,e,!1)}};rI=Jx;iI=mc;var Bj={usingClientEntryPoint:!1,Events:[Wd,zh,rv,tI,nI,Jx]},Rp={findFiberByHostInstance:ec,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Nj={bundleType:Rp.bundleType,version:Rp.version,rendererPackageName:Rp.rendererPackageName,rendererConfig:Rp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=sI(t),t===null?null:t.stateNode},findFiberByHostInstance:Rp.findFiberByHostInstance||Dj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ig=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ig.isDisabled&&Ig.supportsFiber)try{Qy=Ig.inject(Nj),ms=Ig}catch{}}Bo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bj;Bo.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ob(e))throw Error(Ke(200));return Oj(t,e,null,n)};Bo.createRoot=function(t,e){if(!ob(t))throw Error(Ke(299));var n=!1,r="",o=UC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=nb(t,1,!1,null,null,n,!1,r,o),t[fl]=e.current,vd(t.nodeType===8?t.parentNode:t),new ib(e)};Bo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ke(188)):(t=Object.keys(t).join(","),Error(Ke(268,t)));return t=sI(e),t=t===null?null:t.stateNode,t};Bo.flushSync=function(t){return mc(t)};Bo.hydrate=function(t,e,n){if(!fv(e))throw Error(Ke(200));return pv(null,t,e,!0,n)};Bo.hydrateRoot=function(t,e,n){if(!ob(t))throw Error(Ke(405));var r=n!=null&&n.hydratedSources||null,o=!1,l="",s=UC;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=FC(e,null,t,1,n??null,o,!1,l,s),t[fl]=e.current,vd(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new hv(e)};Bo.render=function(t,e,n){if(!fv(e))throw Error(Ke(200));return pv(null,t,e,!1,n)};Bo.unmountComponentAtNode=function(t){if(!fv(t))throw Error(Ke(40));return t._reactRootContainer?(mc(function(){pv(null,null,t,!1,function(){t._reactRootContainer=null,t[fl]=null})}),!0):!1};Bo.unstable_batchedUpdates=Jx;Bo.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!fv(n))throw Error(Ke(200));if(t==null||t._reactInternals===void 0)throw Error(Ke(38));return pv(t,e,n,!1,r)};Bo.version="18.2.0-next-9e3b772b8-20220608";function jC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jC)}catch(t){console.error(t)}}jC(),FP.exports=Bo;var Fj=FP.exports,VC,ZT=Fj;VC=ZT.createRoot,ZT.hydrateRoot;function Fy(){return Fy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Fy.apply(this,arguments)}function I1(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Uj(t){if(Array.isArray(t))return I1(t)}function jj(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function GC(t,e){if(t){if(typeof t=="string")return I1(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I1(t,e)}}function Vj(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gj(t){return Uj(t)||jj(t)||GC(t)||Vj()}var WC={exports:{}},Wj="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Hj=Wj,qj=Hj;function HC(){}function qC(){}qC.resetWarningCache=HC;var Zj=function(){function t(r,o,l,s,g,y){if(y!==qj){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:qC,resetWarningCache:HC};return n.PropTypes=n,n};WC.exports=Zj();var Ee=WC.exports;function Xj(t){if(Array.isArray(t))return t}function Yj(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,l,s,g=[],y=!0,b=!1;try{if(l=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;y=!1}else for(;!(y=(r=l.call(n)).done)&&(g.push(r.value),g.length!==e);y=!0);}catch(S){b=!0,o=S}finally{try{if(!y&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(b)throw o}}return g}}function $j(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gr(t,e){return Xj(t)||Yj(t,e)||GC(t,e)||$j()}var ZC=function(){if(typeof Map<"u")return Map;function t(e,n){var r=-1;return e.some(function(o,l){return o[0]===n?(r=l,!0):!1}),r}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(n){var r=t(this.__entries__,n),o=this.__entries__[r];return o&&o[1]},e.prototype.set=function(n,r){var o=t(this.__entries__,n);~o?this.__entries__[o][1]=r:this.__entries__.push([n,r])},e.prototype.delete=function(n){var r=this.__entries__,o=t(r,n);~o&&r.splice(o,1)},e.prototype.has=function(n){return!!~t(this.__entries__,n)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(n,r){r===void 0&&(r=null);for(var o=0,l=this.__entries__;o<l.length;o++){var s=l[o];n.call(r,s[1],s[0])}},e}()}(),C1=typeof window<"u"&&typeof document<"u"&&window.document===document,Uy=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),Kj=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Uy):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),Jj=2;function Qj(t,e){var n=!1,r=!1,o=0;function l(){n&&(n=!1,t()),r&&g()}function s(){Kj(l)}function g(){var y=Date.now();if(n){if(y-o<Jj)return;r=!0}else n=!0,r=!1,setTimeout(s,e);o=y}return g}var eV=20,tV=["top","right","bottom","left","width","height","size","weight"],nV=typeof MutationObserver<"u",rV=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Qj(this.refresh.bind(this),eV)}return t.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},t.prototype.removeObserver=function(e){var n=this.observers_,r=n.indexOf(e);~r&&n.splice(r,1),!n.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},t.prototype.updateObservers_=function(){var e=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return e.forEach(function(n){return n.broadcastActive()}),e.length>0},t.prototype.connect_=function(){!C1||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),nV?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){!C1||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(e){var n=e.propertyName,r=n===void 0?"":n,o=tV.some(function(l){return!!~r.indexOf(l)});o&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),XC=function(t,e){for(var n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];Object.defineProperty(t,o,{value:e[o],enumerable:!1,writable:!1,configurable:!0})}return t},vf=function(t){var e=t&&t.ownerDocument&&t.ownerDocument.defaultView;return e||Uy},YC=dv(0,0,0,0);function jy(t){return parseFloat(t)||0}function XT(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(r,o){var l=t["border-"+o+"-width"];return r+jy(l)},0)}function iV(t){for(var e=["top","right","bottom","left"],n={},r=0,o=e;r<o.length;r++){var l=o[r],s=t["padding-"+l];n[l]=jy(s)}return n}function oV(t){var e=t.getBBox();return dv(0,0,e.width,e.height)}function aV(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return YC;var r=vf(t).getComputedStyle(t),o=iV(r),l=o.left+o.right,s=o.top+o.bottom,g=jy(r.width),y=jy(r.height);if(r.boxSizing==="border-box"&&(Math.round(g+l)!==e&&(g-=XT(r,"left","right")+l),Math.round(y+s)!==n&&(y-=XT(r,"top","bottom")+s)),!lV(t)){var b=Math.round(g+l)-e,S=Math.round(y+s)-n;Math.abs(b)!==1&&(g-=b),Math.abs(S)!==1&&(y-=S)}return dv(o.left,o.top,g,y)}var sV=function(){return typeof SVGGraphicsElement<"u"?function(t){return t instanceof vf(t).SVGGraphicsElement}:function(t){return t instanceof vf(t).SVGElement&&typeof t.getBBox=="function"}}();function lV(t){return t===vf(t).document.documentElement}function uV(t){return C1?sV(t)?oV(t):aV(t):YC}function cV(t){var e=t.x,n=t.y,r=t.width,o=t.height,l=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,s=Object.create(l.prototype);return XC(s,{x:e,y:n,width:r,height:o,top:n,right:e+r,bottom:o+n,left:e}),s}function dv(t,e,n,r){return{x:t,y:e,width:n,height:r}}var hV=function(){function t(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=dv(0,0,0,0),this.target=e}return t.prototype.isActive=function(){var e=uV(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},t}(),fV=function(){function t(e,n){var r=cV(n);XC(this,{target:e,contentRect:r})}return t}(),pV=function(){function t(e,n,r){if(this.activeObservations_=[],this.observations_=new ZC,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=n,this.callbackCtx_=r}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof vf(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)||(n.set(e,new hV(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof vf(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)&&(n.delete(e),n.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&e.activeObservations_.push(n)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,n=this.activeObservations_.map(function(r){return new fV(r.target,r.broadcastRect())});this.callback_.call(e,n,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),$C=typeof WeakMap<"u"?new WeakMap:new ZC,KC=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=rV.getInstance(),r=new pV(e,n,this);$C.set(this,r)}return t}();["observe","unobserve","disconnect"].forEach(function(t){KC.prototype[t]=function(){var e;return(e=$C.get(this))[t].apply(e,arguments)}});var dV=function(){return typeof Uy.ResizeObserver<"u"?Uy.ResizeObserver:KC}();function pu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YT(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,US(r.key),r)}}function du(t,e,n){return e&&YT(t.prototype,e),n&&YT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var rl=typeof document<"u"?document:{};function $T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Cg(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$T(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$T(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function KT(t,e){var n;if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(n=mV(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(b){throw b},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l=!0,s=!1,g;return{s:function(){n=t[Symbol.iterator]()},n:function(){var b=n.next();return l=b.done,b},e:function(b){s=!0,g=b},f:function(){try{!l&&n.return!=null&&n.return()}finally{if(s)throw g}}}}function mV(t,e){if(t){if(typeof t=="string")return JT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JT(t,e)}}function JT(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var gV=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function r0(t){if(!t)return null;if(typeof t=="string")return t;t.toJS&&(t=t.toJS());var e={},n=KT(t.layers),r;try{for(n.s();!(r=n.n()).done;){var o=r.value;e[o.id]=o}}catch(s){n.e(s)}finally{n.f()}var l=t.layers.map(function(s){var g=e[s.ref],y=null;if("interactive"in s&&(y=Cg({},s),delete y.interactive),g){y=y||Cg({},s),delete y.ref;var b=KT(gV),S;try{for(b.s();!(S=b.n()).done;){var I=S.value;I in g&&(y[I]=g[I])}}catch(C){b.e(C)}finally{b.f()}}return y||s});return Cg(Cg({},t),{},{layers:l})}function yV(){}function vV(t){t&&console.error(t.error)}var JC={container:Ee.object,gl:Ee.object,mapboxApiAccessToken:Ee.string,mapboxApiUrl:Ee.string,attributionControl:Ee.bool,preserveDrawingBuffer:Ee.bool,reuseMaps:Ee.bool,transformRequest:Ee.func,mapOptions:Ee.object,mapStyle:Ee.oneOfType([Ee.string,Ee.object]),preventStyleDiffing:Ee.bool,visible:Ee.bool,asyncRender:Ee.bool,onLoad:Ee.func,onError:Ee.func,width:Ee.number,height:Ee.number,viewState:Ee.object,longitude:Ee.number,latitude:Ee.number,zoom:Ee.number,bearing:Ee.number,pitch:Ee.number,altitude:Ee.number},Jg={container:rl.body,mapboxApiAccessToken:_V(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",preventStyleDiffing:!1,visible:!0,asyncRender:!1,onLoad:yV,onError:vV,width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function _V(){var t=null;if(typeof window<"u"&&window.location){var e=window.location.search.match(/access_token=([^&\/]*)/);t=e&&e[1]}return!t&&typeof process<"u"&&(t=t||{}.MapboxAccessToken||{}.REACT_APP_MAPBOX_ACCESS_TOKEN),t||"no-token"}function QT(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"component";t.debug&&Ee.checkPropTypes(JC,t,"prop",e)}var wc=function(){function t(e){var n=this;if(pu(this,t),D(this,"props",Jg),D(this,"width",0),D(this,"height",0),D(this,"_fireLoadEvent",function(){n.props.onLoad({type:"load",target:n._map})}),D(this,"_handleError",function(r){n.props.onError(r)}),!e.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=e.mapboxgl,t.initialized||(t.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(e)}return du(t,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(n){return this._update(this.props,n),this}},{key:"redraw",value:function(){var n=this._map;n.style&&(n._frame&&(n._frame.cancel(),n._frame=null),n._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(n){this._map=t.savedMap;var r=this._map.getContainer(),o=n.container;for(o.classList.add("mapboxgl-map");r.childNodes.length>0;)o.appendChild(r.childNodes[0]);this._map._container=o,t.savedMap=null,n.mapStyle&&this._map.setStyle(r0(n.mapStyle),{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(n){if(n.reuseMaps&&t.savedMap)this._reuse(n);else{if(n.gl){var r=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=r,n.gl}}var o={container:n.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:r0(n.mapStyle),interactive:!1,trackResize:!1,attributionControl:n.attributionControl,preserveDrawingBuffer:n.preserveDrawingBuffer};n.transformRequest&&(o.transformRequest=n.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},o,n.mapOptions)),this._map.once("load",this._fireLoadEvent),this._map.on("error",this._handleError)}return this}},{key:"_destroy",value:function(){this._map&&(this.props.reuseMaps&&!t.savedMap?(t.savedMap=this._map,this._map.off("load",this._fireLoadEvent),this._map.off("error",this._handleError),this._map.off("styledata",this._fireLoadEvent)):this._map.remove(),this._map=null)}},{key:"_initialize",value:function(n){var r=this;n=Object.assign({},Jg,n),QT(n,"Mapbox"),this.mapboxgl.accessToken=n.mapboxApiAccessToken||Jg.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=n.mapboxApiUrl,this._create(n);var o=n,l=o.container;Object.defineProperty(l,"offsetWidth",{configurable:!0,get:function(){return r.width}}),Object.defineProperty(l,"clientWidth",{configurable:!0,get:function(){return r.width}}),Object.defineProperty(l,"offsetHeight",{configurable:!0,get:function(){return r.height}}),Object.defineProperty(l,"clientHeight",{configurable:!0,get:function(){return r.height}});var s=this._map.getCanvas();s&&(s.style.outline="none"),this._updateMapViewport({},n),this._updateMapSize({},n),this.props=n}},{key:"_update",value:function(n,r){if(this._map){r=Object.assign({},this.props,r),QT(r,"Mapbox");var o=this._updateMapViewport(n,r),l=this._updateMapSize(n,r);this._updateMapStyle(n,r),!r.asyncRender&&(o||l)&&this.redraw(),this.props=r}}},{key:"_updateMapStyle",value:function(n,r){var o=n.mapStyle!==r.mapStyle;o&&this._map.setStyle(r0(r.mapStyle),{diff:!r.preventStyleDiffing})}},{key:"_updateMapSize",value:function(n,r){var o=n.width!==r.width||n.height!==r.height;return o&&(this.width=r.width,this.height=r.height,this._map.resize()),o}},{key:"_updateMapViewport",value:function(n,r){var o=this._getViewState(n),l=this._getViewState(r),s=l.latitude!==o.latitude||l.longitude!==o.longitude||l.zoom!==o.zoom||l.pitch!==o.pitch||l.bearing!==o.bearing||l.altitude!==o.altitude;return s&&(this._map.jumpTo(this._viewStateToMapboxProps(l)),l.altitude!==o.altitude&&(this._map.transform.altitude=l.altitude)),s}},{key:"_getViewState",value:function(n){var r=n.viewState||n,o=r.longitude,l=r.latitude,s=r.zoom,g=r.pitch,y=g===void 0?0:g,b=r.bearing,S=b===void 0?0:b,I=r.altitude,C=I===void 0?1.5:I;return{longitude:o,latitude:l,zoom:s,pitch:y,bearing:S,altitude:C}}},{key:"_checkStyleSheet",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"0.47.0";if(!(typeof rl>"u"))try{var r=rl.createElement("div");r.className="mapboxgl-map",r.style.display="none",rl.body.appendChild(r);var o=window.getComputedStyle(r).position!=="static";if(!o){var l=rl.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),l.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(n,"/mapbox-gl.css")),rl.head.appendChild(l)}}catch{}}},{key:"_viewStateToMapboxProps",value:function(n){return{center:[n.longitude,n.latitude],zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}}}]),t}();D(wc,"initialized",!1);D(wc,"propTypes",JC);D(wc,"defaultProps",Jg);D(wc,"savedMap",null);var QC={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(Wk,function(){var n,r,o;function l(s,g){if(!n)n=g;else if(!r)r=g;else{var y="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",b={};n(b),o=g(b),typeof window<"u"&&(o.workerUrl=window.URL.createObjectURL(new Blob([y],{type:"text/javascript"})))}}return l(["exports"],function(s){function g(i,a){return i(a={exports:{}},a.exports),a.exports}var y=b;function b(i,a,u,p){this.cx=3*i,this.bx=3*(u-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=p,this.p2x=u,this.p2y=p}b.prototype.sampleCurveX=function(i){return((this.ax*i+this.bx)*i+this.cx)*i},b.prototype.sampleCurveY=function(i){return((this.ay*i+this.by)*i+this.cy)*i},b.prototype.sampleCurveDerivativeX=function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},b.prototype.solveCurveX=function(i,a){var u,p,m,v,x;for(a===void 0&&(a=1e-6),m=i,x=0;x<8;x++){if(v=this.sampleCurveX(m)-i,Math.abs(v)<a)return m;var T=this.sampleCurveDerivativeX(m);if(Math.abs(T)<1e-6)break;m-=v/T}if((m=i)<(u=0))return u;if(m>(p=1))return p;for(;u<p;){if(v=this.sampleCurveX(m),Math.abs(v-i)<a)return m;i>v?u=m:p=m,m=.5*(p-u)+u}return m},b.prototype.solve=function(i,a){return this.sampleCurveY(this.solveCurveX(i,a))};var S=I;function I(i,a){this.x=i,this.y=a}I.prototype={clone:function(){return new I(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,a){return this.clone()._rotateAround(i,a)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var a=i.x-this.x,u=i.y-this.y;return a*a+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,a){return Math.atan2(this.x*a-this.y*i,this.x*i+this.y*a)},_matMult:function(i){var a=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=a,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var a=Math.cos(i),u=Math.sin(i),p=u*this.x+a*this.y;return this.x=a*this.x-u*this.y,this.y=p,this},_rotateAround:function(i,a){var u=Math.cos(i),p=Math.sin(i),m=a.y+p*(this.x-a.x)+u*(this.y-a.y);return this.x=a.x+u*(this.x-a.x)-p*(this.y-a.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},I.convert=function(i){return i instanceof I?i:Array.isArray(i)?new I(i[0],i[1]):i};var C=typeof self<"u"?self:{},B=Math.pow(2,53)-1;function G(i,a,u,p){var m=new y(i,a,u,p);return function(v){return m.solve(v)}}var W=G(.25,.1,.25,1);function he(i,a,u){return Math.min(u,Math.max(a,i))}function H(i,a,u){var p=u-a,m=((i-a)%p+p)%p+a;return m===a?u:m}function U(i){for(var a=[],u=arguments.length-1;u-- >0;)a[u]=arguments[u+1];for(var p=0,m=a;p<m.length;p+=1){var v=m[p];for(var x in v)i[x]=v[x]}return i}var K=1;function fe(){return K++}function ye(){return function i(a){return a?(a^16*Math.random()>>a/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function xe(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function Te(i,a){i.forEach(function(u){a[u]&&(a[u]=a[u].bind(a))})}function De(i,a){return i.indexOf(a,i.length-a.length)!==-1}function Fe(i,a,u){var p={};for(var m in i)p[m]=a.call(u||this,i[m],m,i);return p}function Ve(i,a,u){var p={};for(var m in i)a.call(u||this,i[m],m,i)&&(p[m]=i[m]);return p}function tt(i){return Array.isArray(i)?i.map(tt):typeof i=="object"&&i?Fe(i,tt):i}var Bt={};function ft(i){Bt[i]||(typeof console<"u"&&console.warn(i),Bt[i]=!0)}function wt(i,a,u){return(u.y-i.y)*(a.x-i.x)>(a.y-i.y)*(u.x-i.x)}function nr(i){for(var a=0,u=0,p=i.length,m=p-1,v=void 0,x=void 0;u<p;m=u++)a+=((x=i[m]).x-(v=i[u]).x)*(v.y+x.y);return a}function rr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Pr(i){var a={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(p,m,v,x){var T=v||x;return a[m]=!T||T.toLowerCase(),""}),a["max-age"]){var u=parseInt(a["max-age"],10);isNaN(u)?delete a["max-age"]:a["max-age"]=u}return a}var ut=null;function Mt(i){if(ut==null){var a=i.navigator?i.navigator.userAgent:null;ut=!!i.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return ut}function Ot(i){try{var a=C[i];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch{return!1}}var Qt,en,vi,Ir,_i=C.performance&&C.performance.now?C.performance.now.bind(C.performance):Date.now.bind(Date),Fi=C.requestAnimationFrame||C.mozRequestAnimationFrame||C.webkitRequestAnimationFrame||C.msRequestAnimationFrame,an=C.cancelAnimationFrame||C.mozCancelAnimationFrame||C.webkitCancelAnimationFrame||C.msCancelAnimationFrame,Wr={now:_i,frame:function(i){var a=Fi(i);return{cancel:function(){return an(a)}}},getImageData:function(i,a){a===void 0&&(a=0);var u=C.document.createElement("canvas"),p=u.getContext("2d");if(!p)throw new Error("failed to create canvas 2d context");return u.width=i.width,u.height=i.height,p.drawImage(i,0,0,i.width,i.height),p.getImageData(-a,-a,i.width+2*a,i.height+2*a)},resolveURL:function(i){return Qt||(Qt=C.document.createElement("a")),Qt.href=i,Qt.href},hardwareConcurrency:C.navigator&&C.navigator.hardwareConcurrency||4,get devicePixelRatio(){return C.devicePixelRatio},get prefersReducedMotion(){return!!C.matchMedia&&(en==null&&(en=C.matchMedia("(prefers-reduced-motion: reduce)")),en.matches)}},Dt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Dn={supported:!1,testSupport:function(i){!go&&Ir&&(Hr?Vt(i):vi=i)}},go=!1,Hr=!1;function Vt(i){var a=i.createTexture();i.bindTexture(i.TEXTURE_2D,a);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,Ir),i.isContextLost())return;Dn.supported=!0}catch{}i.deleteTexture(a),go=!0}C.document&&((Ir=C.document.createElement("img")).onload=function(){vi&&Vt(vi),vi=null,Hr=!0},Ir.onerror=function(){go=!0,vi=null},Ir.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var xi="01",hr=function(i,a){this._transformRequestFn=i,this._customAccessToken=a,this._createSkuToken()};function Zn(i){return i.indexOf("mapbox:")===0}hr.prototype._createSkuToken=function(){var i=function(){for(var a="",u=0;u<10;u++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",xi,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt},hr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},hr.prototype.transformRequest=function(i,a){return this._transformRequestFn&&this._transformRequestFn(i,a)||{url:i}},hr.prototype.normalizeStyleURL=function(i,a){if(!Zn(i))return i;var u=qr(i);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||a)},hr.prototype.normalizeGlyphsURL=function(i,a){if(!Zn(i))return i;var u=qr(i);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||a)},hr.prototype.normalizeSourceURL=function(i,a){if(!Zn(i))return i;var u=qr(i);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||a)},hr.prototype.normalizeSpriteURL=function(i,a,u,p){var m=qr(i);return Zn(i)?(m.path="/styles/v1"+m.path+"/sprite"+a+u,this._makeAPIURL(m,this._customAccessToken||p)):(m.path+=""+a+u,_r(m))},hr.prototype.normalizeTileURL=function(i,a){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!Zn(i))return i;var u=qr(i);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Wr.devicePixelRatio>=2||a===512?"@2x":"")+(Dn.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var p=this._customAccessToken||function(m){for(var v=0,x=m;v<x.length;v+=1){var T=x[v].match(/^access_token=(.*)$/);if(T)return T[1]}return null}(u.params)||Dt.ACCESS_TOKEN;return Dt.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,p)},hr.prototype.canonicalizeTileURL=function(i,a){var u=qr(i);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return i;var p="mapbox://tiles/";p+=u.path.replace("/v4/","");var m=u.params;return a&&(m=m.filter(function(v){return!v.match(/^access_token=/)})),m.length&&(p+="?"+m.join("&")),p},hr.prototype.canonicalizeTileset=function(i,a){for(var u=!!a&&Zn(a),p=[],m=0,v=i.tiles||[];m<v.length;m+=1){var x=v[m];bi(x)?p.push(this.canonicalizeTileURL(x,u)):p.push(x)}return p},hr.prototype._makeAPIURL=function(i,a){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",p=qr(Dt.API_URL);if(i.protocol=p.protocol,i.authority=p.authority,i.protocol==="http"){var m=i.params.indexOf("secure");m>=0&&i.params.splice(m,1)}if(p.path!=="/"&&(i.path=""+p.path+i.path),!Dt.REQUIRE_ACCESS_TOKEN)return _r(i);if(!(a=a||Dt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if(a[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return i.params=i.params.filter(function(v){return v.indexOf("access_token")===-1}),i.params.push("access_token="+a),_r(i)};var yo=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function bi(i){return yo.test(i)}var Aa=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function qr(i){var a=i.match(Aa);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function _r(i){var a=i.params.length?"?"+i.params.join("&"):"";return i.protocol+"://"+i.authority+i.path+a}function Pa(i){if(!i)return null;var a=i.split(".");if(!a||a.length!==3)return null;try{return JSON.parse(decodeURIComponent(C.atob(a[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var wi=function(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};wi.prototype.getStorageKey=function(i){var a,u=Pa(Dt.ACCESS_TOKEN);return a=u&&u.u?C.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(p,m){return String.fromCharCode(+("0x"+m))})):Dt.ACCESS_TOKEN||"",i?"mapbox.eventData."+i+":"+a:"mapbox.eventData:"+a},wi.prototype.fetchEventData=function(){var i=Ot("localStorage"),a=this.getStorageKey(),u=this.getStorageKey("uuid");if(i)try{var p=C.localStorage.getItem(a);p&&(this.eventData=JSON.parse(p));var m=C.localStorage.getItem(u);m&&(this.anonId=m)}catch{ft("Unable to read from LocalStorage")}},wi.prototype.saveEventData=function(){var i=Ot("localStorage"),a=this.getStorageKey(),u=this.getStorageKey("uuid");if(i)try{C.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&C.localStorage.setItem(a,JSON.stringify(this.eventData))}catch{ft("Unable to write to LocalStorage")}},wi.prototype.processRequests=function(i){},wi.prototype.postEvent=function(i,a,u,p){var m=this;if(Dt.EVENTS_URL){var v=qr(Dt.EVENTS_URL);v.params.push("access_token="+(p||Dt.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(i).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:xi,userId:this.anonId},T=a?U(x,a):x,P={url:_r(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([T])};this.pendingRequest=zn(P,function(M){m.pendingRequest=null,u(M),m.saveEventData(),m.processRequests(p)})}},wi.prototype.queueRequest=function(i,a){this.queue.push(i),this.processRequests(a)};var Ei,ta,Ui=function(i){function a(){i.call(this,"map.load"),this.success={},this.skuToken=""}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.postMapLoadEvent=function(u,p,m,v){this.skuToken=m;var x=!(!v&&!Dt.ACCESS_TOKEN),T=Array.isArray(u)&&u.some(function(P){return Zn(P)||bi(P)});Dt.EVENTS_URL&&x&&T&&this.queueRequest({id:p,timestamp:Date.now()},v)},a.prototype.processRequests=function(u){var p=this;if(!this.pendingRequest&&this.queue.length!==0){var m=this.queue.shift(),v=m.id,x=m.timestamp;v&&this.success[v]||(this.anonId||this.fetchEventData(),xe(this.anonId)||(this.anonId=ye()),this.postEvent(x,{skuToken:this.skuToken},function(T){T||v&&(p.success[v]=!0)},u))}},a}(wi),xs=new(function(i){function a(u){i.call(this,"appUserTurnstile"),this._customAccessToken=u}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.postTurnstileEvent=function(u,p){Dt.EVENTS_URL&&Dt.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(m){return Zn(m)||bi(m)})&&this.queueRequest(Date.now(),p)},a.prototype.processRequests=function(u){var p=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var m=Pa(Dt.ACCESS_TOKEN),v=m?m.u:Dt.ACCESS_TOKEN,x=v!==this.eventData.tokenU;xe(this.anonId)||(this.anonId=ye(),x=!0);var T=this.queue.shift();if(this.eventData.lastSuccess){var P=new Date(this.eventData.lastSuccess),M=new Date(T),L=(T-this.eventData.lastSuccess)/864e5;x=x||L>=1||L<-1||P.getDate()!==M.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(T,{"enabled.telemetry":!1},function(R){R||(p.eventData.lastSuccess=T,p.eventData.tokenU=v)},u)}},a}(wi)),bs=xs.postTurnstileEvent.bind(xs),Ia=new Ui,Ca=Ia.postMapLoadEvent.bind(Ia),vo=500,Ma=50;function ka(){C.caches&&!Ei&&(Ei=C.caches.open("mapbox-tiles"))}function ws(i){var a=i.indexOf("?");return a<0?i:i.slice(0,a)}var na,Es=1/0;function Ts(){return na==null&&(na=C.OffscreenCanvas&&new C.OffscreenCanvas(1,1).getContext("2d")&&typeof C.createImageBitmap=="function"),na}var ra={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ra);var _l=function(i){function a(u,p,m){p===401&&bi(m)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),i.call(this,u),this.status=p,this.url=m,this.name=this.constructor.name,this.message=u}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},a}(Error),ia=rr()?function(){return self.worker&&self.worker.referrer}:function(){return(C.location.protocol==="blob:"?C.parent:C).location.href},Qi,eo,Fo=function(i,a){if(!(/^file:/.test(u=i.url)||/^file:/.test(ia())&&!/^\w+:/.test(u))){if(C.fetch&&C.Request&&C.AbortController&&C.Request.prototype.hasOwnProperty("signal"))return function(p,m){var v,x=new C.AbortController,T=new C.Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:ia(),signal:x.signal}),P=!1,M=!1,L=(v=T.url).indexOf("sku=")>0&&bi(v);p.type==="json"&&T.headers.set("Accept","application/json");var R=function(V,te,ne){if(!M){if(V&&V.message!=="SecurityError"&&ft(V),te&&ne)return F(te);var ce=Date.now();C.fetch(T).then(function(se){if(se.ok){var ve=L?se.clone():null;return F(se,ve,ce)}return m(new _l(se.statusText,se.status,p.url))}).catch(function(se){se.code!==20&&m(new Error(se.message))})}},F=function(V,te,ne){(p.type==="arrayBuffer"?V.arrayBuffer():p.type==="json"?V.json():V.text()).then(function(ce){M||(te&&ne&&function(se,ve,we){if(ka(),Ei){var Ae={status:ve.status,statusText:ve.statusText,headers:new C.Headers};ve.headers.forEach(function(Oe,je){return Ae.headers.set(je,Oe)});var Ie=Pr(ve.headers.get("Cache-Control")||"");Ie["no-store"]||(Ie["max-age"]&&Ae.headers.set("Expires",new Date(we+1e3*Ie["max-age"]).toUTCString()),new Date(Ae.headers.get("Expires")).getTime()-we<42e4||function(Oe,je){if(ta===void 0)try{new Response(new ReadableStream),ta=!0}catch{ta=!1}ta?je(Oe.body):Oe.blob().then(je)}(ve,function(Oe){var je=new C.Response(Oe,Ae);ka(),Ei&&Ei.then(function(Xe){return Xe.put(ws(se.url),je)}).catch(function(Xe){return ft(Xe.message)})}))}}(T,te,ne),P=!0,m(null,ce,V.headers.get("Cache-Control"),V.headers.get("Expires")))}).catch(function(ce){M||m(new Error(ce.message))})};return L?function(V,te){if(ka(),!Ei)return te(null);var ne=ws(V.url);Ei.then(function(ce){ce.match(ne).then(function(se){var ve=function(we){if(!we)return!1;var Ae=new Date(we.headers.get("Expires")||0),Ie=Pr(we.headers.get("Cache-Control")||"");return Ae>Date.now()&&!Ie["no-cache"]}(se);ce.delete(ne),ve&&ce.put(ne,se.clone()),te(null,se,ve)}).catch(te)}).catch(te)}(T,R):R(null,null),{cancel:function(){M=!0,P||x.abort()}}}(i,a);if(rr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,a,void 0,!0)}var u;return function(p,m){var v=new C.XMLHttpRequest;for(var x in v.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(v.responseType="arraybuffer"),p.headers)v.setRequestHeader(x,p.headers[x]);return p.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=p.credentials==="include",v.onerror=function(){m(new Error(v.statusText))},v.onload=function(){if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){var T=v.response;if(p.type==="json")try{T=JSON.parse(v.response)}catch(P){return m(P)}m(null,T,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else m(new _l(v.statusText,v.status,p.url))},v.send(p.body),{cancel:function(){return v.abort()}}}(i,a)},Ss=function(i,a){return Fo(U(i,{type:"arrayBuffer"}),a)},zn=function(i,a){return Fo(U(i,{method:"POST"}),a)},O="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Qi=[],eo=0;var N=function(i,a){if(Dn.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),eo>=Dt.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:i,callback:a,cancelled:!1,cancel:function(){this.cancelled=!0}};return Qi.push(u),u}eo++;var p=!1,m=function(){if(!p)for(p=!0,eo--;Qi.length&&eo<Dt.MAX_PARALLEL_IMAGE_REQUESTS;){var x=Qi.shift();x.cancelled||(x.cancel=N(x.requestParameters,x.callback).cancel)}},v=Ss(i,function(x,T,P,M){m(),x?a(x):T&&(Ts()?function(L,R){var F=new C.Blob([new Uint8Array(L)],{type:"image/png"});C.createImageBitmap(F).then(function(V){R(null,V)}).catch(function(V){R(new Error("Could not load image because of "+V.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(T,a):function(L,R,F,V){var te=new C.Image,ne=C.URL;te.onload=function(){R(null,te),ne.revokeObjectURL(te.src),te.onload=null,C.requestAnimationFrame(function(){te.src=O})},te.onerror=function(){return R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var ce=new C.Blob([new Uint8Array(L)],{type:"image/png"});te.cacheControl=F,te.expires=V,te.src=L.byteLength?ne.createObjectURL(ce):O}(T,a,P,M))});return{cancel:function(){v.cancel(),m()}}};function j(i,a,u){u[i]&&u[i].indexOf(a)!==-1||(u[i]=u[i]||[],u[i].push(a))}function J(i,a,u){if(u&&u[i]){var p=u[i].indexOf(a);p!==-1&&u[i].splice(p,1)}}var ie=function(i,a){a===void 0&&(a={}),U(this,a),this.type=i},de=function(i){function a(u,p){p===void 0&&(p={}),i.call(this,"error",U({error:u},p))}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a}(ie),me=function(){};me.prototype.on=function(i,a){return this._listeners=this._listeners||{},j(i,a,this._listeners),this},me.prototype.off=function(i,a){return J(i,a,this._listeners),J(i,a,this._oneTimeListeners),this},me.prototype.once=function(i,a){return this._oneTimeListeners=this._oneTimeListeners||{},j(i,a,this._oneTimeListeners),this},me.prototype.fire=function(i,a){typeof i=="string"&&(i=new ie(i,a||{}));var u=i.type;if(this.listens(u)){i.target=this;for(var p=0,m=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];p<m.length;p+=1)m[p].call(this,i);for(var v=0,x=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];v<x.length;v+=1){var T=x[v];J(u,T,this._oneTimeListeners),T.call(this,i)}var P=this._eventedParent;P&&(U(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),P.fire(i))}else i instanceof de&&console.error(i.error);return this},me.prototype.listens=function(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)},me.prototype.setEventedParent=function(i,a){return this._eventedParent=i,this._eventedParentData=a,this};var X={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},ae=function(i,a,u,p){this.message=(i?i+": ":"")+u,p&&(this.identifier=p),a!=null&&a.__line__&&(this.line=a.__line__)};function _e(i){var a=i.value;return a?[new ae(i.key,a,"constants have been deprecated as of v8")]:[]}function Be(i){for(var a=[],u=arguments.length-1;u-- >0;)a[u]=arguments[u+1];for(var p=0,m=a;p<m.length;p+=1){var v=m[p];for(var x in v)i[x]=v[x]}return i}function Ue(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Me(i){if(Array.isArray(i))return i.map(Me);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){var a={};for(var u in i)a[u]=Me(i[u]);return a}return Ue(i)}var Ne=function(i){function a(u,p){i.call(this,p),this.message=p,this.key=u}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a}(Error),at=function(i,a){a===void 0&&(a=[]),this.parent=i,this.bindings={};for(var u=0,p=a;u<p.length;u+=1){var m=p[u];this.bindings[m[0]]=m[1]}};at.prototype.concat=function(i){return new at(this,i)},at.prototype.get=function(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(i+" not found in scope.")},at.prototype.has=function(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)};var rt={kind:"null"},Le={kind:"number"},Je={kind:"string"},qe={kind:"boolean"},Ze={kind:"color"},kt={kind:"object"},$e={kind:"value"},Ht={kind:"collator"},pn={kind:"formatted"},Gt={kind:"resolvedImage"};function $t(i,a){return{kind:"array",itemType:i,N:a}}function Lt(i){if(i.kind==="array"){var a=Lt(i.itemType);return typeof i.N=="number"?"array<"+a+", "+i.N+">":i.itemType.kind==="value"?"array":"array<"+a+">"}return i.kind}var Xn=[rt,Le,Je,qe,Ze,pn,kt,$t($e),Gt];function Xt(i,a){if(a.kind==="error")return null;if(i.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!Xt(i.itemType,a.itemType))&&(typeof i.N!="number"||i.N===a.N))return null}else{if(i.kind===a.kind)return null;if(i.kind==="value"){for(var u=0,p=Xn;u<p.length;u+=1)if(!Xt(p[u],a))return null}}return"Expected "+Lt(i)+" but found "+Lt(a)+" instead."}function dn(i,a){return a.some(function(u){return u.kind===i.kind})}function on(i,a){return a.some(function(u){return u==="null"?i===null:u==="array"?Array.isArray(i):u==="object"?i&&!Array.isArray(i)&&typeof i=="object":u===typeof i})}var Rt=g(function(i,a){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function p(T){return(T=Math.round(T))<0?0:T>255?255:T}function m(T){return p(T[T.length-1]==="%"?parseFloat(T)/100*255:parseInt(T))}function v(T){return(P=T[T.length-1]==="%"?parseFloat(T)/100:parseFloat(T))<0?0:P>1?1:P;var P}function x(T,P,M){return M<0?M+=1:M>1&&(M-=1),6*M<1?T+(P-T)*M*6:2*M<1?P:3*M<2?T+(P-T)*(2/3-M)*6:T}try{a.parseCSSColor=function(T){var P,M=T.replace(/ /g,"").toLowerCase();if(M in u)return u[M].slice();if(M[0]==="#")return M.length===4?(P=parseInt(M.substr(1),16))>=0&&P<=4095?[(3840&P)>>4|(3840&P)>>8,240&P|(240&P)>>4,15&P|(15&P)<<4,1]:null:M.length===7&&(P=parseInt(M.substr(1),16))>=0&&P<=16777215?[(16711680&P)>>16,(65280&P)>>8,255&P,1]:null;var L=M.indexOf("("),R=M.indexOf(")");if(L!==-1&&R+1===M.length){var F=M.substr(0,L),V=M.substr(L+1,R-(L+1)).split(","),te=1;switch(F){case"rgba":if(V.length!==4)return null;te=v(V.pop());case"rgb":return V.length!==3?null:[m(V[0]),m(V[1]),m(V[2]),te];case"hsla":if(V.length!==4)return null;te=v(V.pop());case"hsl":if(V.length!==3)return null;var ne=(parseFloat(V[0])%360+360)%360/360,ce=v(V[1]),se=v(V[2]),ve=se<=.5?se*(ce+1):se+ce-se*ce,we=2*se-ve;return[p(255*x(we,ve,ne+1/3)),p(255*x(we,ve,ne)),p(255*x(we,ve,ne-1/3)),te];default:return null}}return null}}catch{}}).parseCSSColor,Wt=function(i,a,u,p){p===void 0&&(p=1),this.r=i,this.g=a,this.b=u,this.a=p};Wt.parse=function(i){if(i){if(i instanceof Wt)return i;if(typeof i=="string"){var a=Rt(i);if(a)return new Wt(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3])}}},Wt.prototype.toString=function(){var i=this.toArray(),a=i[1],u=i[2],p=i[3];return"rgba("+Math.round(i[0])+","+Math.round(a)+","+Math.round(u)+","+p+")"},Wt.prototype.toArray=function(){var i=this.a;return i===0?[0,0,0,0]:[255*this.r/i,255*this.g/i,255*this.b/i,i]},Wt.black=new Wt(0,0,0,1),Wt.white=new Wt(1,1,1,1),Wt.transparent=new Wt(0,0,0,0),Wt.red=new Wt(1,0,0,1);var zr=function(i,a,u){this.sensitivity=i?a?"variant":"case":a?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};zr.prototype.compare=function(i,a){return this.collator.compare(i,a)},zr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var La=function(i,a,u,p,m){this.text=i,this.image=a,this.scale=u,this.fontStack=p,this.textColor=m},Un=function(i){this.sections=i};Un.fromString=function(i){return new Un([new La(i,null,null,null,null)])},Un.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(i){return i.text.length!==0||i.image&&i.image.name.length!==0})},Un.factory=function(i){return i instanceof Un?i:Un.fromString(i)},Un.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(i){return i.text}).join("")},Un.prototype.serialize=function(){for(var i=["format"],a=0,u=this.sections;a<u.length;a+=1){var p=u[a];if(p.image)i.push(["image",p.image.name]);else{i.push(p.text);var m={};p.fontStack&&(m["text-font"]=["literal",p.fontStack.split(",")]),p.scale&&(m["font-scale"]=p.scale),p.textColor&&(m["text-color"]=["rgba"].concat(p.textColor.toArray())),i.push(m)}}return i};var Pn=function(i){this.name=i.name,this.available=i.available};function Ra(i,a,u,p){return typeof i=="number"&&i>=0&&i<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof u=="number"&&u>=0&&u<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:"Invalid rgba value ["+[i,a,u,p].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof p=="number"?[i,a,u,p]:[i,a,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function oa(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Wt||i instanceof zr||i instanceof Un||i instanceof Pn)return!0;if(Array.isArray(i)){for(var a=0,u=i;a<u.length;a+=1)if(!oa(u[a]))return!1;return!0}if(typeof i=="object"){for(var p in i)if(!oa(i[p]))return!1;return!0}return!1}function In(i){if(i===null)return rt;if(typeof i=="string")return Je;if(typeof i=="boolean")return qe;if(typeof i=="number")return Le;if(i instanceof Wt)return Ze;if(i instanceof zr)return Ht;if(i instanceof Un)return pn;if(i instanceof Pn)return Gt;if(Array.isArray(i)){for(var a,u=i.length,p=0,m=i;p<m.length;p+=1){var v=In(m[p]);if(a){if(a===v)continue;a=$e;break}a=v}return $t(a||$e,u)}return kt}function aa(i){var a=typeof i;return i===null?"":a==="string"||a==="number"||a==="boolean"?String(i):i instanceof Wt||i instanceof Un||i instanceof Pn?i.toString():JSON.stringify(i)}Pn.prototype.toString=function(){return this.name},Pn.fromString=function(i){return i?new Pn({name:i,available:!1}):null},Pn.prototype.serialize=function(){return["image",this.name]};var xr=function(i,a){this.type=i,this.value=a};xr.parse=function(i,a){if(i.length!==2)return a.error("'literal' expression requires exactly one argument, but found "+(i.length-1)+" instead.");if(!oa(i[1]))return a.error("invalid value");var u=i[1],p=In(u),m=a.expectedType;return p.kind!=="array"||p.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(p=m),new xr(p,u)},xr.prototype.evaluate=function(){return this.value},xr.prototype.eachChild=function(){},xr.prototype.outputDefined=function(){return!0},xr.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Wt?["rgba"].concat(this.value.toArray()):this.value instanceof Un?this.value.serialize():this.value};var jn=function(i){this.name="ExpressionEvaluationError",this.message=i};jn.prototype.toJSON=function(){return this.message};var ir={string:Je,number:Le,boolean:qe,object:kt},bn=function(i,a){this.type=i,this.args=a};bn.parse=function(i,a){if(i.length<2)return a.error("Expected at least one argument.");var u,p=1,m=i[0];if(m==="array"){var v,x;if(i.length>2){var T=i[1];if(typeof T!="string"||!(T in ir)||T==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);v=ir[T],p++}else v=$e;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return a.error('The length argument to "array" must be a positive integer literal',2);x=i[2],p++}u=$t(v,x)}else u=ir[m];for(var P=[];p<i.length;p++){var M=a.parse(i[p],p,$e);if(!M)return null;P.push(M)}return new bn(u,P)},bn.prototype.evaluate=function(i){for(var a=0;a<this.args.length;a++){var u=this.args[a].evaluate(i);if(!Xt(this.type,In(u)))return u;if(a===this.args.length-1)throw new jn("Expected value to be of type "+Lt(this.type)+", but found "+Lt(In(u))+" instead.")}return null},bn.prototype.eachChild=function(i){this.args.forEach(i)},bn.prototype.outputDefined=function(){return this.args.every(function(i){return i.outputDefined()})},bn.prototype.serialize=function(){var i=this.type,a=[i.kind];if(i.kind==="array"){var u=i.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){a.push(u.kind);var p=i.N;(typeof p=="number"||this.args.length>1)&&a.push(p)}}return a.concat(this.args.map(function(m){return m.serialize()}))};var Ti=function(i){this.type=pn,this.sections=i};Ti.parse=function(i,a){if(i.length<2)return a.error("Expected at least one argument.");var u=i[1];if(!Array.isArray(u)&&typeof u=="object")return a.error("First argument must be an image or text section.");for(var p=[],m=!1,v=1;v<=i.length-1;++v){var x=i[v];if(m&&typeof x=="object"&&!Array.isArray(x)){m=!1;var T=null;if(x["font-scale"]&&!(T=a.parse(x["font-scale"],1,Le)))return null;var P=null;if(x["text-font"]&&!(P=a.parse(x["text-font"],1,$t(Je))))return null;var M=null;if(x["text-color"]&&!(M=a.parse(x["text-color"],1,Ze)))return null;var L=p[p.length-1];L.scale=T,L.font=P,L.textColor=M}else{var R=a.parse(i[v],1,$e);if(!R)return null;var F=R.type.kind;if(F!=="string"&&F!=="value"&&F!=="null"&&F!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,p.push({content:R,scale:null,font:null,textColor:null})}}return new Ti(p)},Ti.prototype.evaluate=function(i){return new Un(this.sections.map(function(a){var u=a.content.evaluate(i);return In(u)===Gt?new La("",u,null,null,null):new La(aa(u),null,a.scale?a.scale.evaluate(i):null,a.font?a.font.evaluate(i).join(","):null,a.textColor?a.textColor.evaluate(i):null)}))},Ti.prototype.eachChild=function(i){for(var a=0,u=this.sections;a<u.length;a+=1){var p=u[a];i(p.content),p.scale&&i(p.scale),p.font&&i(p.font),p.textColor&&i(p.textColor)}},Ti.prototype.outputDefined=function(){return!1},Ti.prototype.serialize=function(){for(var i=["format"],a=0,u=this.sections;a<u.length;a+=1){var p=u[a];i.push(p.content.serialize());var m={};p.scale&&(m["font-scale"]=p.scale.serialize()),p.font&&(m["text-font"]=p.font.serialize()),p.textColor&&(m["text-color"]=p.textColor.serialize()),i.push(m)}return i};var Zr=function(i){this.type=Gt,this.input=i};Zr.parse=function(i,a){if(i.length!==2)return a.error("Expected two arguments.");var u=a.parse(i[1],1,Je);return u?new Zr(u):a.error("No image name provided.")},Zr.prototype.evaluate=function(i){var a=this.input.evaluate(i),u=Pn.fromString(a);return u&&i.availableImages&&(u.available=i.availableImages.indexOf(a)>-1),u},Zr.prototype.eachChild=function(i){i(this.input)},Zr.prototype.outputDefined=function(){return!1},Zr.prototype.serialize=function(){return["image",this.input.serialize()]};var yu={"to-boolean":qe,"to-color":Ze,"to-number":Le,"to-string":Je},Si=function(i,a){this.type=i,this.args=a};Si.parse=function(i,a){if(i.length<2)return a.error("Expected at least one argument.");var u=i[0];if((u==="to-boolean"||u==="to-string")&&i.length!==2)return a.error("Expected one argument.");for(var p=yu[u],m=[],v=1;v<i.length;v++){var x=a.parse(i[v],v,$e);if(!x)return null;m.push(x)}return new Si(p,m)},Si.prototype.evaluate=function(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){for(var a,u,p=0,m=this.args;p<m.length;p+=1){if(u=null,(a=m[p].evaluate(i))instanceof Wt)return a;if(typeof a=="string"){var v=i.parseColor(a);if(v)return v}else if(Array.isArray(a)&&!(u=a.length<3||a.length>4?"Invalid rbga value "+JSON.stringify(a)+": expected an array containing either three or four numeric values.":Ra(a[0],a[1],a[2],a[3])))return new Wt(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new jn(u||"Could not parse color from value '"+(typeof a=="string"?a:String(JSON.stringify(a)))+"'")}if(this.type.kind==="number"){for(var x=null,T=0,P=this.args;T<P.length;T+=1){if((x=P[T].evaluate(i))===null)return 0;var M=Number(x);if(!isNaN(M))return M}throw new jn("Could not convert "+JSON.stringify(x)+" to number.")}return this.type.kind==="formatted"?Un.fromString(aa(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?Pn.fromString(aa(this.args[0].evaluate(i))):aa(this.args[0].evaluate(i))},Si.prototype.eachChild=function(i){this.args.forEach(i)},Si.prototype.outputDefined=function(){return this.args.every(function(i){return i.outputDefined()})},Si.prototype.serialize=function(){if(this.type.kind==="formatted")return new Ti([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Zr(this.args[0]).serialize();var i=["to-"+this.type.kind];return this.eachChild(function(a){i.push(a.serialize())}),i};var Tf=["Unknown","Point","LineString","Polygon"],q=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};q.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},q.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Tf[this.feature.type]:this.feature.type:null},q.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},q.prototype.canonicalID=function(){return this.canonical},q.prototype.properties=function(){return this.feature&&this.feature.properties||{}},q.prototype.parseColor=function(i){var a=this._parseColorCache[i];return a||(a=this._parseColorCache[i]=Wt.parse(i)),a};var Q=function(i,a,u,p){this.name=i,this.type=a,this._evaluate=u,this.args=p};Q.prototype.evaluate=function(i){return this._evaluate(i,this.args)},Q.prototype.eachChild=function(i){this.args.forEach(i)},Q.prototype.outputDefined=function(){return!1},Q.prototype.serialize=function(){return[this.name].concat(this.args.map(function(i){return i.serialize()}))},Q.parse=function(i,a){var u,p=i[0],m=Q.definitions[p];if(!m)return a.error('Unknown expression "'+p+'". If you wanted a literal array, use ["literal", [...]].',0);for(var v=Array.isArray(m)?m[0]:m.type,x=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,T=x.filter(function(mt){var et=mt[0];return!Array.isArray(et)||et.length===i.length-1}),P=null,M=0,L=T;M<L.length;M+=1){var R=L[M],F=R[0],V=R[1];P=new Ba(a.registry,a.path,null,a.scope);for(var te=[],ne=!1,ce=1;ce<i.length;ce++){var se=i[ce],ve=Array.isArray(F)?F[ce-1]:F.type,we=P.parse(se,1+te.length,ve);if(!we){ne=!0;break}te.push(we)}if(!ne)if(Array.isArray(F)&&F.length!==te.length)P.error("Expected "+F.length+" arguments, but found "+te.length+" instead.");else{for(var Ae=0;Ae<te.length;Ae++){var Ie=Array.isArray(F)?F[Ae]:F.type,Oe=te[Ae];P.concat(Ae+1).checkSubtype(Ie,Oe.type)}if(P.errors.length===0)return new Q(p,v,V,te)}}if(T.length===1)(u=a.errors).push.apply(u,P.errors);else{for(var je=(T.length?T:x).map(function(mt){var et;return et=mt[0],Array.isArray(et)?"("+et.map(Lt).join(", ")+")":"("+Lt(et.type)+"...)"}).join(" | "),Xe=[],ct=1;ct<i.length;ct++){var Qe=a.parse(i[ct],1+Xe.length);if(!Qe)return null;Xe.push(Lt(Qe.type))}a.error("Expected arguments of type "+je+", but found ("+Xe.join(", ")+") instead.")}return null},Q.register=function(i,a){for(var u in Q.definitions=a,a)i[u]=Q};var pe=function(i,a,u){this.type=Ht,this.locale=u,this.caseSensitive=i,this.diacriticSensitive=a};function Se(i,a){i[0]=Math.min(i[0],a[0]),i[1]=Math.min(i[1],a[1]),i[2]=Math.max(i[2],a[0]),i[3]=Math.max(i[3],a[1])}function Ge(i,a){return!(i[0]<=a[0]||i[2]>=a[2]||i[1]<=a[1]||i[3]>=a[3])}function ht(i,a){var u=(180+i[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,m=Math.pow(2,a.z);return[Math.round(u*m*8192),Math.round(p*m*8192)]}function tn(i,a,u){return a[1]>i[1]!=u[1]>i[1]&&i[0]<(u[0]-a[0])*(i[1]-a[1])/(u[1]-a[1])+a[0]}function or(i,a){for(var u,p,m,v,x,T,P,M=!1,L=0,R=a.length;L<R;L++)for(var F=a[L],V=0,te=F.length;V<te-1;V++){if((v=(u=i)[0]-(p=F[V])[0])*(P=u[1]-(m=F[V+1])[1])-(T=u[0]-m[0])*(x=u[1]-p[1])==0&&v*T<=0&&x*P<=0)return!1;tn(i,F[V],F[V+1])&&(M=!M)}return M}function Cr(i,a){for(var u=0;u<a.length;u++)if(or(i,a[u]))return!0;return!1}function Br(i,a,u,p){var m=p[0]-u[0],v=p[1]-u[1],x=(i[0]-u[0])*v-m*(i[1]-u[1]),T=(a[0]-u[0])*v-m*(a[1]-u[1]);return x>0&&T<0||x<0&&T>0}function to(i,a,u){for(var p=0,m=u;p<m.length;p+=1)for(var v=m[p],x=0;x<v.length-1;++x)if((R=[(L=v[x+1])[0]-(M=v[x])[0],L[1]-M[1]])[0]*(F=[(P=a)[0]-(T=i)[0],P[1]-T[1]])[1]-R[1]*F[0]!=0&&Br(T,P,M,L)&&Br(M,L,T,P))return!0;var T,P,M,L,R,F;return!1}function qd(i,a){for(var u=0;u<i.length;++u)if(!or(i[u],a))return!1;for(var p=0;p<i.length-1;++p)if(to(i[p],i[p+1],a))return!1;return!0}function Zd(i,a){for(var u=0;u<a.length;u++)if(qd(i,a[u]))return!0;return!1}function xl(i,a,u){for(var p=[],m=0;m<i.length;m++){for(var v=[],x=0;x<i[m].length;x++){var T=ht(i[m][x],u);Se(a,T),v.push(T)}p.push(v)}return p}function Sf(i,a,u){for(var p=[],m=0;m<i.length;m++){var v=xl(i[m],a,u);p.push(v)}return p}function vu(i,a,u,p){if(i[0]<u[0]||i[0]>u[2]){var m=.5*p,v=i[0]-u[0]>m?-p:u[0]-i[0]>m?p:0;v===0&&(v=i[0]-u[2]>m?-p:u[2]-i[0]>m?p:0),i[0]+=v}Se(a,i)}function Xd(i,a,u,p){for(var m=8192*Math.pow(2,p.z),v=[8192*p.x,8192*p.y],x=[],T=0,P=i;T<P.length;T+=1)for(var M=0,L=P[T];M<L.length;M+=1){var R=L[M],F=[R.x+v[0],R.y+v[1]];vu(F,a,u,m),x.push(F)}return x}function Ec(i,a,u,p){for(var m,v=8192*Math.pow(2,p.z),x=[8192*p.x,8192*p.y],T=[],P=0,M=i;P<M.length;P+=1){for(var L=[],R=0,F=M[P];R<F.length;R+=1){var V=F[R],te=[V.x+x[0],V.y+x[1]];Se(a,te),L.push(te)}T.push(L)}if(a[2]-a[0]<=v/2){(m=a)[0]=m[1]=1/0,m[2]=m[3]=-1/0;for(var ne=0,ce=T;ne<ce.length;ne+=1)for(var se=0,ve=ce[ne];se<ve.length;se+=1)vu(ve[se],a,u,v)}return T}pe.parse=function(i,a){if(i.length!==2)return a.error("Expected one argument.");var u=i[1];if(typeof u!="object"||Array.isArray(u))return a.error("Collator options argument must be an object.");var p=a.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,qe);if(!p)return null;var m=a.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,qe);if(!m)return null;var v=null;return u.locale&&!(v=a.parse(u.locale,1,Je))?null:new pe(p,m,v)},pe.prototype.evaluate=function(i){return new zr(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)},pe.prototype.eachChild=function(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)},pe.prototype.outputDefined=function(){return!1},pe.prototype.serialize=function(){var i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]};var no=function(i,a){this.type=qe,this.geojson=i,this.geometries=a};function Oa(i){if(i instanceof Q&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof no)return!1;var a=!0;return i.eachChild(function(u){a&&!Oa(u)&&(a=!1)}),a}function Da(i){if(i instanceof Q&&i.name==="feature-state")return!1;var a=!0;return i.eachChild(function(u){a&&!Da(u)&&(a=!1)}),a}function As(i,a){if(i instanceof Q&&a.indexOf(i.name)>=0)return!1;var u=!0;return i.eachChild(function(p){u&&!As(p,a)&&(u=!1)}),u}no.parse=function(i,a){if(i.length!==2)return a.error("'within' expression requires exactly one argument, but found "+(i.length-1)+" instead.");if(oa(i[1])){var u=i[1];if(u.type==="FeatureCollection")for(var p=0;p<u.features.length;++p){var m=u.features[p].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new no(u,u.features[p].geometry)}else if(u.type==="Feature"){var v=u.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new no(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new no(u,u)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")},no.prototype.evaluate=function(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(a,u){var p=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(u.type==="Polygon"){var x=xl(u.coordinates,m,v),T=Xd(a.geometry(),p,m,v);if(!Ge(p,m))return!1;for(var P=0,M=T;P<M.length;P+=1)if(!or(M[P],x))return!1}if(u.type==="MultiPolygon"){var L=Sf(u.coordinates,m,v),R=Xd(a.geometry(),p,m,v);if(!Ge(p,m))return!1;for(var F=0,V=R;F<V.length;F+=1)if(!Cr(V[F],L))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(a,u){var p=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(u.type==="Polygon"){var x=xl(u.coordinates,m,v),T=Ec(a.geometry(),p,m,v);if(!Ge(p,m))return!1;for(var P=0,M=T;P<M.length;P+=1)if(!qd(M[P],x))return!1}if(u.type==="MultiPolygon"){var L=Sf(u.coordinates,m,v),R=Ec(a.geometry(),p,m,v);if(!Ge(p,m))return!1;for(var F=0,V=R;F<V.length;F+=1)if(!Zd(V[F],L))return!1}return!0}(i,this.geometries)}return!1},no.prototype.eachChild=function(){},no.prototype.outputDefined=function(){return!0},no.prototype.serialize=function(){return["within",this.geojson]};var za=function(i,a){this.type=a.type,this.name=i,this.boundExpression=a};za.parse=function(i,a){if(i.length!==2||typeof i[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");var u=i[1];return a.scope.has(u)?new za(u,a.scope.get(u)):a.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},za.prototype.evaluate=function(i){return this.boundExpression.evaluate(i)},za.prototype.eachChild=function(){},za.prototype.outputDefined=function(){return!1},za.prototype.serialize=function(){return["var",this.name]};var Ba=function(i,a,u,p,m){a===void 0&&(a=[]),p===void 0&&(p=new at),m===void 0&&(m=[]),this.registry=i,this.path=a,this.key=a.map(function(v){return"["+v+"]"}).join(""),this.scope=p,this.errors=m,this.expectedType=u};function Tc(i,a){for(var u,p=i.length-1,m=0,v=p,x=0;m<=v;)if((u=i[x=Math.floor((m+v)/2)])<=a){if(x===p||a<i[x+1])return x;m=x+1}else{if(!(u>a))throw new jn("Input is not a number.");v=x-1}return 0}Ba.prototype.parse=function(i,a,u,p,m){return m===void 0&&(m={}),a?this.concat(a,u,p)._parse(i,m):this._parse(i,m)},Ba.prototype._parse=function(i,a){function u(M,L,R){return R==="assert"?new bn(L,[M]):R==="coerce"?new Si(L,[M]):M}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var p=i[0];if(typeof p!="string")return this.error("Expression name must be a string, but found "+typeof p+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var m=this.registry[p];if(m){var v=m.parse(i,this);if(!v)return null;if(this.expectedType){var x=this.expectedType,T=v.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||T.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(x,T))return null}else v=u(v,x,a.typeAnnotation||"coerce");else v=u(v,x,a.typeAnnotation||"assert")}if(!(v instanceof xr)&&v.type.kind!=="resolvedImage"&&function M(L){if(L instanceof za)return M(L.boundExpression);if(L instanceof Q&&L.name==="error"||L instanceof pe||L instanceof no)return!1;var R=L instanceof Si||L instanceof bn,F=!0;return L.eachChild(function(V){F=R?F&&M(V):F&&V instanceof xr}),!!F&&Oa(L)&&As(L,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(v)){var P=new q;try{v=new xr(v.type,v.evaluate(P))}catch(M){return this.error(M.message),null}}return v}return this.error('Unknown expression "'+p+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof i+" instead.")},Ba.prototype.concat=function(i,a,u){var p=typeof i=="number"?this.path.concat(i):this.path,m=u?this.scope.concat(u):this.scope;return new Ba(this.registry,p,a||null,m,this.errors)},Ba.prototype.error=function(i){for(var a=[],u=arguments.length-1;u-- >0;)a[u]=arguments[u+1];var p=""+this.key+a.map(function(m){return"["+m+"]"}).join("");this.errors.push(new Ne(p,i))},Ba.prototype.checkSubtype=function(i,a){var u=Xt(i,a);return u&&this.error(u),u};var Ai=function(i,a,u){this.type=i,this.input=a,this.labels=[],this.outputs=[];for(var p=0,m=u;p<m.length;p+=1){var v=m[p],x=v[1];this.labels.push(v[0]),this.outputs.push(x)}};function ar(i,a,u){return i*(1-u)+a*u}Ai.parse=function(i,a){if(i.length-1<4)return a.error("Expected at least 4 arguments, but found only "+(i.length-1)+".");if((i.length-1)%2!=0)return a.error("Expected an even number of arguments.");var u=a.parse(i[1],1,Le);if(!u)return null;var p=[],m=null;a.expectedType&&a.expectedType.kind!=="value"&&(m=a.expectedType);for(var v=1;v<i.length;v+=2){var x=v===1?-1/0:i[v],T=i[v+1],P=v,M=v+1;if(typeof x!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(p.length&&p[p.length-1][0]>=x)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);var L=a.parse(T,M,m);if(!L)return null;m=m||L.type,p.push([x,L])}return new Ai(m,u,p)},Ai.prototype.evaluate=function(i){var a=this.labels,u=this.outputs;if(a.length===1)return u[0].evaluate(i);var p=this.input.evaluate(i);if(p<=a[0])return u[0].evaluate(i);var m=a.length;return p>=a[m-1]?u[m-1].evaluate(i):u[Tc(a,p)].evaluate(i)},Ai.prototype.eachChild=function(i){i(this.input);for(var a=0,u=this.outputs;a<u.length;a+=1)i(u[a])},Ai.prototype.outputDefined=function(){return this.outputs.every(function(i){return i.outputDefined()})},Ai.prototype.serialize=function(){for(var i=["step",this.input.serialize()],a=0;a<this.labels.length;a++)a>0&&i.push(this.labels[a]),i.push(this.outputs[a].serialize());return i};var bl=Object.freeze({__proto__:null,number:ar,color:function(i,a,u){return new Wt(ar(i.r,a.r,u),ar(i.g,a.g,u),ar(i.b,a.b,u),ar(i.a,a.a,u))},array:function(i,a,u){return i.map(function(p,m){return ar(p,a[m],u)})}}),Yd=6/29*3*(6/29),mv=Math.PI/180,gv=180/Math.PI;function Af(i){return i>.008856451679035631?Math.pow(i,1/3):i/Yd+4/29}function Pf(i){return i>6/29?i*i*i:Yd*(i-4/29)}function If(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function Cf(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function $d(i){var a=Cf(i.r),u=Cf(i.g),p=Cf(i.b),m=Af((.4124564*a+.3575761*u+.1804375*p)/.95047),v=Af((.2126729*a+.7151522*u+.072175*p)/1);return{l:116*v-16,a:500*(m-v),b:200*(v-Af((.0193339*a+.119192*u+.9503041*p)/1.08883)),alpha:i.a}}function Kd(i){var a=(i.l+16)/116,u=isNaN(i.a)?a:a+i.a/500,p=isNaN(i.b)?a:a-i.b/200;return a=1*Pf(a),u=.95047*Pf(u),p=1.08883*Pf(p),new Wt(If(3.2404542*u-1.5371385*a-.4985314*p),If(-.969266*u+1.8760108*a+.041556*p),If(.0556434*u-.2040259*a+1.0572252*p),i.alpha)}function yv(i,a,u){var p=a-i;return i+u*(p>180||p<-180?p-360*Math.round(p/360):p)}var _u={forward:$d,reverse:Kd,interpolate:function(i,a,u){return{l:ar(i.l,a.l,u),a:ar(i.a,a.a,u),b:ar(i.b,a.b,u),alpha:ar(i.alpha,a.alpha,u)}}},xu={forward:function(i){var a=$d(i),u=a.l,p=a.a,m=a.b,v=Math.atan2(m,p)*gv;return{h:v<0?v+360:v,c:Math.sqrt(p*p+m*m),l:u,alpha:i.a}},reverse:function(i){var a=i.h*mv,u=i.c;return Kd({l:i.l,a:Math.cos(a)*u,b:Math.sin(a)*u,alpha:i.alpha})},interpolate:function(i,a,u){return{h:yv(i.h,a.h,u),c:ar(i.c,a.c,u),l:ar(i.l,a.l,u),alpha:ar(i.alpha,a.alpha,u)}}},Jd=Object.freeze({__proto__:null,lab:_u,hcl:xu}),Nr=function(i,a,u,p,m){this.type=i,this.operator=a,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(var v=0,x=m;v<x.length;v+=1){var T=x[v],P=T[1];this.labels.push(T[0]),this.outputs.push(P)}};function Mf(i,a,u,p){var m=p-u,v=i-u;return m===0?0:a===1?v/m:(Math.pow(a,v)-1)/(Math.pow(a,m)-1)}Nr.interpolationFactor=function(i,a,u,p){var m=0;if(i.name==="exponential")m=Mf(a,i.base,u,p);else if(i.name==="linear")m=Mf(a,1,u,p);else if(i.name==="cubic-bezier"){var v=i.controlPoints;m=new y(v[0],v[1],v[2],v[3]).solve(Mf(a,1,u,p))}return m},Nr.parse=function(i,a){var u=i[0],p=i[1],m=i[2],v=i.slice(3);if(!Array.isArray(p)||p.length===0)return a.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){var x=p[1];if(typeof x!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:x}}else{if(p[0]!=="cubic-bezier")return a.error("Unknown interpolation type "+String(p[0]),1,0);var T=p.slice(1);if(T.length!==4||T.some(function(ce){return typeof ce!="number"||ce<0||ce>1}))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:T}}if(i.length-1<4)return a.error("Expected at least 4 arguments, but found only "+(i.length-1)+".");if((i.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(!(m=a.parse(m,2,Le)))return null;var P=[],M=null;u==="interpolate-hcl"||u==="interpolate-lab"?M=Ze:a.expectedType&&a.expectedType.kind!=="value"&&(M=a.expectedType);for(var L=0;L<v.length;L+=2){var R=v[L],F=v[L+1],V=L+3,te=L+4;if(typeof R!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(P.length&&P[P.length-1][0]>=R)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);var ne=a.parse(F,te,M);if(!ne)return null;M=M||ne.type,P.push([R,ne])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new Nr(M,u,p,m,P):a.error("Type "+Lt(M)+" is not interpolatable.")},Nr.prototype.evaluate=function(i){var a=this.labels,u=this.outputs;if(a.length===1)return u[0].evaluate(i);var p=this.input.evaluate(i);if(p<=a[0])return u[0].evaluate(i);var m=a.length;if(p>=a[m-1])return u[m-1].evaluate(i);var v=Tc(a,p),x=Nr.interpolationFactor(this.interpolation,p,a[v],a[v+1]),T=u[v].evaluate(i),P=u[v+1].evaluate(i);return this.operator==="interpolate"?bl[this.type.kind.toLowerCase()](T,P,x):this.operator==="interpolate-hcl"?xu.reverse(xu.interpolate(xu.forward(T),xu.forward(P),x)):_u.reverse(_u.interpolate(_u.forward(T),_u.forward(P),x))},Nr.prototype.eachChild=function(i){i(this.input);for(var a=0,u=this.outputs;a<u.length;a+=1)i(u[a])},Nr.prototype.outputDefined=function(){return this.outputs.every(function(i){return i.outputDefined()})},Nr.prototype.serialize=function(){var i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var a=[this.operator,i,this.input.serialize()],u=0;u<this.labels.length;u++)a.push(this.labels[u],this.outputs[u].serialize());return a};var Na=function(i,a){this.type=i,this.args=a};Na.parse=function(i,a){if(i.length<2)return a.error("Expectected at least one argument.");var u=null,p=a.expectedType;p&&p.kind!=="value"&&(u=p);for(var m=[],v=0,x=i.slice(1);v<x.length;v+=1){var T=a.parse(x[v],1+m.length,u,void 0,{typeAnnotation:"omit"});if(!T)return null;u=u||T.type,m.push(T)}var P=p&&m.some(function(M){return Xt(p,M.type)});return new Na(P?$e:u,m)},Na.prototype.evaluate=function(i){for(var a,u=null,p=0,m=0,v=this.args;m<v.length&&(p++,(u=v[m].evaluate(i))&&u instanceof Pn&&!u.available&&(a||(a=u.name),u=null,p===this.args.length&&(u=a)),u===null);m+=1);return u},Na.prototype.eachChild=function(i){this.args.forEach(i)},Na.prototype.outputDefined=function(){return this.args.every(function(i){return i.outputDefined()})},Na.prototype.serialize=function(){var i=["coalesce"];return this.eachChild(function(a){i.push(a.serialize())}),i};var Fa=function(i,a){this.type=a.type,this.bindings=[].concat(i),this.result=a};Fa.prototype.evaluate=function(i){return this.result.evaluate(i)},Fa.prototype.eachChild=function(i){for(var a=0,u=this.bindings;a<u.length;a+=1)i(u[a][1]);i(this.result)},Fa.parse=function(i,a){if(i.length<4)return a.error("Expected at least 3 arguments, but found "+(i.length-1)+" instead.");for(var u=[],p=1;p<i.length-1;p+=2){var m=i[p];if(typeof m!="string")return a.error("Expected string, but found "+typeof m+" instead.",p);if(/[^a-zA-Z0-9_]/.test(m))return a.error("Variable names must contain only alphanumeric characters or '_'.",p);var v=a.parse(i[p+1],p+1);if(!v)return null;u.push([m,v])}var x=a.parse(i[i.length-1],i.length-1,a.expectedType,u);return x?new Fa(u,x):null},Fa.prototype.outputDefined=function(){return this.result.outputDefined()},Fa.prototype.serialize=function(){for(var i=["let"],a=0,u=this.bindings;a<u.length;a+=1){var p=u[a];i.push(p[0],p[1].serialize())}return i.push(this.result.serialize()),i};var Ps=function(i,a,u){this.type=i,this.index=a,this.input=u};Ps.parse=function(i,a){if(i.length!==3)return a.error("Expected 2 arguments, but found "+(i.length-1)+" instead.");var u=a.parse(i[1],1,Le),p=a.parse(i[2],2,$t(a.expectedType||$e));return u&&p?new Ps(p.type.itemType,u,p):null},Ps.prototype.evaluate=function(i){var a=this.index.evaluate(i),u=this.input.evaluate(i);if(a<0)throw new jn("Array index out of bounds: "+a+" < 0.");if(a>=u.length)throw new jn("Array index out of bounds: "+a+" > "+(u.length-1)+".");if(a!==Math.floor(a))throw new jn("Array index must be an integer, but found "+a+" instead.");return u[a]},Ps.prototype.eachChild=function(i){i(this.index),i(this.input)},Ps.prototype.outputDefined=function(){return!1},Ps.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Is=function(i,a){this.type=qe,this.needle=i,this.haystack=a};Is.parse=function(i,a){if(i.length!==3)return a.error("Expected 2 arguments, but found "+(i.length-1)+" instead.");var u=a.parse(i[1],1,$e),p=a.parse(i[2],2,$e);return u&&p?dn(u.type,[qe,Je,Le,rt,$e])?new Is(u,p):a.error("Expected first argument to be of type boolean, string, number or null, but found "+Lt(u.type)+" instead"):null},Is.prototype.evaluate=function(i){var a=this.needle.evaluate(i),u=this.haystack.evaluate(i);if(!u)return!1;if(!on(a,["boolean","string","number","null"]))throw new jn("Expected first argument to be of type boolean, string, number or null, but found "+Lt(In(a))+" instead.");if(!on(u,["string","array"]))throw new jn("Expected second argument to be of type array or string, but found "+Lt(In(u))+" instead.");return u.indexOf(a)>=0},Is.prototype.eachChild=function(i){i(this.needle),i(this.haystack)},Is.prototype.outputDefined=function(){return!0},Is.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ua=function(i,a,u){this.type=Le,this.needle=i,this.haystack=a,this.fromIndex=u};Ua.parse=function(i,a){if(i.length<=2||i.length>=5)return a.error("Expected 3 or 4 arguments, but found "+(i.length-1)+" instead.");var u=a.parse(i[1],1,$e),p=a.parse(i[2],2,$e);if(!u||!p)return null;if(!dn(u.type,[qe,Je,Le,rt,$e]))return a.error("Expected first argument to be of type boolean, string, number or null, but found "+Lt(u.type)+" instead");if(i.length===4){var m=a.parse(i[3],3,Le);return m?new Ua(u,p,m):null}return new Ua(u,p)},Ua.prototype.evaluate=function(i){var a=this.needle.evaluate(i),u=this.haystack.evaluate(i);if(!on(a,["boolean","string","number","null"]))throw new jn("Expected first argument to be of type boolean, string, number or null, but found "+Lt(In(a))+" instead.");if(!on(u,["string","array"]))throw new jn("Expected second argument to be of type array or string, but found "+Lt(In(u))+" instead.");if(this.fromIndex){var p=this.fromIndex.evaluate(i);return u.indexOf(a,p)}return u.indexOf(a)},Ua.prototype.eachChild=function(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)},Ua.prototype.outputDefined=function(){return!1},Ua.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Cs=function(i,a,u,p,m,v){this.inputType=i,this.type=a,this.input=u,this.cases=p,this.outputs=m,this.otherwise=v};Cs.parse=function(i,a){if(i.length<5)return a.error("Expected at least 4 arguments, but found only "+(i.length-1)+".");if(i.length%2!=1)return a.error("Expected an even number of arguments.");var u,p;a.expectedType&&a.expectedType.kind!=="value"&&(p=a.expectedType);for(var m={},v=[],x=2;x<i.length-1;x+=2){var T=i[x],P=i[x+1];Array.isArray(T)||(T=[T]);var M=a.concat(x);if(T.length===0)return M.error("Expected at least one branch label.");for(var L=0,R=T;L<R.length;L+=1){var F=R[L];if(typeof F!="number"&&typeof F!="string")return M.error("Branch labels must be numbers or strings.");if(typeof F=="number"&&Math.abs(F)>Number.MAX_SAFE_INTEGER)return M.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof F=="number"&&Math.floor(F)!==F)return M.error("Numeric branch labels must be integer values.");if(u){if(M.checkSubtype(u,In(F)))return null}else u=In(F);if(m[String(F)]!==void 0)return M.error("Branch labels must be unique.");m[String(F)]=v.length}var V=a.parse(P,x,p);if(!V)return null;p=p||V.type,v.push(V)}var te=a.parse(i[1],1,$e);if(!te)return null;var ne=a.parse(i[i.length-1],i.length-1,p);return ne?te.type.kind!=="value"&&a.concat(1).checkSubtype(u,te.type)?null:new Cs(u,p,te,m,v,ne):null},Cs.prototype.evaluate=function(i){var a=this.input.evaluate(i);return(In(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(i)},Cs.prototype.eachChild=function(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)},Cs.prototype.outputDefined=function(){return this.outputs.every(function(i){return i.outputDefined()})&&this.otherwise.outputDefined()},Cs.prototype.serialize=function(){for(var i=this,a=["match",this.input.serialize()],u=[],p={},m=0,v=Object.keys(this.cases).sort();m<v.length;m+=1){var x=v[m];(R=p[this.cases[x]])===void 0?(p[this.cases[x]]=u.length,u.push([this.cases[x],[x]])):u[R][1].push(x)}for(var T=function(V){return i.inputType.kind==="number"?Number(V):V},P=0,M=u;P<M.length;P+=1){var L=M[P],R=L[0],F=L[1];a.push(F.length===1?T(F[0]):F.map(T)),a.push(this.outputs[outputIndex$1].serialize())}return a.push(this.otherwise.serialize()),a};var Ms=function(i,a,u){this.type=i,this.branches=a,this.otherwise=u};Ms.parse=function(i,a){if(i.length<4)return a.error("Expected at least 3 arguments, but found only "+(i.length-1)+".");if(i.length%2!=0)return a.error("Expected an odd number of arguments.");var u;a.expectedType&&a.expectedType.kind!=="value"&&(u=a.expectedType);for(var p=[],m=1;m<i.length-1;m+=2){var v=a.parse(i[m],m,qe);if(!v)return null;var x=a.parse(i[m+1],m+1,u);if(!x)return null;p.push([v,x]),u=u||x.type}var T=a.parse(i[i.length-1],i.length-1,u);return T?new Ms(u,p,T):null},Ms.prototype.evaluate=function(i){for(var a=0,u=this.branches;a<u.length;a+=1){var p=u[a],m=p[1];if(p[0].evaluate(i))return m.evaluate(i)}return this.otherwise.evaluate(i)},Ms.prototype.eachChild=function(i){for(var a=0,u=this.branches;a<u.length;a+=1){var p=u[a],m=p[1];i(p[0]),i(m)}i(this.otherwise)},Ms.prototype.outputDefined=function(){return this.branches.every(function(i){return i[1].outputDefined()})&&this.otherwise.outputDefined()},Ms.prototype.serialize=function(){var i=["case"];return this.eachChild(function(a){i.push(a.serialize())}),i};var ja=function(i,a,u,p){this.type=i,this.input=a,this.beginIndex=u,this.endIndex=p};function Qd(i,a){return i==="=="||i==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function em(i,a,u,p){return p.compare(a,u)===0}function vn(i,a,u){var p=i!=="=="&&i!=="!=";return function(){function m(v,x,T){this.type=qe,this.lhs=v,this.rhs=x,this.collator=T,this.hasUntypedArgument=v.type.kind==="value"||x.type.kind==="value"}return m.parse=function(v,x){if(v.length!==3&&v.length!==4)return x.error("Expected two or three arguments.");var T=v[0],P=x.parse(v[1],1,$e);if(!P)return null;if(!Qd(T,P.type))return x.concat(1).error('"'+T+`" comparisons are not supported for type '`+Lt(P.type)+"'.");var M=x.parse(v[2],2,$e);if(!M)return null;if(!Qd(T,M.type))return x.concat(2).error('"'+T+`" comparisons are not supported for type '`+Lt(M.type)+"'.");if(P.type.kind!==M.type.kind&&P.type.kind!=="value"&&M.type.kind!=="value")return x.error("Cannot compare types '"+Lt(P.type)+"' and '"+Lt(M.type)+"'.");p&&(P.type.kind==="value"&&M.type.kind!=="value"?P=new bn(M.type,[P]):P.type.kind!=="value"&&M.type.kind==="value"&&(M=new bn(P.type,[M])));var L=null;if(v.length===4){if(P.type.kind!=="string"&&M.type.kind!=="string"&&P.type.kind!=="value"&&M.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(!(L=x.parse(v[3],3,Ht)))return null}return new m(P,M,L)},m.prototype.evaluate=function(v){var x=this.lhs.evaluate(v),T=this.rhs.evaluate(v);if(p&&this.hasUntypedArgument){var P=In(x),M=In(T);if(P.kind!==M.kind||P.kind!=="string"&&P.kind!=="number")throw new jn('Expected arguments for "'+i+'" to be (string, string) or (number, number), but found ('+P.kind+", "+M.kind+") instead.")}if(this.collator&&!p&&this.hasUntypedArgument){var L=In(x),R=In(T);if(L.kind!=="string"||R.kind!=="string")return a(v,x,T)}return this.collator?u(v,x,T,this.collator.evaluate(v)):a(v,x,T)},m.prototype.eachChild=function(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)},m.prototype.outputDefined=function(){return!0},m.prototype.serialize=function(){var v=[i];return this.eachChild(function(x){v.push(x.serialize())}),v},m}()}ja.parse=function(i,a){if(i.length<=2||i.length>=5)return a.error("Expected 3 or 4 arguments, but found "+(i.length-1)+" instead.");var u=a.parse(i[1],1,$e),p=a.parse(i[2],2,Le);if(!u||!p)return null;if(!dn(u.type,[$t($e),Je,$e]))return a.error("Expected first argument to be of type array or string, but found "+Lt(u.type)+" instead");if(i.length===4){var m=a.parse(i[3],3,Le);return m?new ja(u.type,u,p,m):null}return new ja(u.type,u,p)},ja.prototype.evaluate=function(i){var a=this.input.evaluate(i),u=this.beginIndex.evaluate(i);if(!on(a,["string","array"]))throw new jn("Expected first argument to be of type array or string, but found "+Lt(In(a))+" instead.");if(this.endIndex){var p=this.endIndex.evaluate(i);return a.slice(u,p)}return a.slice(u)},ja.prototype.eachChild=function(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)},ja.prototype.outputDefined=function(){return!1},ja.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var vv=vn("==",function(i,a,u){return a===u},em),Sc=vn("!=",function(i,a,u){return a!==u},function(i,a,u,p){return!em(0,a,u,p)}),tm=vn("<",function(i,a,u){return a<u},function(i,a,u,p){return p.compare(a,u)<0}),nm=vn(">",function(i,a,u){return a>u},function(i,a,u,p){return p.compare(a,u)>0}),rm=vn("<=",function(i,a,u){return a<=u},function(i,a,u,p){return p.compare(a,u)<=0}),im=vn(">=",function(i,a,u){return a>=u},function(i,a,u,p){return p.compare(a,u)>=0}),ks=function(i,a,u,p,m){this.type=Je,this.number=i,this.locale=a,this.currency=u,this.minFractionDigits=p,this.maxFractionDigits=m};ks.parse=function(i,a){if(i.length!==3)return a.error("Expected two arguments.");var u=a.parse(i[1],1,Le);if(!u)return null;var p=i[2];if(typeof p!="object"||Array.isArray(p))return a.error("NumberFormat options argument must be an object.");var m=null;if(p.locale&&!(m=a.parse(p.locale,1,Je)))return null;var v=null;if(p.currency&&!(v=a.parse(p.currency,1,Je)))return null;var x=null;if(p["min-fraction-digits"]&&!(x=a.parse(p["min-fraction-digits"],1,Le)))return null;var T=null;return p["max-fraction-digits"]&&!(T=a.parse(p["max-fraction-digits"],1,Le))?null:new ks(u,m,v,x,T)},ks.prototype.evaluate=function(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))},ks.prototype.eachChild=function(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)},ks.prototype.outputDefined=function(){return!1},ks.prototype.serialize=function(){var i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]};var Va=function(i){this.type=Le,this.input=i};Va.parse=function(i,a){if(i.length!==2)return a.error("Expected 1 argument, but found "+(i.length-1)+" instead.");var u=a.parse(i[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?a.error("Expected argument of type string or array, but found "+Lt(u.type)+" instead."):new Va(u):null},Va.prototype.evaluate=function(i){var a=this.input.evaluate(i);if(typeof a=="string"||Array.isArray(a))return a.length;throw new jn("Expected value to be of type string or array, but found "+Lt(In(a))+" instead.")},Va.prototype.eachChild=function(i){i(this.input)},Va.prototype.outputDefined=function(){return!1},Va.prototype.serialize=function(){var i=["length"];return this.eachChild(function(a){i.push(a.serialize())}),i};var Ls={"==":vv,"!=":Sc,">":nm,"<":tm,">=":im,"<=":rm,array:bn,at:Ps,boolean:bn,case:Ms,coalesce:Na,collator:pe,format:Ti,image:Zr,in:Is,"index-of":Ua,interpolate:Nr,"interpolate-hcl":Nr,"interpolate-lab":Nr,length:Va,let:Fa,literal:xr,match:Cs,number:bn,"number-format":ks,object:bn,slice:ja,step:Ai,string:bn,"to-boolean":Si,"to-color":Si,"to-number":Si,"to-string":Si,var:za,within:no};function om(i,a){var u=a[0],p=a[1],m=a[2],v=a[3];u=u.evaluate(i),p=p.evaluate(i),m=m.evaluate(i);var x=v?v.evaluate(i):1,T=Ra(u,p,m,x);if(T)throw new jn(T);return new Wt(u/255*x,p/255*x,m/255*x,x)}function am(i,a){return i in a}function kf(i,a){var u=a[i];return u===void 0?null:u}function Rs(i){return{type:i}}function sm(i){return{result:"success",value:i}}function Os(i){return{result:"error",value:i}}function Ds(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function lm(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function bu(i){return!!i.expression&&i.expression.interpolated}function wn(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Ac(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function _v(i){return i}function wl(i,a,u){return i!==void 0?i:a!==void 0?a:u!==void 0?u:void 0}function um(i,a,u,p,m){return wl(typeof u===m?p[u]:void 0,i.default,a.default)}function xv(i,a,u){if(wn(u)!=="number")return wl(i.default,a.default);var p=i.stops.length;if(p===1||u<=i.stops[0][0])return i.stops[0][1];if(u>=i.stops[p-1][0])return i.stops[p-1][1];var m=Tc(i.stops.map(function(v){return v[0]}),u);return i.stops[m][1]}function cm(i,a,u){var p=i.base!==void 0?i.base:1;if(wn(u)!=="number")return wl(i.default,a.default);var m=i.stops.length;if(m===1||u<=i.stops[0][0])return i.stops[0][1];if(u>=i.stops[m-1][0])return i.stops[m-1][1];var v=Tc(i.stops.map(function(R){return R[0]}),u),x=function(R,F,V,te){var ne=te-V,ce=R-V;return ne===0?0:F===1?ce/ne:(Math.pow(F,ce)-1)/(Math.pow(F,ne)-1)}(u,p,i.stops[v][0],i.stops[v+1][0]),T=i.stops[v][1],P=i.stops[v+1][1],M=bl[a.type]||_v;if(i.colorSpace&&i.colorSpace!=="rgb"){var L=Jd[i.colorSpace];M=function(R,F){return L.reverse(L.interpolate(L.forward(R),L.forward(F),x))}}return typeof T.evaluate=="function"?{evaluate:function(){for(var R=[],F=arguments.length;F--;)R[F]=arguments[F];var V=T.evaluate.apply(void 0,R),te=P.evaluate.apply(void 0,R);if(V!==void 0&&te!==void 0)return M(V,te,x)}}:M(T,P,x)}function Pc(i,a,u){return a.type==="color"?u=Wt.parse(u):a.type==="formatted"?u=Un.fromString(u.toString()):a.type==="resolvedImage"?u=Pn.fromString(u.toString()):wn(u)===a.type||a.type==="enum"&&a.values[u]||(u=void 0),wl(u,i.default,a.default)}Q.register(Ls,{error:[{kind:"error"},[Je],function(i,a){throw new jn(a[0].evaluate(i))}],typeof:[Je,[$e],function(i,a){return Lt(In(a[0].evaluate(i)))}],"to-rgba":[$t(Le,4),[Ze],function(i,a){return a[0].evaluate(i).toArray()}],rgb:[Ze,[Le,Le,Le],om],rgba:[Ze,[Le,Le,Le,Le],om],has:{type:qe,overloads:[[[Je],function(i,a){return am(a[0].evaluate(i),i.properties())}],[[Je,kt],function(i,a){var u=a[1];return am(a[0].evaluate(i),u.evaluate(i))}]]},get:{type:$e,overloads:[[[Je],function(i,a){return kf(a[0].evaluate(i),i.properties())}],[[Je,kt],function(i,a){var u=a[1];return kf(a[0].evaluate(i),u.evaluate(i))}]]},"feature-state":[$e,[Je],function(i,a){return kf(a[0].evaluate(i),i.featureState||{})}],properties:[kt,[],function(i){return i.properties()}],"geometry-type":[Je,[],function(i){return i.geometryType()}],id:[$e,[],function(i){return i.id()}],zoom:[Le,[],function(i){return i.globals.zoom}],"heatmap-density":[Le,[],function(i){return i.globals.heatmapDensity||0}],"line-progress":[Le,[],function(i){return i.globals.lineProgress||0}],accumulated:[$e,[],function(i){return i.globals.accumulated===void 0?null:i.globals.accumulated}],"+":[Le,Rs(Le),function(i,a){for(var u=0,p=0,m=a;p<m.length;p+=1)u+=m[p].evaluate(i);return u}],"*":[Le,Rs(Le),function(i,a){for(var u=1,p=0,m=a;p<m.length;p+=1)u*=m[p].evaluate(i);return u}],"-":{type:Le,overloads:[[[Le,Le],function(i,a){var u=a[1];return a[0].evaluate(i)-u.evaluate(i)}],[[Le],function(i,a){return-a[0].evaluate(i)}]]},"/":[Le,[Le,Le],function(i,a){var u=a[1];return a[0].evaluate(i)/u.evaluate(i)}],"%":[Le,[Le,Le],function(i,a){var u=a[1];return a[0].evaluate(i)%u.evaluate(i)}],ln2:[Le,[],function(){return Math.LN2}],pi:[Le,[],function(){return Math.PI}],e:[Le,[],function(){return Math.E}],"^":[Le,[Le,Le],function(i,a){var u=a[1];return Math.pow(a[0].evaluate(i),u.evaluate(i))}],sqrt:[Le,[Le],function(i,a){return Math.sqrt(a[0].evaluate(i))}],log10:[Le,[Le],function(i,a){return Math.log(a[0].evaluate(i))/Math.LN10}],ln:[Le,[Le],function(i,a){return Math.log(a[0].evaluate(i))}],log2:[Le,[Le],function(i,a){return Math.log(a[0].evaluate(i))/Math.LN2}],sin:[Le,[Le],function(i,a){return Math.sin(a[0].evaluate(i))}],cos:[Le,[Le],function(i,a){return Math.cos(a[0].evaluate(i))}],tan:[Le,[Le],function(i,a){return Math.tan(a[0].evaluate(i))}],asin:[Le,[Le],function(i,a){return Math.asin(a[0].evaluate(i))}],acos:[Le,[Le],function(i,a){return Math.acos(a[0].evaluate(i))}],atan:[Le,[Le],function(i,a){return Math.atan(a[0].evaluate(i))}],min:[Le,Rs(Le),function(i,a){return Math.min.apply(Math,a.map(function(u){return u.evaluate(i)}))}],max:[Le,Rs(Le),function(i,a){return Math.max.apply(Math,a.map(function(u){return u.evaluate(i)}))}],abs:[Le,[Le],function(i,a){return Math.abs(a[0].evaluate(i))}],round:[Le,[Le],function(i,a){var u=a[0].evaluate(i);return u<0?-Math.round(-u):Math.round(u)}],floor:[Le,[Le],function(i,a){return Math.floor(a[0].evaluate(i))}],ceil:[Le,[Le],function(i,a){return Math.ceil(a[0].evaluate(i))}],"filter-==":[qe,[Je,$e],function(i,a){var u=a[0],p=a[1];return i.properties()[u.value]===p.value}],"filter-id-==":[qe,[$e],function(i,a){var u=a[0];return i.id()===u.value}],"filter-type-==":[qe,[Je],function(i,a){var u=a[0];return i.geometryType()===u.value}],"filter-<":[qe,[Je,$e],function(i,a){var u=a[0],p=a[1],m=i.properties()[u.value],v=p.value;return typeof m==typeof v&&m<v}],"filter-id-<":[qe,[$e],function(i,a){var u=a[0],p=i.id(),m=u.value;return typeof p==typeof m&&p<m}],"filter->":[qe,[Je,$e],function(i,a){var u=a[0],p=a[1],m=i.properties()[u.value],v=p.value;return typeof m==typeof v&&m>v}],"filter-id->":[qe,[$e],function(i,a){var u=a[0],p=i.id(),m=u.value;return typeof p==typeof m&&p>m}],"filter-<=":[qe,[Je,$e],function(i,a){var u=a[0],p=a[1],m=i.properties()[u.value],v=p.value;return typeof m==typeof v&&m<=v}],"filter-id-<=":[qe,[$e],function(i,a){var u=a[0],p=i.id(),m=u.value;return typeof p==typeof m&&p<=m}],"filter->=":[qe,[Je,$e],function(i,a){var u=a[0],p=a[1],m=i.properties()[u.value],v=p.value;return typeof m==typeof v&&m>=v}],"filter-id->=":[qe,[$e],function(i,a){var u=a[0],p=i.id(),m=u.value;return typeof p==typeof m&&p>=m}],"filter-has":[qe,[$e],function(i,a){return a[0].value in i.properties()}],"filter-has-id":[qe,[],function(i){return i.id()!==null&&i.id()!==void 0}],"filter-type-in":[qe,[$t(Je)],function(i,a){return a[0].value.indexOf(i.geometryType())>=0}],"filter-id-in":[qe,[$t($e)],function(i,a){return a[0].value.indexOf(i.id())>=0}],"filter-in-small":[qe,[Je,$t($e)],function(i,a){var u=a[0];return a[1].value.indexOf(i.properties()[u.value])>=0}],"filter-in-large":[qe,[Je,$t($e)],function(i,a){var u=a[0],p=a[1];return function(m,v,x,T){for(;x<=T;){var P=x+T>>1;if(v[P]===m)return!0;v[P]>m?T=P-1:x=P+1}return!1}(i.properties()[u.value],p.value,0,p.value.length-1)}],all:{type:qe,overloads:[[[qe,qe],function(i,a){var u=a[1];return a[0].evaluate(i)&&u.evaluate(i)}],[Rs(qe),function(i,a){for(var u=0,p=a;u<p.length;u+=1)if(!p[u].evaluate(i))return!1;return!0}]]},any:{type:qe,overloads:[[[qe,qe],function(i,a){var u=a[1];return a[0].evaluate(i)||u.evaluate(i)}],[Rs(qe),function(i,a){for(var u=0,p=a;u<p.length;u+=1)if(p[u].evaluate(i))return!0;return!1}]]},"!":[qe,[qe],function(i,a){return!a[0].evaluate(i)}],"is-supported-script":[qe,[Je],function(i,a){var u=i.globals&&i.globals.isSupportedScript;return!u||u(a[0].evaluate(i))}],upcase:[Je,[Je],function(i,a){return a[0].evaluate(i).toUpperCase()}],downcase:[Je,[Je],function(i,a){return a[0].evaluate(i).toLowerCase()}],concat:[Je,Rs($e),function(i,a){return a.map(function(u){return aa(u.evaluate(i))}).join("")}],"resolved-locale":[Je,[Ht],function(i,a){return a[0].evaluate(i).resolvedLocale()}]});var El=function(i,a){this.expression=i,this._warningHistory={},this._evaluator=new q,this._defaultValue=a?function(u){return u.type==="color"&&Ac(u.default)?new Wt(0,0,0,0):u.type==="color"?Wt.parse(u.default)||null:u.default===void 0?null:u.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null};function wu(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Ls}function Ic(i,a){var u=new Ba(Ls,[],a?function(m){var v={color:Ze,string:Je,number:Le,enum:Je,boolean:qe,formatted:pn,resolvedImage:Gt};return m.type==="array"?$t(v[m.value]||$e,m.length):v[m.type]}(a):void 0),p=u.parse(i,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?sm(new El(p,a)):Os(u.errors)}El.prototype.evaluateWithoutErrorHandling=function(i,a,u,p,m,v){return this._evaluator.globals=i,this._evaluator.feature=a,this._evaluator.featureState=u,this._evaluator.canonical=p,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)},El.prototype.evaluate=function(i,a,u,p,m,v){this._evaluator.globals=i,this._evaluator.feature=a||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=v||null;try{var x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new jn("Expected value to be one of "+Object.keys(this._enumValues).map(function(T){return JSON.stringify(T)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}};var Eu=function(i,a){this.kind=i,this._styleExpression=a,this.isStateDependent=i!=="constant"&&!Da(a.expression)};Eu.prototype.evaluateWithoutErrorHandling=function(i,a,u,p,m,v){return this._styleExpression.evaluateWithoutErrorHandling(i,a,u,p,m,v)},Eu.prototype.evaluate=function(i,a,u,p,m,v){return this._styleExpression.evaluate(i,a,u,p,m,v)};var Tl=function(i,a,u,p){this.kind=i,this.zoomStops=u,this._styleExpression=a,this.isStateDependent=i!=="camera"&&!Da(a.expression),this.interpolationType=p};function hm(i,a){if((i=Ic(i,a)).result==="error")return i;var u=i.value.expression,p=Oa(u);if(!p&&!Ds(a))return Os([new Ne("","data expressions not supported")]);var m=As(u,["zoom"]);if(!m&&!lm(a))return Os([new Ne("","zoom expressions not supported")]);var v=function x(T){var P=null;if(T instanceof Fa)P=x(T.result);else if(T instanceof Na)for(var M=0,L=T.args;M<L.length&&!(P=x(L[M]));M+=1);else(T instanceof Ai||T instanceof Nr)&&T.input instanceof Q&&T.input.name==="zoom"&&(P=T);return P instanceof Ne||T.eachChild(function(R){var F=x(R);F instanceof Ne?P=F:!P&&F?P=new Ne("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):P&&F&&P!==F&&(P=new Ne("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),P}(u);return v||m?v instanceof Ne?Os([v]):v instanceof Nr&&!bu(a)?Os([new Ne("",'"interpolate" expressions cannot be used with this property')]):sm(v?new Tl(p?"camera":"composite",i.value,v.labels,v instanceof Nr?v.interpolation:void 0):new Eu(p?"constant":"source",i.value)):Os([new Ne("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Tl.prototype.evaluateWithoutErrorHandling=function(i,a,u,p,m,v){return this._styleExpression.evaluateWithoutErrorHandling(i,a,u,p,m,v)},Tl.prototype.evaluate=function(i,a,u,p,m,v){return this._styleExpression.evaluate(i,a,u,p,m,v)},Tl.prototype.interpolationFactor=function(i,a,u){return this.interpolationType?Nr.interpolationFactor(this.interpolationType,i,a,u):0};var Sl=function(i,a){this._parameters=i,this._specification=a,Be(this,function u(p,m){var v,x,T,P=m.type==="color",M=p.stops&&typeof p.stops[0][0]=="object",L=M||!(M||p.property!==void 0),R=p.type||(bu(m)?"exponential":"interval");if(P&&((p=Be({},p)).stops&&(p.stops=p.stops.map(function(Qe){return[Qe[0],Wt.parse(Qe[1])]})),p.default=Wt.parse(p.default?p.default:m.default)),p.colorSpace&&p.colorSpace!=="rgb"&&!Jd[p.colorSpace])throw new Error("Unknown color space: "+p.colorSpace);if(R==="exponential")v=cm;else if(R==="interval")v=xv;else if(R==="categorical"){v=um,x=Object.create(null);for(var F=0,V=p.stops;F<V.length;F+=1){var te=V[F];x[te[0]]=te[1]}T=typeof p.stops[0][0]}else{if(R!=="identity")throw new Error('Unknown function type "'+R+'"');v=Pc}if(M){for(var ne={},ce=[],se=0;se<p.stops.length;se++){var ve=p.stops[se],we=ve[0].zoom;ne[we]===void 0&&(ne[we]={zoom:we,type:p.type,property:p.property,default:p.default,stops:[]},ce.push(we)),ne[we].stops.push([ve[0].value,ve[1]])}for(var Ae=[],Ie=0,Oe=ce;Ie<Oe.length;Ie+=1){var je=Oe[Ie];Ae.push([ne[je].zoom,u(ne[je],m)])}var Xe={name:"linear"};return{kind:"composite",interpolationType:Xe,interpolationFactor:Nr.interpolationFactor.bind(void 0,Xe),zoomStops:Ae.map(function(Qe){return Qe[0]}),evaluate:function(Qe,mt){var et=Qe.zoom;return cm({stops:Ae,base:p.base},m,et).evaluate(et,mt)}}}if(L){var ct=R==="exponential"?{name:"exponential",base:p.base!==void 0?p.base:1}:null;return{kind:"camera",interpolationType:ct,interpolationFactor:Nr.interpolationFactor.bind(void 0,ct),zoomStops:p.stops.map(function(Qe){return Qe[0]}),evaluate:function(Qe){return v(p,m,Qe.zoom,x,T)}}}return{kind:"source",evaluate:function(Qe,mt){var et=mt&&mt.properties?mt.properties[p.property]:void 0;return et===void 0?wl(p.default,m.default):v(p,m,et,x,T)}}}(this._parameters,this._specification))};function _o(i){var a=i.key,u=i.value,p=i.valueSpec||{},m=i.objectElementValidators||{},v=i.style,x=i.styleSpec,T=[],P=wn(u);if(P!=="object")return[new ae(a,u,"object expected, "+P+" found")];for(var M in u){var L=M.split(".")[0],R=p[L]||p["*"],F=void 0;if(m[L])F=m[L];else if(p[L])F=Kt;else if(m["*"])F=m["*"];else{if(!p["*"]){T.push(new ae(a,u[M],'unknown property "'+M+'"'));continue}F=Kt}T=T.concat(F({key:(a&&a+".")+M,value:u[M],valueSpec:R,style:v,styleSpec:x,object:u,objectKey:M},u))}for(var V in p)m[V]||p[V].required&&p[V].default===void 0&&u[V]===void 0&&T.push(new ae(a,u,'missing required property "'+V+'"'));return T}function fm(i){var a=i.value,u=i.valueSpec,p=i.style,m=i.styleSpec,v=i.key,x=i.arrayElementValidator||Kt;if(wn(a)!=="array")return[new ae(v,a,"array expected, "+wn(a)+" found")];if(u.length&&a.length!==u.length)return[new ae(v,a,"array length "+u.length+" expected, length "+a.length+" found")];if(u["min-length"]&&a.length<u["min-length"])return[new ae(v,a,"array length at least "+u["min-length"]+" expected, length "+a.length+" found")];var T={type:u.value,values:u.values};m.$version<7&&(T.function=u.function),wn(u.value)==="object"&&(T=u.value);for(var P=[],M=0;M<a.length;M++)P=P.concat(x({array:a,arrayIndex:M,value:a[M],valueSpec:T,style:p,styleSpec:m,key:v+"["+M+"]"}));return P}function pm(i){var a=i.key,u=i.value,p=i.valueSpec,m=wn(u);return m==="number"&&u!=u&&(m="NaN"),m!=="number"?[new ae(a,u,"number expected, "+m+" found")]:"minimum"in p&&u<p.minimum?[new ae(a,u,u+" is less than the minimum value "+p.minimum)]:"maximum"in p&&u>p.maximum?[new ae(a,u,u+" is greater than the maximum value "+p.maximum)]:[]}function dm(i){var a,u,p,m=i.valueSpec,v=Ue(i.value.type),x={},T=v!=="categorical"&&i.value.property===void 0,P=!T,M=wn(i.value.stops)==="array"&&wn(i.value.stops[0])==="array"&&wn(i.value.stops[0][0])==="object",L=_o({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(V){if(v==="identity")return[new ae(V.key,V.value,'identity function may not have a "stops" property')];var te=[],ne=V.value;return te=te.concat(fm({key:V.key,value:ne,valueSpec:V.valueSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:R})),wn(ne)==="array"&&ne.length===0&&te.push(new ae(V.key,ne,"array must have at least one stop")),te},default:function(V){return Kt({key:V.key,value:V.value,valueSpec:m,style:V.style,styleSpec:V.styleSpec})}}});return v==="identity"&&T&&L.push(new ae(i.key,i.value,'missing required property "property"')),v==="identity"||i.value.stops||L.push(new ae(i.key,i.value,'missing required property "stops"')),v==="exponential"&&i.valueSpec.expression&&!bu(i.valueSpec)&&L.push(new ae(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(P&&!Ds(i.valueSpec)?L.push(new ae(i.key,i.value,"property functions not supported")):T&&!lm(i.valueSpec)&&L.push(new ae(i.key,i.value,"zoom functions not supported"))),v!=="categorical"&&!M||i.value.property!==void 0||L.push(new ae(i.key,i.value,'"property" property is required')),L;function R(V){var te=[],ne=V.value,ce=V.key;if(wn(ne)!=="array")return[new ae(ce,ne,"array expected, "+wn(ne)+" found")];if(ne.length!==2)return[new ae(ce,ne,"array length 2 expected, length "+ne.length+" found")];if(M){if(wn(ne[0])!=="object")return[new ae(ce,ne,"object expected, "+wn(ne[0])+" found")];if(ne[0].zoom===void 0)return[new ae(ce,ne,"object stop key must have zoom")];if(ne[0].value===void 0)return[new ae(ce,ne,"object stop key must have value")];if(p&&p>Ue(ne[0].zoom))return[new ae(ce,ne[0].zoom,"stop zoom values must appear in ascending order")];Ue(ne[0].zoom)!==p&&(p=Ue(ne[0].zoom),u=void 0,x={}),te=te.concat(_o({key:ce+"[0]",value:ne[0],valueSpec:{zoom:{}},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:pm,value:F}}))}else te=te.concat(F({key:ce+"[0]",value:ne[0],valueSpec:{},style:V.style,styleSpec:V.styleSpec},ne));return wu(Me(ne[1]))?te.concat([new ae(ce+"[1]",ne[1],"expressions are not allowed in function stops.")]):te.concat(Kt({key:ce+"[1]",value:ne[1],valueSpec:m,style:V.style,styleSpec:V.styleSpec}))}function F(V,te){var ne=wn(V.value),ce=Ue(V.value),se=V.value!==null?V.value:te;if(a){if(ne!==a)return[new ae(V.key,se,ne+" stop domain type must match previous stop domain type "+a)]}else a=ne;if(ne!=="number"&&ne!=="string"&&ne!=="boolean")return[new ae(V.key,se,"stop domain value must be a number, string, or boolean")];if(ne!=="number"&&v!=="categorical"){var ve="number expected, "+ne+" found";return Ds(m)&&v===void 0&&(ve+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ae(V.key,se,ve)]}return v!=="categorical"||ne!=="number"||isFinite(ce)&&Math.floor(ce)===ce?v!=="categorical"&&ne==="number"&&u!==void 0&&ce<u?[new ae(V.key,se,"stop domain values must appear in ascending order")]:(u=ce,v==="categorical"&&ce in x?[new ae(V.key,se,"stop domain values must be unique")]:(x[ce]=!0,[])):[new ae(V.key,se,"integer expected, found "+ce)]}}function zs(i){var a=(i.expressionContext==="property"?hm:Ic)(Me(i.value),i.valueSpec);if(a.result==="error")return a.value.map(function(p){return new ae(""+i.key+p.key,i.value,p.message)});var u=a.value.expression||a.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!u.outputDefined())return[new ae(i.key,i.value,'Invalid data expression for "'+i.propertyKey+'". Output values must be contained as literals within the expression.')];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Da(u))return[new ae(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Da(u))return[new ae(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!As(u,["zoom","feature-state"]))return[new ae(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Oa(u))return[new ae(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Tu(i){var a=i.key,u=i.value,p=i.valueSpec,m=[];return Array.isArray(p.values)?p.values.indexOf(Ue(u))===-1&&m.push(new ae(a,u,"expected one of ["+p.values.join(", ")+"], "+JSON.stringify(u)+" found")):Object.keys(p.values).indexOf(Ue(u))===-1&&m.push(new ae(a,u,"expected one of ["+Object.keys(p.values).join(", ")+"], "+JSON.stringify(u)+" found")),m}function Cc(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(var a=0,u=i.slice(1);a<u.length;a+=1){var p=u[a];if(!Cc(p)&&typeof p!="boolean")return!1}return!0;default:return!0}}Sl.deserialize=function(i){return new Sl(i._parameters,i._specification)},Sl.serialize=function(i){return{_parameters:i._parameters,_specification:i._specification}};var Lf={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Mc(i){if(i==null)return{filter:function(){return!0},needGeometry:!1};Cc(i)||(i=kc(i));var a=Ic(i,Lf);if(a.result==="error")throw new Error(a.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(u,p,m){return a.value.evaluate(u,p,{},m)},needGeometry:function u(p){if(!Array.isArray(p))return!1;if(p[0]==="within")return!0;for(var m=1;m<p.length;m++)if(u(p[m]))return!0;return!1}(i)}}function bv(i,a){return i<a?-1:i>a?1:0}function kc(i){if(!i)return!0;var a,u=i[0];return i.length<=1?u!=="any":u==="=="?Rf(i[1],i[2],"=="):u==="!="?Lc(Rf(i[1],i[2],"==")):u==="<"||u===">"||u==="<="||u===">="?Rf(i[1],i[2],u):u==="any"?(a=i.slice(1),["any"].concat(a.map(kc))):u==="all"?["all"].concat(i.slice(1).map(kc)):u==="none"?["all"].concat(i.slice(1).map(kc).map(Lc)):u==="in"?mm(i[1],i.slice(2)):u==="!in"?Lc(mm(i[1],i.slice(2))):u==="has"?gm(i[1]):u==="!has"?Lc(gm(i[1])):u!=="within"||i}function Rf(i,a,u){switch(i){case"$type":return["filter-type-"+u,a];case"$id":return["filter-id-"+u,a];default:return["filter-"+u,i,a]}}function mm(i,a){if(a.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(function(u){return typeof u!=typeof a[0]})?["filter-in-large",i,["literal",a.sort(bv)]]:["filter-in-small",i,["literal",a]]}}function gm(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Lc(i){return["!",i]}function Of(i){return Cc(Me(i.value))?zs(Be({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function a(u){var p=u.value,m=u.key;if(wn(p)!=="array")return[new ae(m,p,"array expected, "+wn(p)+" found")];var v,x=u.styleSpec,T=[];if(p.length<1)return[new ae(m,p,"filter array must have at least 1 element")];switch(T=T.concat(Tu({key:m+"[0]",value:p[0],valueSpec:x.filter_operator,style:u.style,styleSpec:u.styleSpec})),Ue(p[0])){case"<":case"<=":case">":case">=":p.length>=2&&Ue(p[1])==="$type"&&T.push(new ae(m,p,'"$type" cannot be use with operator "'+p[0]+'"'));case"==":case"!=":p.length!==3&&T.push(new ae(m,p,'filter array for operator "'+p[0]+'" must have 3 elements'));case"in":case"!in":p.length>=2&&(v=wn(p[1]))!=="string"&&T.push(new ae(m+"[1]",p[1],"string expected, "+v+" found"));for(var P=2;P<p.length;P++)v=wn(p[P]),Ue(p[1])==="$type"?T=T.concat(Tu({key:m+"["+P+"]",value:p[P],valueSpec:x.geometry_type,style:u.style,styleSpec:u.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&T.push(new ae(m+"["+P+"]",p[P],"string, number, or boolean expected, "+v+" found"));break;case"any":case"all":case"none":for(var M=1;M<p.length;M++)T=T.concat(a({key:m+"["+M+"]",value:p[M],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":v=wn(p[1]),p.length!==2?T.push(new ae(m,p,'filter array for "'+p[0]+'" operator must have 2 elements')):v!=="string"&&T.push(new ae(m+"[1]",p[1],"string expected, "+v+" found"));break;case"within":v=wn(p[1]),p.length!==2?T.push(new ae(m,p,'filter array for "'+p[0]+'" operator must have 2 elements')):v!=="object"&&T.push(new ae(m+"[1]",p[1],"object expected, "+v+" found"))}return T}(i)}function Df(i,a){var u=i.key,p=i.style,m=i.styleSpec,v=i.value,x=i.objectKey,T=m[a+"_"+i.layerType];if(!T)return[];var P=x.match(/^(.*)-transition$/);if(a==="paint"&&P&&T[P[1]]&&T[P[1]].transition)return Kt({key:u,value:v,valueSpec:m.transition,style:p,styleSpec:m});var M,L=i.valueSpec||T[x];if(!L)return[new ae(u,v,'unknown property "'+x+'"')];if(wn(v)==="string"&&Ds(L)&&!L.tokens&&(M=/^{([^}]+)}$/.exec(v)))return[new ae(u,v,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(M[1])+" }`.")];var R=[];return i.layerType==="symbol"&&(x==="text-field"&&p&&!p.glyphs&&R.push(new ae(u,v,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Ac(Me(v))&&Ue(v.type)==="identity"&&R.push(new ae(u,v,'"text-font" does not support identity functions'))),R.concat(Kt({key:i.key,value:v,valueSpec:L,style:p,styleSpec:m,expressionContext:"property",propertyType:a,propertyKey:x}))}function zf(i){return Df(i,"paint")}function Su(i){return Df(i,"layout")}function ym(i){var a=[],u=i.value,p=i.key,m=i.style,v=i.styleSpec;u.type||u.ref||a.push(new ae(p,u,'either "type" or "ref" is required'));var x,T=Ue(u.type),P=Ue(u.ref);if(u.id)for(var M=Ue(u.id),L=0;L<i.arrayIndex;L++){var R=m.layers[L];Ue(R.id)===M&&a.push(new ae(p,u.id,'duplicate layer id "'+u.id+'", previously used at line '+R.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(te){te in u&&a.push(new ae(p,u[te],'"'+te+'" is prohibited for ref layers'))}),m.layers.forEach(function(te){Ue(te.id)===P&&(x=te)}),x?x.ref?a.push(new ae(p,u.ref,"ref cannot reference another ref layer")):T=Ue(x.type):a.push(new ae(p,u.ref,'ref layer "'+P+'" not found'));else if(T!=="background")if(u.source){var F=m.sources&&m.sources[u.source],V=F&&Ue(F.type);F?V==="vector"&&T==="raster"?a.push(new ae(p,u.source,'layer "'+u.id+'" requires a raster source')):V==="raster"&&T!=="raster"?a.push(new ae(p,u.source,'layer "'+u.id+'" requires a vector source')):V!=="vector"||u["source-layer"]?V==="raster-dem"&&T!=="hillshade"?a.push(new ae(p,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!u.paint||!u.paint["line-gradient"]||V==="geojson"&&F.lineMetrics||a.push(new ae(p,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):a.push(new ae(p,u,'layer "'+u.id+'" must specify a "source-layer"')):a.push(new ae(p,u.source,'source "'+u.source+'" not found'))}else a.push(new ae(p,u,'missing required property "source"'));return a=a.concat(_o({key:p,value:u,valueSpec:v.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Kt({key:p+".type",value:u.type,valueSpec:v.layer.type,style:i.style,styleSpec:i.styleSpec,object:u,objectKey:"type"})},filter:Of,layout:function(te){return _o({layer:u,key:te.key,value:te.value,style:te.style,styleSpec:te.styleSpec,objectElementValidators:{"*":function(ne){return Su(Be({layerType:T},ne))}}})},paint:function(te){return _o({layer:u,key:te.key,value:te.value,style:te.style,styleSpec:te.styleSpec,objectElementValidators:{"*":function(ne){return zf(Be({layerType:T},ne))}}})}}}))}function Bs(i){var a=i.value,u=i.key,p=wn(a);return p!=="string"?[new ae(u,a,"string expected, "+p+" found")]:[]}var Cn={promoteId:function(i){var a=i.key,u=i.value;if(wn(u)==="string")return Bs({key:a,value:u});var p=[];for(var m in u)p.push.apply(p,Bs({key:a+"."+m,value:u[m]}));return p}};function Rc(i){var a=i.value,u=i.key,p=i.styleSpec,m=i.style;if(!a.type)return[new ae(u,a,'"type" is required')];var v,x=Ue(a.type);switch(x){case"vector":case"raster":case"raster-dem":return _o({key:u,value:a,valueSpec:p["source_"+x.replace("-","_")],style:i.style,styleSpec:p,objectElementValidators:Cn});case"geojson":if(v=_o({key:u,value:a,valueSpec:p.source_geojson,style:m,styleSpec:p,objectElementValidators:Cn}),a.cluster)for(var T in a.clusterProperties){var P=a.clusterProperties[T],M=P[0],L=typeof M=="string"?[M,["accumulated"],["get",T]]:M;v.push.apply(v,zs({key:u+"."+T+".map",value:P[1],expressionContext:"cluster-map"})),v.push.apply(v,zs({key:u+"."+T+".reduce",value:L,expressionContext:"cluster-reduce"}))}return v;case"video":return _o({key:u,value:a,valueSpec:p.source_video,style:m,styleSpec:p});case"image":return _o({key:u,value:a,valueSpec:p.source_image,style:m,styleSpec:p});case"canvas":return[new ae(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Tu({key:u+".type",value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:m,styleSpec:p})}}function Ns(i){var a=i.value,u=i.styleSpec,p=u.light,m=i.style,v=[],x=wn(a);if(a===void 0)return v;if(x!=="object")return v.concat([new ae("light",a,"object expected, "+x+" found")]);for(var T in a){var P=T.match(/^(.*)-transition$/);v=v.concat(P&&p[P[1]]&&p[P[1]].transition?Kt({key:T,value:a[T],valueSpec:u.transition,style:m,styleSpec:u}):p[T]?Kt({key:T,value:a[T],valueSpec:p[T],style:m,styleSpec:u}):[new ae(T,a[T],'unknown property "'+T+'"')])}return v}var Ga={"*":function(){return[]},array:fm,boolean:function(i){var a=i.value,u=i.key,p=wn(a);return p!=="boolean"?[new ae(u,a,"boolean expected, "+p+" found")]:[]},number:pm,color:function(i){var a=i.key,u=i.value,p=wn(u);return p!=="string"?[new ae(a,u,"color expected, "+p+" found")]:Rt(u)===null?[new ae(a,u,'color expected, "'+u+'" found')]:[]},constants:_e,enum:Tu,filter:Of,function:dm,layer:ym,object:_o,source:Rc,light:Ns,string:Bs,formatted:function(i){return Bs(i).length===0?[]:zs(i)},resolvedImage:function(i){return Bs(i).length===0?[]:zs(i)}};function Kt(i){var a=i.value,u=i.valueSpec,p=i.styleSpec;return u.expression&&Ac(Ue(a))?dm(i):u.expression&&wu(Me(a))?zs(i):u.type&&Ga[u.type]?Ga[u.type](i):_o(Be({},i,{valueSpec:u.type?p[u.type]:u}))}function En(i){var a=i.value,u=i.key,p=Bs(i);return p.length||(a.indexOf("{fontstack}")===-1&&p.push(new ae(u,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&p.push(new ae(u,a,'"glyphs" url must include a "{range}" token'))),p}function ji(i,a){a===void 0&&(a=X);var u=[];return u=u.concat(Kt({key:"",value:i,valueSpec:a.$root,styleSpec:a,style:i,objectElementValidators:{glyphs:En,"*":function(){return[]}}})),i.constants&&(u=u.concat(_e({key:"constants",value:i.constants,style:i,styleSpec:a}))),Au(u)}function Au(i){return[].concat(i).sort(function(a,u){return a.line-u.line})}function Al(i){return function(){for(var a=[],u=arguments.length;u--;)a[u]=arguments[u];return Au(i.apply(this,a))}}ji.source=Al(Rc),ji.light=Al(Ns),ji.layer=Al(ym),ji.filter=Al(Of),ji.paintProperty=Al(zf),ji.layoutProperty=Al(Su);var Pu=ji,wv=Pu.light,Ev=Pu.paintProperty,Iu=Pu.layoutProperty;function Cu(i,a){var u=!1;if(a&&a.length)for(var p=0,m=a;p<m.length;p+=1)i.fire(new de(new Error(m[p].message))),u=!0;return u}var sa=fr;function fr(i,a,u){var p=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var m=new Int32Array(this.arrayBuffer);i=m[0],this.d=(a=m[1])+2*(u=m[2]);for(var v=0;v<this.d*this.d;v++){var x=m[3+v],T=m[3+v+1];p.push(x===T?null:m.subarray(x,T))}var P=m[3+p.length+1];this.keys=m.subarray(m[3+p.length],P),this.bboxes=m.subarray(P),this.insert=this._insertReadonly}else{this.d=a+2*u;for(var M=0;M<this.d*this.d;M++)p.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=i,this.padding=u,this.scale=a/i,this.uid=0;var L=u/a*i;this.min=-L,this.max=i+L}fr.prototype.insert=function(i,a,u,p,m){this._forEachCell(a,u,p,m,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(m)},fr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},fr.prototype._insertCell=function(i,a,u,p,m,v){this.cells[m].push(v)},fr.prototype.query=function(i,a,u,p,m){var v=this.min,x=this.max;if(i<=v&&a<=v&&x<=u&&x<=p&&!m)return Array.prototype.slice.call(this.keys);var T=[];return this._forEachCell(i,a,u,p,this._queryCell,T,{},m),T},fr.prototype._queryCell=function(i,a,u,p,m,v,x,T){var P=this.cells[m];if(P!==null)for(var M=this.keys,L=this.bboxes,R=0;R<P.length;R++){var F=P[R];if(x[F]===void 0){var V=4*F;(T?T(L[V+0],L[V+1],L[V+2],L[V+3]):i<=L[V+2]&&a<=L[V+3]&&u>=L[V+0]&&p>=L[V+1])?(x[F]=!0,v.push(M[F])):x[F]=!1}}},fr.prototype._forEachCell=function(i,a,u,p,m,v,x,T){for(var P=this._convertToCellCoord(i),M=this._convertToCellCoord(a),L=this._convertToCellCoord(u),R=this._convertToCellCoord(p),F=P;F<=L;F++)for(var V=M;V<=R;V++){var te=this.d*V+F;if((!T||T(this._convertFromCellCoord(F),this._convertFromCellCoord(V),this._convertFromCellCoord(F+1),this._convertFromCellCoord(V+1)))&&m.call(this,i,a,u,p,te,v,x,T))return}},fr.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},fr.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},fr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,a=3+this.cells.length+1+1,u=0,p=0;p<this.cells.length;p++)u+=this.cells[p].length;var m=new Int32Array(a+u+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var v=a,x=0;x<i.length;x++){var T=i[x];m[3+x]=v,m.set(T,v),v+=T.length}return m[3+i.length]=v,m.set(this.keys,v),m[3+i.length+1]=v+=this.keys.length,m.set(this.bboxes,v),v+=this.bboxes.length,m.buffer};var Mu=C.ImageData,vm=C.ImageBitmap,sr={};function ot(i,a,u){u===void 0&&(u={}),Object.defineProperty(a,"_classRegistryKey",{value:i,writeable:!1}),sr[i]={klass:a,omit:u.omit||[],shallow:u.shallow||[]}}for(var Pi in ot("Object",Object),sa.serialize=function(i,a){var u=i.toArrayBuffer();return a&&a.push(u),{buffer:u}},sa.deserialize=function(i){return new sa(i.buffer)},ot("Grid",sa),ot("Color",Wt),ot("Error",Error),ot("ResolvedImage",Pn),ot("StylePropertyFunction",Sl),ot("StyleExpression",El,{omit:["_evaluator"]}),ot("ZoomDependentExpression",Tl),ot("ZoomConstantExpression",Eu),ot("CompoundExpression",Q,{omit:["_evaluate"]}),Ls)Ls[Pi]._classRegistryKey||ot("Expression_"+Pi,Ls[Pi]);function Oc(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Pl(i){return vm&&i instanceof vm}function xo(i,a){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(Oc(i)||Pl(i))return a&&a.push(i),i;if(ArrayBuffer.isView(i)){var u=i;return a&&a.push(u.buffer),u}if(i instanceof Mu)return a&&a.push(i.data.buffer),i;if(Array.isArray(i)){for(var p=[],m=0,v=i;m<v.length;m+=1)p.push(xo(v[m],a));return p}if(typeof i=="object"){var x=i.constructor,T=x._classRegistryKey;if(!T)throw new Error("can't serialize object of unregistered class");var P=x.serialize?x.serialize(i,a):{};if(!x.serialize){for(var M in i)if(i.hasOwnProperty(M)&&!(sr[T].omit.indexOf(M)>=0)){var L=i[M];P[M]=sr[T].shallow.indexOf(M)>=0?L:xo(L,a)}i instanceof Error&&(P.message=i.message)}if(P.$name)throw new Error("$name property is reserved for worker serialization logic.");return T!=="Object"&&(P.$name=T),P}throw new Error("can't serialize object of type "+typeof i)}function Ii(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||Oc(i)||Pl(i)||ArrayBuffer.isView(i)||i instanceof Mu)return i;if(Array.isArray(i))return i.map(Ii);if(typeof i=="object"){var a=i.$name||"Object",u=sr[a].klass;if(!u)throw new Error("can't deserialize unregistered class "+a);if(u.deserialize)return u.deserialize(i);for(var p=Object.create(u.prototype),m=0,v=Object.keys(i);m<v.length;m+=1){var x=v[m];if(x!=="$name"){var T=i[x];p[x]=sr[a].shallow.indexOf(x)>=0?T:Ii(T)}}return p}throw new Error("can't deserialize object of type "+typeof i)}var Bf=function(){this.first=!0};Bf.prototype.update=function(i,a){var u=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=a),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=u,!0))};var Ye={"Latin-1 Supplement":function(i){return i>=128&&i<=255},Arabic:function(i){return i>=1536&&i<=1791},"Arabic Supplement":function(i){return i>=1872&&i<=1919},"Arabic Extended-A":function(i){return i>=2208&&i<=2303},"Hangul Jamo":function(i){return i>=4352&&i<=4607},"Unified Canadian Aboriginal Syllabics":function(i){return i>=5120&&i<=5759},Khmer:function(i){return i>=6016&&i<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(i){return i>=6320&&i<=6399},"General Punctuation":function(i){return i>=8192&&i<=8303},"Letterlike Symbols":function(i){return i>=8448&&i<=8527},"Number Forms":function(i){return i>=8528&&i<=8591},"Miscellaneous Technical":function(i){return i>=8960&&i<=9215},"Control Pictures":function(i){return i>=9216&&i<=9279},"Optical Character Recognition":function(i){return i>=9280&&i<=9311},"Enclosed Alphanumerics":function(i){return i>=9312&&i<=9471},"Geometric Shapes":function(i){return i>=9632&&i<=9727},"Miscellaneous Symbols":function(i){return i>=9728&&i<=9983},"Miscellaneous Symbols and Arrows":function(i){return i>=11008&&i<=11263},"CJK Radicals Supplement":function(i){return i>=11904&&i<=12031},"Kangxi Radicals":function(i){return i>=12032&&i<=12255},"Ideographic Description Characters":function(i){return i>=12272&&i<=12287},"CJK Symbols and Punctuation":function(i){return i>=12288&&i<=12351},Hiragana:function(i){return i>=12352&&i<=12447},Katakana:function(i){return i>=12448&&i<=12543},Bopomofo:function(i){return i>=12544&&i<=12591},"Hangul Compatibility Jamo":function(i){return i>=12592&&i<=12687},Kanbun:function(i){return i>=12688&&i<=12703},"Bopomofo Extended":function(i){return i>=12704&&i<=12735},"CJK Strokes":function(i){return i>=12736&&i<=12783},"Katakana Phonetic Extensions":function(i){return i>=12784&&i<=12799},"Enclosed CJK Letters and Months":function(i){return i>=12800&&i<=13055},"CJK Compatibility":function(i){return i>=13056&&i<=13311},"CJK Unified Ideographs Extension A":function(i){return i>=13312&&i<=19903},"Yijing Hexagram Symbols":function(i){return i>=19904&&i<=19967},"CJK Unified Ideographs":function(i){return i>=19968&&i<=40959},"Yi Syllables":function(i){return i>=40960&&i<=42127},"Yi Radicals":function(i){return i>=42128&&i<=42191},"Hangul Jamo Extended-A":function(i){return i>=43360&&i<=43391},"Hangul Syllables":function(i){return i>=44032&&i<=55215},"Hangul Jamo Extended-B":function(i){return i>=55216&&i<=55295},"Private Use Area":function(i){return i>=57344&&i<=63743},"CJK Compatibility Ideographs":function(i){return i>=63744&&i<=64255},"Arabic Presentation Forms-A":function(i){return i>=64336&&i<=65023},"Vertical Forms":function(i){return i>=65040&&i<=65055},"CJK Compatibility Forms":function(i){return i>=65072&&i<=65103},"Small Form Variants":function(i){return i>=65104&&i<=65135},"Arabic Presentation Forms-B":function(i){return i>=65136&&i<=65279},"Halfwidth and Fullwidth Forms":function(i){return i>=65280&&i<=65519}};function Nf(i){for(var a=0,u=i;a<u.length;a+=1)if(Dc(u[a].charCodeAt(0)))return!0;return!1}function Dc(i){return!(i!==746&&i!==747&&(i<4352||!(Ye["Bopomofo Extended"](i)||Ye.Bopomofo(i)||Ye["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Ye["CJK Compatibility Ideographs"](i)||Ye["CJK Compatibility"](i)||Ye["CJK Radicals Supplement"](i)||Ye["CJK Strokes"](i)||!(!Ye["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Ye["CJK Unified Ideographs Extension A"](i)||Ye["CJK Unified Ideographs"](i)||Ye["Enclosed CJK Letters and Months"](i)||Ye["Hangul Compatibility Jamo"](i)||Ye["Hangul Jamo Extended-A"](i)||Ye["Hangul Jamo Extended-B"](i)||Ye["Hangul Jamo"](i)||Ye["Hangul Syllables"](i)||Ye.Hiragana(i)||Ye["Ideographic Description Characters"](i)||Ye.Kanbun(i)||Ye["Kangxi Radicals"](i)||Ye["Katakana Phonetic Extensions"](i)||Ye.Katakana(i)&&i!==12540||!(!Ye["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Ye["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Ye["Unified Canadian Aboriginal Syllabics"](i)||Ye["Unified Canadian Aboriginal Syllabics Extended"](i)||Ye["Vertical Forms"](i)||Ye["Yijing Hexagram Symbols"](i)||Ye["Yi Syllables"](i)||Ye["Yi Radicals"](i))))}function Ff(i){return!(Dc(i)||function(a){return!!(Ye["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||Ye["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||Ye["Letterlike Symbols"](a)||Ye["Number Forms"](a)||Ye["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||Ye["Control Pictures"](a)&&a!==9251||Ye["Optical Character Recognition"](a)||Ye["Enclosed Alphanumerics"](a)||Ye["Geometric Shapes"](a)||Ye["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||Ye["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Ye["CJK Symbols and Punctuation"](a)||Ye.Katakana(a)||Ye["Private Use Area"](a)||Ye["CJK Compatibility Forms"](a)||Ye["Small Form Variants"](a)||Ye["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(i))}function ro(i){return i>=1424&&i<=2303||Ye["Arabic Presentation Forms-A"](i)||Ye["Arabic Presentation Forms-B"](i)}function Ci(i,a){return!(!a&&ro(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Ye.Khmer(i))}function zc(i){for(var a=0,u=i;a<u.length;a+=1)if(ro(u[a].charCodeAt(0)))return!0;return!1}var Bc=null,Mi="unavailable",la=null,_m=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(Mi="error"),Bc&&Bc(i)};function ku(){Uf.fire(new ie("pluginStateChange",{pluginStatus:Mi,pluginURL:la}))}var Uf=new me,jf=function(){return Mi},bo=function(){if(Mi!=="deferred"||!la)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Mi="loading",ku(),la&&Ss({url:la},function(i){i?_m(i):(Mi="loaded",ku())})},Vi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Mi==="loaded"||Vi.applyArabicShaping!=null},isLoading:function(){return Mi==="loading"},setState:function(i){Mi=i.pluginStatus,la=i.pluginURL},isParsed:function(){return Vi.applyArabicShaping!=null&&Vi.processBidirectionalText!=null&&Vi.processStyledBidirectionalText!=null},getPluginURL:function(){return la}},Zt=function(i,a){this.zoom=i,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Bf,this.transition={})};Zt.prototype.isSupportedScript=function(i){return function(a,u){for(var p=0,m=a;p<m.length;p+=1)if(!Ci(m[p].charCodeAt(0),u))return!1;return!0}(i,Vi.isLoaded())},Zt.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Zt.prototype.getCrossfadeParameters=function(){var i=this.zoom,a=i-Math.floor(i),u=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*a}};var Uo=function(i,a){this.property=i,this.value=a,this.expression=function(u,p){if(Ac(u))return new Sl(u,p);if(wu(u)){var m=hm(u,p);if(m.result==="error")throw new Error(m.value.map(function(x){return x.key+": "+x.message}).join(", "));return m.value}var v=u;return typeof u=="string"&&p.type==="color"&&(v=Wt.parse(u)),{kind:"constant",evaluate:function(){return v}}}(a===void 0?i.specification.default:a,i.specification)};Uo.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Uo.prototype.possiblyEvaluate=function(i,a,u){return this.property.possiblyEvaluate(this,i,a,u)};var io=function(i){this.property=i,this.value=new Uo(i,void 0)};io.prototype.transitioned=function(i,a){return new Fs(this.property,this.value,a,U({},i.transition,this.transition),i.now)},io.prototype.untransitioned=function(){return new Fs(this.property,this.value,null,{},0)};var Fr=function(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)};Fr.prototype.getValue=function(i){return tt(this._values[i].value.value)},Fr.prototype.setValue=function(i,a){this._values.hasOwnProperty(i)||(this._values[i]=new io(this._values[i].property)),this._values[i].value=new Uo(this._values[i].property,a===null?void 0:tt(a))},Fr.prototype.getTransition=function(i){return tt(this._values[i].transition)},Fr.prototype.setTransition=function(i,a){this._values.hasOwnProperty(i)||(this._values[i]=new io(this._values[i].property)),this._values[i].transition=tt(a)||void 0},Fr.prototype.serialize=function(){for(var i={},a=0,u=Object.keys(this._values);a<u.length;a+=1){var p=u[a],m=this.getValue(p);m!==void 0&&(i[p]=m);var v=this.getTransition(p);v!==void 0&&(i[p+"-transition"]=v)}return i},Fr.prototype.transitioned=function(i,a){for(var u=new Wa(this._properties),p=0,m=Object.keys(this._values);p<m.length;p+=1){var v=m[p];u._values[v]=this._values[v].transitioned(i,a._values[v])}return u},Fr.prototype.untransitioned=function(){for(var i=new Wa(this._properties),a=0,u=Object.keys(this._values);a<u.length;a+=1){var p=u[a];i._values[p]=this._values[p].untransitioned()}return i};var Fs=function(i,a,u,p,m){this.property=i,this.value=a,this.begin=m+p.delay||0,this.end=this.begin+p.duration||0,i.specification.transition&&(p.delay||p.duration)&&(this.prior=u)};Fs.prototype.possiblyEvaluate=function(i,a,u){var p=i.now||0,m=this.value.possiblyEvaluate(i,a,u),v=this.prior;if(v){if(p>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(p<this.begin)return v.possiblyEvaluate(i,a,u);var x=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(i,a,u),m,function(T){if(T<=0)return 0;if(T>=1)return 1;var P=T*T,M=P*T;return 4*(T<.5?M:3*(T-P)+M-.75)}(x))}return m};var Wa=function(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)};Wa.prototype.possiblyEvaluate=function(i,a,u){for(var p=new Lu(this._properties),m=0,v=Object.keys(this._values);m<v.length;m+=1){var x=v[m];p._values[x]=this._values[x].possiblyEvaluate(i,a,u)}return p},Wa.prototype.hasTransition=function(){for(var i=0,a=Object.keys(this._values);i<a.length;i+=1)if(this._values[a[i]].prior)return!0;return!1};var wo=function(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)};wo.prototype.getValue=function(i){return tt(this._values[i].value)},wo.prototype.setValue=function(i,a){this._values[i]=new Uo(this._values[i].property,a===null?void 0:tt(a))},wo.prototype.serialize=function(){for(var i={},a=0,u=Object.keys(this._values);a<u.length;a+=1){var p=u[a],m=this.getValue(p);m!==void 0&&(i[p]=m)}return i},wo.prototype.possiblyEvaluate=function(i,a,u){for(var p=new Lu(this._properties),m=0,v=Object.keys(this._values);m<v.length;m+=1){var x=v[m];p._values[x]=this._values[x].possiblyEvaluate(i,a,u)}return p};var ti=function(i,a,u){this.property=i,this.value=a,this.parameters=u};ti.prototype.isConstant=function(){return this.value.kind==="constant"},ti.prototype.constantOr=function(i){return this.value.kind==="constant"?this.value.value:i},ti.prototype.evaluate=function(i,a,u,p){return this.property.evaluate(this.value,this.parameters,i,a,u,p)};var Lu=function(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)};Lu.prototype.get=function(i){return this._values[i]};var pt=function(i){this.specification=i};pt.prototype.possiblyEvaluate=function(i,a){return i.expression.evaluate(a)},pt.prototype.interpolate=function(i,a,u){var p=bl[this.specification.type];return p?p(i,a,u):i};var st=function(i,a){this.specification=i,this.overrides=a};st.prototype.possiblyEvaluate=function(i,a,u,p){return new ti(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(a,null,{},u,p)}:i.expression,a)},st.prototype.interpolate=function(i,a,u){if(i.value.kind!=="constant"||a.value.kind!=="constant")return i;if(i.value.value===void 0||a.value.value===void 0)return new ti(this,{kind:"constant",value:void 0},i.parameters);var p=bl[this.specification.type];return p?new ti(this,{kind:"constant",value:p(i.value.value,a.value.value,u)},i.parameters):i},st.prototype.evaluate=function(i,a,u,p,m,v){return i.kind==="constant"?i.value:i.evaluate(a,u,p,m,v)};var Nc=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.possiblyEvaluate=function(u,p,m,v){if(u.value===void 0)return new ti(this,{kind:"constant",value:void 0},p);if(u.expression.kind==="constant"){var x=u.expression.evaluate(p,null,{},m,v),T=u.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,P=this._calculate(T,T,T,p);return new ti(this,{kind:"constant",value:P},p)}if(u.expression.kind==="camera"){var M=this._calculate(u.expression.evaluate({zoom:p.zoom-1}),u.expression.evaluate({zoom:p.zoom}),u.expression.evaluate({zoom:p.zoom+1}),p);return new ti(this,{kind:"constant",value:M},p)}return new ti(this,u.expression,p)},a.prototype.evaluate=function(u,p,m,v,x,T){if(u.kind==="source"){var P=u.evaluate(p,m,v,x,T);return this._calculate(P,P,P,p)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(p.zoom)-1},m,v),u.evaluate({zoom:Math.floor(p.zoom)},m,v),u.evaluate({zoom:Math.floor(p.zoom)+1},m,v),p):u.value},a.prototype._calculate=function(u,p,m,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:m,to:p}},a.prototype.interpolate=function(u){return u},a}(st),ni=function(i){this.specification=i};ni.prototype.possiblyEvaluate=function(i,a,u,p){if(i.value!==void 0){if(i.expression.kind==="constant"){var m=i.expression.evaluate(a,null,{},u,p);return this._calculate(m,m,m,a)}return this._calculate(i.expression.evaluate(new Zt(Math.floor(a.zoom-1),a)),i.expression.evaluate(new Zt(Math.floor(a.zoom),a)),i.expression.evaluate(new Zt(Math.floor(a.zoom+1),a)),a)}},ni.prototype._calculate=function(i,a,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:i,to:a}:{from:u,to:a}},ni.prototype.interpolate=function(i){return i};var Eo=function(i){this.specification=i};Eo.prototype.possiblyEvaluate=function(i,a,u,p){return!!i.expression.evaluate(a,null,{},u,p)},Eo.prototype.interpolate=function(){return!1};var Ur=function(i){for(var a in this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],i){var u=i[a];u.specification.overridable&&this.overridableProperties.push(a);var p=this.defaultPropertyValues[a]=new Uo(u,void 0),m=this.defaultTransitionablePropertyValues[a]=new io(u);this.defaultTransitioningPropertyValues[a]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=p.possiblyEvaluate({})}};ot("DataDrivenProperty",st),ot("DataConstantProperty",pt),ot("CrossFadedDataDrivenProperty",Nc),ot("CrossFadedProperty",ni),ot("ColorRampProperty",Eo);var jo=function(i){function a(u,p){if(i.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},u.type!=="custom"&&(this.metadata=(u=u).metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),p.layout&&(this._unevaluatedLayout=new wo(p.layout)),p.paint)){for(var m in this._transitionablePaint=new Fr(p.paint),u.paint)this.setPaintProperty(m,u.paint[m],{validate:!1});for(var v in u.layout)this.setLayoutProperty(v,u.layout[v],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Lu(p.paint)}}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},a.prototype.getLayoutProperty=function(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)},a.prototype.setLayoutProperty=function(u,p,m){m===void 0&&(m={}),p!=null&&this._validate(Iu,"layers."+this.id+".layout."+u,u,p,m)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,p):this.visibility=p)},a.prototype.getPaintProperty=function(u){return De(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)},a.prototype.setPaintProperty=function(u,p,m){if(m===void 0&&(m={}),p!=null&&this._validate(Ev,"layers."+this.id+".paint."+u,u,p,m))return!1;if(De(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-11),p||void 0),!1;var v=this._transitionablePaint._values[u],x=v.property.specification["property-type"]==="cross-faded-data-driven",T=v.value.isDataDriven(),P=v.value;this._transitionablePaint.setValue(u,p),this._handleSpecialPaintPropertyUpdate(u);var M=this._transitionablePaint._values[u].value;return M.isDataDriven()||T||x||this._handleOverridablePaintPropertyUpdate(u,P,M)},a.prototype._handleSpecialPaintPropertyUpdate=function(u){},a.prototype._handleOverridablePaintPropertyUpdate=function(u,p,m){return!1},a.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"},a.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},a.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},a.prototype.recalculate=function(u,p){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,p)},a.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),Ve(u,function(p,m){return!(p===void 0||m==="layout"&&!Object.keys(p).length||m==="paint"&&!Object.keys(p).length)})},a.prototype._validate=function(u,p,m,v,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&Cu(this,u.call(Pu,{key:p,layerType:this.type,objectKey:m,value:v,styleSpec:X,style:{glyphs:!0,sprite:!0}}))},a.prototype.is3D=function(){return!1},a.prototype.isTileClipped=function(){return!1},a.prototype.hasOffscreenPass=function(){return!1},a.prototype.resize=function(){},a.prototype.isStateDependent=function(){for(var u in this.paint._values){var p=this.paint.get(u);if(p instanceof ti&&Ds(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1},a}(me),Vf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Fc=function(i,a){this._structArray=i,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},cn=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Mr(i,a){a===void 0&&(a=1);var u=0,p=0;return{members:i.map(function(m){var v=Vf[m.type].BYTES_PER_ELEMENT,x=u=xm(u,Math.max(a,v)),T=m.components||1;return p=Math.max(p,v),u+=v*T,{name:m.name,type:m.type,components:T,offset:x}}),size:xm(u,Math.max(p,a)),alignment:a}}function xm(i,a){return Math.ceil(i/a)*a}cn.serialize=function(i,a){return i._trim(),a&&(i.isTransferred=!0,a.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}},cn.deserialize=function(i){var a=Object.create(this.prototype);return a.arrayBuffer=i.arrayBuffer,a.length=i.length,a.capacity=i.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a},cn.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},cn.prototype.clear=function(){this.length=0},cn.prototype.resize=function(i){this.reserve(i),this.length=i},cn.prototype.reserve=function(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}},cn.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Us=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p){var m=this.length;return this.resize(m+1),this.emplace(m,u,p)},a.prototype.emplace=function(u,p,m){var v=2*u;return this.int16[v+0]=p,this.int16[v+1]=m,u},a}(cn);Us.prototype.bytesPerElement=4,ot("StructArrayLayout2i4",Us);var Gf=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v){var x=this.length;return this.resize(x+1),this.emplace(x,u,p,m,v)},a.prototype.emplace=function(u,p,m,v,x){var T=4*u;return this.int16[T+0]=p,this.int16[T+1]=m,this.int16[T+2]=v,this.int16[T+3]=x,u},a}(cn);Gf.prototype.bytesPerElement=8,ot("StructArrayLayout4i8",Gf);var ua=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v,x,T){var P=this.length;return this.resize(P+1),this.emplace(P,u,p,m,v,x,T)},a.prototype.emplace=function(u,p,m,v,x,T,P){var M=6*u;return this.int16[M+0]=p,this.int16[M+1]=m,this.int16[M+2]=v,this.int16[M+3]=x,this.int16[M+4]=T,this.int16[M+5]=P,u},a}(cn);ua.prototype.bytesPerElement=12,ot("StructArrayLayout2i4i12",ua);var ki=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v,x,T){var P=this.length;return this.resize(P+1),this.emplace(P,u,p,m,v,x,T)},a.prototype.emplace=function(u,p,m,v,x,T,P){var M=4*u,L=8*u;return this.int16[M+0]=p,this.int16[M+1]=m,this.uint8[L+4]=v,this.uint8[L+5]=x,this.uint8[L+6]=T,this.uint8[L+7]=P,u},a}(cn);ki.prototype.bytesPerElement=8,ot("StructArrayLayout2i4ub8",ki);var Il=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p){var m=this.length;return this.resize(m+1),this.emplace(m,u,p)},a.prototype.emplace=function(u,p,m){var v=2*u;return this.float32[v+0]=p,this.float32[v+1]=m,u},a}(cn);Il.prototype.bytesPerElement=8,ot("StructArrayLayout2f8",Il);var Vo=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v,x,T,P,M,L,R){var F=this.length;return this.resize(F+1),this.emplace(F,u,p,m,v,x,T,P,M,L,R)},a.prototype.emplace=function(u,p,m,v,x,T,P,M,L,R,F){var V=10*u;return this.uint16[V+0]=p,this.uint16[V+1]=m,this.uint16[V+2]=v,this.uint16[V+3]=x,this.uint16[V+4]=T,this.uint16[V+5]=P,this.uint16[V+6]=M,this.uint16[V+7]=L,this.uint16[V+8]=R,this.uint16[V+9]=F,u},a}(cn);Vo.prototype.bytesPerElement=20,ot("StructArrayLayout10ui20",Vo);var Uc=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v,x,T,P,M,L,R,F,V){var te=this.length;return this.resize(te+1),this.emplace(te,u,p,m,v,x,T,P,M,L,R,F,V)},a.prototype.emplace=function(u,p,m,v,x,T,P,M,L,R,F,V,te){var ne=12*u;return this.int16[ne+0]=p,this.int16[ne+1]=m,this.int16[ne+2]=v,this.int16[ne+3]=x,this.uint16[ne+4]=T,this.uint16[ne+5]=P,this.uint16[ne+6]=M,this.uint16[ne+7]=L,this.int16[ne+8]=R,this.int16[ne+9]=F,this.int16[ne+10]=V,this.int16[ne+11]=te,u},a}(cn);Uc.prototype.bytesPerElement=24,ot("StructArrayLayout4i4ui4i24",Uc);var Cl=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m){var v=this.length;return this.resize(v+1),this.emplace(v,u,p,m)},a.prototype.emplace=function(u,p,m,v){var x=3*u;return this.float32[x+0]=p,this.float32[x+1]=m,this.float32[x+2]=v,u},a}(cn);Cl.prototype.bytesPerElement=12,ot("StructArrayLayout3f12",Cl);var Ru=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u){var p=this.length;return this.resize(p+1),this.emplace(p,u)},a.prototype.emplace=function(u,p){return this.uint32[1*u+0]=p,u},a}(cn);Ru.prototype.bytesPerElement=4,ot("StructArrayLayout1ul4",Ru);var Wf=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v,x,T,P,M,L){var R=this.length;return this.resize(R+1),this.emplace(R,u,p,m,v,x,T,P,M,L)},a.prototype.emplace=function(u,p,m,v,x,T,P,M,L,R){var F=10*u,V=5*u;return this.int16[F+0]=p,this.int16[F+1]=m,this.int16[F+2]=v,this.int16[F+3]=x,this.int16[F+4]=T,this.int16[F+5]=P,this.uint32[V+3]=M,this.uint16[F+8]=L,this.uint16[F+9]=R,u},a}(cn);Wf.prototype.bytesPerElement=20,ot("StructArrayLayout6i1ul2ui20",Wf);var Ml=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v,x,T){var P=this.length;return this.resize(P+1),this.emplace(P,u,p,m,v,x,T)},a.prototype.emplace=function(u,p,m,v,x,T,P){var M=6*u;return this.int16[M+0]=p,this.int16[M+1]=m,this.int16[M+2]=v,this.int16[M+3]=x,this.int16[M+4]=T,this.int16[M+5]=P,u},a}(cn);Ml.prototype.bytesPerElement=12,ot("StructArrayLayout2i2i2i12",Ml);var js=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v,x){var T=this.length;return this.resize(T+1),this.emplace(T,u,p,m,v,x)},a.prototype.emplace=function(u,p,m,v,x,T){var P=4*u,M=8*u;return this.float32[P+0]=p,this.float32[P+1]=m,this.float32[P+2]=v,this.int16[M+6]=x,this.int16[M+7]=T,u},a}(cn);js.prototype.bytesPerElement=16,ot("StructArrayLayout2f1f2i16",js);var Hf=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v){var x=this.length;return this.resize(x+1),this.emplace(x,u,p,m,v)},a.prototype.emplace=function(u,p,m,v,x){var T=12*u,P=3*u;return this.uint8[T+0]=p,this.uint8[T+1]=m,this.float32[P+1]=v,this.float32[P+2]=x,u},a}(cn);Hf.prototype.bytesPerElement=12,ot("StructArrayLayout2ub2f12",Hf);var Ha=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m){var v=this.length;return this.resize(v+1),this.emplace(v,u,p,m)},a.prototype.emplace=function(u,p,m,v){var x=3*u;return this.uint16[x+0]=p,this.uint16[x+1]=m,this.uint16[x+2]=v,u},a}(cn);Ha.prototype.bytesPerElement=6,ot("StructArrayLayout3ui6",Ha);var qa=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v,x,T,P,M,L,R,F,V,te,ne,ce,se,ve){var we=this.length;return this.resize(we+1),this.emplace(we,u,p,m,v,x,T,P,M,L,R,F,V,te,ne,ce,se,ve)},a.prototype.emplace=function(u,p,m,v,x,T,P,M,L,R,F,V,te,ne,ce,se,ve,we){var Ae=24*u,Ie=12*u,Oe=48*u;return this.int16[Ae+0]=p,this.int16[Ae+1]=m,this.uint16[Ae+2]=v,this.uint16[Ae+3]=x,this.uint32[Ie+2]=T,this.uint32[Ie+3]=P,this.uint32[Ie+4]=M,this.uint16[Ae+10]=L,this.uint16[Ae+11]=R,this.uint16[Ae+12]=F,this.float32[Ie+7]=V,this.float32[Ie+8]=te,this.uint8[Oe+36]=ne,this.uint8[Oe+37]=ce,this.uint8[Oe+38]=se,this.uint32[Ie+10]=ve,this.int16[Ae+22]=we,u},a}(cn);qa.prototype.bytesPerElement=48,ot("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",qa);var jc=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v,x,T,P,M,L,R,F,V,te,ne,ce,se,ve,we,Ae,Ie,Oe,je,Xe,ct,Qe,mt,et,jt){var Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,u,p,m,v,x,T,P,M,L,R,F,V,te,ne,ce,se,ve,we,Ae,Ie,Oe,je,Xe,ct,Qe,mt,et,jt)},a.prototype.emplace=function(u,p,m,v,x,T,P,M,L,R,F,V,te,ne,ce,se,ve,we,Ae,Ie,Oe,je,Xe,ct,Qe,mt,et,jt,Tt){var lt=34*u,qt=17*u;return this.int16[lt+0]=p,this.int16[lt+1]=m,this.int16[lt+2]=v,this.int16[lt+3]=x,this.int16[lt+4]=T,this.int16[lt+5]=P,this.int16[lt+6]=M,this.int16[lt+7]=L,this.uint16[lt+8]=R,this.uint16[lt+9]=F,this.uint16[lt+10]=V,this.uint16[lt+11]=te,this.uint16[lt+12]=ne,this.uint16[lt+13]=ce,this.uint16[lt+14]=se,this.uint16[lt+15]=ve,this.uint16[lt+16]=we,this.uint16[lt+17]=Ae,this.uint16[lt+18]=Ie,this.uint16[lt+19]=Oe,this.uint16[lt+20]=je,this.uint16[lt+21]=Xe,this.uint16[lt+22]=ct,this.uint32[qt+12]=Qe,this.float32[qt+13]=mt,this.float32[qt+14]=et,this.float32[qt+15]=jt,this.float32[qt+16]=Tt,u},a}(cn);jc.prototype.bytesPerElement=68,ot("StructArrayLayout8i15ui1ul4f68",jc);var Za=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u){var p=this.length;return this.resize(p+1),this.emplace(p,u)},a.prototype.emplace=function(u,p){return this.float32[1*u+0]=p,u},a}(cn);Za.prototype.bytesPerElement=4,ot("StructArrayLayout1f4",Za);var oo=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m){var v=this.length;return this.resize(v+1),this.emplace(v,u,p,m)},a.prototype.emplace=function(u,p,m,v){var x=3*u;return this.int16[x+0]=p,this.int16[x+1]=m,this.int16[x+2]=v,u},a}(cn);oo.prototype.bytesPerElement=6,ot("StructArrayLayout3i6",oo);var qf=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m){var v=this.length;return this.resize(v+1),this.emplace(v,u,p,m)},a.prototype.emplace=function(u,p,m,v){var x=4*u;return this.uint32[2*u+0]=p,this.uint16[x+2]=m,this.uint16[x+3]=v,u},a}(cn);qf.prototype.bytesPerElement=8,ot("StructArrayLayout1ul2ui8",qf);var Ou=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p){var m=this.length;return this.resize(m+1),this.emplace(m,u,p)},a.prototype.emplace=function(u,p,m){var v=2*u;return this.uint16[v+0]=p,this.uint16[v+1]=m,u},a}(cn);Ou.prototype.bytesPerElement=4,ot("StructArrayLayout2ui4",Ou);var Zf=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u){var p=this.length;return this.resize(p+1),this.emplace(p,u)},a.prototype.emplace=function(u,p){return this.uint16[1*u+0]=p,u},a}(cn);Zf.prototype.bytesPerElement=2,ot("StructArrayLayout1ui2",Zf);var Vc=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(u,p,m,v){var x=this.length;return this.resize(x+1),this.emplace(x,u,p,m,v)},a.prototype.emplace=function(u,p,m,v,x){var T=4*u;return this.float32[T+0]=p,this.float32[T+1]=m,this.float32[T+2]=v,this.float32[T+3]=x,u},a}(cn);Vc.prototype.bytesPerElement=16,ot("StructArrayLayout4f16",Vc);var c=function(i){function a(){i.apply(this,arguments)}i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new S(this.anchorPointX,this.anchorPointY)},Object.defineProperties(a.prototype,u),a}(Fc);c.prototype.size=20;var f=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.get=function(u){return new c(this,u)},a}(Wf);ot("CollisionBoxArray",f);var h=function(i){function a(){i.apply(this,arguments)}i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(p){this._structArray.uint8[this._pos1+37]=p},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(p){this._structArray.uint8[this._pos1+38]=p},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(p){this._structArray.uint32[this._pos4+10]=p},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(a.prototype,u),a}(Fc);h.prototype.size=48;var d=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.get=function(u){return new h(this,u)},a}(qa);ot("PlacedSymbolArray",d);var _=function(i){function a(){i.apply(this,arguments)}i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(p){this._structArray.uint32[this._pos4+12]=p},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(a.prototype,u),a}(Fc);_.prototype.size=68;var w=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.get=function(u){return new _(this,u)},a}(jc);ot("SymbolInstanceArray",w);var E=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getoffsetX=function(u){return this.float32[1*u+0]},a}(Za);ot("GlyphOffsetArray",E);var A=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getx=function(u){return this.int16[3*u+0]},a.prototype.gety=function(u){return this.int16[3*u+1]},a.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},a}(oo);ot("SymbolLineVertexArray",A);var k=function(i){function a(){i.apply(this,arguments)}i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(a.prototype,u),a}(Fc);k.prototype.size=8;var z=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.get=function(u){return new k(this,u)},a}(qf);ot("FeatureIndexArray",z);var Z=Mr([{name:"a_pos",components:2,type:"Int16"}],4).members,Y=function(i){i===void 0&&(i=[]),this.segments=i};function $(i,a){return 256*(i=he(Math.floor(i),0,255))+he(Math.floor(a),0,255)}Y.prototype.prepareSegment=function(i,a,u,p){var m=this.segments[this.segments.length-1];return i>Y.MAX_VERTEX_ARRAY_LENGTH&&ft("Max vertices per segment is "+Y.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+i),(!m||m.vertexLength+i>Y.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==p)&&(m={vertexOffset:a.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},p!==void 0&&(m.sortKey=p),this.segments.push(m)),m},Y.prototype.get=function(){return this.segments},Y.prototype.destroy=function(){for(var i=0,a=this.segments;i<a.length;i+=1){var u=a[i];for(var p in u.vaos)u.vaos[p].destroy()}},Y.simpleSegment=function(i,a,u,p){return new Y([{vertexOffset:i,primitiveOffset:a,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])},Y.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ot("SegmentVector",Y);var oe=Mr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),re=g(function(i){i.exports=function(a,u){var p,m,v,x,T,P,M,L;for(m=a.length-(p=3&a.length),v=u,T=3432918353,P=461845907,L=0;L<m;)M=255&a.charCodeAt(L)|(255&a.charCodeAt(++L))<<8|(255&a.charCodeAt(++L))<<16|(255&a.charCodeAt(++L))<<24,++L,v=27492+(65535&(x=5*(65535&(v=(v^=M=(65535&(M=(M=(65535&M)*T+(((M>>>16)*T&65535)<<16)&4294967295)<<15|M>>>17))*P+(((M>>>16)*P&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(M=0,p){case 3:M^=(255&a.charCodeAt(L+2))<<16;case 2:M^=(255&a.charCodeAt(L+1))<<8;case 1:v^=M=(65535&(M=(M=(65535&(M^=255&a.charCodeAt(L)))*T+(((M>>>16)*T&65535)<<16)&4294967295)<<15|M>>>17))*P+(((M>>>16)*P&65535)<<16)&4294967295}return v^=a.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}}),ue=g(function(i){i.exports=function(a,u){for(var p,m=a.length,v=u^m,x=0;m>=4;)p=1540483477*(65535&(p=255&a.charCodeAt(x)|(255&a.charCodeAt(++x))<<8|(255&a.charCodeAt(++x))<<16|(255&a.charCodeAt(++x))<<24))+((1540483477*(p>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),m-=4,++x;switch(m){case 3:v^=(255&a.charCodeAt(x+2))<<16;case 2:v^=(255&a.charCodeAt(x+1))<<8;case 1:v=1540483477*(65535&(v^=255&a.charCodeAt(x)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}}),ee=re,le=ue;ee.murmur3=re,ee.murmur2=le;var ge=function(){this.ids=[],this.positions=[],this.indexed=!1};ge.prototype.add=function(i,a,u,p){this.ids.push(Ce(i)),this.positions.push(a,u,p)},ge.prototype.getPositions=function(i){for(var a=Ce(i),u=0,p=this.ids.length-1;u<p;){var m=u+p>>1;this.ids[m]>=a?p=m:u=m+1}for(var v=[];this.ids[u]===a;)v.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return v},ge.serialize=function(i,a){var u=new Float64Array(i.ids),p=new Uint32Array(i.positions);return function m(v,x,T,P){for(;T<P;){for(var M=v[T+P>>1],L=T-1,R=P+1;;){do L++;while(v[L]<M);do R--;while(v[R]>M);if(L>=R)break;Pe(v,L,R),Pe(x,3*L,3*R),Pe(x,3*L+1,3*R+1),Pe(x,3*L+2,3*R+2)}R-T<P-R?(m(v,x,T,R),T=R+1):(m(v,x,R+1,P),P=R)}}(u,p,0,u.length-1),a&&a.push(u.buffer,p.buffer),{ids:u,positions:p}},ge.deserialize=function(i){var a=new ge;return a.ids=i.ids,a.positions=i.positions,a.indexed=!0,a};var be=Math.pow(2,53)-1;function Ce(i){var a=+i;return!isNaN(a)&&a<=be?a:ee(String(i))}function Pe(i,a,u){var p=i[a];i[a]=i[u],i[u]=p}ot("FeaturePositionMap",ge);var ke=function(i,a){this.gl=i.gl,this.location=a},ze=function(i){function a(u,p){i.call(this,u,p),this.current=0}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},a}(ke),He=function(i){function a(u,p){i.call(this,u,p),this.current=0}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},a}(ke),We=function(i){function a(u,p){i.call(this,u,p),this.current=[0,0]}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},a}(ke),nt=function(i){function a(u,p){i.call(this,u,p),this.current=[0,0,0]}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},a}(ke),dt=function(i){function a(u,p){i.call(this,u,p),this.current=[0,0,0,0]}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},a}(ke),vt=function(i){function a(u,p){i.call(this,u,p),this.current=Wt.transparent}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},a}(ke),yt=new Float32Array(16),nn=function(i){function a(u,p){i.call(this,u,p),this.current=yt}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var p=1;p<16;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},a}(ke);function it(i){return[$(255*i.r,255*i.g),$(255*i.b,255*i.a)]}var It=function(i,a,u){this.value=i,this.uniformNames=a.map(function(p){return"u_"+p}),this.type=u};It.prototype.setUniform=function(i,a,u){i.set(u.constantOr(this.value))},It.prototype.getBinding=function(i,a,u){return this.type==="color"?new vt(i,a):new He(i,a)};var Ut=function(i,a){this.uniformNames=a.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ut.prototype.setConstantPatternPositions=function(i,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=i.tlbr},Ut.prototype.setUniform=function(i,a,u,p){var m=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&i.set(m)},Ut.prototype.getBinding=function(i,a,u){return u.substr(0,9)==="u_pattern"?new dt(i,a):new He(i,a)};var Pt=function(i,a,u,p){this.expression=i,this.type=u,this.maxValue=0,this.paintVertexAttributes=a.map(function(m){return{name:"a_"+m,type:"Float32",components:u==="color"?2:1,offset:0}}),this.paintVertexArray=new p};Pt.prototype.populatePaintArray=function(i,a,u,p,m){var v=this.paintVertexArray.length,x=this.expression.evaluate(new Zt(0),a,{},p,[],m);this.paintVertexArray.resize(i),this._setPaintValue(v,i,x)},Pt.prototype.updatePaintArray=function(i,a,u,p){var m=this.expression.evaluate({zoom:0},u,p);this._setPaintValue(i,a,m)},Pt.prototype._setPaintValue=function(i,a,u){if(this.type==="color")for(var p=it(u),m=i;m<a;m++)this.paintVertexArray.emplace(m,p[0],p[1]);else{for(var v=i;v<a;v++)this.paintVertexArray.emplace(v,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},Pt.prototype.upload=function(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Pt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var At=function(i,a,u,p,m,v){this.expression=i,this.uniformNames=a.map(function(x){return"u_"+x+"_t"}),this.type=u,this.useIntegerZoom=p,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=a.map(function(x){return{name:"a_"+x,type:"Float32",components:u==="color"?4:2,offset:0}}),this.paintVertexArray=new v};At.prototype.populatePaintArray=function(i,a,u,p,m){var v=this.expression.evaluate(new Zt(this.zoom),a,{},p,[],m),x=this.expression.evaluate(new Zt(this.zoom+1),a,{},p,[],m),T=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(T,i,v,x)},At.prototype.updatePaintArray=function(i,a,u,p){var m=this.expression.evaluate({zoom:this.zoom},u,p),v=this.expression.evaluate({zoom:this.zoom+1},u,p);this._setPaintValue(i,a,m,v)},At.prototype._setPaintValue=function(i,a,u,p){if(this.type==="color")for(var m=it(u),v=it(p),x=i;x<a;x++)this.paintVertexArray.emplace(x,m[0],m[1],v[0],v[1]);else{for(var T=i;T<a;T++)this.paintVertexArray.emplace(T,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}},At.prototype.upload=function(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},At.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},At.prototype.setUniform=function(i,a){var u=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,p=he(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);i.set(p)},At.prototype.getBinding=function(i,a,u){return new He(i,a)};var Nt=function(i,a,u,p,m,v){this.expression=i,this.type=a,this.useIntegerZoom=u,this.zoom=p,this.layerId=v,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m};Nt.prototype.populatePaintArray=function(i,a,u){var p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(p,i,a.patterns&&a.patterns[this.layerId],u)},Nt.prototype.updatePaintArray=function(i,a,u,p,m){this._setPaintValues(i,a,u.patterns&&u.patterns[this.layerId],m)},Nt.prototype._setPaintValues=function(i,a,u,p){if(p&&u){var m=p[u.min],v=p[u.mid],x=p[u.max];if(m&&v&&x)for(var T=i;T<a;T++)this.zoomInPaintVertexArray.emplace(T,v.tl[0],v.tl[1],v.br[0],v.br[1],m.tl[0],m.tl[1],m.br[0],m.br[1],v.pixelRatio,m.pixelRatio),this.zoomOutPaintVertexArray.emplace(T,v.tl[0],v.tl[1],v.br[0],v.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],v.pixelRatio,x.pixelRatio)}},Nt.prototype.upload=function(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,oe.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,oe.members,this.expression.isStateDependent))},Nt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var St=function(i,a,u){this.binders={},this._buffers=[];var p=[];for(var m in i.paint._values)if(u(m)){var v=i.paint.get(m);if(v instanceof ti&&Ds(v.property.specification)){var x=br(m,i.type),T=v.value,P=v.property.specification.type,M=v.property.useIntegerZoom,L=v.property.specification["property-type"],R=L==="cross-faded"||L==="cross-faded-data-driven";if(T.kind==="constant")this.binders[m]=R?new Ut(T.value,x):new It(T.value,x,P),p.push("/u_"+m);else if(T.kind==="source"||R){var F=Vn(m,P,"source");this.binders[m]=R?new Nt(T,P,M,a,F,i.id):new Pt(T,x,P,F),p.push("/a_"+m)}else{var V=Vn(m,P,"composite");this.binders[m]=new At(T,x,P,M,a,V),p.push("/z_"+m)}}}this.cacheKey=p.sort().join("")};St.prototype.getMaxValue=function(i){var a=this.binders[i];return a instanceof Pt||a instanceof At?a.maxValue:0},St.prototype.populatePaintArrays=function(i,a,u,p,m){for(var v in this.binders){var x=this.binders[v];(x instanceof Pt||x instanceof At||x instanceof Nt)&&x.populatePaintArray(i,a,u,p,m)}},St.prototype.setConstantPatternPositions=function(i,a){for(var u in this.binders){var p=this.binders[u];p instanceof Ut&&p.setConstantPatternPositions(i,a)}},St.prototype.updatePaintArrays=function(i,a,u,p,m){var v=!1;for(var x in i)for(var T=0,P=a.getPositions(x);T<P.length;T+=1){var M=P[T],L=u.feature(M.index);for(var R in this.binders){var F=this.binders[R];if((F instanceof Pt||F instanceof At||F instanceof Nt)&&F.expression.isStateDependent===!0){var V=p.paint.get(R);F.expression=V.value,F.updatePaintArray(M.start,M.end,L,i[x],m),v=!0}}}return v},St.prototype.defines=function(){var i=[];for(var a in this.binders){var u=this.binders[a];(u instanceof It||u instanceof Ut)&&i.push.apply(i,u.uniformNames.map(function(p){return"#define HAS_UNIFORM_"+p}))}return i},St.prototype.getBinderAttributes=function(){var i=[];for(var a in this.binders){var u=this.binders[a];if(u instanceof Pt||u instanceof At)for(var p=0;p<u.paintVertexAttributes.length;p++)i.push(u.paintVertexAttributes[p].name);else if(u instanceof Nt)for(var m=0;m<oe.members.length;m++)i.push(oe.members[m].name)}return i},St.prototype.getBinderUniforms=function(){var i=[];for(var a in this.binders){var u=this.binders[a];if(u instanceof It||u instanceof Ut||u instanceof At)for(var p=0,m=u.uniformNames;p<m.length;p+=1)i.push(m[p])}return i},St.prototype.getPaintVertexBuffers=function(){return this._buffers},St.prototype.getUniforms=function(i,a){var u=[];for(var p in this.binders){var m=this.binders[p];if(m instanceof It||m instanceof Ut||m instanceof At)for(var v=0,x=m.uniformNames;v<x.length;v+=1){var T=x[v];if(a[T]){var P=m.getBinding(i,a[T],T);u.push({name:T,property:p,binding:P})}}}return u},St.prototype.setUniforms=function(i,a,u,p){for(var m=0,v=a;m<v.length;m+=1){var x=v[m],T=x.name,P=x.property;this.binders[P].setUniform(x.binding,p,u.get(P),T)}},St.prototype.updatePaintBuffers=function(i){for(var a in this._buffers=[],this.binders){var u=this.binders[a];if(i&&u instanceof Nt){var p=i.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(u instanceof Pt||u instanceof At)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},St.prototype.upload=function(i){for(var a in this.binders){var u=this.binders[a];(u instanceof Pt||u instanceof At||u instanceof Nt)&&u.upload(i)}this.updatePaintBuffers()},St.prototype.destroy=function(){for(var i in this.binders){var a=this.binders[i];(a instanceof Pt||a instanceof At||a instanceof Nt)&&a.destroy()}};var Et=function(i,a,u){u===void 0&&(u=function(){return!0}),this.programConfigurations={};for(var p=0,m=i;p<m.length;p+=1){var v=m[p];this.programConfigurations[v.id]=new St(v,a,u)}this.needsUpload=!1,this._featureMap=new ge,this._bufferOffset=0};function br(i,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(a+"-","").replace(/-/g,"_")]}function Vn(i,a,u){var p={color:{source:Il,composite:Vc},number:{source:Za,composite:Il}},m=function(v){return{"line-pattern":{source:Vo,composite:Vo},"fill-pattern":{source:Vo,composite:Vo},"fill-extrusion-pattern":{source:Vo,composite:Vo}}[v]}(i);return m&&m[u]||p[a][u]}Et.prototype.populatePaintArrays=function(i,a,u,p,m,v){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(i,a,p,m,v);a.id!==void 0&&this._featureMap.add(a.id,u,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0},Et.prototype.updatePaintArrays=function(i,a,u,p){for(var m=0,v=u;m<v.length;m+=1){var x=v[m];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(i,this._featureMap,a,x,p)||this.needsUpload}},Et.prototype.get=function(i){return this.programConfigurations[i]},Et.prototype.upload=function(i){if(this.needsUpload){for(var a in this.programConfigurations)this.programConfigurations[a].upload(i);this.needsUpload=!1}},Et.prototype.destroy=function(){for(var i in this.programConfigurations)this.programConfigurations[i].destroy()},ot("ConstantBinder",It),ot("CrossFadedConstantBinder",Ut),ot("SourceExpressionBinder",Pt),ot("CrossFadedCompositeBinder",Nt),ot("CompositeExpressionBinder",At),ot("ProgramConfiguration",St,{omit:["_buffers"]}),ot("ProgramConfigurationSet",Et);var Xr=Math.pow(2,14)-1,kr=-Xr-1;function Bn(i){for(var a=8192/i.extent,u=i.loadGeometry(),p=0;p<u.length;p++)for(var m=u[p],v=0;v<m.length;v++){var x=m[v],T=Math.round(x.x*a),P=Math.round(x.y*a);x.x=he(T,kr,Xr),x.y=he(P,kr,Xr),(T<x.x||T>x.x+1||P<x.y||P>x.y+1)&&ft("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function Yn(i,a){return{type:i.type,id:i.id,properties:i.properties,geometry:a?Bn(i):[]}}function Li(i,a,u,p,m){i.emplaceBack(2*a+(p+1)/2,2*u+(m+1)/2)}var ri=function(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new Us,this.indexArray=new Ha,this.segments=new Y,this.programConfigurations=new Et(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};function Xa(i,a){for(var u=0;u<i.length;u++)if(Go(a,i[u]))return!0;for(var p=0;p<a.length;p++)if(Go(i,a[p]))return!0;return!!Du(i,a)}function ui(i,a,u){return!!Go(i,a)||!!Ya(a,i,u)}function To(i,a){if(i.length===1)return zu(a,i[0]);for(var u=0;u<a.length;u++)for(var p=a[u],m=0;m<p.length;m++)if(Go(i,p[m]))return!0;for(var v=0;v<i.length;v++)if(zu(a,i[v]))return!0;for(var x=0;x<a.length;x++)if(Du(i,a[x]))return!0;return!1}function ao(i,a,u){if(i.length>1){if(Du(i,a))return!0;for(var p=0;p<a.length;p++)if(Ya(a[p],i,u))return!0}for(var m=0;m<i.length;m++)if(Ya(i[m],a,u))return!0;return!1}function Du(i,a){if(i.length===0||a.length===0)return!1;for(var u=0;u<i.length-1;u++)for(var p=i[u],m=i[u+1],v=0;v<a.length-1;v++)if(kl(p,m,a[v],a[v+1]))return!0;return!1}function kl(i,a,u,p){return wt(i,u,p)!==wt(a,u,p)&&wt(i,a,u)!==wt(i,a,p)}function Ya(i,a,u){var p=u*u;if(a.length===1)return i.distSqr(a[0])<p;for(var m=1;m<a.length;m++)if(Ll(i,a[m-1],a[m])<p)return!0;return!1}function Ll(i,a,u){var p=a.distSqr(u);if(p===0)return i.distSqr(a);var m=((i.x-a.x)*(u.x-a.x)+(i.y-a.y)*(u.y-a.y))/p;return i.distSqr(m<0?a:m>1?u:u.sub(a)._mult(m)._add(a))}function zu(i,a){for(var u,p,m,v=!1,x=0;x<i.length;x++)for(var T=0,P=(u=i[x]).length-1;T<u.length;P=T++)(p=u[T]).y>a.y!=(m=u[P]).y>a.y&&a.x<(m.x-p.x)*(a.y-p.y)/(m.y-p.y)+p.x&&(v=!v);return v}function Go(i,a){for(var u=!1,p=0,m=i.length-1;p<i.length;m=p++){var v=i[p],x=i[m];v.y>a.y!=x.y>a.y&&a.x<(x.x-v.x)*(a.y-v.y)/(x.y-v.y)+v.x&&(u=!u)}return u}function Bu(i,a,u){var p=u[0],m=u[2];if(i.x<p.x&&a.x<p.x||i.x>m.x&&a.x>m.x||i.y<p.y&&a.y<p.y||i.y>m.y&&a.y>m.y)return!1;var v=wt(i,a,u[0]);return v!==wt(i,a,u[1])||v!==wt(i,a,u[2])||v!==wt(i,a,u[3])}function Wo(i,a,u){var p=a.paint.get(i).value;return p.kind==="constant"?p.value:u.programConfigurations.get(a.id).getMaxValue(i)}function wr(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function ca(i,a,u,p,m){if(!a[0]&&!a[1])return i;var v=S.convert(a)._mult(m);u==="viewport"&&v._rotate(-p);for(var x=[],T=0;T<i.length;T++)x.push(i[T].sub(v));return x}ri.prototype.populate=function(i,a,u){var p=this.layers[0],m=[],v=null;p.type==="circle"&&(v=p.layout.get("circle-sort-key"));for(var x=0,T=i;x<T.length;x+=1){var P=T[x],M=P.feature,L=P.id,R=P.index,F=P.sourceLayerIndex,V=this.layers[0]._featureFilter.needGeometry,te=Yn(M,V);if(this.layers[0]._featureFilter.filter(new Zt(this.zoom),te,u)){var ne=v?v.evaluate(te,{},u):void 0,ce={id:L,properties:M.properties,type:M.type,sourceLayerIndex:F,index:R,geometry:V?te.geometry:Bn(M),patterns:{},sortKey:ne};m.push(ce)}}v&&m.sort(function(Xe,ct){return Xe.sortKey-ct.sortKey});for(var se=0,ve=m;se<ve.length;se+=1){var we=ve[se],Ae=we.geometry,Ie=we.index,Oe=we.sourceLayerIndex,je=i[Ie].feature;this.addFeature(we,Ae,Ie,u),a.featureIndex.insert(je,Ae,Ie,Oe,this.index)}},ri.prototype.update=function(i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,u)},ri.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ri.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ri.prototype.upload=function(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Z),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0},ri.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ri.prototype.addFeature=function(i,a,u,p){for(var m=0,v=a;m<v.length;m+=1)for(var x=0,T=v[m];x<T.length;x+=1){var P=T[x],M=P.x,L=P.y;if(!(M<0||M>=8192||L<0||L>=8192)){var R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),F=R.vertexLength;Li(this.layoutVertexArray,M,L,-1,-1),Li(this.layoutVertexArray,M,L,1,-1),Li(this.layoutVertexArray,M,L,1,1),Li(this.layoutVertexArray,M,L,-1,1),this.indexArray.emplaceBack(F,F+1,F+2),this.indexArray.emplaceBack(F,F+3,F+2),R.vertexLength+=4,R.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,{},p)},ot("CircleBucket",ri,{omit:["layers"]});var $a=new Ur({"circle-sort-key":new st(X.layout_circle["circle-sort-key"])}),Vs={paint:new Ur({"circle-radius":new st(X.paint_circle["circle-radius"]),"circle-color":new st(X.paint_circle["circle-color"]),"circle-blur":new st(X.paint_circle["circle-blur"]),"circle-opacity":new st(X.paint_circle["circle-opacity"]),"circle-translate":new pt(X.paint_circle["circle-translate"]),"circle-translate-anchor":new pt(X.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new pt(X.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new pt(X.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new st(X.paint_circle["circle-stroke-width"]),"circle-stroke-color":new st(X.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new st(X.paint_circle["circle-stroke-opacity"])}),layout:$a},un=typeof Float32Array<"u"?Float32Array:Array;function Gi(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function ci(i,a,u){var p=a[0],m=a[1],v=a[2],x=a[3],T=a[4],P=a[5],M=a[6],L=a[7],R=a[8],F=a[9],V=a[10],te=a[11],ne=a[12],ce=a[13],se=a[14],ve=a[15],we=u[0],Ae=u[1],Ie=u[2],Oe=u[3];return i[0]=we*p+Ae*T+Ie*R+Oe*ne,i[1]=we*m+Ae*P+Ie*F+Oe*ce,i[2]=we*v+Ae*M+Ie*V+Oe*se,i[3]=we*x+Ae*L+Ie*te+Oe*ve,i[4]=(we=u[4])*p+(Ae=u[5])*T+(Ie=u[6])*R+(Oe=u[7])*ne,i[5]=we*m+Ae*P+Ie*F+Oe*ce,i[6]=we*v+Ae*M+Ie*V+Oe*se,i[7]=we*x+Ae*L+Ie*te+Oe*ve,i[8]=(we=u[8])*p+(Ae=u[9])*T+(Ie=u[10])*R+(Oe=u[11])*ne,i[9]=we*m+Ae*P+Ie*F+Oe*ce,i[10]=we*v+Ae*M+Ie*V+Oe*se,i[11]=we*x+Ae*L+Ie*te+Oe*ve,i[12]=(we=u[12])*p+(Ae=u[13])*T+(Ie=u[14])*R+(Oe=u[15])*ne,i[13]=we*m+Ae*P+Ie*F+Oe*ce,i[14]=we*v+Ae*M+Ie*V+Oe*se,i[15]=we*x+Ae*L+Ie*te+Oe*ve,i}Math.hypot||(Math.hypot=function(){for(var i=arguments,a=0,u=arguments.length;u--;)a+=i[u]*i[u];return Math.sqrt(a)});var Gs,Tv=ci;function Gc(i,a,u){var p=a[0],m=a[1],v=a[2],x=a[3];return i[0]=u[0]*p+u[4]*m+u[8]*v+u[12]*x,i[1]=u[1]*p+u[5]*m+u[9]*v+u[13]*x,i[2]=u[2]*p+u[6]*m+u[10]*v+u[14]*x,i[3]=u[3]*p+u[7]*m+u[11]*v+u[15]*x,i}Gs=new un(3),un!=Float32Array&&(Gs[0]=0,Gs[1]=0,Gs[2]=0),function(){var i=new un(4);un!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0)}();var Sv=(function(){var i=new un(2);un!=Float32Array&&(i[0]=0,i[1]=0)}(),function(i){function a(u){i.call(this,u,Vs)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.createBucket=function(u){return new ri(u)},a.prototype.queryRadius=function(u){var p=u;return Wo("circle-radius",this,p)+Wo("circle-stroke-width",this,p)+wr(this.paint.get("circle-translate"))},a.prototype.queryIntersectsFeature=function(u,p,m,v,x,T,P,M){for(var L=ca(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),T.angle,P),R=this.paint.get("circle-radius").evaluate(p,m)+this.paint.get("circle-stroke-width").evaluate(p,m),F=this.paint.get("circle-pitch-alignment")==="map",V=F?L:function(je,Xe){return je.map(function(ct){return Nu(ct,Xe)})}(L,M),te=F?R*P:R,ne=0,ce=v;ne<ce.length;ne+=1)for(var se=0,ve=ce[ne];se<ve.length;se+=1){var we=ve[se],Ae=F?we:Nu(we,M),Ie=te,Oe=Gc([],[we.x,we.y,0,1],M);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ie*=Oe[3]/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ie*=T.cameraToCenterDistance/Oe[3]),ui(V,Ae,Ie))return!0}return!1},a}(jo));function Nu(i,a){var u=Gc([],[i.x,i.y,0,1],a);return new S(u[0]/u[3],u[1]/u[3])}var bm=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a}(ri);function Rl(i,a,u,p){var m=a.width,v=a.height;if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==m*v*u)throw new RangeError("mismatched image size")}else p=new Uint8Array(m*v*u);return i.width=m,i.height=v,i.data=p,i}function Wc(i,a,u){var p=a.width,m=a.height;if(p!==i.width||m!==i.height){var v=Rl({},{width:p,height:m},u);Av(i,v,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,p),height:Math.min(i.height,m)},u),i.width=p,i.height=m,i.data=v.data}}function Av(i,a,u,p,m,v){if(m.width===0||m.height===0)return a;if(m.width>i.width||m.height>i.height||u.x>i.width-m.width||u.y>i.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>a.width||m.height>a.height||p.x>a.width-m.width||p.y>a.height-m.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=i.data,T=a.data,P=0;P<m.height;P++)for(var M=((u.y+P)*i.width+u.x)*v,L=((p.y+P)*a.width+p.x)*v,R=0;R<m.width*v;R++)T[L+R]=x[M+R];return a}ot("HeatmapBucket",bm,{omit:["layers"]});var Fu=function(i,a){Rl(this,i,1,a)};Fu.prototype.resize=function(i){Wc(this,i,1)},Fu.prototype.clone=function(){return new Fu({width:this.width,height:this.height},new Uint8Array(this.data))},Fu.copy=function(i,a,u,p,m){Av(i,a,u,p,m,1)};var Ri=function(i,a){Rl(this,i,4,a)};Ri.prototype.resize=function(i){Wc(this,i,4)},Ri.prototype.replace=function(i,a){a?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i},Ri.prototype.clone=function(){return new Ri({width:this.width,height:this.height},new Uint8Array(this.data))},Ri.copy=function(i,a,u,p,m){Av(i,a,u,p,m,4)},ot("AlphaImage",Fu),ot("RGBAImage",Ri);var hM={paint:new Ur({"heatmap-radius":new st(X.paint_heatmap["heatmap-radius"]),"heatmap-weight":new st(X.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new pt(X.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Eo(X.paint_heatmap["heatmap-color"]),"heatmap-opacity":new pt(X.paint_heatmap["heatmap-opacity"])})};function Ab(i){var a={},u=i.resolution||256,p=i.clips?i.clips.length:1,m=i.image||new Ri({width:u,height:p}),v=function(te,ne,ce){a[i.evaluationKey]=ce;var se=i.expression.evaluate(a);m.data[te+ne+0]=Math.floor(255*se.r/se.a),m.data[te+ne+1]=Math.floor(255*se.g/se.a),m.data[te+ne+2]=Math.floor(255*se.b/se.a),m.data[te+ne+3]=Math.floor(255*se.a)};if(i.clips)for(var x=0,T=0;x<p;++x,T+=4*u)for(var P=0,M=0;P<u;P++,M+=4){var L=P/(u-1),R=i.clips[x];v(T,M,R.start*(1-L)+R.end*L)}else for(var F=0,V=0;F<u;F++,V+=4)v(0,V,F/(u-1));return m}var fM=function(i){function a(u){i.call(this,u,hM),this._updateColorRamp()}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.createBucket=function(u){return new bm(u)},a.prototype._handleSpecialPaintPropertyUpdate=function(u){u==="heatmap-color"&&this._updateColorRamp()},a.prototype._updateColorRamp=function(){this.colorRamp=Ab({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},a.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},a.prototype.queryRadius=function(){return 0},a.prototype.queryIntersectsFeature=function(){return!1},a.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},a}(jo),pM={paint:new Ur({"hillshade-illumination-direction":new pt(X.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new pt(X.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new pt(X.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new pt(X.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new pt(X.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new pt(X.paint_hillshade["hillshade-accent-color"])})},dM=function(i){function a(u){i.call(this,u,pM)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},a}(jo),mM=Mr([{name:"a_pos",components:2,type:"Int16"}],4).members,Pv=wm,gM=wm;function wm(i,a,u){u=u||2;var p,m,v,x,T,P,M,L=a&&a.length,R=L?a[0]*u:i.length,F=Pb(i,0,R,u,!0),V=[];if(!F||F.next===F.prev)return V;if(L&&(F=function(ne,ce,se,ve){var we,Ae,Ie,Oe=[];for(we=0,Ae=ce.length;we<Ae;we++)(Ie=Pb(ne,ce[we]*ve,we<Ae-1?ce[we+1]*ve:ne.length,ve,!1))===Ie.next&&(Ie.steiner=!0),Oe.push(TM(Ie));for(Oe.sort(bM),we=0;we<Oe.length;we++)wM(Oe[we],se),se=Ol(se,se.next);return se}(i,a,F,u)),i.length>80*u){p=v=i[0],m=x=i[1];for(var te=u;te<R;te+=u)(T=i[te])<p&&(p=T),(P=i[te+1])<m&&(m=P),T>v&&(v=T),P>x&&(x=P);M=(M=Math.max(v-p,x-m))!==0?1/M:0}return Xf(F,V,u,p,m,M),V}function Pb(i,a,u,p,m){var v,x;if(m===Mv(i,a,u,p)>0)for(v=a;v<u;v+=p)x=Mb(v,i[v],i[v+1],x);else for(v=u-p;v>=a;v-=p)x=Mb(v,i[v],i[v+1],x);return x&&Em(x,x.next)&&($f(x),x=x.next),x}function Ol(i,a){if(!i)return i;a||(a=i);var u,p=i;do if(u=!1,p.steiner||!Em(p,p.next)&&pr(p.prev,p,p.next)!==0)p=p.next;else{if($f(p),(p=a=p.prev)===p.next)break;u=!0}while(u||p!==a);return a}function Xf(i,a,u,p,m,v,x){if(i){!x&&v&&function(L,R,F,V){var te=L;do te.z===null&&(te.z=Iv(te.x,te.y,R,F,V)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next;while(te!==L);te.prevZ.nextZ=null,te.prevZ=null,function(ne){var ce,se,ve,we,Ae,Ie,Oe,je,Xe=1;do{for(se=ne,ne=null,Ae=null,Ie=0;se;){for(Ie++,ve=se,Oe=0,ce=0;ce<Xe&&(Oe++,ve=ve.nextZ);ce++);for(je=Xe;Oe>0||je>0&&ve;)Oe!==0&&(je===0||!ve||se.z<=ve.z)?(we=se,se=se.nextZ,Oe--):(we=ve,ve=ve.nextZ,je--),Ae?Ae.nextZ=we:ne=we,we.prevZ=Ae,Ae=we;se=ve}Ae.nextZ=null,Xe*=2}while(Ie>1)}(te)}(i,p,m,v);for(var T,P,M=i;i.prev!==i.next;)if(T=i.prev,P=i.next,v?vM(i,p,m,v):yM(i))a.push(T.i/u),a.push(i.i/u),a.push(P.i/u),$f(i),i=P.next,M=P.next;else if((i=P)===M){x?x===1?Xf(i=_M(Ol(i),a,u),a,u,p,m,v,2):x===2&&xM(i,a,u,p,m,v):Xf(Ol(i),a,u,p,m,v,1);break}}}function yM(i){var a=i.prev,u=i,p=i.next;if(pr(a,u,p)>=0)return!1;for(var m=i.next.next;m!==i.prev;){if(Hc(a.x,a.y,u.x,u.y,p.x,p.y,m.x,m.y)&&pr(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function vM(i,a,u,p){var m=i.prev,v=i,x=i.next;if(pr(m,v,x)>=0)return!1;for(var T=m.x>v.x?m.x>x.x?m.x:x.x:v.x>x.x?v.x:x.x,P=m.y>v.y?m.y>x.y?m.y:x.y:v.y>x.y?v.y:x.y,M=Iv(m.x<v.x?m.x<x.x?m.x:x.x:v.x<x.x?v.x:x.x,m.y<v.y?m.y<x.y?m.y:x.y:v.y<x.y?v.y:x.y,a,u,p),L=Iv(T,P,a,u,p),R=i.prevZ,F=i.nextZ;R&&R.z>=M&&F&&F.z<=L;){if(R!==i.prev&&R!==i.next&&Hc(m.x,m.y,v.x,v.y,x.x,x.y,R.x,R.y)&&pr(R.prev,R,R.next)>=0||(R=R.prevZ,F!==i.prev&&F!==i.next&&Hc(m.x,m.y,v.x,v.y,x.x,x.y,F.x,F.y)&&pr(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;R&&R.z>=M;){if(R!==i.prev&&R!==i.next&&Hc(m.x,m.y,v.x,v.y,x.x,x.y,R.x,R.y)&&pr(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;F&&F.z<=L;){if(F!==i.prev&&F!==i.next&&Hc(m.x,m.y,v.x,v.y,x.x,x.y,F.x,F.y)&&pr(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function _M(i,a,u){var p=i;do{var m=p.prev,v=p.next.next;!Em(m,v)&&Ib(m,p,p.next,v)&&Yf(m,v)&&Yf(v,m)&&(a.push(m.i/u),a.push(p.i/u),a.push(v.i/u),$f(p),$f(p.next),p=i=v),p=p.next}while(p!==i);return Ol(p)}function xM(i,a,u,p,m,v){var x=i;do{for(var T=x.next.next;T!==x.prev;){if(x.i!==T.i&&SM(x,T)){var P=Cb(x,T);return x=Ol(x,x.next),P=Ol(P,P.next),Xf(x,a,u,p,m,v),void Xf(P,a,u,p,m,v)}T=T.next}x=x.next}while(x!==i)}function bM(i,a){return i.x-a.x}function wM(i,a){if(a=function(p,m){var v,x=m,T=p.x,P=p.y,M=-1/0;do{if(P<=x.y&&P>=x.next.y&&x.next.y!==x.y){var L=x.x+(P-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(L<=T&&L>M){if(M=L,L===T){if(P===x.y)return x;if(P===x.next.y)return x.next}v=x.x<x.next.x?x:x.next}}x=x.next}while(x!==m);if(!v)return null;if(T===M)return v;var R,F=v,V=v.x,te=v.y,ne=1/0;x=v;do T>=x.x&&x.x>=V&&T!==x.x&&Hc(P<te?T:M,P,V,te,P<te?M:T,P,x.x,x.y)&&(R=Math.abs(P-x.y)/(T-x.x),Yf(x,p)&&(R<ne||R===ne&&(x.x>v.x||x.x===v.x&&EM(v,x)))&&(v=x,ne=R)),x=x.next;while(x!==F);return v}(i,a)){var u=Cb(a,i);Ol(a,a.next),Ol(u,u.next)}}function EM(i,a){return pr(i.prev,i,a.prev)<0&&pr(a.next,i,i.next)<0}function Iv(i,a,u,p,m){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-u)*m)|i<<8))|i<<4))|i<<2))|i<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-p)*m)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function TM(i){var a=i,u=i;do(a.x<u.x||a.x===u.x&&a.y<u.y)&&(u=a),a=a.next;while(a!==i);return u}function Hc(i,a,u,p,m,v,x,T){return(m-x)*(a-T)-(i-x)*(v-T)>=0&&(i-x)*(p-T)-(u-x)*(a-T)>=0&&(u-x)*(v-T)-(m-x)*(p-T)>=0}function SM(i,a){return i.next.i!==a.i&&i.prev.i!==a.i&&!function(u,p){var m=u;do{if(m.i!==u.i&&m.next.i!==u.i&&m.i!==p.i&&m.next.i!==p.i&&Ib(m,m.next,u,p))return!0;m=m.next}while(m!==u);return!1}(i,a)&&(Yf(i,a)&&Yf(a,i)&&function(u,p){var m=u,v=!1,x=(u.x+p.x)/2,T=(u.y+p.y)/2;do m.y>T!=m.next.y>T&&m.next.y!==m.y&&x<(m.next.x-m.x)*(T-m.y)/(m.next.y-m.y)+m.x&&(v=!v),m=m.next;while(m!==u);return v}(i,a)&&(pr(i.prev,i,a.prev)||pr(i,a.prev,a))||Em(i,a)&&pr(i.prev,i,i.next)>0&&pr(a.prev,a,a.next)>0)}function pr(i,a,u){return(a.y-i.y)*(u.x-a.x)-(a.x-i.x)*(u.y-a.y)}function Em(i,a){return i.x===a.x&&i.y===a.y}function Ib(i,a,u,p){var m=Sm(pr(i,a,u)),v=Sm(pr(i,a,p)),x=Sm(pr(u,p,i)),T=Sm(pr(u,p,a));return m!==v&&x!==T||!(m!==0||!Tm(i,u,a))||!(v!==0||!Tm(i,p,a))||!(x!==0||!Tm(u,i,p))||!(T!==0||!Tm(u,a,p))}function Tm(i,a,u){return a.x<=Math.max(i.x,u.x)&&a.x>=Math.min(i.x,u.x)&&a.y<=Math.max(i.y,u.y)&&a.y>=Math.min(i.y,u.y)}function Sm(i){return i>0?1:i<0?-1:0}function Yf(i,a){return pr(i.prev,i,i.next)<0?pr(i,a,i.next)>=0&&pr(i,i.prev,a)>=0:pr(i,a,i.prev)<0||pr(i,i.next,a)<0}function Cb(i,a){var u=new Cv(i.i,i.x,i.y),p=new Cv(a.i,a.x,a.y),m=i.next,v=a.prev;return i.next=a,a.prev=i,u.next=m,m.prev=u,p.next=u,u.prev=p,v.next=p,p.prev=v,p}function Mb(i,a,u,p){var m=new Cv(i,a,u);return p?(m.next=p.next,m.prev=p,p.next.prev=m,p.next=m):(m.prev=m,m.next=m),m}function $f(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Cv(i,a,u){this.i=i,this.x=a,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Mv(i,a,u,p){for(var m=0,v=a,x=u-p;v<u;v+=p)m+=(i[x]-i[v])*(i[v+1]+i[x+1]),x=v;return m}function AM(i,a,u,p,m){(function v(x,T,P,M,L){for(;M>P;){if(M-P>600){var R=M-P+1,F=T-P+1,V=Math.log(R),te=.5*Math.exp(2*V/3),ne=.5*Math.sqrt(V*te*(R-te)/R)*(F-R/2<0?-1:1);v(x,T,Math.max(P,Math.floor(T-F*te/R+ne)),Math.min(M,Math.floor(T+(R-F)*te/R+ne)),L)}var ce=x[T],se=P,ve=M;for(Kf(x,P,T),L(x[M],ce)>0&&Kf(x,P,M);se<ve;){for(Kf(x,se,ve),se++,ve--;L(x[se],ce)<0;)se++;for(;L(x[ve],ce)>0;)ve--}L(x[P],ce)===0?Kf(x,P,ve):Kf(x,++ve,M),ve<=T&&(P=ve+1),T<=ve&&(M=ve-1)}})(i,a,u||0,p||i.length-1,m||PM)}function Kf(i,a,u){var p=i[a];i[a]=i[u],i[u]=p}function PM(i,a){return i<a?-1:i>a?1:0}function kv(i,a){var u=i.length;if(u<=1)return[i];for(var p,m,v=[],x=0;x<u;x++){var T=nr(i[x]);T!==0&&(i[x].area=Math.abs(T),m===void 0&&(m=T<0),m===T<0?(p&&v.push(p),p=[i[x]]):p.push(i[x]))}if(p&&v.push(p),a>1)for(var P=0;P<v.length;P++)v[P].length<=a||(AM(v[P],a,1,v[P].length-1,IM),v[P]=v[P].slice(0,a));return v}function IM(i,a){return a.area-i.area}function Lv(i,a,u){for(var p=u.patternDependencies,m=!1,v=0,x=a;v<x.length;v+=1){var T=x[v].paint.get(i+"-pattern");T.isConstant()||(m=!0);var P=T.constantOr(null);P&&(m=!0,p[P.to]=!0,p[P.from]=!0)}return m}function Rv(i,a,u,p,m){for(var v=m.patternDependencies,x=0,T=a;x<T.length;x+=1){var P=T[x],M=P.paint.get(i+"-pattern").value;if(M.kind!=="constant"){var L=M.evaluate({zoom:p-1},u,{},m.availableImages),R=M.evaluate({zoom:p},u,{},m.availableImages),F=M.evaluate({zoom:p+1},u,{},m.availableImages);R=R&&R.name?R.name:R,F=F&&F.name?F.name:F,v[L=L&&L.name?L.name:L]=!0,v[R]=!0,v[F]=!0,u.patterns[P.id]={min:L,mid:R,max:F}}}return u}wm.deviation=function(i,a,u,p){var m=a&&a.length,v=Math.abs(Mv(i,0,m?a[0]*u:i.length,u));if(m)for(var x=0,T=a.length;x<T;x++)v-=Math.abs(Mv(i,a[x]*u,x<T-1?a[x+1]*u:i.length,u));var P=0;for(x=0;x<p.length;x+=3){var M=p[x]*u,L=p[x+1]*u,R=p[x+2]*u;P+=Math.abs((i[M]-i[R])*(i[L+1]-i[M+1])-(i[M]-i[L])*(i[R+1]-i[M+1]))}return v===0&&P===0?0:Math.abs((P-v)/v)},wm.flatten=function(i){for(var a=i[0][0].length,u={vertices:[],holes:[],dimensions:a},p=0,m=0;m<i.length;m++){for(var v=0;v<i[m].length;v++)for(var x=0;x<a;x++)u.vertices.push(i[m][v][x]);m>0&&u.holes.push(p+=i[m-1].length)}return u},Pv.default=gM;var ha=function(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Us,this.indexArray=new Ha,this.indexArray2=new Ou,this.programConfigurations=new Et(i.layers,i.zoom),this.segments=new Y,this.segments2=new Y,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};ha.prototype.populate=function(i,a,u){this.hasPattern=Lv("fill",this.layers,a);for(var p=this.layers[0].layout.get("fill-sort-key"),m=[],v=0,x=i;v<x.length;v+=1){var T=x[v],P=T.feature,M=T.id,L=T.index,R=T.sourceLayerIndex,F=this.layers[0]._featureFilter.needGeometry,V=Yn(P,F);if(this.layers[0]._featureFilter.filter(new Zt(this.zoom),V,u)){var te=p?p.evaluate(V,{},u,a.availableImages):void 0,ne={id:M,properties:P.properties,type:P.type,sourceLayerIndex:R,index:L,geometry:F?V.geometry:Bn(P),patterns:{},sortKey:te};m.push(ne)}}p&&m.sort(function(je,Xe){return je.sortKey-Xe.sortKey});for(var ce=0,se=m;ce<se.length;ce+=1){var ve=se[ce],we=ve.geometry,Ae=ve.index,Ie=ve.sourceLayerIndex;if(this.hasPattern){var Oe=Rv("fill",this.layers,ve,this.zoom,a);this.patternFeatures.push(Oe)}else this.addFeature(ve,we,Ae,u,{});a.featureIndex.insert(i[Ae].feature,we,Ae,Ie,this.index)}},ha.prototype.update=function(i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,u)},ha.prototype.addFeatures=function(i,a,u){for(var p=0,m=this.patternFeatures;p<m.length;p+=1){var v=m[p];this.addFeature(v,v.geometry,v.index,a,u)}},ha.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ha.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ha.prototype.upload=function(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,mM),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0},ha.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ha.prototype.addFeature=function(i,a,u,p,m){for(var v=0,x=kv(a,500);v<x.length;v+=1){for(var T=x[v],P=0,M=0,L=T;M<L.length;M+=1)P+=L[M].length;for(var R=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray),F=R.vertexLength,V=[],te=[],ne=0,ce=T;ne<ce.length;ne+=1){var se=ce[ne];if(se.length!==0){se!==T[0]&&te.push(V.length/2);var ve=this.segments2.prepareSegment(se.length,this.layoutVertexArray,this.indexArray2),we=ve.vertexLength;this.layoutVertexArray.emplaceBack(se[0].x,se[0].y),this.indexArray2.emplaceBack(we+se.length-1,we),V.push(se[0].x),V.push(se[0].y);for(var Ae=1;Ae<se.length;Ae++)this.layoutVertexArray.emplaceBack(se[Ae].x,se[Ae].y),this.indexArray2.emplaceBack(we+Ae-1,we+Ae),V.push(se[Ae].x),V.push(se[Ae].y);ve.vertexLength+=se.length,ve.primitiveLength+=se.length}}for(var Ie=Pv(V,te),Oe=0;Oe<Ie.length;Oe+=3)this.indexArray.emplaceBack(F+Ie[Oe],F+Ie[Oe+1],F+Ie[Oe+2]);R.vertexLength+=P,R.primitiveLength+=Ie.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,m,p)},ot("FillBucket",ha,{omit:["layers","patternFeatures"]});var CM=new Ur({"fill-sort-key":new st(X.layout_fill["fill-sort-key"])}),MM={paint:new Ur({"fill-antialias":new pt(X.paint_fill["fill-antialias"]),"fill-opacity":new st(X.paint_fill["fill-opacity"]),"fill-color":new st(X.paint_fill["fill-color"]),"fill-outline-color":new st(X.paint_fill["fill-outline-color"]),"fill-translate":new pt(X.paint_fill["fill-translate"]),"fill-translate-anchor":new pt(X.paint_fill["fill-translate-anchor"]),"fill-pattern":new Nc(X.paint_fill["fill-pattern"])}),layout:CM},kM=function(i){function a(u){i.call(this,u,MM)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.recalculate=function(u,p){i.prototype.recalculate.call(this,u,p);var m=this.paint._values["fill-outline-color"];m.value.kind==="constant"&&m.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},a.prototype.createBucket=function(u){return new ha(u)},a.prototype.queryRadius=function(){return wr(this.paint.get("fill-translate"))},a.prototype.queryIntersectsFeature=function(u,p,m,v,x,T,P){return To(ca(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),T.angle,P),v)},a.prototype.isTileClipped=function(){return!0},a}(jo),LM=Mr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,kb=qc;function qc(i,a,u,p,m){this.properties={},this.extent=u,this.type=0,this._pbf=i,this._geometry=-1,this._keys=p,this._values=m,i.readFields(RM,this,a)}function RM(i,a,u){i==1?a.id=u.readVarint():i==2?function(p,m){for(var v=p.readVarint()+p.pos;p.pos<v;){var x=m._keys[p.readVarint()],T=m._values[p.readVarint()];m.properties[x]=T}}(u,a):i==3?a.type=u.readVarint():i==4&&(a._geometry=u.pos)}function OM(i){for(var a,u,p=0,m=0,v=i.length,x=v-1;m<v;x=m++)p+=((u=i[x]).x-(a=i[m]).x)*(a.y+u.y);return p}qc.types=["Unknown","Point","LineString","Polygon"],qc.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var a,u=i.readVarint()+i.pos,p=1,m=0,v=0,x=0,T=[];i.pos<u;){if(m<=0){var P=i.readVarint();p=7&P,m=P>>3}if(m--,p===1||p===2)v+=i.readSVarint(),x+=i.readSVarint(),p===1&&(a&&T.push(a),a=[]),a.push(new S(v,x));else{if(p!==7)throw new Error("unknown command "+p);a&&a.push(a[0].clone())}}return a&&T.push(a),T},qc.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var a=i.readVarint()+i.pos,u=1,p=0,m=0,v=0,x=1/0,T=-1/0,P=1/0,M=-1/0;i.pos<a;){if(p<=0){var L=i.readVarint();u=7&L,p=L>>3}if(p--,u===1||u===2)(m+=i.readSVarint())<x&&(x=m),m>T&&(T=m),(v+=i.readSVarint())<P&&(P=v),v>M&&(M=v);else if(u!==7)throw new Error("unknown command "+u)}return[x,P,T,M]},qc.prototype.toGeoJSON=function(i,a,u){var p,m,v=this.extent*Math.pow(2,u),x=this.extent*i,T=this.extent*a,P=this.loadGeometry(),M=qc.types[this.type];function L(V){for(var te=0;te<V.length;te++){var ne=V[te];V[te]=[360*(ne.x+x)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(ne.y+T)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(p=0;p<P.length;p++)R[p]=P[p][0];L(P=R);break;case 2:for(p=0;p<P.length;p++)L(P[p]);break;case 3:for(P=function(V){var te=V.length;if(te<=1)return[V];for(var ne,ce,se=[],ve=0;ve<te;ve++){var we=OM(V[ve]);we!==0&&(ce===void 0&&(ce=we<0),ce===we<0?(ne&&se.push(ne),ne=[V[ve]]):ne.push(V[ve]))}return ne&&se.push(ne),se}(P),p=0;p<P.length;p++)for(m=0;m<P[p].length;m++)L(P[p][m])}P.length===1?P=P[0]:M="Multi"+M;var F={type:"Feature",geometry:{type:M,coordinates:P},properties:this.properties};return"id"in this&&(F.id=this.id),F};var Lb=Rb;function Rb(i,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(DM,this,a),this.length=this._features.length}function DM(i,a,u){i===15?a.version=u.readVarint():i===1?a.name=u.readString():i===5?a.extent=u.readVarint():i===2?a._features.push(u.pos):i===3?a._keys.push(u.readString()):i===4&&a._values.push(function(p){for(var m=null,v=p.readVarint()+p.pos;p.pos<v;){var x=p.readVarint()>>3;m=x===1?p.readString():x===2?p.readFloat():x===3?p.readDouble():x===4?p.readVarint64():x===5?p.readVarint():x===6?p.readSVarint():x===7?p.readBoolean():null}return m}(u))}function zM(i,a,u){if(i===3){var p=new Lb(u,u.readVarint()+u.pos);p.length&&(a[p.name]=p)}}Rb.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var a=this._pbf.readVarint()+this._pbf.pos;return new kb(this._pbf,a,this.extent,this._keys,this._values)};var Zc={VectorTile:function(i,a){this.layers=i.readFields(zM,{},a)},VectorTileFeature:kb,VectorTileLayer:Lb},BM=Zc.VectorTileFeature.types,Ov=Math.pow(2,13);function Jf(i,a,u,p,m,v,x,T){i.emplaceBack(a,u,2*Math.floor(p*Ov)+x,m*Ov*2,v*Ov*2,Math.round(T))}var fa=function(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new ua,this.indexArray=new Ha,this.programConfigurations=new Et(i.layers,i.zoom),this.segments=new Y,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};function NM(i,a){return i.x===a.x&&(i.x<0||i.x>8192)||i.y===a.y&&(i.y<0||i.y>8192)}fa.prototype.populate=function(i,a,u){this.features=[],this.hasPattern=Lv("fill-extrusion",this.layers,a);for(var p=0,m=i;p<m.length;p+=1){var v=m[p],x=v.feature,T=v.id,P=v.index,M=v.sourceLayerIndex,L=this.layers[0]._featureFilter.needGeometry,R=Yn(x,L);if(this.layers[0]._featureFilter.filter(new Zt(this.zoom),R,u)){var F={id:T,sourceLayerIndex:M,index:P,geometry:L?R.geometry:Bn(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(Rv("fill-extrusion",this.layers,F,this.zoom,a)):this.addFeature(F,F.geometry,P,u,{}),a.featureIndex.insert(x,F.geometry,P,M,this.index,!0)}}},fa.prototype.addFeatures=function(i,a,u){for(var p=0,m=this.features;p<m.length;p+=1){var v=m[p];this.addFeature(v,v.geometry,v.index,a,u)}},fa.prototype.update=function(i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,u)},fa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},fa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},fa.prototype.upload=function(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,LM),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0},fa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},fa.prototype.addFeature=function(i,a,u,p,m){for(var v=0,x=kv(a,500);v<x.length;v+=1){for(var T=x[v],P=0,M=0,L=T;M<L.length;M+=1)P+=L[M].length;for(var R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),F=0,V=T;F<V.length;F+=1){var te=V[F];if(te.length!==0&&!((qt=te).every(function(zt){return zt.x<0})||qt.every(function(zt){return zt.x>8192})||qt.every(function(zt){return zt.y<0})||qt.every(function(zt){return zt.y>8192})))for(var ne=0,ce=0;ce<te.length;ce++){var se=te[ce];if(ce>=1){var ve=te[ce-1];if(!NM(se,ve)){R.vertexLength+4>Y.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var we=se.sub(ve)._perp()._unit(),Ae=ve.dist(se);ne+Ae>32768&&(ne=0),Jf(this.layoutVertexArray,se.x,se.y,we.x,we.y,0,0,ne),Jf(this.layoutVertexArray,se.x,se.y,we.x,we.y,0,1,ne),Jf(this.layoutVertexArray,ve.x,ve.y,we.x,we.y,0,0,ne+=Ae),Jf(this.layoutVertexArray,ve.x,ve.y,we.x,we.y,0,1,ne);var Ie=R.vertexLength;this.indexArray.emplaceBack(Ie,Ie+2,Ie+1),this.indexArray.emplaceBack(Ie+1,Ie+2,Ie+3),R.vertexLength+=4,R.primitiveLength+=2}}}}if(R.vertexLength+P>Y.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray)),BM[i.type]==="Polygon"){for(var Oe=[],je=[],Xe=R.vertexLength,ct=0,Qe=T;ct<Qe.length;ct+=1){var mt=Qe[ct];if(mt.length!==0){mt!==T[0]&&je.push(Oe.length/2);for(var et=0;et<mt.length;et++){var jt=mt[et];Jf(this.layoutVertexArray,jt.x,jt.y,0,0,1,1,0),Oe.push(jt.x),Oe.push(jt.y)}}}for(var Tt=Pv(Oe,je),lt=0;lt<Tt.length;lt+=3)this.indexArray.emplaceBack(Xe+Tt[lt],Xe+Tt[lt+2],Xe+Tt[lt+1]);R.primitiveLength+=Tt.length/3,R.vertexLength+=P}}var qt;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,m,p)},ot("FillExtrusionBucket",fa,{omit:["layers","features"]});var FM={paint:new Ur({"fill-extrusion-opacity":new pt(X["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new st(X["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new pt(X["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new pt(X["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Nc(X["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new st(X["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new st(X["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new pt(X["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},UM=function(i){function a(u){i.call(this,u,FM)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.createBucket=function(u){return new fa(u)},a.prototype.queryRadius=function(){return wr(this.paint.get("fill-extrusion-translate"))},a.prototype.is3D=function(){return!0},a.prototype.queryIntersectsFeature=function(u,p,m,v,x,T,P,M){var L=ca(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),T.angle,P),R=this.paint.get("fill-extrusion-height").evaluate(p,m),F=this.paint.get("fill-extrusion-base").evaluate(p,m),V=function(ne,ce,se,ve){for(var we=[],Ae=0,Ie=ne;Ae<Ie.length;Ae+=1){var Oe=Ie[Ae],je=[Oe.x,Oe.y,0,1];Gc(je,je,ce),we.push(new S(je[0]/je[3],je[1]/je[3]))}return we}(L,M),te=function(ne,ce,se,ve){for(var we=[],Ae=[],Ie=ve[8]*ce,Oe=ve[9]*ce,je=ve[10]*ce,Xe=ve[11]*ce,ct=ve[8]*se,Qe=ve[9]*se,mt=ve[10]*se,et=ve[11]*se,jt=0,Tt=ne;jt<Tt.length;jt+=1){for(var lt=[],qt=[],zt=0,Jt=Tt[jt];zt<Jt.length;zt+=1){var gt=Jt[zt],sn=gt.x,kn=gt.y,Gn=ve[0]*sn+ve[4]*kn+ve[12],Nn=ve[1]*sn+ve[5]*kn+ve[13],Ln=ve[2]*sn+ve[6]*kn+ve[14],Wn=ve[3]*sn+ve[7]*kn+ve[15],Er=Ln+je,Tr=Wn+Xe,oi=Gn+ct,Rr=Nn+Qe,ai=Ln+mt,$n=Wn+et,Or=new S((Gn+Ie)/Tr,(Nn+Oe)/Tr);Or.z=Er/Tr,lt.push(Or);var Yt=new S(oi/$n,Rr/$n);Yt.z=ai/$n,qt.push(Yt)}we.push(lt),Ae.push(qt)}return[we,Ae]}(v,F,R,M);return function(ne,ce,se){var ve=1/0;To(se,ce)&&(ve=Ob(se,ce[0]));for(var we=0;we<ce.length;we++)for(var Ae=ce[we],Ie=ne[we],Oe=0;Oe<Ae.length-1;Oe++){var je=Ae[Oe],Xe=[je,Ae[Oe+1],Ie[Oe+1],Ie[Oe],je];Xa(se,Xe)&&(ve=Math.min(ve,Ob(se,Xe)))}return ve!==1/0&&ve}(te[0],te[1],V)},a}(jo);function Qf(i,a){return i.x*a.x+i.y*a.y}function Ob(i,a){if(i.length===1){for(var u,p=0,m=a[p++];!u||m.equals(u);)if(!(u=a[p++]))return 1/0;for(;p<a.length;p++){var v=a[p],x=i[0],T=u.sub(m),P=v.sub(m),M=x.sub(m),L=Qf(T,T),R=Qf(T,P),F=Qf(P,P),V=Qf(M,T),te=Qf(M,P),ne=L*F-R*R,ce=(F*V-R*te)/ne,se=(L*te-R*V)/ne,ve=m.z*(1-ce-se)+u.z*ce+v.z*se;if(isFinite(ve))return ve}return 1/0}for(var we=1/0,Ae=0,Ie=a;Ae<Ie.length;Ae+=1)we=Math.min(we,Ie[Ae].z);return we}var jM=Mr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,VM=Mr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,GM=Zc.VectorTileFeature.types,WM=Math.cos(Math.PI/180*37.5),Db=Math.pow(2,14)/.5,hi=function(i){var a=this;this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){a.gradients[u.id]={}}),this.layoutVertexArray=new ki,this.layoutVertexArray2=new Il,this.indexArray=new Ha,this.programConfigurations=new Et(i.layers,i.zoom),this.segments=new Y,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};hi.prototype.populate=function(i,a,u){this.hasPattern=Lv("line",this.layers,a);for(var p=this.layers[0].layout.get("line-sort-key"),m=[],v=0,x=i;v<x.length;v+=1){var T=x[v],P=T.feature,M=T.id,L=T.index,R=T.sourceLayerIndex,F=this.layers[0]._featureFilter.needGeometry,V=Yn(P,F);if(this.layers[0]._featureFilter.filter(new Zt(this.zoom),V,u)){var te=p?p.evaluate(V,{},u):void 0,ne={id:M,properties:P.properties,type:P.type,sourceLayerIndex:R,index:L,geometry:F?V.geometry:Bn(P),patterns:{},sortKey:te};m.push(ne)}}p&&m.sort(function(je,Xe){return je.sortKey-Xe.sortKey});for(var ce=0,se=m;ce<se.length;ce+=1){var ve=se[ce],we=ve.geometry,Ae=ve.index,Ie=ve.sourceLayerIndex;if(this.hasPattern){var Oe=Rv("line",this.layers,ve,this.zoom,a);this.patternFeatures.push(Oe)}else this.addFeature(ve,we,Ae,u,{});a.featureIndex.insert(i[Ae].feature,we,Ae,Ie,this.index)}},hi.prototype.update=function(i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,u)},hi.prototype.addFeatures=function(i,a,u){for(var p=0,m=this.patternFeatures;p<m.length;p+=1){var v=m[p];this.addFeature(v,v.geometry,v.index,a,u)}},hi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},hi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},hi.prototype.upload=function(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,VM)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,jM),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0},hi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},hi.prototype.lineFeatureClips=function(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}},hi.prototype.addFeature=function(i,a,u,p,m){var v=this.layers[0].layout,x=v.get("line-join").evaluate(i,{}),T=v.get("line-cap"),P=v.get("line-miter-limit"),M=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(var L=0,R=a;L<R.length;L+=1)this.addLine(R[L],i,x,T,P,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,m,p)},hi.prototype.addLine=function(i,a,u,p,m,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<i.length-1;x++)this.totalDistance+=i[x].dist(i[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var T=GM[a.type]==="Polygon",P=i.length;P>=2&&i[P-1].equals(i[P-2]);)P--;for(var M=0;M<P-1&&i[M].equals(i[M+1]);)M++;if(!(P<(T?3:2))){u==="bevel"&&(m=1.05);var L,R=this.overscaling<=16?122880/(512*this.overscaling):0,F=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray),V=void 0,te=void 0,ne=void 0,ce=void 0;this.e1=this.e2=-1,T&&(ce=i[M].sub(L=i[P-2])._unit()._perp());for(var se=M;se<P;se++)if(!(te=se===P-1?T?i[M+1]:void 0:i[se+1])||!i[se].equals(te)){ce&&(ne=ce),L&&(V=L),L=i[se],ce=te?te.sub(L)._unit()._perp():ne;var ve=(ne=ne||ce).add(ce);ve.x===0&&ve.y===0||ve._unit();var we=ne.x*ce.x+ne.y*ce.y,Ae=ve.x*ce.x+ve.y*ce.y,Ie=Ae!==0?1/Ae:1/0,Oe=2*Math.sqrt(2-2*Ae),je=Ae<WM&&V&&te,Xe=ne.x*ce.y-ne.y*ce.x>0;if(je&&se>M){var ct=L.dist(V);if(ct>2*R){var Qe=L.sub(L.sub(V)._mult(R/ct)._round());this.updateDistance(V,Qe),this.addCurrentVertex(Qe,ne,0,0,F),V=Qe}}var mt=V&&te,et=mt?u:T?"butt":p;if(mt&&et==="round"&&(Ie<v?et="miter":Ie<=2&&(et="fakeround")),et==="miter"&&Ie>m&&(et="bevel"),et==="bevel"&&(Ie>2&&(et="flipbevel"),Ie<m&&(et="miter")),V&&this.updateDistance(V,L),et==="miter")ve._mult(Ie),this.addCurrentVertex(L,ve,0,0,F);else if(et==="flipbevel"){if(Ie>100)ve=ce.mult(-1);else{var jt=Ie*ne.add(ce).mag()/ne.sub(ce).mag();ve._perp()._mult(jt*(Xe?-1:1))}this.addCurrentVertex(L,ve,0,0,F),this.addCurrentVertex(L,ve.mult(-1),0,0,F)}else if(et==="bevel"||et==="fakeround"){var Tt=-Math.sqrt(Ie*Ie-1),lt=Xe?Tt:0,qt=Xe?0:Tt;if(V&&this.addCurrentVertex(L,ne,lt,qt,F),et==="fakeround")for(var zt=Math.round(180*Oe/Math.PI/20),Jt=1;Jt<zt;Jt++){var gt=Jt/zt;if(gt!==.5){var sn=gt-.5;gt+=gt*sn*(gt-1)*((1.0904+we*(we*(3.55645-1.43519*we)-3.2452))*sn*sn+(.848013+we*(.215638*we-1.06021)))}var kn=ce.sub(ne)._mult(gt)._add(ne)._unit()._mult(Xe?-1:1);this.addHalfVertex(L,kn.x,kn.y,!1,Xe,0,F)}te&&this.addCurrentVertex(L,ce,-lt,-qt,F)}else if(et==="butt")this.addCurrentVertex(L,ve,0,0,F);else if(et==="square"){var Gn=V?1:-1;this.addCurrentVertex(L,ve,Gn,Gn,F)}else et==="round"&&(V&&(this.addCurrentVertex(L,ne,0,0,F),this.addCurrentVertex(L,ne,1,1,F,!0)),te&&(this.addCurrentVertex(L,ce,-1,-1,F,!0),this.addCurrentVertex(L,ce,0,0,F)));if(je&&se<P-1){var Nn=L.dist(te);if(Nn>2*R){var Ln=L.add(te.sub(L)._mult(R/Nn)._round());this.updateDistance(L,Ln),this.addCurrentVertex(Ln,ce,0,0,F),L=Ln}}}}},hi.prototype.addCurrentVertex=function(i,a,u,p,m,v){v===void 0&&(v=!1);var x=a.y*p-a.x,T=-a.y-a.x*p;this.addHalfVertex(i,a.x+a.y*u,a.y-a.x*u,v,!1,u,m),this.addHalfVertex(i,x,T,v,!0,-p,m),this.distance>Db/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(i,a,u,p,m,v))},hi.prototype.addHalfVertex=function(i,a,u,p,m,v,x){var T=.5*(this.lineClips?this.scaledDistance*(Db-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i.x<<1)+(p?1:0),(i.y<<1)+(m?1:0),Math.round(63*a)+128,Math.round(63*u)+128,1+(v===0?0:v<0?-1:1)|(63&T)<<2,T>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var P=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),x.primitiveLength++),m?this.e2=P:this.e1=P},hi.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},hi.prototype.updateDistance=function(i,a){this.distance+=i.dist(a),this.updateScaledDistance()},ot("LineBucket",hi,{omit:["layers","patternFeatures"]});var HM=new Ur({"line-cap":new pt(X.layout_line["line-cap"]),"line-join":new st(X.layout_line["line-join"]),"line-miter-limit":new pt(X.layout_line["line-miter-limit"]),"line-round-limit":new pt(X.layout_line["line-round-limit"]),"line-sort-key":new st(X.layout_line["line-sort-key"])}),zb={paint:new Ur({"line-opacity":new st(X.paint_line["line-opacity"]),"line-color":new st(X.paint_line["line-color"]),"line-translate":new pt(X.paint_line["line-translate"]),"line-translate-anchor":new pt(X.paint_line["line-translate-anchor"]),"line-width":new st(X.paint_line["line-width"]),"line-gap-width":new st(X.paint_line["line-gap-width"]),"line-offset":new st(X.paint_line["line-offset"]),"line-blur":new st(X.paint_line["line-blur"]),"line-dasharray":new ni(X.paint_line["line-dasharray"]),"line-pattern":new Nc(X.paint_line["line-pattern"]),"line-gradient":new Eo(X.paint_line["line-gradient"])}),layout:HM},Bb=new(function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.possiblyEvaluate=function(u,p){return p=new Zt(Math.floor(p.zoom),{now:p.now,fadeDuration:p.fadeDuration,zoomHistory:p.zoomHistory,transition:p.transition}),i.prototype.possiblyEvaluate.call(this,u,p)},a.prototype.evaluate=function(u,p,m,v){return p=U({},p,{zoom:Math.floor(p.zoom)}),i.prototype.evaluate.call(this,u,p,m,v)},a}(st))(zb.paint.properties["line-width"].specification);Bb.useIntegerZoom=!0;var qM=function(i){function a(u){i.call(this,u,zb),this.gradientVersion=0}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._handleSpecialPaintPropertyUpdate=function(u){u==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ai,this.gradientVersion=(this.gradientVersion+1)%B)},a.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},a.prototype.recalculate=function(u,p){i.prototype.recalculate.call(this,u,p),this.paint._values["line-floorwidth"]=Bb.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},a.prototype.createBucket=function(u){return new hi(u)},a.prototype.queryRadius=function(u){var p=u,m=Nb(Wo("line-width",this,p),Wo("line-gap-width",this,p)),v=Wo("line-offset",this,p);return m/2+Math.abs(v)+wr(this.paint.get("line-translate"))},a.prototype.queryIntersectsFeature=function(u,p,m,v,x,T,P){var M=ca(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),T.angle,P),L=P/2*Nb(this.paint.get("line-width").evaluate(p,m),this.paint.get("line-gap-width").evaluate(p,m)),R=this.paint.get("line-offset").evaluate(p,m);return R&&(v=function(F,V){for(var te=[],ne=new S(0,0),ce=0;ce<F.length;ce++){for(var se=F[ce],ve=[],we=0;we<se.length;we++){var Ae=se[we],Ie=se[we+1],Oe=we===0?ne:Ae.sub(se[we-1])._unit()._perp(),je=we===se.length-1?ne:Ie.sub(Ae)._unit()._perp(),Xe=Oe._add(je)._unit();Xe._mult(1/(Xe.x*je.x+Xe.y*je.y)),ve.push(Xe._mult(V)._add(Ae))}te.push(ve)}return te}(v,R*P)),function(F,V,te){for(var ne=0;ne<V.length;ne++){var ce=V[ne];if(F.length>=3){for(var se=0;se<ce.length;se++)if(Go(F,ce[se]))return!0}if(ao(F,ce,te))return!0}return!1}(M,v,L)},a.prototype.isTileClipped=function(){return!0},a}(jo);function Nb(i,a){return a>0?a+2*i:i}var ZM=Mr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),XM=Mr([{name:"a_projected_pos",components:3,type:"Float32"}],4),YM=(Mr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Mr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Fb=(Mr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Mr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),$M=Mr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function KM(i,a,u){return i.sections.forEach(function(p){p.text=function(m,v,x){var T=v.layout.get("text-transform").evaluate(x,{});return T==="uppercase"?m=m.toLocaleUpperCase():T==="lowercase"&&(m=m.toLocaleLowerCase()),Vi.applyArabicShaping&&(m=Vi.applyArabicShaping(m)),m}(p.text,a,u)}),i}Mr([{name:"triangle",components:3,type:"Uint16"}]),Mr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Mr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Mr([{type:"Float32",name:"offsetX"}]),Mr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var ep={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},Ub=function(i,a,u,p,m){var v,x,T=8*m-p-1,P=(1<<T)-1,M=P>>1,L=-7,R=u?m-1:0,F=u?-1:1,V=i[a+R];for(R+=F,v=V&(1<<-L)-1,V>>=-L,L+=T;L>0;v=256*v+i[a+R],R+=F,L-=8);for(x=v&(1<<-L)-1,v>>=-L,L+=p;L>0;x=256*x+i[a+R],R+=F,L-=8);if(v===0)v=1-M;else{if(v===P)return x?NaN:1/0*(V?-1:1);x+=Math.pow(2,p),v-=M}return(V?-1:1)*x*Math.pow(2,v-p)},jb=function(i,a,u,p,m,v){var x,T,P,M=8*v-m-1,L=(1<<M)-1,R=L>>1,F=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,V=p?0:v-1,te=p?1:-1,ne=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(T=isNaN(a)?1:0,x=L):(x=Math.floor(Math.log(a)/Math.LN2),a*(P=Math.pow(2,-x))<1&&(x--,P*=2),(a+=x+R>=1?F/P:F*Math.pow(2,1-R))*P>=2&&(x++,P/=2),x+R>=L?(T=0,x=L):x+R>=1?(T=(a*P-1)*Math.pow(2,m),x+=R):(T=a*Math.pow(2,R-1)*Math.pow(2,m),x=0));m>=8;i[u+V]=255&T,V+=te,T/=256,m-=8);for(x=x<<m|T,M+=m;M>0;i[u+V]=255&x,V+=te,x/=256,M-=8);i[u+V-te]|=128*ne},Am=Tn;function Tn(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Tn.Varint=0,Tn.Fixed64=1,Tn.Bytes=2,Tn.Fixed32=5;var Vb=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ws(i){return i.type===Tn.Bytes?i.readVarint()+i.pos:i.pos+1}function Xc(i,a,u){return u?4294967296*a+(i>>>0):4294967296*(a>>>0)+(i>>>0)}function Gb(i,a,u){var p=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));u.realloc(p);for(var m=u.pos-1;m>=i;m--)u.buf[m+p]=u.buf[m]}function JM(i,a){for(var u=0;u<i.length;u++)a.writeVarint(i[u])}function QM(i,a){for(var u=0;u<i.length;u++)a.writeSVarint(i[u])}function ek(i,a){for(var u=0;u<i.length;u++)a.writeFloat(i[u])}function tk(i,a){for(var u=0;u<i.length;u++)a.writeDouble(i[u])}function nk(i,a){for(var u=0;u<i.length;u++)a.writeBoolean(i[u])}function rk(i,a){for(var u=0;u<i.length;u++)a.writeFixed32(i[u])}function ik(i,a){for(var u=0;u<i.length;u++)a.writeSFixed32(i[u])}function ok(i,a){for(var u=0;u<i.length;u++)a.writeFixed64(i[u])}function ak(i,a){for(var u=0;u<i.length;u++)a.writeSFixed64(i[u])}function Pm(i,a){return(i[a]|i[a+1]<<8|i[a+2]<<16)+16777216*i[a+3]}function Yc(i,a,u){i[u]=a,i[u+1]=a>>>8,i[u+2]=a>>>16,i[u+3]=a>>>24}function Wb(i,a){return(i[a]|i[a+1]<<8|i[a+2]<<16)+(i[a+3]<<24)}function sk(i,a,u){i===1&&u.readMessage(lk,a)}function lk(i,a,u){if(i===3){var p=u.readMessage(uk,{}),m=p.width,v=p.height,x=p.left,T=p.top,P=p.advance;a.push({id:p.id,bitmap:new Fu({width:m+6,height:v+6},p.bitmap),metrics:{width:m,height:v,left:x,top:T,advance:P}})}}function uk(i,a,u){i===1?a.id=u.readVarint():i===2?a.bitmap=u.readBytes():i===3?a.width=u.readVarint():i===4?a.height=u.readVarint():i===5?a.left=u.readSVarint():i===6?a.top=u.readSVarint():i===7&&(a.advance=u.readVarint())}function Hb(i){for(var a=0,u=0,p=0,m=i;p<m.length;p+=1){var v=m[p];a+=v.w*v.h,u=Math.max(u,v.w)}i.sort(function(ne,ce){return ce.h-ne.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),u),h:1/0}],T=0,P=0,M=0,L=i;M<L.length;M+=1)for(var R=L[M],F=x.length-1;F>=0;F--){var V=x[F];if(!(R.w>V.w||R.h>V.h)){if(R.x=V.x,R.y=V.y,P=Math.max(P,R.y+R.h),T=Math.max(T,R.x+R.w),R.w===V.w&&R.h===V.h){var te=x.pop();F<x.length&&(x[F]=te)}else R.h===V.h?(V.x+=R.w,V.w-=R.w):R.w===V.w?(V.y+=R.h,V.h-=R.h):(x.push({x:V.x+R.w,y:V.y,w:V.w-R.w,h:R.h}),V.y+=R.h,V.h-=R.h);break}}return{w:T,h:P,fill:a/(T*P)||0}}Tn.prototype={destroy:function(){this.buf=null},readFields:function(i,a,u){for(u=u||this.length;this.pos<u;){var p=this.readVarint(),m=p>>3,v=this.pos;this.type=7&p,i(m,a,this),this.pos===v&&this.skip(p)}return a},readMessage:function(i,a){return this.readFields(i,a,this.readVarint()+this.pos)},readFixed32:function(){var i=Pm(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Wb(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=Pm(this.buf,this.pos)+4294967296*Pm(this.buf,this.pos+4);return this.pos+=8,i},readSFixed64:function(){var i=Pm(this.buf,this.pos)+4294967296*Wb(this.buf,this.pos+4);return this.pos+=8,i},readFloat:function(){var i=Ub(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=Ub(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var a,u,p=this.buf;return a=127&(u=p[this.pos++]),u<128?a:(a|=(127&(u=p[this.pos++]))<<7,u<128?a:(a|=(127&(u=p[this.pos++]))<<14,u<128?a:(a|=(127&(u=p[this.pos++]))<<21,u<128?a:function(m,v,x){var T,P,M=x.buf;if(T=(112&(P=M[x.pos++]))>>4,P<128||(T|=(127&(P=M[x.pos++]))<<3,P<128)||(T|=(127&(P=M[x.pos++]))<<10,P<128)||(T|=(127&(P=M[x.pos++]))<<17,P<128)||(T|=(127&(P=M[x.pos++]))<<24,P<128)||(T|=(1&(P=M[x.pos++]))<<31,P<128))return Xc(m,T,v);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(u=p[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,a=this.pos;return this.pos=i,i-a>=12&&Vb?function(u,p,m){return Vb.decode(u.subarray(p,m))}(this.buf,a,i):function(u,p,m){for(var v="",x=p;x<m;){var T,P,M,L=u[x],R=null,F=L>239?4:L>223?3:L>191?2:1;if(x+F>m)break;F===1?L<128&&(R=L):F===2?(192&(T=u[x+1]))==128&&(R=(31&L)<<6|63&T)<=127&&(R=null):F===3?(P=u[x+2],(192&(T=u[x+1]))==128&&(192&P)==128&&((R=(15&L)<<12|(63&T)<<6|63&P)<=2047||R>=55296&&R<=57343)&&(R=null)):F===4&&(P=u[x+2],M=u[x+3],(192&(T=u[x+1]))==128&&(192&P)==128&&(192&M)==128&&((R=(15&L)<<18|(63&T)<<12|(63&P)<<6|63&M)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,F=1):R>65535&&(R-=65536,v+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),v+=String.fromCharCode(R),x+=F}return v}(this.buf,a,i)},readBytes:function(){var i=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,i);return this.pos=i,a},readPackedVarint:function(i,a){if(this.type!==Tn.Bytes)return i.push(this.readVarint(a));var u=Ws(this);for(i=i||[];this.pos<u;)i.push(this.readVarint(a));return i},readPackedSVarint:function(i){if(this.type!==Tn.Bytes)return i.push(this.readSVarint());var a=Ws(this);for(i=i||[];this.pos<a;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Tn.Bytes)return i.push(this.readBoolean());var a=Ws(this);for(i=i||[];this.pos<a;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Tn.Bytes)return i.push(this.readFloat());var a=Ws(this);for(i=i||[];this.pos<a;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Tn.Bytes)return i.push(this.readDouble());var a=Ws(this);for(i=i||[];this.pos<a;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Tn.Bytes)return i.push(this.readFixed32());var a=Ws(this);for(i=i||[];this.pos<a;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Tn.Bytes)return i.push(this.readSFixed32());var a=Ws(this);for(i=i||[];this.pos<a;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Tn.Bytes)return i.push(this.readFixed64());var a=Ws(this);for(i=i||[];this.pos<a;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Tn.Bytes)return i.push(this.readSFixed64());var a=Ws(this);for(i=i||[];this.pos<a;)i.push(this.readSFixed64());return i},skip:function(i){var a=7&i;if(a===Tn.Varint)for(;this.buf[this.pos++]>127;);else if(a===Tn.Bytes)this.pos=this.readVarint()+this.pos;else if(a===Tn.Fixed32)this.pos+=4;else{if(a!==Tn.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(i,a){this.writeVarint(i<<3|a)},realloc:function(i){for(var a=this.length||16;a<this.pos+i;)a*=2;if(a!==this.length){var u=new Uint8Array(a);u.set(this.buf),this.buf=u,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Yc(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Yc(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Yc(this.buf,-1&i,this.pos),Yc(this.buf,Math.floor(i*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Yc(this.buf,-1&i,this.pos),Yc(this.buf,Math.floor(i*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(a,u){var p,m;if(a>=0?(p=a%4294967296|0,m=a/4294967296|0):(m=~(-a/4294967296),4294967295^(p=~(-a%4294967296))?p=p+1|0:(p=0,m=m+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(v,x,T){T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,T.buf[T.pos]=127&(v>>>=7)}(p,0,u),function(v,x){var T=(7&v)<<4;x.buf[x.pos++]|=T|((v>>>=3)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v)))))}(m,u)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var a=this.pos;this.pos=function(p,m,v){for(var x,T,P=0;P<m.length;P++){if((x=m.charCodeAt(P))>55295&&x<57344){if(!T){x>56319||P+1===m.length?(p[v++]=239,p[v++]=191,p[v++]=189):T=x;continue}if(x<56320){p[v++]=239,p[v++]=191,p[v++]=189,T=x;continue}x=T-55296<<10|x-56320|65536,T=null}else T&&(p[v++]=239,p[v++]=191,p[v++]=189,T=null);x<128?p[v++]=x:(x<2048?p[v++]=x>>6|192:(x<65536?p[v++]=x>>12|224:(p[v++]=x>>18|240,p[v++]=x>>12&63|128),p[v++]=x>>6&63|128),p[v++]=63&x|128)}return v}(this.buf,i,this.pos);var u=this.pos-a;u>=128&&Gb(a,u,this),this.pos=a-1,this.writeVarint(u),this.pos+=u},writeFloat:function(i){this.realloc(4),jb(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),jb(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var a=i.length;this.writeVarint(a),this.realloc(a);for(var u=0;u<a;u++)this.buf[this.pos++]=i[u]},writeRawMessage:function(i,a){this.pos++;var u=this.pos;i(a,this);var p=this.pos-u;p>=128&&Gb(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeMessage:function(i,a,u){this.writeTag(i,Tn.Bytes),this.writeRawMessage(a,u)},writePackedVarint:function(i,a){a.length&&this.writeMessage(i,JM,a)},writePackedSVarint:function(i,a){a.length&&this.writeMessage(i,QM,a)},writePackedBoolean:function(i,a){a.length&&this.writeMessage(i,nk,a)},writePackedFloat:function(i,a){a.length&&this.writeMessage(i,ek,a)},writePackedDouble:function(i,a){a.length&&this.writeMessage(i,tk,a)},writePackedFixed32:function(i,a){a.length&&this.writeMessage(i,rk,a)},writePackedSFixed32:function(i,a){a.length&&this.writeMessage(i,ik,a)},writePackedFixed64:function(i,a){a.length&&this.writeMessage(i,ok,a)},writePackedSFixed64:function(i,a){a.length&&this.writeMessage(i,ak,a)},writeBytesField:function(i,a){this.writeTag(i,Tn.Bytes),this.writeBytes(a)},writeFixed32Field:function(i,a){this.writeTag(i,Tn.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(i,a){this.writeTag(i,Tn.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(i,a){this.writeTag(i,Tn.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(i,a){this.writeTag(i,Tn.Fixed64),this.writeSFixed64(a)},writeVarintField:function(i,a){this.writeTag(i,Tn.Varint),this.writeVarint(a)},writeSVarintField:function(i,a){this.writeTag(i,Tn.Varint),this.writeSVarint(a)},writeStringField:function(i,a){this.writeTag(i,Tn.Bytes),this.writeString(a)},writeFloatField:function(i,a){this.writeTag(i,Tn.Fixed32),this.writeFloat(a)},writeDoubleField:function(i,a){this.writeTag(i,Tn.Fixed64),this.writeDouble(a)},writeBooleanField:function(i,a){this.writeVarintField(i,!!a)}};var Im=function(i,a){var u=a.pixelRatio,p=a.version,m=a.stretchX,v=a.stretchY,x=a.content;this.paddedRect=i,this.pixelRatio=u,this.stretchX=m,this.stretchY=v,this.content=x,this.version=p},tp={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};tp.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},tp.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},tp.tlbr.get=function(){return this.tl.concat(this.br)},tp.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Im.prototype,tp);var np=function(i,a){var u={},p={};this.haveRenderCallbacks=[];var m=[];this.addImages(i,u,m),this.addImages(a,p,m);var v=Hb(m),x=new Ri({width:v.w||1,height:v.h||1});for(var T in i){var P=i[T],M=u[T].paddedRect;Ri.copy(P.data,x,{x:0,y:0},{x:M.x+1,y:M.y+1},P.data)}for(var L in a){var R=a[L],F=p[L].paddedRect,V=F.x+1,te=F.y+1,ne=R.data.width,ce=R.data.height;Ri.copy(R.data,x,{x:0,y:0},{x:V,y:te},R.data),Ri.copy(R.data,x,{x:0,y:ce-1},{x:V,y:te-1},{width:ne,height:1}),Ri.copy(R.data,x,{x:0,y:0},{x:V,y:te+ce},{width:ne,height:1}),Ri.copy(R.data,x,{x:ne-1,y:0},{x:V-1,y:te},{width:1,height:ce}),Ri.copy(R.data,x,{x:0,y:0},{x:V+ne,y:te},{width:1,height:ce})}this.image=x,this.iconPositions=u,this.patternPositions=p};np.prototype.addImages=function(i,a,u){for(var p in i){var m=i[p],v={x:0,y:0,w:m.data.width+2,h:m.data.height+2};u.push(v),a[p]=new Im(v,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(p)}},np.prototype.patchUpdatedImages=function(i,a){for(var u in i.dispatchRenderCallbacks(this.haveRenderCallbacks),i.updatedImages)this.patchUpdatedImage(this.iconPositions[u],i.getImage(u),a),this.patchUpdatedImage(this.patternPositions[u],i.getImage(u),a)},np.prototype.patchUpdatedImage=function(i,a,u){if(i&&a&&i.version!==a.version){i.version=a.version;var p=i.tl;u.update(a.data,void 0,{x:p[0],y:p[1]})}},ot("ImagePosition",Im),ot("ImageAtlas",np);var so={horizontal:1,vertical:2,horizontalOnly:3},$c=function(){this.scale=1,this.fontStack="",this.imageName=null};$c.forText=function(i,a){var u=new $c;return u.scale=i||1,u.fontStack=a,u},$c.forImage=function(i){var a=new $c;return a.imageName=i,a};var ii=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Cm(i,a,u,p,m,v,x,T,P,M,L,R,F,V,te,ne){var ce,se=ii.fromFeature(i,m);R===so.vertical&&se.verticalizePunctuation();var ve=Vi.processBidirectionalText,we=Vi.processStyledBidirectionalText;if(ve&&se.sections.length===1){ce=[];for(var Ae=0,Ie=ve(se.toString(),Dv(se,M,v,a,p,V,te));Ae<Ie.length;Ae+=1){var Oe=Ie[Ae],je=new ii;je.text=Oe,je.sections=se.sections;for(var Xe=0;Xe<Oe.length;Xe++)je.sectionIndex.push(0);ce.push(je)}}else if(we){ce=[];for(var ct=0,Qe=we(se.text,se.sectionIndex,Dv(se,M,v,a,p,V,te));ct<Qe.length;ct+=1){var mt=Qe[ct],et=new ii;et.text=mt[0],et.sectionIndex=mt[1],et.sections=se.sections,ce.push(et)}}else ce=function(lt,qt){for(var zt=[],Jt=lt.text,gt=0,sn=0,kn=qt;sn<kn.length;sn+=1){var Gn=kn[sn];zt.push(lt.substring(gt,Gn)),gt=Gn}return gt<Jt.length&&zt.push(lt.substring(gt,Jt.length)),zt}(se,Dv(se,M,v,a,p,V,te));var jt=[],Tt={positionedLines:jt,text:se.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:R,iconsInText:!1,verticalizable:!1};return function(lt,qt,zt,Jt,gt,sn,kn,Gn,Nn,Ln,Wn,Er){for(var Tr=0,oi=-17,Rr=0,ai=0,$n=Gn==="right"?1:Gn==="left"?0:.5,Or=0,Yt=0,_n=gt;Yt<_n.length;Yt+=1){var mn=_n[Yt];mn.trim();var rn=mn.getMaxScale(),fi=24*(rn-1),Yr={positionedGlyphs:[],lineOffset:0};lt.positionedLines[Or]=Yr;var An=Yr.positionedGlyphs,lr=0;if(mn.length()){for(var $r=0;$r<mn.length();$r++){var ln=mn.getSection($r),Ka=mn.getSectionIndex($r),lo=mn.getCharCode($r),Ja=0,Kn=null,Qa=null,Ho=null,ih=24,Gu=!(Nn===so.horizontal||!Wn&&!Dc(lo)||Wn&&(Mm[lo]||(Xs=lo,Ye.Arabic(Xs)||Ye["Arabic Supplement"](Xs)||Ye["Arabic Extended-A"](Xs)||Ye["Arabic Presentation Forms-A"](Xs)||Ye["Arabic Presentation Forms-B"](Xs))));if(ln.imageName){var oh=Jt[ln.imageName];if(!oh)continue;Ho=ln.imageName,lt.iconsInText=lt.iconsInText||!0,Qa=oh.paddedRect;var Zs=oh.displaySize;ln.scale=24*ln.scale/Er,Ja=fi+(24-Zs[1]*ln.scale),ih=(Kn={width:Zs[0],height:Zs[1],left:1,top:-3,advance:Gu?Zs[1]:Zs[0]}).advance;var ah=Gu?Zs[0]*ln.scale-24*rn:Zs[1]*ln.scale-24*rn;ah>0&&ah>lr&&(lr=ah)}else{var Fm=zt[ln.fontStack],sh=Fm&&Fm[lo];if(sh&&sh.rect)Qa=sh.rect,Kn=sh.metrics;else{var op=qt[ln.fontStack],Um=op&&op[lo];if(!Um)continue;Kn=Um.metrics}Ja=24*(rn-ln.scale)}Gu?(lt.verticalizable=!0,An.push({glyph:lo,imageName:Ho,x:Tr,y:oi+Ja,vertical:Gu,scale:ln.scale,fontStack:ln.fontStack,sectionIndex:Ka,metrics:Kn,rect:Qa}),Tr+=ih*ln.scale+Ln):(An.push({glyph:lo,imageName:Ho,x:Tr,y:oi+Ja,vertical:Gu,scale:ln.scale,fontStack:ln.fontStack,sectionIndex:Ka,metrics:Kn,rect:Qa}),Tr+=Kn.advance*ln.scale+Ln)}An.length!==0&&(Rr=Math.max(Tr-Ln,Rr),hk(An,0,An.length-1,$n,lr)),Tr=0;var jm=sn*rn+lr;Yr.lineOffset=Math.max(lr,fi),oi+=jm,ai=Math.max(jm,ai),++Or}else oi+=sn,++Or}var Xs,ap=oi- -17,lh=zv(kn),zl=lh.horizontalAlign,uh=lh.verticalAlign;(function(Vm,Gm,sp,lp,Wm,up,cp,hp,Hm){var ch,qm=(Gm-sp)*Wm;ch=up!==cp?-hp*lp- -17:(-lp*Hm+.5)*cp;for(var hh=0,fp=Vm;hh<fp.length;hh+=1)for(var Wu=0,pp=fp[hh].positionedGlyphs;Wu<pp.length;Wu+=1){var fh=pp[Wu];fh.x+=qm,fh.y+=ch}})(lt.positionedLines,$n,zl,uh,Rr,ai,sn,ap,gt.length),lt.top+=-uh*ap,lt.bottom=lt.top+ap,lt.left+=-zl*Rr,lt.right=lt.left+Rr}(Tt,a,u,p,ce,x,T,P,R,M,F,ne),!function(lt){for(var qt=0,zt=lt;qt<zt.length;qt+=1)if(zt[qt].positionedGlyphs.length!==0)return!1;return!0}(jt)&&Tt}ii.fromFeature=function(i,a){for(var u=new ii,p=0;p<i.sections.length;p++){var m=i.sections[p];m.image?u.addImageSection(m):u.addTextSection(m,a)}return u},ii.prototype.length=function(){return this.text.length},ii.prototype.getSection=function(i){return this.sections[this.sectionIndex[i]]},ii.prototype.getSectionIndex=function(i){return this.sectionIndex[i]},ii.prototype.getCharCode=function(i){return this.text.charCodeAt(i)},ii.prototype.verticalizePunctuation=function(){this.text=function(i){for(var a="",u=0;u<i.length;u++){var p=i.charCodeAt(u+1)||null,m=i.charCodeAt(u-1)||null;a+=p&&Ff(p)&&!ep[i[u+1]]||m&&Ff(m)&&!ep[i[u-1]]||!ep[i[u]]?i[u]:ep[i[u]]}return a}(this.text)},ii.prototype.trim=function(){for(var i=0,a=0;a<this.text.length&&Mm[this.text.charCodeAt(a)];a++)i++;for(var u=this.text.length,p=this.text.length-1;p>=0&&p>=i&&Mm[this.text.charCodeAt(p)];p--)u--;this.text=this.text.substring(i,u),this.sectionIndex=this.sectionIndex.slice(i,u)},ii.prototype.substring=function(i,a){var u=new ii;return u.text=this.text.substring(i,a),u.sectionIndex=this.sectionIndex.slice(i,a),u.sections=this.sections,u},ii.prototype.toString=function(){return this.text},ii.prototype.getMaxScale=function(){var i=this;return this.sectionIndex.reduce(function(a,u){return Math.max(a,i.sections[u].scale)},0)},ii.prototype.addTextSection=function(i,a){this.text+=i.text,this.sections.push($c.forText(i.scale,i.fontStack||a));for(var u=this.sections.length-1,p=0;p<i.text.length;++p)this.sectionIndex.push(u)},ii.prototype.addImageSection=function(i){var a=i.image?i.image.name:"";if(a.length!==0){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push($c.forImage(a)),this.sectionIndex.push(this.sections.length-1)):ft("Reached maximum number of images 6401")}else ft("Can't add FormattedSection with an empty image.")},ii.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Mm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Wi={};function qb(i,a,u,p,m,v){if(a.imageName){var x=p[a.imageName];return x?x.displaySize[0]*a.scale*24/v+m:0}var T=u[a.fontStack],P=T&&T[i];return P?P.metrics.advance*a.scale+m:0}function Zb(i,a,u,p){var m=Math.pow(i-a,2);return p?i<a?m/2:2*m:m+Math.abs(u)*u}function ck(i,a,u){var p=0;return i===10&&(p-=1e4),u&&(p+=150),i!==40&&i!==65288||(p+=50),a!==41&&a!==65289||(p+=50),p}function Xb(i,a,u,p,m,v){for(var x=null,T=Zb(a,u,m,v),P=0,M=p;P<M.length;P+=1){var L=M[P],R=Zb(a-L.x,u,m,v)+L.badness;R<=T&&(x=L,T=R)}return{index:i,x:a,priorBreak:x,badness:T}}function Dv(i,a,u,p,m,v,x){if(v!=="point")return[];if(!i)return[];for(var T,P=[],M=function(ce,se,ve,we,Ae,Ie){for(var Oe=0,je=0;je<ce.length();je++){var Xe=ce.getSection(je);Oe+=qb(ce.getCharCode(je),Xe,we,Ae,se,Ie)}return Oe/Math.max(1,Math.ceil(Oe/ve))}(i,a,u,p,m,x),L=i.text.indexOf("​")>=0,R=0,F=0;F<i.length();F++){var V=i.getSection(F),te=i.getCharCode(F);if(Mm[te]||(R+=qb(te,V,p,m,a,x)),F<i.length()-1){var ne=!((T=te)<11904||!(Ye["Bopomofo Extended"](T)||Ye.Bopomofo(T)||Ye["CJK Compatibility Forms"](T)||Ye["CJK Compatibility Ideographs"](T)||Ye["CJK Compatibility"](T)||Ye["CJK Radicals Supplement"](T)||Ye["CJK Strokes"](T)||Ye["CJK Symbols and Punctuation"](T)||Ye["CJK Unified Ideographs Extension A"](T)||Ye["CJK Unified Ideographs"](T)||Ye["Enclosed CJK Letters and Months"](T)||Ye["Halfwidth and Fullwidth Forms"](T)||Ye.Hiragana(T)||Ye["Ideographic Description Characters"](T)||Ye["Kangxi Radicals"](T)||Ye["Katakana Phonetic Extensions"](T)||Ye.Katakana(T)||Ye["Vertical Forms"](T)||Ye["Yi Radicals"](T)||Ye["Yi Syllables"](T)));(Wi[te]||ne||V.imageName)&&P.push(Xb(F+1,R,M,P,ck(te,i.getCharCode(F+1),ne&&L),!1))}}return function ce(se){return se?ce(se.priorBreak).concat(se.index):[]}(Xb(i.length(),R,M,P,0,!0))}function zv(i){var a=.5,u=.5;switch(i){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:a,verticalAlign:u}}function hk(i,a,u,p,m){if(p||m)for(var v=i[u],x=(i[u].x+v.metrics.advance*v.scale)*p,T=a;T<=u;T++)i[T].x-=x,i[T].y+=m}function Yb(i,a,u,p,m,v){var x,T=i.image;if(T.content){var P=T.content,M=T.pixelRatio||1;x=[P[0]/M,P[1]/M,T.displaySize[0]-P[2]/M,T.displaySize[1]-P[3]/M]}var L,R,F,V,te=a.left*v,ne=a.right*v;u==="width"||u==="both"?(V=m[0]+te-p[3],R=m[0]+ne+p[1]):R=(V=m[0]+(te+ne-T.displaySize[0])/2)+T.displaySize[0];var ce=a.top*v,se=a.bottom*v;return u==="height"||u==="both"?(L=m[1]+ce-p[0],F=m[1]+se+p[2]):F=(L=m[1]+(ce+se-T.displaySize[1])/2)+T.displaySize[1],{image:T,top:L,right:R,bottom:F,left:V,collisionPadding:x}}Wi[10]=!0,Wi[32]=!0,Wi[38]=!0,Wi[40]=!0,Wi[41]=!0,Wi[43]=!0,Wi[45]=!0,Wi[47]=!0,Wi[173]=!0,Wi[183]=!0,Wi[8203]=!0,Wi[8208]=!0,Wi[8211]=!0,Wi[8231]=!0;var Kc=function(i){function a(u,p,m,v){i.call(this,u,p),this.angle=m,v!==void 0&&(this.segment=v)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.clone=function(){return new a(this.x,this.y,this.angle,this.segment)},a}(S);function Bv(i,a){var u=a.expression;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new Zt(i+1))};if(u.kind==="source")return{kind:"source"};for(var p=u.zoomStops,m=u.interpolationType,v=0;v<p.length&&p[v]<=i;)v++;for(var x=v=Math.max(0,v-1);x<p.length&&p[x]<i+1;)x++;x=Math.min(p.length-1,x);var T=p[v],P=p[x];return u.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:P,interpolationType:m}:{kind:"camera",minZoom:T,maxZoom:P,minSize:u.evaluate(new Zt(T)),maxSize:u.evaluate(new Zt(P)),interpolationType:m}}function $b(i,a,u){var p=a.uSize,m=u.lowerSize;return i.kind==="source"?m/128:i.kind==="composite"?ar(m/128,u.upperSize/128,a.uSizeT):p}function Kb(i,a){var u=0,p=0;if(i.kind==="constant")p=i.layoutSize;else if(i.kind!=="source"){var m=i.interpolationType,v=m?he(Nr.interpolationFactor(m,a,i.minZoom,i.maxZoom),0,1):0;i.kind==="camera"?p=ar(i.minSize,i.maxSize,v):u=v}return{uSizeT:u,uSize:p}}ot("Anchor",Kc);var fk=Object.freeze({__proto__:null,getSizeData:Bv,evaluateSizeForFeature:$b,evaluateSizeForZoom:Kb,SIZE_PACK_FACTOR:128});function Jb(i,a,u,p,m){if(a.segment===void 0)return!0;for(var v=a,x=a.segment+1,T=0;T>-u/2;){if(--x<0)return!1;T-=i[x].dist(v),v=i[x]}T+=i[x].dist(i[x+1]),x++;for(var P=[],M=0;T<u/2;){var L=i[x],R=i[x+1];if(!R)return!1;var F=i[x-1].angleTo(L)-L.angleTo(R);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:T,angleDelta:F}),M+=F;T-P[0].distance>p;)M-=P.shift().angleDelta;if(M>m)return!1;x++,T+=L.dist(R)}return!0}function Qb(i){for(var a=0,u=0;u<i.length-1;u++)a+=i[u].dist(i[u+1]);return a}function ew(i,a,u){return i?.6*a*u:0}function tw(i,a){return Math.max(i?i.right-i.left:0,a?a.right-a.left:0)}function pk(i,a,u,p,m,v){for(var x=ew(u,m,v),T=tw(u,p)*v,P=0,M=Qb(i)/2,L=0;L<i.length-1;L++){var R=i[L],F=i[L+1],V=R.dist(F);if(P+V>M){var te=(M-P)/V,ne=ar(R.x,F.x,te),ce=ar(R.y,F.y,te),se=new Kc(ne,ce,F.angleTo(R),L);return se._round(),!x||Jb(i,se,T,x,a)?se:void 0}P+=V}}function dk(i,a,u,p,m,v,x,T,P){var M=ew(p,v,x),L=tw(p,m),R=L*x,F=i[0].x===0||i[0].x===P||i[0].y===0||i[0].y===P;return a-R<a/4&&(a=R+a/4),function V(te,ne,ce,se,ve,we,Ae,Ie,Oe){for(var je=we/2,Xe=Qb(te),ct=0,Qe=ne-ce,mt=[],et=0;et<te.length-1;et++){for(var jt=te[et],Tt=te[et+1],lt=jt.dist(Tt),qt=Tt.angleTo(jt);Qe+ce<ct+lt;){var zt=((Qe+=ce)-ct)/lt,Jt=ar(jt.x,Tt.x,zt),gt=ar(jt.y,Tt.y,zt);if(Jt>=0&&Jt<Oe&&gt>=0&&gt<Oe&&Qe-je>=0&&Qe+je<=Xe){var sn=new Kc(Jt,gt,qt,et);sn._round(),se&&!Jb(te,sn,we,se,ve)||mt.push(sn)}}ct+=lt}return Ie||mt.length||Ae||(mt=V(te,ct/2,ce,se,ve,we,Ae,!0,Oe)),mt}(i,F?a/2*T%a:(L/2+2*v)*x*T%a,a,M,u,R,F,!1,P)}function nw(i,a,u,p,m){for(var v=[],x=0;x<i.length;x++)for(var T=i[x],P=void 0,M=0;M<T.length-1;M++){var L=T[M],R=T[M+1];L.x<a&&R.x<a||(L.x<a?L=new S(a,L.y+(a-L.x)/(R.x-L.x)*(R.y-L.y))._round():R.x<a&&(R=new S(a,L.y+(a-L.x)/(R.x-L.x)*(R.y-L.y))._round()),L.y<u&&R.y<u||(L.y<u?L=new S(L.x+(u-L.y)/(R.y-L.y)*(R.x-L.x),u)._round():R.y<u&&(R=new S(L.x+(u-L.y)/(R.y-L.y)*(R.x-L.x),u)._round()),L.x>=p&&R.x>=p||(L.x>=p?L=new S(p,L.y+(p-L.x)/(R.x-L.x)*(R.y-L.y))._round():R.x>=p&&(R=new S(p,L.y+(p-L.x)/(R.x-L.x)*(R.y-L.y))._round()),L.y>=m&&R.y>=m||(L.y>=m?L=new S(L.x+(m-L.y)/(R.y-L.y)*(R.x-L.x),m)._round():R.y>=m&&(R=new S(L.x+(m-L.y)/(R.y-L.y)*(R.x-L.x),m)._round()),P&&L.equals(P[P.length-1])||v.push(P=[L]),P.push(R)))))}return v}function rw(i,a,u,p){var m=[],v=i.image,x=v.pixelRatio,T=v.paddedRect.w-2,P=v.paddedRect.h-2,M=i.right-i.left,L=i.bottom-i.top,R=v.stretchX||[[0,T]],F=v.stretchY||[[0,P]],V=function(Jt,gt){return Jt+gt[1]-gt[0]},te=R.reduce(V,0),ne=F.reduce(V,0),ce=T-te,se=P-ne,ve=0,we=te,Ae=0,Ie=ne,Oe=0,je=ce,Xe=0,ct=se;if(v.content&&p){var Qe=v.content;ve=km(R,0,Qe[0]),Ae=km(F,0,Qe[1]),we=km(R,Qe[0],Qe[2]),Ie=km(F,Qe[1],Qe[3]),Oe=Qe[0]-ve,Xe=Qe[1]-Ae,je=Qe[2]-Qe[0]-we,ct=Qe[3]-Qe[1]-Ie}var mt=function(Jt,gt,sn,kn){var Gn=Lm(Jt.stretch-ve,we,M,i.left),Nn=Rm(Jt.fixed-Oe,je,Jt.stretch,te),Ln=Lm(gt.stretch-Ae,Ie,L,i.top),Wn=Rm(gt.fixed-Xe,ct,gt.stretch,ne),Er=Lm(sn.stretch-ve,we,M,i.left),Tr=Rm(sn.fixed-Oe,je,sn.stretch,te),oi=Lm(kn.stretch-Ae,Ie,L,i.top),Rr=Rm(kn.fixed-Xe,ct,kn.stretch,ne),ai=new S(Gn,Ln),$n=new S(Er,Ln),Or=new S(Er,oi),Yt=new S(Gn,oi),_n=new S(Nn/x,Wn/x),mn=new S(Tr/x,Rr/x),rn=a*Math.PI/180;if(rn){var fi=Math.sin(rn),Yr=Math.cos(rn),An=[Yr,-fi,fi,Yr];ai._matMult(An),$n._matMult(An),Yt._matMult(An),Or._matMult(An)}var lr=Jt.stretch+Jt.fixed,$r=gt.stretch+gt.fixed;return{tl:ai,tr:$n,bl:Yt,br:Or,tex:{x:v.paddedRect.x+1+lr,y:v.paddedRect.y+1+$r,w:sn.stretch+sn.fixed-lr,h:kn.stretch+kn.fixed-$r},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:_n,pixelOffsetBR:mn,minFontScaleX:je/x/M,minFontScaleY:ct/x/L,isSDF:u}};if(p&&(v.stretchX||v.stretchY))for(var et=iw(R,ce,te),jt=iw(F,se,ne),Tt=0;Tt<et.length-1;Tt++)for(var lt=et[Tt],qt=et[Tt+1],zt=0;zt<jt.length-1;zt++)m.push(mt(lt,jt[zt],qt,jt[zt+1]));else m.push(mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:P+1}));return m}function km(i,a,u){for(var p=0,m=0,v=i;m<v.length;m+=1){var x=v[m];p+=Math.max(a,Math.min(u,x[1]))-Math.max(a,Math.min(u,x[0]))}return p}function iw(i,a,u){for(var p=[{fixed:-1,stretch:0}],m=0,v=i;m<v.length;m+=1){var x=v[m],T=x[0],P=x[1],M=p[p.length-1];p.push({fixed:T-M.stretch,stretch:M.stretch}),p.push({fixed:T-M.stretch,stretch:M.stretch+(P-T)})}return p.push({fixed:a+1,stretch:u}),p}function Lm(i,a,u,p){return i/a*u+p}function Rm(i,a,u,p){return i-a*u/p}var Om=function(i,a,u,p,m,v,x,T,P,M){if(this.boxStartIndex=i.length,P){var L=v.top,R=v.bottom,F=v.collisionPadding;F&&(L-=F[1],R+=F[3]);var V=R-L;V>0&&(V=Math.max(10,V),this.circleDiameter=V)}else{var te=v.top*x-T,ne=v.bottom*x+T,ce=v.left*x-T,se=v.right*x+T,ve=v.collisionPadding;if(ve&&(ce-=ve[0]*x,te-=ve[1]*x,se+=ve[2]*x,ne+=ve[3]*x),M){var we=new S(ce,te),Ae=new S(se,te),Ie=new S(ce,ne),Oe=new S(se,ne),je=M*Math.PI/180;we._rotate(je),Ae._rotate(je),Ie._rotate(je),Oe._rotate(je),ce=Math.min(we.x,Ae.x,Ie.x,Oe.x),se=Math.max(we.x,Ae.x,Ie.x,Oe.x),te=Math.min(we.y,Ae.y,Ie.y,Oe.y),ne=Math.max(we.y,Ae.y,Ie.y,Oe.y)}i.emplaceBack(a.x,a.y,ce,te,se,ne,u,p,m)}this.boxEndIndex=i.length},Jc=function(i,a){if(i===void 0&&(i=[]),a===void 0&&(a=mk),this.data=i,this.length=this.data.length,this.compare=a,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function mk(i,a){return i<a?-1:i>a?1:0}function gk(i,a,u){a===void 0&&(a=1),u===void 0&&(u=!1);for(var p=1/0,m=1/0,v=-1/0,x=-1/0,T=i[0],P=0;P<T.length;P++){var M=T[P];(!P||M.x<p)&&(p=M.x),(!P||M.y<m)&&(m=M.y),(!P||M.x>v)&&(v=M.x),(!P||M.y>x)&&(x=M.y)}var L=Math.min(v-p,x-m),R=L/2,F=new Jc([],yk);if(L===0)return new S(p,m);for(var V=p;V<v;V+=L)for(var te=m;te<x;te+=L)F.push(new Qc(V+R,te+R,R,i));for(var ne=function(ve){for(var we=0,Ae=0,Ie=0,Oe=ve[0],je=0,Xe=Oe.length,ct=Xe-1;je<Xe;ct=je++){var Qe=Oe[je],mt=Oe[ct],et=Qe.x*mt.y-mt.x*Qe.y;Ae+=(Qe.x+mt.x)*et,Ie+=(Qe.y+mt.y)*et,we+=3*et}return new Qc(Ae/we,Ie/we,0,ve)}(i),ce=F.length;F.length;){var se=F.pop();(se.d>ne.d||!ne.d)&&(ne=se,u&&console.log("found best %d after %d probes",Math.round(1e4*se.d)/1e4,ce)),se.max-ne.d<=a||(F.push(new Qc(se.p.x-(R=se.h/2),se.p.y-R,R,i)),F.push(new Qc(se.p.x+R,se.p.y-R,R,i)),F.push(new Qc(se.p.x-R,se.p.y+R,R,i)),F.push(new Qc(se.p.x+R,se.p.y+R,R,i)),ce+=4)}return u&&(console.log("num probes: "+ce),console.log("best distance: "+ne.d)),ne.p}function yk(i,a){return a.max-i.max}function Qc(i,a,u,p){this.p=new S(i,a),this.h=u,this.d=function(m,v){for(var x=!1,T=1/0,P=0;P<v.length;P++)for(var M=v[P],L=0,R=M.length,F=R-1;L<R;F=L++){var V=M[L],te=M[F];V.y>m.y!=te.y>m.y&&m.x<(te.x-V.x)*(m.y-V.y)/(te.y-V.y)+V.x&&(x=!x),T=Math.min(T,Ll(m,V,te))}return(x?1:-1)*Math.sqrt(T)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}Jc.prototype.push=function(i){this.data.push(i),this.length++,this._up(this.length-1)},Jc.prototype.pop=function(){if(this.length!==0){var i=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),i}},Jc.prototype.peek=function(){return this.data[0]},Jc.prototype._up=function(i){for(var a=this.data,u=this.compare,p=a[i];i>0;){var m=i-1>>1,v=a[m];if(u(p,v)>=0)break;a[i]=v,i=m}a[i]=p},Jc.prototype._down=function(i){for(var a=this.data,u=this.compare,p=this.length>>1,m=a[i];i<p;){var v=1+(i<<1),x=a[v],T=v+1;if(T<this.length&&u(a[T],x)<0&&(v=T,x=a[T]),u(x,m)>=0)break;a[i]=x,i=v}a[i]=m};var Nv=Number.POSITIVE_INFINITY;function ow(i,a){return a[1]!==Nv?function(u,p,m){var v=0,x=0;switch(p=Math.abs(p),m=Math.abs(m),u){case"top-right":case"top-left":case"top":x=m-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-m}switch(u){case"top-right":case"bottom-right":case"right":v=-p;break;case"top-left":case"bottom-left":case"left":v=p}return[v,x]}(i,a[0],a[1]):function(u,p){var m=0,v=0;p<0&&(p=0);var x=p/Math.sqrt(2);switch(u){case"top-right":case"top-left":v=x-7;break;case"bottom-right":case"bottom-left":v=7-x;break;case"bottom":v=7-p;break;case"top":v=p-7}switch(u){case"top-right":case"bottom-right":m=-x;break;case"top-left":case"bottom-left":m=x;break;case"left":m=p;break;case"right":m=-p}return[m,v]}(i,a[0])}function Fv(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function aw(i,a,u,p,m,v,x,T,P,M,L,R,F,V,te){var ne=function(Ae,Ie,Oe,je,Xe,ct,Qe,mt){for(var et=je.layout.get("text-rotate").evaluate(ct,{})*Math.PI/180,jt=[],Tt=0,lt=Ie.positionedLines;Tt<lt.length;Tt+=1)for(var qt=lt[Tt],zt=0,Jt=qt.positionedGlyphs;zt<Jt.length;zt+=1){var gt=Jt[zt];if(gt.rect){var sn=gt.rect||{},kn=4,Gn=!0,Nn=1,Ln=0,Wn=(Xe||mt)&&gt.vertical,Er=gt.metrics.advance*gt.scale/2;if(mt&&Ie.verticalizable&&(Ln=qt.lineOffset/2-(gt.imageName?-(24-gt.metrics.width*gt.scale)/2:24*(gt.scale-1))),gt.imageName){var Tr=Qe[gt.imageName];Gn=Tr.sdf,kn=1/(Nn=Tr.pixelRatio)}var oi=Xe?[gt.x+Er,gt.y]:[0,0],Rr=Xe?[0,0]:[gt.x+Er+Oe[0],gt.y+Oe[1]-Ln],ai=[0,0];Wn&&(ai=Rr,Rr=[0,0]);var $n=(gt.metrics.left-kn)*gt.scale-Er+Rr[0],Or=(-gt.metrics.top-kn)*gt.scale+Rr[1],Yt=$n+sn.w*gt.scale/Nn,_n=Or+sn.h*gt.scale/Nn,mn=new S($n,Or),rn=new S(Yt,Or),fi=new S($n,_n),Yr=new S(Yt,_n);if(Wn){var An=new S(-Er,Er- -17),lr=-Math.PI/2,$r=12-Er,ln=new S(22-$r,-(gt.imageName?$r:0)),Ka=new(Function.prototype.bind.apply(S,[null].concat(ai)));mn._rotateAround(lr,An)._add(ln)._add(Ka),rn._rotateAround(lr,An)._add(ln)._add(Ka),fi._rotateAround(lr,An)._add(ln)._add(Ka),Yr._rotateAround(lr,An)._add(ln)._add(Ka)}if(et){var lo=Math.sin(et),Ja=Math.cos(et),Kn=[Ja,-lo,lo,Ja];mn._matMult(Kn),rn._matMult(Kn),fi._matMult(Kn),Yr._matMult(Kn)}var Qa=new S(0,0),Ho=new S(0,0);jt.push({tl:mn,tr:rn,bl:fi,br:Yr,tex:sn,writingMode:Ie.writingMode,glyphOffset:oi,sectionIndex:gt.sectionIndex,isSDF:Gn,pixelOffsetTL:Qa,pixelOffsetBR:Ho,minFontScaleX:0,minFontScaleY:0})}}return jt}(0,u,T,m,v,x,p,i.allowVerticalPlacement),ce=i.textSizeData,se=null;ce.kind==="source"?(se=[128*m.layout.get("text-size").evaluate(x,{})])[0]>32640&&ft(i.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):ce.kind==="composite"&&((se=[128*V.compositeTextSizes[0].evaluate(x,{},te),128*V.compositeTextSizes[1].evaluate(x,{},te)])[0]>32640||se[1]>32640)&&ft(i.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),i.addSymbols(i.text,ne,se,T,v,x,M,a,P.lineStartIndex,P.lineLength,F,te);for(var ve=0,we=L;ve<we.length;ve+=1)R[we[ve]]=i.text.placedSymbolArray.length-1;return 4*ne.length}function sw(i){for(var a in i)return i[a];return null}function vk(i,a,u,p){var m=i.compareText;if(a in m){for(var v=m[a],x=v.length-1;x>=0;x--)if(p.dist(v[x])<u)return!0}else m[a]=[];return m[a].push(p),!1}var _k=Zc.VectorTileFeature.types,xk=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Dm(i,a,u,p,m,v,x,T,P,M,L,R,F){var V=T?Math.min(32640,Math.round(T[0])):0,te=T?Math.min(32640,Math.round(T[1])):0;i.emplaceBack(a,u,Math.round(32*p),Math.round(32*m),v,x,(V<<1)+(P?1:0),te,16*M,16*L,256*R,256*F)}function Uv(i,a,u){i.emplaceBack(a.x,a.y,u),i.emplaceBack(a.x,a.y,u),i.emplaceBack(a.x,a.y,u),i.emplaceBack(a.x,a.y,u)}function bk(i){for(var a=0,u=i.sections;a<u.length;a+=1)if(zc(u[a].text))return!0;return!1}var eh=function(i){this.layoutVertexArray=new Uc,this.indexArray=new Ha,this.programConfigurations=i,this.segments=new Y,this.dynamicLayoutVertexArray=new Cl,this.opacityVertexArray=new Ru,this.placedSymbolArray=new d};eh.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},eh.prototype.upload=function(i,a,u,p){this.isEmpty()||(u&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ZM.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,XM.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,xk,!0),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(i))},eh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ot("SymbolBuffers",eh);var rp=function(i,a,u){this.layoutVertexArray=new i,this.layoutAttributes=a,this.indexArray=new u,this.segments=new Y,this.collisionVertexArray=new Hf};rp.prototype.upload=function(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,YM.members,!0)},rp.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ot("CollisionBuffers",rp);var yn=function(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(function(v){return v.id}),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Gi([]),this.placementViewportMatrix=Gi([]);var a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Bv(this.zoom,a["text-size"]),this.iconSizeData=Bv(this.zoom,a["icon-size"]);var u=this.layers[0].layout,p=u.get("symbol-sort-key"),m=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(function(v){return so[v]})),this.stateDependentLayerIds=this.layers.filter(function(v){return v.isStateDependent()}).map(function(v){return v.id}),this.sourceID=i.sourceID};yn.prototype.createArrays=function(){this.text=new eh(new Et(this.layers,this.zoom,function(i){return/^text/.test(i)})),this.icon=new eh(new Et(this.layers,this.zoom,function(i){return/^icon/.test(i)})),this.glyphOffsetArray=new E,this.lineVertexArray=new A,this.symbolInstances=new w},yn.prototype.calculateGlyphDependencies=function(i,a,u,p,m){for(var v=0;v<i.length;v++)if(a[i.charCodeAt(v)]=!0,(u||p)&&m){var x=ep[i.charAt(v)];x&&(a[x.charCodeAt(0)]=!0)}},yn.prototype.populate=function(i,a,u){var p=this.layers[0],m=p.layout,v=m.get("text-font"),x=m.get("text-field"),T=m.get("icon-image"),P=(x.value.kind!=="constant"||x.value.value instanceof Un&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),M=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,L=m.get("symbol-sort-key");if(this.features=[],P||M){for(var R=a.iconDependencies,F=a.glyphDependencies,V=a.availableImages,te=new Zt(this.zoom),ne=0,ce=i;ne<ce.length;ne+=1){var se=ce[ne],ve=se.feature,we=se.id,Ae=se.index,Ie=se.sourceLayerIndex,Oe=p._featureFilter.needGeometry,je=Yn(ve,Oe);if(p._featureFilter.filter(te,je,u)){Oe||(je.geometry=Bn(ve));var Xe=void 0;if(P){var ct=p.getValueAndResolveTokens("text-field",je,u,V),Qe=Un.factory(ct);bk(Qe)&&(this.hasRTLText=!0),(!this.hasRTLText||jf()==="unavailable"||this.hasRTLText&&Vi.isParsed())&&(Xe=KM(Qe,p,je))}var mt=void 0;if(M){var et=p.getValueAndResolveTokens("icon-image",je,u,V);mt=et instanceof Pn?et:Pn.fromString(et)}if(Xe||mt){var jt=this.sortFeaturesByKey?L.evaluate(je,{},u):void 0;if(this.features.push({id:we,text:Xe,icon:mt,index:Ae,sourceLayerIndex:Ie,geometry:je.geometry,properties:ve.properties,type:_k[ve.type],sortKey:jt}),mt&&(R[mt.name]=!0),Xe){var Tt=v.evaluate(je,{},u).join(","),lt=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(so.vertical)>=0;for(var qt=0,zt=Xe.sections;qt<zt.length;qt+=1){var Jt=zt[qt];if(Jt.image)R[Jt.image.name]=!0;else{var gt=Nf(Xe.toString()),sn=Jt.fontStack||Tt,kn=F[sn]=F[sn]||{};this.calculateGlyphDependencies(Jt.text,kn,lt,this.allowVerticalPlacement,gt)}}}}}}m.get("symbol-placement")==="line"&&(this.features=function(Gn){var Nn={},Ln={},Wn=[],Er=0;function Tr(An){Wn.push(Gn[An]),Er++}function oi(An,lr,$r){var ln=Ln[An];return delete Ln[An],Ln[lr]=ln,Wn[ln].geometry[0].pop(),Wn[ln].geometry[0]=Wn[ln].geometry[0].concat($r[0]),ln}function Rr(An,lr,$r){var ln=Nn[lr];return delete Nn[lr],Nn[An]=ln,Wn[ln].geometry[0].shift(),Wn[ln].geometry[0]=$r[0].concat(Wn[ln].geometry[0]),ln}function ai(An,lr,$r){var ln=$r?lr[0][lr[0].length-1]:lr[0][0];return An+":"+ln.x+":"+ln.y}for(var $n=0;$n<Gn.length;$n++){var Or=Gn[$n],Yt=Or.geometry,_n=Or.text?Or.text.toString():null;if(_n){var mn=ai(_n,Yt),rn=ai(_n,Yt,!0);if(mn in Ln&&rn in Nn&&Ln[mn]!==Nn[rn]){var fi=Rr(mn,rn,Yt),Yr=oi(mn,rn,Wn[fi].geometry);delete Nn[mn],delete Ln[rn],Ln[ai(_n,Wn[Yr].geometry,!0)]=Yr,Wn[fi].geometry=null}else mn in Ln?oi(mn,rn,Yt):rn in Nn?Rr(mn,rn,Yt):(Tr($n),Nn[mn]=Er-1,Ln[rn]=Er-1)}else Tr($n)}return Wn.filter(function(An){return An.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Gn,Nn){return Gn.sortKey-Nn.sortKey})}},yn.prototype.update=function(i,a,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,a,this.layers,u),this.icon.programConfigurations.updatePaintArrays(i,a,this.layers,u))},yn.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},yn.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},yn.prototype.upload=function(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},yn.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},yn.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},yn.prototype.addToLineVertexArray=function(i,a){var u=this.lineVertexArray.length;if(i.segment!==void 0){for(var p=i.dist(a[i.segment+1]),m=i.dist(a[i.segment]),v={},x=i.segment+1;x<a.length;x++)v[x]={x:a[x].x,y:a[x].y,tileUnitDistanceFromAnchor:p},x<a.length-1&&(p+=a[x+1].dist(a[x]));for(var T=i.segment||0;T>=0;T--)v[T]={x:a[T].x,y:a[T].y,tileUnitDistanceFromAnchor:m},T>0&&(m+=a[T-1].dist(a[T]));for(var P=0;P<a.length;P++){var M=v[P];this.lineVertexArray.emplaceBack(M.x,M.y,M.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},yn.prototype.addSymbols=function(i,a,u,p,m,v,x,T,P,M,L,R){for(var F=i.indexArray,V=i.layoutVertexArray,te=i.segments.prepareSegment(4*a.length,V,F,this.canOverlap?v.sortKey:void 0),ne=this.glyphOffsetArray.length,ce=te.vertexLength,se=this.allowVerticalPlacement&&x===so.vertical?Math.PI/2:0,ve=v.text&&v.text.sections,we=0;we<a.length;we++){var Ae=a[we],Ie=Ae.tl,Oe=Ae.tr,je=Ae.bl,Xe=Ae.br,ct=Ae.tex,Qe=Ae.pixelOffsetTL,mt=Ae.pixelOffsetBR,et=Ae.minFontScaleX,jt=Ae.minFontScaleY,Tt=Ae.glyphOffset,lt=Ae.isSDF,qt=Ae.sectionIndex,zt=te.vertexLength,Jt=Tt[1];Dm(V,T.x,T.y,Ie.x,Jt+Ie.y,ct.x,ct.y,u,lt,Qe.x,Qe.y,et,jt),Dm(V,T.x,T.y,Oe.x,Jt+Oe.y,ct.x+ct.w,ct.y,u,lt,mt.x,Qe.y,et,jt),Dm(V,T.x,T.y,je.x,Jt+je.y,ct.x,ct.y+ct.h,u,lt,Qe.x,mt.y,et,jt),Dm(V,T.x,T.y,Xe.x,Jt+Xe.y,ct.x+ct.w,ct.y+ct.h,u,lt,mt.x,mt.y,et,jt),Uv(i.dynamicLayoutVertexArray,T,se),F.emplaceBack(zt,zt+1,zt+2),F.emplaceBack(zt+1,zt+2,zt+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Tt[0]),we!==a.length-1&&qt===a[we+1].sectionIndex||i.programConfigurations.populatePaintArrays(V.length,v,v.index,{},R,ve&&ve[qt])}i.placedSymbolArray.emplaceBack(T.x,T.y,ne,this.glyphOffsetArray.length-ne,ce,P,M,T.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],x,0,!1,0,L)},yn.prototype._addCollisionDebugVertex=function(i,a,u,p,m,v){return a.emplaceBack(0,0),i.emplaceBack(u.x,u.y,p,m,Math.round(v.x),Math.round(v.y))},yn.prototype.addCollisionDebugVertices=function(i,a,u,p,m,v,x){var T=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),P=T.vertexLength,M=m.layoutVertexArray,L=m.collisionVertexArray,R=x.anchorX,F=x.anchorY;this._addCollisionDebugVertex(M,L,v,R,F,new S(i,a)),this._addCollisionDebugVertex(M,L,v,R,F,new S(u,a)),this._addCollisionDebugVertex(M,L,v,R,F,new S(u,p)),this._addCollisionDebugVertex(M,L,v,R,F,new S(i,p)),T.vertexLength+=4;var V=m.indexArray;V.emplaceBack(P,P+1),V.emplaceBack(P+1,P+2),V.emplaceBack(P+2,P+3),V.emplaceBack(P+3,P),T.primitiveLength+=4},yn.prototype.addDebugCollisionBoxes=function(i,a,u,p){for(var m=i;m<a;m++){var v=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,p?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,u)}},yn.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new rp(Ml,Fb.members,Ou),this.iconCollisionBox=new rp(Ml,Fb.members,Ou);for(var i=0;i<this.symbolInstances.length;i++){var a=this.symbolInstances.get(i);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}},yn.prototype._deserializeCollisionBoxesForSymbol=function(i,a,u,p,m,v,x,T,P){for(var M={},L=a;L<u;L++){var R=i.get(L);M.textBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},M.textFeatureIndex=R.featureIndex;break}for(var F=p;F<m;F++){var V=i.get(F);M.verticalTextBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},M.verticalTextFeatureIndex=V.featureIndex;break}for(var te=v;te<x;te++){var ne=i.get(te);M.iconBox={x1:ne.x1,y1:ne.y1,x2:ne.x2,y2:ne.y2,anchorPointX:ne.anchorPointX,anchorPointY:ne.anchorPointY},M.iconFeatureIndex=ne.featureIndex;break}for(var ce=T;ce<P;ce++){var se=i.get(ce);M.verticalIconBox={x1:se.x1,y1:se.y1,x2:se.x2,y2:se.y2,anchorPointX:se.anchorPointX,anchorPointY:se.anchorPointY},M.verticalIconFeatureIndex=se.featureIndex;break}return M},yn.prototype.deserializeCollisionBoxes=function(i){this.collisionArrays=[];for(var a=0;a<this.symbolInstances.length;a++){var u=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},yn.prototype.hasTextData=function(){return this.text.segments.get().length>0},yn.prototype.hasIconData=function(){return this.icon.segments.get().length>0},yn.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},yn.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},yn.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},yn.prototype.addIndicesForPlacedSymbol=function(i,a){for(var u=i.placedSymbolArray.get(a),p=u.vertexStartIndex+4*u.numGlyphs,m=u.vertexStartIndex;m<p;m+=4)i.indexArray.emplaceBack(m,m+1,m+2),i.indexArray.emplaceBack(m+1,m+2,m+3)},yn.prototype.getSortedSymbolIndexes=function(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var a=Math.sin(i),u=Math.cos(i),p=[],m=[],v=[],x=0;x<this.symbolInstances.length;++x){v.push(x);var T=this.symbolInstances.get(x);p.push(0|Math.round(a*T.anchorX+u*T.anchorY)),m.push(T.featureIndex)}return v.sort(function(P,M){return p[P]-p[M]||m[M]-m[P]}),v},yn.prototype.addToSortKeyRanges=function(i,a){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===a?u.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:i,symbolInstanceEnd:i+1})},yn.prototype.sortFeatures=function(i){var a=this;if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,p=this.symbolInstanceIndexes;u<p.length;u+=1){var m=this.symbolInstances.get(p[u]);this.featureSortOrder.push(m.featureIndex),[m.rightJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.leftJustifiedTextSymbolIndex].forEach(function(v,x,T){v>=0&&T.indexOf(v)===x&&a.addIndicesForPlacedSymbol(a.text,v)}),m.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,m.verticalPlacedTextSymbolIndex),m.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.placedIconSymbolIndex),m.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ot("SymbolBucket",yn,{omit:["layers","collisionBoxArray","features","compareText"]}),yn.MAX_GLYPHS=65535,yn.addDynamicAttributes=Uv;var wk=new Ur({"symbol-placement":new pt(X.layout_symbol["symbol-placement"]),"symbol-spacing":new pt(X.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new pt(X.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new st(X.layout_symbol["symbol-sort-key"]),"symbol-z-order":new pt(X.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new pt(X.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new pt(X.layout_symbol["icon-ignore-placement"]),"icon-optional":new pt(X.layout_symbol["icon-optional"]),"icon-rotation-alignment":new pt(X.layout_symbol["icon-rotation-alignment"]),"icon-size":new st(X.layout_symbol["icon-size"]),"icon-text-fit":new pt(X.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new pt(X.layout_symbol["icon-text-fit-padding"]),"icon-image":new st(X.layout_symbol["icon-image"]),"icon-rotate":new st(X.layout_symbol["icon-rotate"]),"icon-padding":new pt(X.layout_symbol["icon-padding"]),"icon-keep-upright":new pt(X.layout_symbol["icon-keep-upright"]),"icon-offset":new st(X.layout_symbol["icon-offset"]),"icon-anchor":new st(X.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new pt(X.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new pt(X.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new pt(X.layout_symbol["text-rotation-alignment"]),"text-field":new st(X.layout_symbol["text-field"]),"text-font":new st(X.layout_symbol["text-font"]),"text-size":new st(X.layout_symbol["text-size"]),"text-max-width":new st(X.layout_symbol["text-max-width"]),"text-line-height":new pt(X.layout_symbol["text-line-height"]),"text-letter-spacing":new st(X.layout_symbol["text-letter-spacing"]),"text-justify":new st(X.layout_symbol["text-justify"]),"text-radial-offset":new st(X.layout_symbol["text-radial-offset"]),"text-variable-anchor":new pt(X.layout_symbol["text-variable-anchor"]),"text-anchor":new st(X.layout_symbol["text-anchor"]),"text-max-angle":new pt(X.layout_symbol["text-max-angle"]),"text-writing-mode":new pt(X.layout_symbol["text-writing-mode"]),"text-rotate":new st(X.layout_symbol["text-rotate"]),"text-padding":new pt(X.layout_symbol["text-padding"]),"text-keep-upright":new pt(X.layout_symbol["text-keep-upright"]),"text-transform":new st(X.layout_symbol["text-transform"]),"text-offset":new st(X.layout_symbol["text-offset"]),"text-allow-overlap":new pt(X.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new pt(X.layout_symbol["text-ignore-placement"]),"text-optional":new pt(X.layout_symbol["text-optional"])}),jv={paint:new Ur({"icon-opacity":new st(X.paint_symbol["icon-opacity"]),"icon-color":new st(X.paint_symbol["icon-color"]),"icon-halo-color":new st(X.paint_symbol["icon-halo-color"]),"icon-halo-width":new st(X.paint_symbol["icon-halo-width"]),"icon-halo-blur":new st(X.paint_symbol["icon-halo-blur"]),"icon-translate":new pt(X.paint_symbol["icon-translate"]),"icon-translate-anchor":new pt(X.paint_symbol["icon-translate-anchor"]),"text-opacity":new st(X.paint_symbol["text-opacity"]),"text-color":new st(X.paint_symbol["text-color"],{runtimeType:Ze,getOverride:function(i){return i.textColor},hasOverride:function(i){return!!i.textColor}}),"text-halo-color":new st(X.paint_symbol["text-halo-color"]),"text-halo-width":new st(X.paint_symbol["text-halo-width"]),"text-halo-blur":new st(X.paint_symbol["text-halo-blur"]),"text-translate":new pt(X.paint_symbol["text-translate"]),"text-translate-anchor":new pt(X.paint_symbol["text-translate-anchor"])}),layout:wk},th=function(i){this.type=i.property.overrides?i.property.overrides.runtimeType:rt,this.defaultValue=i};th.prototype.evaluate=function(i){if(i.formattedSection){var a=this.defaultValue.property.overrides;if(a&&a.hasOverride(i.formattedSection))return a.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default},th.prototype.eachChild=function(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)},th.prototype.outputDefined=function(){return!1},th.prototype.serialize=function(){return null},ot("FormatSectionOverride",th,{omit:["defaultValue"]});var Ek=function(i){function a(u){i.call(this,u,jv)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.recalculate=function(u,p){if(i.prototype.recalculate.call(this,u,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var m=this.layout.get("text-writing-mode");if(m){for(var v=[],x=0,T=m;x<T.length;x+=1){var P=T[x];v.indexOf(P)<0&&v.push(P)}this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},a.prototype.getValueAndResolveTokens=function(u,p,m,v){var x=this.layout.get(u).evaluate(p,{},m,v),T=this._unevaluatedLayout._values[u];return T.isDataDriven()||wu(T.value)||!x?x:function(P,M){return M.replace(/{([^{}]+)}/g,function(L,R){return R in P?String(P[R]):""})}(p.properties,x)},a.prototype.createBucket=function(u){return new yn(u)},a.prototype.queryRadius=function(){return 0},a.prototype.queryIntersectsFeature=function(){return!1},a.prototype._setPaintOverrides=function(){for(var u=0,p=jv.paint.overridableProperties;u<p.length;u+=1){var m=p[u];if(a.hasPaintOverride(this.layout,m)){var v,x=this.paint.get(m),T=new th(x),P=new El(T,x.property.specification);v=x.value.kind==="constant"||x.value.kind==="source"?new Eu("source",P):new Tl("composite",P,x.value.zoomStops,x.value._interpolationType),this.paint._values[m]=new ti(x.property,v,x.parameters)}}},a.prototype._handleOverridablePaintPropertyUpdate=function(u,p,m){return!(!this.layout||p.isDataDriven()||m.isDataDriven())&&a.hasPaintOverride(this.layout,u)},a.hasPaintOverride=function(u,p){var m=u.get("text-field"),v=jv.paint.properties[p],x=!1,T=function(L){for(var R=0,F=L;R<F.length;R+=1)if(v.overrides&&v.overrides.hasOverride(F[R]))return void(x=!0)};if(m.value.kind==="constant"&&m.value.value instanceof Un)T(m.value.value.sections);else if(m.value.kind==="source"){var P=function(L){x||(L instanceof xr&&In(L.value)===pn?T(L.value.sections):L instanceof Ti?T(L.sections):L.eachChild(P))},M=m.value;M._styleExpression&&P(M._styleExpression.expression)}return x},a}(jo),Tk={paint:new Ur({"background-color":new pt(X.paint_background["background-color"]),"background-pattern":new ni(X.paint_background["background-pattern"]),"background-opacity":new pt(X.paint_background["background-opacity"])})},Sk=function(i){function a(u){i.call(this,u,Tk)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a}(jo),Ak={paint:new Ur({"raster-opacity":new pt(X.paint_raster["raster-opacity"]),"raster-hue-rotate":new pt(X.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new pt(X.paint_raster["raster-brightness-min"]),"raster-brightness-max":new pt(X.paint_raster["raster-brightness-max"]),"raster-saturation":new pt(X.paint_raster["raster-saturation"]),"raster-contrast":new pt(X.paint_raster["raster-contrast"]),"raster-resampling":new pt(X.paint_raster["raster-resampling"]),"raster-fade-duration":new pt(X.paint_raster["raster-fade-duration"])})},Pk=function(i){function a(u){i.call(this,u,Ak)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a}(jo),Ik=function(i){function a(u){i.call(this,u,{}),this.implementation=u}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},a.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},a.prototype.recalculate=function(){},a.prototype.updateTransitions=function(){},a.prototype.hasTransition=function(){},a.prototype.serialize=function(){},a.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},a.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},a}(jo),Ck={circle:Sv,heatmap:fM,hillshade:dM,fill:kM,"fill-extrusion":UM,line:qM,symbol:Ek,background:Sk,raster:Pk},lw=C.HTMLImageElement,uw=C.HTMLCanvasElement,cw=C.HTMLVideoElement,hw=C.ImageData,zm=C.ImageBitmap,Uu=function(i,a,u,p){this.context=i,this.format=u,this.texture=i.gl.createTexture(),this.update(a,p)};Uu.prototype.update=function(i,a,u){var p=i.width,m=i.height,v=!(this.size&&this.size[0]===p&&this.size[1]===m||u),x=this.context,T=x.gl;if(this.useMipmap=!!(a&&a.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!a||a.premultiply!==!1)),v)this.size=[p,m],i instanceof lw||i instanceof uw||i instanceof cw||i instanceof hw||zm&&i instanceof zm?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,i):T.texImage2D(T.TEXTURE_2D,0,this.format,p,m,0,this.format,T.UNSIGNED_BYTE,i.data);else{var P=u||{x:0,y:0},M=P.x,L=P.y;i instanceof lw||i instanceof uw||i instanceof cw||i instanceof hw||zm&&i instanceof zm?T.texSubImage2D(T.TEXTURE_2D,0,M,L,T.RGBA,T.UNSIGNED_BYTE,i):T.texSubImage2D(T.TEXTURE_2D,0,M,L,p,m,T.RGBA,T.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)},Uu.prototype.bind=function(i,a,u){var p=this.context.gl;p.bindTexture(p.TEXTURE_2D,this.texture),u!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=p.LINEAR),i!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,i),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,u||i),this.filter=i),a!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,a),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,a),this.wrap=a)},Uu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Uu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Vv=function(i){var a=this;this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){a._triggered=!1,a._callback()})};Vv.prototype.trigger=function(){var i=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){i._triggered=!1,i._callback()},0))},Vv.prototype.remove=function(){delete this._channel,this._callback=function(){}};var nh=function(i,a,u){this.target=i,this.parent=a,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Te(["receive","process"],this),this.invoker=new Vv(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=rr()?i:C};function fw(i,a,u){var p=2*Math.PI*6378137/256/Math.pow(2,u);return[i*p-2*Math.PI*6378137/2,a*p-2*Math.PI*6378137/2]}nh.prototype.send=function(i,a,u,p,m){var v=this;m===void 0&&(m=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[x]=u);var T=Mt(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:i,hasCallback:!!u,targetMapId:p,mustQueue:m,sourceMapId:this.mapId,data:xo(a,T)},T),{cancel:function(){u&&delete v.callbacks[x],v.target.postMessage({id:x,type:"<cancel>",targetMapId:p,sourceMapId:v.mapId})}}},nh.prototype.receive=function(i){var a=i.data,u=a.id;if(u&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){delete this.tasks[u];var p=this.cancelCallbacks[u];delete this.cancelCallbacks[u],p&&p()}else rr()||a.mustQueue?(this.tasks[u]=a,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,a)},nh.prototype.process=function(){if(this.taskQueue.length){var i=this.taskQueue.shift(),a=this.tasks[i];delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),a&&this.processTask(i,a)}},nh.prototype.processTask=function(i,a){var u=this;if(a.type==="<response>"){var p=this.callbacks[i];delete this.callbacks[i],p&&(a.error?p(Ii(a.error)):p(null,Ii(a.data)))}else{var m=!1,v=Mt(this.globalScope)?void 0:[],x=a.hasCallback?function(L,R){m=!0,delete u.cancelCallbacks[i],u.target.postMessage({id:i,type:"<response>",sourceMapId:u.mapId,error:L?xo(L):null,data:xo(R,v)},v)}:function(L){m=!0},T=null,P=Ii(a.data);if(this.parent[a.type])T=this.parent[a.type](a.sourceMapId,P,x);else if(this.parent.getWorkerSource){var M=a.type.split(".");T=this.parent.getWorkerSource(a.sourceMapId,M[0],P.source)[M[1]](P,x)}else x(new Error("Could not find function "+a.type));!m&&T&&T.cancel&&(this.cancelCallbacks[i]=T.cancel)}},nh.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var dr=function(i,a){i&&(a?this.setSouthWest(i).setNorthEast(a):i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))};dr.prototype.setNorthEast=function(i){return this._ne=i instanceof Mn?new Mn(i.lng,i.lat):Mn.convert(i),this},dr.prototype.setSouthWest=function(i){return this._sw=i instanceof Mn?new Mn(i.lng,i.lat):Mn.convert(i),this},dr.prototype.extend=function(i){var a,u,p=this._sw,m=this._ne;if(i instanceof Mn)a=i,u=i;else{if(!(i instanceof dr))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(dr.convert(i)):this.extend(Mn.convert(i)):this;if(u=i._ne,!(a=i._sw)||!u)return this}return p||m?(p.lng=Math.min(a.lng,p.lng),p.lat=Math.min(a.lat,p.lat),m.lng=Math.max(u.lng,m.lng),m.lat=Math.max(u.lat,m.lat)):(this._sw=new Mn(a.lng,a.lat),this._ne=new Mn(u.lng,u.lat)),this},dr.prototype.getCenter=function(){return new Mn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},dr.prototype.getSouthWest=function(){return this._sw},dr.prototype.getNorthEast=function(){return this._ne},dr.prototype.getNorthWest=function(){return new Mn(this.getWest(),this.getNorth())},dr.prototype.getSouthEast=function(){return new Mn(this.getEast(),this.getSouth())},dr.prototype.getWest=function(){return this._sw.lng},dr.prototype.getSouth=function(){return this._sw.lat},dr.prototype.getEast=function(){return this._ne.lng},dr.prototype.getNorth=function(){return this._ne.lat},dr.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},dr.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},dr.prototype.isEmpty=function(){return!(this._sw&&this._ne)},dr.prototype.contains=function(i){var a=Mn.convert(i),u=a.lng,p=a.lat,m=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&m},dr.convert=function(i){return!i||i instanceof dr?i:new dr(i)};var Mn=function(i,a){if(isNaN(i)||isNaN(a))throw new Error("Invalid LngLat object: ("+i+", "+a+")");if(this.lng=+i,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Mn.prototype.wrap=function(){return new Mn(H(this.lng,-180,180),this.lat)},Mn.prototype.toArray=function(){return[this.lng,this.lat]},Mn.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Mn.prototype.distanceTo=function(i){var a=Math.PI/180,u=this.lat*a,p=i.lat*a,m=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((i.lng-this.lng)*a);return 63710088e-1*Math.acos(Math.min(m,1))},Mn.prototype.toBounds=function(i){i===void 0&&(i=0);var a=360*i/40075017,u=a/Math.cos(Math.PI/180*this.lat);return new dr(new Mn(this.lng-u,this.lat-a),new Mn(this.lng+u,this.lat+a))},Mn.convert=function(i){if(i instanceof Mn)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new Mn(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new Mn(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var pw=2*Math.PI*63710088e-1;function dw(i){return pw*Math.cos(i*Math.PI/180)}function mw(i){return(180+i)/360}function gw(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function yw(i,a){return i/dw(a)}function Gv(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}var ju=function(i,a,u){u===void 0&&(u=0),this.x=+i,this.y=+a,this.z=+u};ju.fromLngLat=function(i,a){a===void 0&&(a=0);var u=Mn.convert(i);return new ju(mw(u.lng),gw(u.lat),yw(a,u.lat))},ju.prototype.toLngLat=function(){return new Mn(360*this.x-180,Gv(this.y))},ju.prototype.toAltitude=function(){return this.z*dw(Gv(this.y))},ju.prototype.meterInMercatorCoordinateUnits=function(){return 1/pw*(i=Gv(this.y),1/Math.cos(i*Math.PI/180));var i};var Vu=function(i,a,u){this.z=i,this.x=a,this.y=u,this.key=ip(0,i,i,a,u)};Vu.prototype.equals=function(i){return this.z===i.z&&this.x===i.x&&this.y===i.y},Vu.prototype.url=function(i,a){var u,p,m,v,x,T=(p=this.y,m=this.z,v=fw(256*(u=this.x),256*(p=Math.pow(2,m)-p-1),m),x=fw(256*(u+1),256*(p+1),m),v[0]+","+v[1]+","+x[0]+","+x[1]),P=function(M,L,R){for(var F,V="",te=M;te>0;te--)V+=(L&(F=1<<te-1)?1:0)+(R&F?2:0);return V}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",P).replace("{bbox-epsg-3857}",T)},Vu.prototype.getTilePoint=function(i){var a=Math.pow(2,this.z);return new S(8192*(i.x*a-this.x),8192*(i.y*a-this.y))},Vu.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var vw=function(i,a){this.wrap=i,this.canonical=a,this.key=ip(i,a.z,a.z,a.x,a.y)},mr=function(i,a,u,p,m){this.overscaledZ=i,this.wrap=a,this.canonical=new Vu(u,+p,+m),this.key=ip(a,i,u,p,m)};function ip(i,a,u,p,m){(i*=2)<0&&(i=-1*i-1);var v=1<<u;return(v*v*i+v*m+p).toString(36)+u.toString(36)+a.toString(36)}mr.prototype.equals=function(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)},mr.prototype.scaledTo=function(i){var a=this.canonical.z-i;return i>this.canonical.z?new mr(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new mr(i,this.wrap,i,this.canonical.x>>a,this.canonical.y>>a)},mr.prototype.calculateScaledKey=function(i,a){var u=this.canonical.z-i;return i>this.canonical.z?ip(this.wrap*+a,i,this.canonical.z,this.canonical.x,this.canonical.y):ip(this.wrap*+a,i,i,this.canonical.x>>u,this.canonical.y>>u)},mr.prototype.isChildOf=function(i){if(i.wrap!==this.wrap)return!1;var a=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>a&&i.canonical.y===this.canonical.y>>a},mr.prototype.children=function(i){if(this.overscaledZ>=i)return[new mr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var a=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new mr(a,this.wrap,a,u,p),new mr(a,this.wrap,a,u+1,p),new mr(a,this.wrap,a,u,p+1),new mr(a,this.wrap,a,u+1,p+1)]},mr.prototype.isLessThan=function(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))},mr.prototype.wrapped=function(){return new mr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},mr.prototype.unwrapTo=function(i){return new mr(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)},mr.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},mr.prototype.toUnwrapped=function(){return new vw(this.wrap,this.canonical)},mr.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},mr.prototype.getTilePoint=function(i){return this.canonical.getTilePoint(new ju(i.x-this.wrap,i.y))},ot("CanonicalTileID",Vu),ot("OverscaledTileID",mr,{omit:["posMatrix"]});var Hs=function(i,a,u){if(this.uid=i,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return ft('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=a.height;var p=this.dim=a.height-2;this.data=new Uint32Array(a.data.buffer),this.encoding=u||"mapbox";for(var m=0;m<p;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(p,m)]=this.data[this._idx(p-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,p)]=this.data[this._idx(m,p-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(p,-1)]=this.data[this._idx(p-1,0)],this.data[this._idx(-1,p)]=this.data[this._idx(0,p-1)],this.data[this._idx(p,p)]=this.data[this._idx(p-1,p-1)]};Hs.prototype.get=function(i,a){var u=new Uint8Array(this.data.buffer),p=4*this._idx(i,a);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(u[p],u[p+1],u[p+2])},Hs.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Hs.prototype._idx=function(i,a){if(i<-1||i>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(i+1)},Hs.prototype._unpackMapbox=function(i,a,u){return(256*i*256+256*a+u)/10-1e4},Hs.prototype._unpackTerrarium=function(i,a,u){return 256*i+a+u/256-32768},Hs.prototype.getPixels=function(){return new Ri({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Hs.prototype.backfillBorder=function(i,a,u){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");var p=a*this.dim,m=a*this.dim+this.dim,v=u*this.dim,x=u*this.dim+this.dim;switch(a){case-1:p=m-1;break;case 1:m=p+1}switch(u){case-1:v=x-1;break;case 1:x=v+1}for(var T=-a*this.dim,P=-u*this.dim,M=v;M<x;M++)for(var L=p;L<m;L++)this.data[this._idx(L,M)]=i.data[this._idx(L+T,M+P)]},ot("DEMData",Hs);var Bm=function(i){this._stringToNumber={},this._numberToString=[];for(var a=0;a<i.length;a++){var u=i[a];this._stringToNumber[u]=a,this._numberToString[a]=u}};Bm.prototype.encode=function(i){return this._stringToNumber[i]},Bm.prototype.decode=function(i){return this._numberToString[i]};var Nm=function(i,a,u,p,m){this.type="Feature",this._vectorTileFeature=i,i._z=a,i._x=u,i._y=p,this.properties=i.properties,this.id=m},Wv={geometry:{configurable:!0}};Wv.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Wv.geometry.set=function(i){this._geometry=i},Nm.prototype.toJSON=function(){var i={geometry:this.geometry};for(var a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(i[a]=this[a]);return i},Object.defineProperties(Nm.prototype,Wv);var rh=function(){this.state={},this.stateChanges={},this.deletedStates={}};rh.prototype.updateState=function(i,a,u){var p=String(a);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][p]=this.stateChanges[i][p]||{},U(this.stateChanges[i][p],u),this.deletedStates[i]===null)for(var m in this.deletedStates[i]={},this.state[i])m!==p&&(this.deletedStates[i][m]=null);else if(this.deletedStates[i]&&this.deletedStates[i][p]===null)for(var v in this.deletedStates[i][p]={},this.state[i][p])u[v]||(this.deletedStates[i][p][v]=null);else for(var x in u)this.deletedStates[i]&&this.deletedStates[i][p]&&this.deletedStates[i][p][x]===null&&delete this.deletedStates[i][p][x]},rh.prototype.removeFeatureState=function(i,a,u){if(this.deletedStates[i]!==null){var p=String(a);if(this.deletedStates[i]=this.deletedStates[i]||{},u&&a!==void 0)this.deletedStates[i][p]!==null&&(this.deletedStates[i][p]=this.deletedStates[i][p]||{},this.deletedStates[i][p][u]=null);else if(a!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][p])for(u in this.deletedStates[i][p]={},this.stateChanges[i][p])this.deletedStates[i][p][u]=null;else this.deletedStates[i][p]=null;else this.deletedStates[i]=null}},rh.prototype.getState=function(i,a){var u=String(a),p=U({},(this.state[i]||{})[u],(this.stateChanges[i]||{})[u]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){var m=this.deletedStates[i][a];if(m===null)return{};for(var v in m)delete p[v]}return p},rh.prototype.initializeTileState=function(i,a){i.setFeatureState(this.state,a)},rh.prototype.coalesceChanges=function(i,a){var u={};for(var p in this.stateChanges){this.state[p]=this.state[p]||{};var m={};for(var v in this.stateChanges[p])this.state[p][v]||(this.state[p][v]={}),U(this.state[p][v],this.stateChanges[p][v]),m[v]=this.state[p][v];u[p]=m}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var T={};if(this.deletedStates[x]===null)for(var P in this.state[x])T[P]={},this.state[x][P]={};else for(var M in this.deletedStates[x]){if(this.deletedStates[x][M]===null)this.state[x][M]={};else for(var L=0,R=Object.keys(this.deletedStates[x][M]);L<R.length;L+=1)delete this.state[x][M][R[L]];T[M]=this.state[x][M]}u[x]=u[x]||{},U(u[x],T)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(var F in i)i[F].setFeatureState(u,a)};var qs=function(i,a){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new sa(8192,16,0),this.grid3D=new sa(8192,16,0),this.featureIndexArray=new z,this.promoteId=a};function _w(i,a,u,p,m){return Fe(i,function(v,x){var T=a instanceof Lu?a.get(x):null;return T&&T.evaluate?T.evaluate(u,p,m):T})}function xw(i){for(var a=1/0,u=1/0,p=-1/0,m=-1/0,v=0,x=i;v<x.length;v+=1){var T=x[v];a=Math.min(a,T.x),u=Math.min(u,T.y),p=Math.max(p,T.x),m=Math.max(m,T.y)}return{minX:a,minY:u,maxX:p,maxY:m}}function Mk(i,a){return a-i}qs.prototype.insert=function(i,a,u,p,m,v){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,m);for(var T=v?this.grid3D:this.grid,P=0;P<a.length;P++){for(var M=a[P],L=[1/0,1/0,-1/0,-1/0],R=0;R<M.length;R++){var F=M[R];L[0]=Math.min(L[0],F.x),L[1]=Math.min(L[1],F.y),L[2]=Math.max(L[2],F.x),L[3]=Math.max(L[3],F.y)}L[0]<8192&&L[1]<8192&&L[2]>=0&&L[3]>=0&&T.insert(x,L[0],L[1],L[2],L[3])}},qs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Zc.VectorTile(new Am(this.rawTileData)).layers,this.sourceLayerCoder=new Bm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},qs.prototype.query=function(i,a,u,p){var m=this;this.loadVTLayers();for(var v=i.params||{},x=8192/i.tileSize/i.scale,T=Mc(v.filter),P=i.queryGeometry,M=i.queryPadding*x,L=xw(P),R=this.grid.query(L.minX-M,L.minY-M,L.maxX+M,L.maxY+M),F=xw(i.cameraQueryGeometry),V=this.grid3D.query(F.minX-M,F.minY-M,F.maxX+M,F.maxY+M,function(Ae,Ie,Oe,je){return function(Xe,ct,Qe,mt,et){for(var jt=0,Tt=Xe;jt<Tt.length;jt+=1){var lt=Tt[jt];if(ct<=lt.x&&Qe<=lt.y&&mt>=lt.x&&et>=lt.y)return!0}var qt=[new S(ct,Qe),new S(ct,et),new S(mt,et),new S(mt,Qe)];if(Xe.length>2){for(var zt=0,Jt=qt;zt<Jt.length;zt+=1)if(Go(Xe,Jt[zt]))return!0}for(var gt=0;gt<Xe.length-1;gt++)if(Bu(Xe[gt],Xe[gt+1],qt))return!0;return!1}(i.cameraQueryGeometry,Ae-M,Ie-M,Oe+M,je+M)}),te=0,ne=V;te<ne.length;te+=1)R.push(ne[te]);R.sort(Mk);for(var ce,se={},ve=function(Ae){var Ie=R[Ae];if(Ie!==ce){ce=Ie;var Oe=m.featureIndexArray.get(Ie),je=null;m.loadMatchingFeature(se,Oe.bucketIndex,Oe.sourceLayerIndex,Oe.featureIndex,T,v.layers,v.availableImages,a,u,p,function(Xe,ct,Qe){return je||(je=Bn(Xe)),ct.queryIntersectsFeature(P,Xe,Qe,je,m.z,i.transform,x,i.pixelPosMatrix)})}},we=0;we<R.length;we++)ve(we);return se},qs.prototype.loadMatchingFeature=function(i,a,u,p,m,v,x,T,P,M,L){var R=this.bucketLayerIDs[a];if(!v||function(Xe,ct){for(var Qe=0;Qe<Xe.length;Qe++)if(ct.indexOf(Xe[Qe])>=0)return!0;return!1}(v,R)){var F=this.sourceLayerCoder.decode(u),V=this.vtLayers[F].feature(p);if(m.needGeometry){var te=Yn(V,!0);if(!m.filter(new Zt(this.tileID.overscaledZ),te,this.tileID.canonical))return}else if(!m.filter(new Zt(this.tileID.overscaledZ),V))return;for(var ne=this.getId(V,F),ce=0;ce<R.length;ce++){var se=R[ce];if(!(v&&v.indexOf(se)<0)){var ve=T[se];if(ve){var we={};ne!==void 0&&M&&(we=M.getState(ve.sourceLayer||"_geojsonTileLayer",ne));var Ae=U({},P[se]);Ae.paint=_w(Ae.paint,ve.paint,V,we,x),Ae.layout=_w(Ae.layout,ve.layout,V,we,x);var Ie=!L||L(V,ve,we);if(Ie){var Oe=new Nm(V,this.z,this.x,this.y,ne);Oe.layer=Ae;var je=i[se];je===void 0&&(je=i[se]=[]),je.push({featureIndex:p,feature:Oe,intersectionZ:Ie})}}}}}},qs.prototype.lookupSymbolFeatures=function(i,a,u,p,m,v,x,T){var P={};this.loadVTLayers();for(var M=Mc(m),L=0,R=i;L<R.length;L+=1)this.loadMatchingFeature(P,u,p,R[L],M,v,x,T,a);return P},qs.prototype.hasLayer=function(i){for(var a=0,u=this.bucketLayerIDs;a<u.length;a+=1)for(var p=0,m=u[a];p<m.length;p+=1)if(i===m[p])return!0;return!1},qs.prototype.getId=function(i,a){var u=i.id;return this.promoteId&&typeof(u=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]])=="boolean"&&(u=Number(u)),u},ot("FeatureIndex",qs,{omit:["rawTileData","sourceLayerCoder"]});var Lr=function(i,a){this.tileID=i,this.uid=fe(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Lr.prototype.registerFadeDuration=function(i){var a=i+this.timeAdded;a<Wr.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)},Lr.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Lr.prototype.loadVectorData=function(i,a,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){for(var p in i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(M,L){var R={};if(!L)return R;for(var F=function(){var ne=te[V],ce=ne.layerIds.map(function(we){return L.getLayer(we)}).filter(Boolean);if(ce.length!==0){ne.layers=ce,ne.stateDependentLayerIds&&(ne.stateDependentLayers=ne.stateDependentLayerIds.map(function(we){return ce.filter(function(Ae){return Ae.id===we})[0]}));for(var se=0,ve=ce;se<ve.length;se+=1)R[ve[se].id]=ne}},V=0,te=M;V<te.length;V+=1)F();return R}(i.buckets,a.style),this.hasSymbolBuckets=!1,this.buckets){var m=this.buckets[p];if(m instanceof yn){if(this.hasSymbolBuckets=!0,!u)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var v in this.buckets){var x=this.buckets[v];if(x instanceof yn&&x.hasRTLText){this.hasRTLText=!0,Vi.isLoading()||Vi.isLoaded()||jf()!=="deferred"||bo();break}}for(var T in this.queryPadding=0,this.buckets){var P=this.buckets[T];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(T).queryRadius(P))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new f},Lr.prototype.unloadVectorData=function(){for(var i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Lr.prototype.getBucket=function(i){return this.buckets[i.id]},Lr.prototype.upload=function(i){for(var a in this.buckets){var u=this.buckets[a];u.uploadPending()&&u.upload(i)}var p=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Uu(i,this.imageAtlas.image,p.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Uu(i,this.glyphAtlasImage,p.ALPHA),this.glyphAtlasImage=null)},Lr.prototype.prepare=function(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)},Lr.prototype.queryRenderedFeatures=function(i,a,u,p,m,v,x,T,P,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:m,scale:v,tileSize:this.tileSize,pixelPosMatrix:M,transform:T,params:x,queryPadding:this.queryPadding*P},i,a,u):{}},Lr.prototype.querySourceFeatures=function(i,a){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var p=u.loadVTLayers(),m=a?a.sourceLayer:"",v=p._geojsonTileLayer||p[m];if(v)for(var x=Mc(a&&a.filter),T=this.tileID.canonical,P=T.z,M=T.x,L=T.y,R={z:P,x:M,y:L},F=0;F<v.length;F++){var V=v.feature(F);if(x.needGeometry){var te=Yn(V,!0);if(!x.filter(new Zt(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!x.filter(new Zt(this.tileID.overscaledZ),V))continue;var ne=u.getId(V,m),ce=new Nm(V,P,M,L,ne);ce.tile=R,i.push(ce)}}},Lr.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Lr.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Lr.prototype.setExpiryData=function(i){var a=this.expirationTime;if(i.cacheControl){var u=Pr(i.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){var p=Date.now(),m=!1;if(this.expirationTime>p)m=!1;else if(a)if(this.expirationTime<a)m=!0;else{var v=this.expirationTime-a;v?this.expirationTime=p+Math.max(v,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Lr.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Lr.prototype.setFeatureState=function(i,a){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(i).length!==0){var u=this.latestFeatureIndex.loadVTLayers();for(var p in this.buckets)if(a.style.hasLayer(p)){var m=this.buckets[p],v=m.layers[0].sourceLayer||"_geojsonTileLayer",x=u[v],T=i[v];if(x&&T&&Object.keys(T).length!==0){m.update(T,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var P=a&&a.style&&a.style.getLayer(p);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(m)))}}}},Lr.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Lr.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Wr.now()},Lr.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Lr.prototype.setHoldDuration=function(i){this.symbolFadeHoldUntil=Wr.now()+i},Lr.prototype.setDependencies=function(i,a){for(var u={},p=0,m=a;p<m.length;p+=1)u[m[p]]=!0;this.dependencies[i]=u},Lr.prototype.hasDependency=function(i,a){for(var u=0,p=i;u<p.length;u+=1){var m=this.dependencies[p[u]];if(m){for(var v=0,x=a;v<x.length;v+=1)if(m[x[v]])return!0}}return!1};var Dl=C.performance,bw=function(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},Dl.mark(this._marks.start)};bw.prototype.finish=function(){Dl.mark(this._marks.end);var i=Dl.getEntriesByName(this._marks.measure);return i.length===0&&(Dl.measure(this._marks.measure,this._marks.start,this._marks.end),i=Dl.getEntriesByName(this._marks.measure),Dl.clearMarks(this._marks.start),Dl.clearMarks(this._marks.end),Dl.clearMeasures(this._marks.measure)),i},s.Actor=nh,s.AlphaImage=Fu,s.CanonicalTileID=Vu,s.CollisionBoxArray=f,s.Color=Wt,s.DEMData=Hs,s.DataConstantProperty=pt,s.DictionaryCoder=Bm,s.EXTENT=8192,s.ErrorEvent=de,s.EvaluationParameters=Zt,s.Event=ie,s.Evented=me,s.FeatureIndex=qs,s.FillBucket=ha,s.FillExtrusionBucket=fa,s.ImageAtlas=np,s.ImagePosition=Im,s.LineBucket=hi,s.LngLat=Mn,s.LngLatBounds=dr,s.MercatorCoordinate=ju,s.ONE_EM=24,s.OverscaledTileID=mr,s.Point=S,s.Point$1=S,s.Properties=Ur,s.Protobuf=Am,s.RGBAImage=Ri,s.RequestManager=hr,s.RequestPerformance=bw,s.ResourceType=ra,s.SegmentVector=Y,s.SourceFeatureState=rh,s.StructArrayLayout1ui2=Zf,s.StructArrayLayout2f1f2i16=js,s.StructArrayLayout2i4=Us,s.StructArrayLayout3ui6=Ha,s.StructArrayLayout4i8=Gf,s.SymbolBucket=yn,s.Texture=Uu,s.Tile=Lr,s.Transitionable=Fr,s.Uniform1f=He,s.Uniform1i=ze,s.Uniform2f=We,s.Uniform3f=nt,s.Uniform4f=dt,s.UniformColor=vt,s.UniformMatrix4f=nn,s.UnwrappedTileID=vw,s.ValidationError=ae,s.WritingMode=so,s.ZoomHistory=Bf,s.add=function(i,a,u){return i[0]=a[0]+u[0],i[1]=a[1]+u[1],i[2]=a[2]+u[2],i},s.addDynamicAttributes=Uv,s.asyncAll=function(i,a,u){if(!i.length)return u(null,[]);var p=i.length,m=new Array(i.length),v=null;i.forEach(function(x,T){a(x,function(P,M){P&&(v=P),m[T]=M,--p==0&&u(v,m)})})},s.bezier=G,s.bindAll=Te,s.browser=Wr,s.cacheEntryPossiblyAdded=function(i){++Es>Ma&&(i.getActor().send("enforceCacheSizeLimit",vo),Es=0)},s.clamp=he,s.clearTileCache=function(i){var a=C.caches.delete("mapbox-tiles");i&&a.catch(i).then(function(){return i()})},s.clipLine=nw,s.clone=function(i){var a=new un(16);return a[0]=i[0],a[1]=i[1],a[2]=i[2],a[3]=i[3],a[4]=i[4],a[5]=i[5],a[6]=i[6],a[7]=i[7],a[8]=i[8],a[9]=i[9],a[10]=i[10],a[11]=i[11],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15],a},s.clone$1=tt,s.clone$2=function(i){var a=new un(3);return a[0]=i[0],a[1]=i[1],a[2]=i[2],a},s.collisionCircleLayout=$M,s.config=Dt,s.create=function(){var i=new un(16);return un!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},s.create$1=function(){var i=new un(9);return un!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i},s.create$2=function(){var i=new un(4);return un!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i},s.createCommonjsModule=g,s.createExpression=Ic,s.createLayout=Mr,s.createStyleLayer=function(i){return i.type==="custom"?new Ik(i):new Ck[i.type](i)},s.cross=function(i,a,u){var p=a[0],m=a[1],v=a[2],x=u[0],T=u[1],P=u[2];return i[0]=m*P-v*T,i[1]=v*x-p*P,i[2]=p*T-m*x,i},s.deepEqual=function i(a,u){if(Array.isArray(a)){if(!Array.isArray(u)||a.length!==u.length)return!1;for(var p=0;p<a.length;p++)if(!i(a[p],u[p]))return!1;return!0}if(typeof a=="object"&&a!==null&&u!==null){if(typeof u!="object"||Object.keys(a).length!==Object.keys(u).length)return!1;for(var m in a)if(!i(a[m],u[m]))return!1;return!0}return a===u},s.dot=function(i,a){return i[0]*a[0]+i[1]*a[1]+i[2]*a[2]},s.dot$1=function(i,a){return i[0]*a[0]+i[1]*a[1]+i[2]*a[2]+i[3]*a[3]},s.ease=W,s.emitValidationErrors=Cu,s.endsWith=De,s.enforceCacheSizeLimit=function(i){ka(),Ei&&Ei.then(function(a){a.keys().then(function(u){for(var p=0;p<u.length-i;p++)a.delete(u[p])})})},s.evaluateSizeForFeature=$b,s.evaluateSizeForZoom=Kb,s.evaluateVariableOffset=ow,s.evented=Uf,s.extend=U,s.featureFilter=Mc,s.filterObject=Ve,s.fromRotation=function(i,a){var u=Math.sin(a),p=Math.cos(a);return i[0]=p,i[1]=u,i[2]=0,i[3]=-u,i[4]=p,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},s.getAnchorAlignment=zv,s.getAnchorJustification=Fv,s.getArrayBuffer=Ss,s.getImage=N,s.getJSON=function(i,a){return Fo(U(i,{type:"json"}),a)},s.getRTLTextPluginStatus=jf,s.getReferrer=ia,s.getVideo=function(i,a){var u,p,m=C.document.createElement("video");m.muted=!0,m.onloadstart=function(){a(null,m)};for(var v=0;v<i.length;v++){var x=C.document.createElement("source");u=i[v],p=void 0,(p=C.document.createElement("a")).href=u,(p.protocol!==C.document.location.protocol||p.host!==C.document.location.host)&&(m.crossOrigin="Anonymous"),x.src=i[v],m.appendChild(x)}return{cancel:function(){}}},s.identity=Gi,s.invert=function(i,a){var u=a[0],p=a[1],m=a[2],v=a[3],x=a[4],T=a[5],P=a[6],M=a[7],L=a[8],R=a[9],F=a[10],V=a[11],te=a[12],ne=a[13],ce=a[14],se=a[15],ve=u*T-p*x,we=u*P-m*x,Ae=u*M-v*x,Ie=p*P-m*T,Oe=p*M-v*T,je=m*M-v*P,Xe=L*ne-R*te,ct=L*ce-F*te,Qe=L*se-V*te,mt=R*ce-F*ne,et=R*se-V*ne,jt=F*se-V*ce,Tt=ve*jt-we*et+Ae*mt+Ie*Qe-Oe*ct+je*Xe;return Tt?(i[0]=(T*jt-P*et+M*mt)*(Tt=1/Tt),i[1]=(m*et-p*jt-v*mt)*Tt,i[2]=(ne*je-ce*Oe+se*Ie)*Tt,i[3]=(F*Oe-R*je-V*Ie)*Tt,i[4]=(P*Qe-x*jt-M*ct)*Tt,i[5]=(u*jt-m*Qe+v*ct)*Tt,i[6]=(ce*Ae-te*je-se*we)*Tt,i[7]=(L*je-F*Ae+V*we)*Tt,i[8]=(x*et-T*Qe+M*Xe)*Tt,i[9]=(p*Qe-u*et-v*Xe)*Tt,i[10]=(te*Oe-ne*Ae+se*ve)*Tt,i[11]=(R*Ae-L*Oe-V*ve)*Tt,i[12]=(T*ct-x*mt-P*Xe)*Tt,i[13]=(u*mt-p*ct+m*Xe)*Tt,i[14]=(ne*we-te*Ie-ce*ve)*Tt,i[15]=(L*Ie-R*we+F*ve)*Tt,i):null},s.isChar=Ye,s.isMapboxURL=Zn,s.keysDifference=function(i,a){var u=[];for(var p in i)p in a||u.push(p);return u},s.makeRequest=Fo,s.mapObject=Fe,s.mercatorXfromLng=mw,s.mercatorYfromLat=gw,s.mercatorZfromAltitude=yw,s.mul=Tv,s.multiply=ci,s.mvt=Zc,s.nextPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},s.normalize=function(i,a){var u=a[0],p=a[1],m=a[2],v=u*u+p*p+m*m;return v>0&&(v=1/Math.sqrt(v)),i[0]=a[0]*v,i[1]=a[1]*v,i[2]=a[2]*v,i},s.number=ar,s.offscreenCanvasSupported=Ts,s.ortho=function(i,a,u,p,m,v,x){var T=1/(a-u),P=1/(p-m),M=1/(v-x);return i[0]=-2*T,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*P,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*M,i[11]=0,i[12]=(a+u)*T,i[13]=(m+p)*P,i[14]=(x+v)*M,i[15]=1,i},s.parseGlyphPBF=function(i){return new Am(i).readFields(sk,[])},s.pbf=Am,s.performSymbolLayout=function(i,a,u,p,m,v,x){i.createArrays(),i.tilePixelRatio=8192/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;var T=i.layers[0].layout,P=i.layers[0]._unevaluatedLayout._values,M={};if(i.textSizeData.kind==="composite"){var L=i.textSizeData,R=L.maxZoom;M.compositeTextSizes=[P["text-size"].possiblyEvaluate(new Zt(L.minZoom),x),P["text-size"].possiblyEvaluate(new Zt(R),x)]}if(i.iconSizeData.kind==="composite"){var F=i.iconSizeData,V=F.maxZoom;M.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new Zt(F.minZoom),x),P["icon-size"].possiblyEvaluate(new Zt(V),x)]}M.layoutTextSize=P["text-size"].possiblyEvaluate(new Zt(i.zoom+1),x),M.layoutIconSize=P["icon-size"].possiblyEvaluate(new Zt(i.zoom+1),x),M.textMaxSize=P["text-size"].possiblyEvaluate(new Zt(18));for(var te=24*T.get("text-line-height"),ne=T.get("text-rotation-alignment")==="map"&&T.get("symbol-placement")!=="point",ce=T.get("text-keep-upright"),se=T.get("text-size"),ve=function(){var Ie=Ae[we],Oe=T.get("text-font").evaluate(Ie,{},x).join(","),je=se.evaluate(Ie,{},x),Xe=M.layoutTextSize.evaluate(Ie,{},x),ct=M.layoutIconSize.evaluate(Ie,{},x),Qe={horizontal:{},vertical:void 0},mt=Ie.text,et=[0,0];if(mt){var jt=mt.toString(),Tt=24*T.get("text-letter-spacing").evaluate(Ie,{},x),lt=function(Yt){for(var _n=0,mn=Yt;_n<mn.length;_n+=1)if(rn=mn[_n].charCodeAt(0),Ye.Arabic(rn)||Ye["Arabic Supplement"](rn)||Ye["Arabic Extended-A"](rn)||Ye["Arabic Presentation Forms-A"](rn)||Ye["Arabic Presentation Forms-B"](rn))return!1;var rn;return!0}(jt)?Tt:0,qt=T.get("text-anchor").evaluate(Ie,{},x),zt=T.get("text-variable-anchor");if(!zt){var Jt=T.get("text-radial-offset").evaluate(Ie,{},x);et=Jt?ow(qt,[24*Jt,Nv]):T.get("text-offset").evaluate(Ie,{},x).map(function(Yt){return 24*Yt})}var gt=ne?"center":T.get("text-justify").evaluate(Ie,{},x),sn=T.get("symbol-placement"),kn=sn==="point"?24*T.get("text-max-width").evaluate(Ie,{},x):0,Gn=function(){i.allowVerticalPlacement&&Nf(jt)&&(Qe.vertical=Cm(mt,a,u,m,Oe,kn,te,qt,"left",lt,et,so.vertical,!0,sn,Xe,je))};if(!ne&&zt){for(var Nn=gt==="auto"?zt.map(function(Yt){return Fv(Yt)}):[gt],Ln=!1,Wn=0;Wn<Nn.length;Wn++){var Er=Nn[Wn];if(!Qe.horizontal[Er])if(Ln)Qe.horizontal[Er]=Qe.horizontal[0];else{var Tr=Cm(mt,a,u,m,Oe,kn,te,"center",Er,lt,et,so.horizontal,!1,sn,Xe,je);Tr&&(Qe.horizontal[Er]=Tr,Ln=Tr.positionedLines.length===1)}}Gn()}else{gt==="auto"&&(gt=Fv(qt));var oi=Cm(mt,a,u,m,Oe,kn,te,qt,gt,lt,et,so.horizontal,!1,sn,Xe,je);oi&&(Qe.horizontal[gt]=oi),Gn(),Nf(jt)&&ne&&ce&&(Qe.vertical=Cm(mt,a,u,m,Oe,kn,te,qt,gt,lt,et,so.vertical,!1,sn,Xe,je))}}var Rr=void 0,ai=!1;if(Ie.icon&&Ie.icon.name){var $n=p[Ie.icon.name];$n&&(Rr=function(Yt,_n,mn){var rn=zv(mn),fi=_n[0]-Yt.displaySize[0]*rn.horizontalAlign,Yr=_n[1]-Yt.displaySize[1]*rn.verticalAlign;return{image:Yt,top:Yr,bottom:Yr+Yt.displaySize[1],left:fi,right:fi+Yt.displaySize[0]}}(m[Ie.icon.name],T.get("icon-offset").evaluate(Ie,{},x),T.get("icon-anchor").evaluate(Ie,{},x)),ai=$n.sdf,i.sdfIcons===void 0?i.sdfIcons=$n.sdf:i.sdfIcons!==$n.sdf&&ft("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),($n.pixelRatio!==i.pixelRatio||T.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}var Or=sw(Qe.horizontal)||Qe.vertical;i.iconsInText=!!Or&&Or.iconsInText,(Or||Rr)&&function(Yt,_n,mn,rn,fi,Yr,An,lr,$r,ln,Ka){var lo=Yr.textMaxSize.evaluate(_n,{});lo===void 0&&(lo=An);var Ja,Kn=Yt.layers[0].layout,Qa=Kn.get("icon-offset").evaluate(_n,{},Ka),Ho=sw(mn.horizontal),ih=An/24,Gu=Yt.tilePixelRatio*ih,oh=Yt.tilePixelRatio*lo/24,Zs=Yt.tilePixelRatio*lr,ah=Yt.tilePixelRatio*Kn.get("symbol-spacing"),Fm=Kn.get("text-padding")*Yt.tilePixelRatio,sh=Kn.get("icon-padding")*Yt.tilePixelRatio,op=Kn.get("text-max-angle")/180*Math.PI,Um=Kn.get("text-rotation-alignment")==="map"&&Kn.get("symbol-placement")!=="point",jm=Kn.get("icon-rotation-alignment")==="map"&&Kn.get("symbol-placement")!=="point",Xs=Kn.get("symbol-placement"),ap=ah/2,lh=Kn.get("icon-text-fit");rn&&lh!=="none"&&(Yt.allowVerticalPlacement&&mn.vertical&&(Ja=Yb(rn,mn.vertical,lh,Kn.get("icon-text-fit-padding"),Qa,ih)),Ho&&(rn=Yb(rn,Ho,lh,Kn.get("icon-text-fit-padding"),Qa,ih)));var zl=function(kk,dp){dp.x<0||dp.x>=8192||dp.y<0||dp.y>=8192||function(Jn,pa,Lk,Bl,Xv,Tw,Zm,es,Xm,mp,Ym,$m,Yv,Sw,gp,Aw,Pw,Iw,Cw,Mw,uo,Km,kw,ts,Rk){var Lw,Hu,ph,dh,mh,gh=Jn.addToLineVertexArray(pa,Lk),Rw=0,Ow=0,Dw=0,zw=0,$v=-1,Kv=-1,Ys={},Bw=ee(""),Jv=0,Qv=0;if(es._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Jv=(Lw=es.layout.get("text-offset").evaluate(uo,{},ts).map(function(vp){return 24*vp}))[0],Qv=Lw[1]):(Jv=24*es.layout.get("text-radial-offset").evaluate(uo,{},ts),Qv=Nv),Jn.allowVerticalPlacement&&Bl.vertical){var Nw=es.layout.get("text-rotate").evaluate(uo,{},ts)+90;dh=new Om(Xm,pa,mp,Ym,$m,Bl.vertical,Yv,Sw,gp,Nw),Zm&&(mh=new Om(Xm,pa,mp,Ym,$m,Zm,Pw,Iw,gp,Nw))}if(Xv){var e_=es.layout.get("icon-rotate").evaluate(uo,{}),Fw=es.layout.get("icon-text-fit")!=="none",Uw=rw(Xv,e_,kw,Fw),t_=Zm?rw(Zm,e_,kw,Fw):void 0;ph=new Om(Xm,pa,mp,Ym,$m,Xv,Pw,Iw,!1,e_),Rw=4*Uw.length;var jw=Jn.iconSizeData,yp=null;jw.kind==="source"?(yp=[128*es.layout.get("icon-size").evaluate(uo,{})])[0]>32640&&ft(Jn.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):jw.kind==="composite"&&((yp=[128*Km.compositeIconSizes[0].evaluate(uo,{},ts),128*Km.compositeIconSizes[1].evaluate(uo,{},ts)])[0]>32640||yp[1]>32640)&&ft(Jn.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Jn.addSymbols(Jn.icon,Uw,yp,Mw,Cw,uo,!1,pa,gh.lineStartIndex,gh.lineLength,-1,ts),$v=Jn.icon.placedSymbolArray.length-1,t_&&(Ow=4*t_.length,Jn.addSymbols(Jn.icon,t_,yp,Mw,Cw,uo,so.vertical,pa,gh.lineStartIndex,gh.lineLength,-1,ts),Kv=Jn.icon.placedSymbolArray.length-1)}for(var Vw in Bl.horizontal){var Jm=Bl.horizontal[Vw];if(!Hu){Bw=ee(Jm.text);var Ok=es.layout.get("text-rotate").evaluate(uo,{},ts);Hu=new Om(Xm,pa,mp,Ym,$m,Jm,Yv,Sw,gp,Ok)}var Gw=Jm.positionedLines.length===1;if(Dw+=aw(Jn,pa,Jm,Tw,es,gp,uo,Aw,gh,Bl.vertical?so.horizontal:so.horizontalOnly,Gw?Object.keys(Bl.horizontal):[Vw],Ys,$v,Km,ts),Gw)break}Bl.vertical&&(zw+=aw(Jn,pa,Bl.vertical,Tw,es,gp,uo,Aw,gh,so.vertical,["vertical"],Ys,Kv,Km,ts));var Dk=Hu?Hu.boxStartIndex:Jn.collisionBoxArray.length,zk=Hu?Hu.boxEndIndex:Jn.collisionBoxArray.length,Bk=dh?dh.boxStartIndex:Jn.collisionBoxArray.length,Nk=dh?dh.boxEndIndex:Jn.collisionBoxArray.length,Fk=ph?ph.boxStartIndex:Jn.collisionBoxArray.length,Uk=ph?ph.boxEndIndex:Jn.collisionBoxArray.length,jk=mh?mh.boxStartIndex:Jn.collisionBoxArray.length,Vk=mh?mh.boxEndIndex:Jn.collisionBoxArray.length,ns=-1,Qm=function(vp,Hw){return vp&&vp.circleDiameter?Math.max(vp.circleDiameter,Hw):Hw};ns=Qm(Hu,ns),ns=Qm(dh,ns),ns=Qm(ph,ns);var Ww=(ns=Qm(mh,ns))>-1?1:0;Ww&&(ns*=Rk/24),Jn.glyphOffsetArray.length>=yn.MAX_GLYPHS&&ft("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),uo.sortKey!==void 0&&Jn.addToSortKeyRanges(Jn.symbolInstances.length,uo.sortKey),Jn.symbolInstances.emplaceBack(pa.x,pa.y,Ys.right>=0?Ys.right:-1,Ys.center>=0?Ys.center:-1,Ys.left>=0?Ys.left:-1,Ys.vertical||-1,$v,Kv,Bw,Dk,zk,Bk,Nk,Fk,Uk,jk,Vk,mp,Dw,zw,Rw,Ow,Ww,0,Yv,Jv,Qv,ns)}(Yt,dp,kk,mn,rn,fi,Ja,Yt.layers[0],Yt.collisionBoxArray,_n.index,_n.sourceLayerIndex,Yt.index,Gu,Fm,Um,$r,Zs,sh,jm,Qa,_n,Yr,ln,Ka,An)};if(Xs==="line")for(var uh=0,Vm=nw(_n.geometry,0,0,8192,8192);uh<Vm.length;uh+=1)for(var Gm=Vm[uh],sp=0,lp=dk(Gm,ah,op,mn.vertical||Ho,rn,24,oh,Yt.overscaling,8192);sp<lp.length;sp+=1){var Wm=lp[sp];Ho&&vk(Yt,Ho.text,ap,Wm)||zl(Gm,Wm)}else if(Xs==="line-center")for(var up=0,cp=_n.geometry;up<cp.length;up+=1){var hp=cp[up];if(hp.length>1){var Hm=pk(hp,op,mn.vertical||Ho,rn,24,oh);Hm&&zl(hp,Hm)}}else if(_n.type==="Polygon")for(var ch=0,qm=kv(_n.geometry,0);ch<qm.length;ch+=1){var hh=qm[ch],fp=gk(hh,16);zl(hh[0],new Kc(fp.x,fp.y,0))}else if(_n.type==="LineString")for(var Wu=0,pp=_n.geometry;Wu<pp.length;Wu+=1){var fh=pp[Wu];zl(fh,new Kc(fh[0].x,fh[0].y,0))}else if(_n.type==="Point")for(var Hv=0,ww=_n.geometry;Hv<ww.length;Hv+=1)for(var qv=0,Ew=ww[Hv];qv<Ew.length;qv+=1){var Zv=Ew[qv];zl([Zv],new Kc(Zv.x,Zv.y,0))}}(i,Ie,Qe,Rr,p,M,Xe,ct,et,ai,x)},we=0,Ae=i.features;we<Ae.length;we+=1)ve();v&&i.generateCollisionDebugBuffers()},s.perspective=function(i,a,u,p,m){var v,x=1/Math.tan(a/2);return i[0]=x/u,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=x,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,m!=null&&m!==1/0?(i[10]=(m+p)*(v=1/(p-m)),i[14]=2*m*p*v):(i[10]=-1,i[14]=-2*p),i},s.pick=function(i,a){for(var u={},p=0;p<a.length;p++){var m=a[p];m in i&&(u[m]=i[m])}return u},s.plugin=Vi,s.polygonIntersectsPolygon=Xa,s.postMapLoadEvent=Ca,s.postTurnstileEvent=bs,s.potpack=Hb,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.register=ot,s.registerForPluginStateChange=function(i){return i({pluginStatus:Mi,pluginURL:la}),Uf.on("pluginStateChange",i),i},s.renderColorRamp=Ab,s.rotate=function(i,a,u){var p=a[0],m=a[1],v=a[2],x=a[3],T=Math.sin(u),P=Math.cos(u);return i[0]=p*P+v*T,i[1]=m*P+x*T,i[2]=p*-T+v*P,i[3]=m*-T+x*P,i},s.rotateX=function(i,a,u){var p=Math.sin(u),m=Math.cos(u),v=a[4],x=a[5],T=a[6],P=a[7],M=a[8],L=a[9],R=a[10],F=a[11];return a!==i&&(i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15]),i[4]=v*m+M*p,i[5]=x*m+L*p,i[6]=T*m+R*p,i[7]=P*m+F*p,i[8]=M*m-v*p,i[9]=L*m-x*p,i[10]=R*m-T*p,i[11]=F*m-P*p,i},s.rotateZ=function(i,a,u){var p=Math.sin(u),m=Math.cos(u),v=a[0],x=a[1],T=a[2],P=a[3],M=a[4],L=a[5],R=a[6],F=a[7];return a!==i&&(i[8]=a[8],i[9]=a[9],i[10]=a[10],i[11]=a[11],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15]),i[0]=v*m+M*p,i[1]=x*m+L*p,i[2]=T*m+R*p,i[3]=P*m+F*p,i[4]=M*m-v*p,i[5]=L*m-x*p,i[6]=R*m-T*p,i[7]=F*m-P*p,i},s.scale=function(i,a,u){var p=u[0],m=u[1],v=u[2];return i[0]=a[0]*p,i[1]=a[1]*p,i[2]=a[2]*p,i[3]=a[3]*p,i[4]=a[4]*m,i[5]=a[5]*m,i[6]=a[6]*m,i[7]=a[7]*m,i[8]=a[8]*v,i[9]=a[9]*v,i[10]=a[10]*v,i[11]=a[11]*v,i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15],i},s.scale$1=function(i,a,u){return i[0]=a[0]*u,i[1]=a[1]*u,i[2]=a[2]*u,i[3]=a[3]*u,i},s.scale$2=function(i,a,u){return i[0]=a[0]*u,i[1]=a[1]*u,i[2]=a[2]*u,i},s.setCacheLimits=function(i,a){vo=i,Ma=a},s.setRTLTextPlugin=function(i,a,u){if(u===void 0&&(u=!1),Mi==="deferred"||Mi==="loading"||Mi==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");la=Wr.resolveURL(i),Mi="deferred",Bc=a,ku(),u||bo()},s.sphericalToCartesian=function(i){var a=i[0],u=i[1],p=i[2];return u+=90,u*=Math.PI/180,p*=Math.PI/180,{x:a*Math.cos(u)*Math.sin(p),y:a*Math.sin(u)*Math.sin(p),z:a*Math.cos(p)}},s.sqrLen=function(i){var a=i[0],u=i[1];return a*a+u*u},s.styleSpec=X,s.sub=function(i,a,u){return i[0]=a[0]-u[0],i[1]=a[1]-u[1],i[2]=a[2]-u[2],i},s.symbolSize=fk,s.transformMat3=function(i,a,u){var p=a[0],m=a[1],v=a[2];return i[0]=p*u[0]+m*u[3]+v*u[6],i[1]=p*u[1]+m*u[4]+v*u[7],i[2]=p*u[2]+m*u[5]+v*u[8],i},s.transformMat4=Gc,s.translate=function(i,a,u){var p,m,v,x,T,P,M,L,R,F,V,te,ne=u[0],ce=u[1],se=u[2];return a===i?(i[12]=a[0]*ne+a[4]*ce+a[8]*se+a[12],i[13]=a[1]*ne+a[5]*ce+a[9]*se+a[13],i[14]=a[2]*ne+a[6]*ce+a[10]*se+a[14],i[15]=a[3]*ne+a[7]*ce+a[11]*se+a[15]):(m=a[1],v=a[2],x=a[3],T=a[4],P=a[5],M=a[6],L=a[7],R=a[8],F=a[9],V=a[10],te=a[11],i[0]=p=a[0],i[1]=m,i[2]=v,i[3]=x,i[4]=T,i[5]=P,i[6]=M,i[7]=L,i[8]=R,i[9]=F,i[10]=V,i[11]=te,i[12]=p*ne+T*ce+R*se+a[12],i[13]=m*ne+P*ce+F*se+a[13],i[14]=v*ne+M*ce+V*se+a[14],i[15]=x*ne+L*ce+te*se+a[15]),i},s.triggerPluginCompletionEvent=_m,s.uniqueId=fe,s.validateCustomStyleLayer=function(i){var a=[],u=i.id;return u===void 0&&a.push({message:"layers."+u+': missing required property "id"'}),i.render===void 0&&a.push({message:"layers."+u+': missing required method "render"'}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&a.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),a},s.validateLight=wv,s.validateStyle=Pu,s.values=function(i){var a=[];for(var u in i)a.push(i[u]);return a},s.vectorTile=Zc,s.version="1.13.3",s.warnOnce=ft,s.webpSupported=Dn,s.window=C,s.wrap=H}),l(["./shared"],function(s){function g(O){var N=typeof O;if(N==="number"||N==="boolean"||N==="string"||O==null)return JSON.stringify(O);if(Array.isArray(O)){for(var j="[",J=0,ie=O;J<ie.length;J+=1)j+=g(ie[J])+",";return j+"]"}for(var de=Object.keys(O).sort(),me="{",X=0;X<de.length;X++)me+=JSON.stringify(de[X])+":"+g(O[de[X]])+",";return me+"}"}function y(O){for(var N="",j=0,J=s.refProperties;j<J.length;j+=1)N+="/"+g(O[J[j]]);return N}var b=function(O){this.keyCache={},O&&this.replace(O)};b.prototype.replace=function(O){this._layerConfigs={},this._layers={},this.update(O,[])},b.prototype.update=function(O,N){for(var j=this,J=0,ie=O;J<ie.length;J+=1){var de=ie[J];this._layerConfigs[de.id]=de;var me=this._layers[de.id]=s.createStyleLayer(de);me._featureFilter=s.featureFilter(me.filter),this.keyCache[de.id]&&delete this.keyCache[de.id]}for(var X=0,ae=N;X<ae.length;X+=1){var _e=ae[X];delete this.keyCache[_e],delete this._layerConfigs[_e],delete this._layers[_e]}this.familiesBySource={};for(var Be=0,Ue=function(qe,Ze){for(var kt={},$e=0;$e<qe.length;$e++){var Ht=Ze&&Ze[qe[$e].id]||y(qe[$e]);Ze&&(Ze[qe[$e].id]=Ht);var pn=kt[Ht];pn||(pn=kt[Ht]=[]),pn.push(qe[$e])}var Gt=[];for(var $t in kt)Gt.push(kt[$t]);return Gt}(s.values(this._layerConfigs),this.keyCache);Be<Ue.length;Be+=1){var Me=Ue[Be].map(function(qe){return j._layers[qe.id]}),Ne=Me[0];if(Ne.visibility!=="none"){var at=Ne.source||"",rt=this.familiesBySource[at];rt||(rt=this.familiesBySource[at]={});var Le=Ne.sourceLayer||"_geojsonTileLayer",Je=rt[Le];Je||(Je=rt[Le]=[]),Je.push(Me)}}};var S=function(O){var N={},j=[];for(var J in O){var ie=O[J],de=N[J]={};for(var me in ie){var X=ie[+me];if(X&&X.bitmap.width!==0&&X.bitmap.height!==0){var ae={x:0,y:0,w:X.bitmap.width+2,h:X.bitmap.height+2};j.push(ae),de[me]={rect:ae,metrics:X.metrics}}}}var _e=s.potpack(j),Be=new s.AlphaImage({width:_e.w||1,height:_e.h||1});for(var Ue in O){var Me=O[Ue];for(var Ne in Me){var at=Me[+Ne];if(at&&at.bitmap.width!==0&&at.bitmap.height!==0){var rt=N[Ue][Ne].rect;s.AlphaImage.copy(at.bitmap,Be,{x:0,y:0},{x:rt.x+1,y:rt.y+1},at.bitmap)}}}this.image=Be,this.positions=N};s.register("GlyphAtlas",S);var I=function(O){this.tileID=new s.OverscaledTileID(O.tileID.overscaledZ,O.tileID.wrap,O.tileID.canonical.z,O.tileID.canonical.x,O.tileID.canonical.y),this.uid=O.uid,this.zoom=O.zoom,this.pixelRatio=O.pixelRatio,this.tileSize=O.tileSize,this.source=O.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=O.showCollisionBoxes,this.collectResourceTiming=!!O.collectResourceTiming,this.returnDependencies=!!O.returnDependencies,this.promoteId=O.promoteId};function C(O,N,j){for(var J=new s.EvaluationParameters(N),ie=0,de=O;ie<de.length;ie+=1)de[ie].recalculate(J,j)}function B(O,N){var j=s.getArrayBuffer(O.request,function(J,ie,de,me){J?N(J):ie&&N(null,{vectorTile:new s.vectorTile.VectorTile(new s.pbf(ie)),rawData:ie,cacheControl:de,expires:me})});return function(){j.cancel(),N()}}I.prototype.parse=function(O,N,j,J,ie){var de=this;this.status="parsing",this.data=O,this.collisionBoxArray=new s.CollisionBoxArray;var me=new s.DictionaryCoder(Object.keys(O.layers).sort()),X=new s.FeatureIndex(this.tileID,this.promoteId);X.bucketLayerIDs=[];var ae,_e,Be,Ue,Me={},Ne={featureIndex:X,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:j},at=N.familiesBySource[this.source];for(var rt in at){var Le=O.layers[rt];if(Le){Le.version===1&&s.warnOnce('Vector tile source "'+this.source+'" layer "'+rt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Je=me.encode(rt),qe=[],Ze=0;Ze<Le.length;Ze++){var kt=Le.feature(Ze),$e=X.getId(kt,rt);qe.push({feature:kt,id:$e,index:Ze,sourceLayerIndex:Je})}for(var Ht=0,pn=at[rt];Ht<pn.length;Ht+=1){var Gt=pn[Ht],$t=Gt[0];$t.minzoom&&this.zoom<Math.floor($t.minzoom)||$t.maxzoom&&this.zoom>=$t.maxzoom||$t.visibility!=="none"&&(C(Gt,this.zoom,j),(Me[$t.id]=$t.createBucket({index:X.bucketLayerIDs.length,layers:Gt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Je,sourceID:this.source})).populate(qe,Ne,this.tileID.canonical),X.bucketLayerIDs.push(Gt.map(function(on){return on.id})))}}}var Lt=s.mapObject(Ne.glyphDependencies,function(on){return Object.keys(on).map(Number)});Object.keys(Lt).length?J.send("getGlyphs",{uid:this.uid,stacks:Lt},function(on,Rt){ae||(ae=on,_e=Rt,dn.call(de))}):_e={};var Xn=Object.keys(Ne.iconDependencies);Xn.length?J.send("getImages",{icons:Xn,source:this.source,tileID:this.tileID,type:"icons"},function(on,Rt){ae||(ae=on,Be=Rt,dn.call(de))}):Be={};var Xt=Object.keys(Ne.patternDependencies);function dn(){if(ae)return ie(ae);if(_e&&Be&&Ue){var on=new S(_e),Rt=new s.ImageAtlas(Be,Ue);for(var Wt in Me){var zr=Me[Wt];zr instanceof s.SymbolBucket?(C(zr.layers,this.zoom,j),s.performSymbolLayout(zr,_e,on.positions,Be,Rt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):zr.hasPattern&&(zr instanceof s.LineBucket||zr instanceof s.FillBucket||zr instanceof s.FillExtrusionBucket)&&(C(zr.layers,this.zoom,j),zr.addFeatures(Ne,this.tileID.canonical,Rt.patternPositions))}this.status="done",ie(null,{buckets:s.values(Me).filter(function(La){return!La.isEmpty()}),featureIndex:X,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:on.image,imageAtlas:Rt,glyphMap:this.returnDependencies?_e:null,iconMap:this.returnDependencies?Be:null,glyphPositions:this.returnDependencies?on.positions:null})}}Xt.length?J.send("getImages",{icons:Xt,source:this.source,tileID:this.tileID,type:"patterns"},function(on,Rt){ae||(ae=on,Ue=Rt,dn.call(de))}):Ue={},dn.call(this)};var G=function(O,N,j,J){this.actor=O,this.layerIndex=N,this.availableImages=j,this.loadVectorData=J||B,this.loading={},this.loaded={}};G.prototype.loadTile=function(O,N){var j=this,J=O.uid;this.loading||(this.loading={});var ie=!!(O&&O.request&&O.request.collectResourceTiming)&&new s.RequestPerformance(O.request),de=this.loading[J]=new I(O);de.abort=this.loadVectorData(O,function(me,X){if(delete j.loading[J],me||!X)return de.status="done",j.loaded[J]=de,N(me);var ae=X.rawData,_e={};X.expires&&(_e.expires=X.expires),X.cacheControl&&(_e.cacheControl=X.cacheControl);var Be={};if(ie){var Ue=ie.finish();Ue&&(Be.resourceTiming=JSON.parse(JSON.stringify(Ue)))}de.vectorTile=X.vectorTile,de.parse(X.vectorTile,j.layerIndex,j.availableImages,j.actor,function(Me,Ne){if(Me||!Ne)return N(Me);N(null,s.extend({rawTileData:ae.slice(0)},Ne,_e,Be))}),j.loaded=j.loaded||{},j.loaded[J]=de})},G.prototype.reloadTile=function(O,N){var j=this,J=this.loaded,ie=O.uid,de=this;if(J&&J[ie]){var me=J[ie];me.showCollisionBoxes=O.showCollisionBoxes;var X=function(ae,_e){var Be=me.reloadCallback;Be&&(delete me.reloadCallback,me.parse(me.vectorTile,de.layerIndex,j.availableImages,de.actor,Be)),N(ae,_e)};me.status==="parsing"?me.reloadCallback=X:me.status==="done"&&(me.vectorTile?me.parse(me.vectorTile,this.layerIndex,this.availableImages,this.actor,X):X())}},G.prototype.abortTile=function(O,N){var j=this.loading,J=O.uid;j&&j[J]&&j[J].abort&&(j[J].abort(),delete j[J]),N()},G.prototype.removeTile=function(O,N){var j=this.loaded,J=O.uid;j&&j[J]&&delete j[J],N()};var W=s.window.ImageBitmap,he=function(){this.loaded={}};function H(O,N){if(O.length!==0){U(O[0],N);for(var j=1;j<O.length;j++)U(O[j],!N)}}function U(O,N){for(var j=0,J=0,ie=0,de=O.length,me=de-1;ie<de;me=ie++){var X=(O[ie][0]-O[me][0])*(O[me][1]+O[ie][1]),ae=j+X;J+=Math.abs(j)>=Math.abs(X)?j-ae+X:X-ae+j,j=ae}j+J>=0!=!!N&&O.reverse()}he.prototype.loadTile=function(O,N){var j=O.uid,J=O.encoding,ie=O.rawImageData,de=W&&ie instanceof W?this.getImageData(ie):ie,me=new s.DEMData(j,de,J);this.loaded=this.loaded||{},this.loaded[j]=me,N(null,me)},he.prototype.getImageData=function(O){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(O.width,O.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=O.width,this.offscreenCanvas.height=O.height,this.offscreenCanvasContext.drawImage(O,0,0,O.width,O.height);var N=this.offscreenCanvasContext.getImageData(-1,-1,O.width+2,O.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new s.RGBAImage({width:N.width,height:N.height},N.data)},he.prototype.removeTile=function(O){var N=this.loaded,j=O.uid;N&&N[j]&&delete N[j]};var K=s.vectorTile.VectorTileFeature.prototype.toGeoJSON,fe=function(O){this._feature=O,this.extent=s.EXTENT,this.type=O.type,this.properties=O.tags,"id"in O&&!isNaN(O.id)&&(this.id=parseInt(O.id,10))};fe.prototype.loadGeometry=function(){if(this._feature.type===1){for(var O=[],N=0,j=this._feature.geometry;N<j.length;N+=1){var J=j[N];O.push([new s.Point$1(J[0],J[1])])}return O}for(var ie=[],de=0,me=this._feature.geometry;de<me.length;de+=1){for(var X=[],ae=0,_e=me[de];ae<_e.length;ae+=1){var Be=_e[ae];X.push(new s.Point$1(Be[0],Be[1]))}ie.push(X)}return ie},fe.prototype.toGeoJSON=function(O,N,j){return K.call(this,O,N,j)};var ye=function(O){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=O.length,this._features=O};ye.prototype.feature=function(O){return new fe(this._features[O])};var xe=s.vectorTile.VectorTileFeature,Te=De;function De(O,N){this.options=N||{},this.features=O,this.length=O.length}function Fe(O,N){this.id=typeof O.id=="number"?O.id:void 0,this.type=O.type,this.rawGeometry=O.type===1?[O.geometry]:O.geometry,this.properties=O.tags,this.extent=N||4096}De.prototype.feature=function(O){return new Fe(this.features[O],this.options.extent)},Fe.prototype.loadGeometry=function(){var O=this.rawGeometry;this.geometry=[];for(var N=0;N<O.length;N++){for(var j=O[N],J=[],ie=0;ie<j.length;ie++)J.push(new s.Point$1(j[ie][0],j[ie][1]));this.geometry.push(J)}return this.geometry},Fe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var O=this.geometry,N=1/0,j=-1/0,J=1/0,ie=-1/0,de=0;de<O.length;de++)for(var me=O[de],X=0;X<me.length;X++){var ae=me[X];N=Math.min(N,ae.x),j=Math.max(j,ae.x),J=Math.min(J,ae.y),ie=Math.max(ie,ae.y)}return[N,J,j,ie]},Fe.prototype.toGeoJSON=xe.prototype.toGeoJSON;var Ve=Bt,tt=Te;function Bt(O){var N=new s.pbf;return function(j,J){for(var ie in j.layers)J.writeMessage(3,ft,j.layers[ie])}(O,N),N.finish()}function ft(O,N){var j;N.writeVarintField(15,O.version||1),N.writeStringField(1,O.name||""),N.writeVarintField(5,O.extent||4096);var J={keys:[],values:[],keycache:{},valuecache:{}};for(j=0;j<O.length;j++)J.feature=O.feature(j),N.writeMessage(2,wt,J);var ie=J.keys;for(j=0;j<ie.length;j++)N.writeStringField(3,ie[j]);var de=J.values;for(j=0;j<de.length;j++)N.writeMessage(4,Mt,de[j])}function wt(O,N){var j=O.feature;j.id!==void 0&&N.writeVarintField(1,j.id),N.writeMessage(2,nr,O),N.writeVarintField(3,j.type),N.writeMessage(4,ut,j)}function nr(O,N){var j=O.feature,J=O.keys,ie=O.values,de=O.keycache,me=O.valuecache;for(var X in j.properties){var ae=de[X];ae===void 0&&(J.push(X),de[X]=ae=J.length-1),N.writeVarint(ae);var _e=j.properties[X],Be=typeof _e;Be!=="string"&&Be!=="boolean"&&Be!=="number"&&(_e=JSON.stringify(_e));var Ue=Be+":"+_e,Me=me[Ue];Me===void 0&&(ie.push(_e),me[Ue]=Me=ie.length-1),N.writeVarint(Me)}}function rr(O,N){return(N<<3)+(7&O)}function Pr(O){return O<<1^O>>31}function ut(O,N){for(var j=O.loadGeometry(),J=O.type,ie=0,de=0,me=j.length,X=0;X<me;X++){var ae=j[X],_e=1;J===1&&(_e=ae.length),N.writeVarint(rr(1,_e));for(var Be=J===3?ae.length-1:ae.length,Ue=0;Ue<Be;Ue++){Ue===1&&J!==1&&N.writeVarint(rr(2,Be-1));var Me=ae[Ue].x-ie,Ne=ae[Ue].y-de;N.writeVarint(Pr(Me)),N.writeVarint(Pr(Ne)),ie+=Me,de+=Ne}J===3&&N.writeVarint(rr(7,1))}}function Mt(O,N){var j=typeof O;j==="string"?N.writeStringField(1,O):j==="boolean"?N.writeBooleanField(7,O):j==="number"&&(O%1!=0?N.writeDoubleField(3,O):O<0?N.writeSVarintField(6,O):N.writeVarintField(5,O))}function Ot(O,N,j,J){Qt(O,j,J),Qt(N,2*j,2*J),Qt(N,2*j+1,2*J+1)}function Qt(O,N,j){var J=O[N];O[N]=O[j],O[j]=J}function en(O,N,j,J){var ie=O-j,de=N-J;return ie*ie+de*de}Ve.fromVectorTileJs=Bt,Ve.fromGeojsonVt=function(O,N){N=N||{};var j={};for(var J in O)j[J]=new Te(O[J].features,N),j[J].name=J,j[J].version=N.version,j[J].extent=N.extent;return Bt({layers:j})},Ve.GeoJSONWrapper=tt;var vi=function(O){return O[0]},Ir=function(O){return O[1]},_i=function(O,N,j,J,ie){N===void 0&&(N=vi),j===void 0&&(j=Ir),J===void 0&&(J=64),ie===void 0&&(ie=Float64Array),this.nodeSize=J,this.points=O;for(var de=O.length<65536?Uint16Array:Uint32Array,me=this.ids=new de(O.length),X=this.coords=new ie(2*O.length),ae=0;ae<O.length;ae++)me[ae]=ae,X[2*ae]=N(O[ae]),X[2*ae+1]=j(O[ae]);(function _e(Be,Ue,Me,Ne,at,rt){if(!(at-Ne<=Me)){var Le=Ne+at>>1;(function Je(qe,Ze,kt,$e,Ht,pn){for(;Ht>$e;){if(Ht-$e>600){var Gt=Ht-$e+1,$t=kt-$e+1,Lt=Math.log(Gt),Xn=.5*Math.exp(2*Lt/3),Xt=.5*Math.sqrt(Lt*Xn*(Gt-Xn)/Gt)*($t-Gt/2<0?-1:1);Je(qe,Ze,kt,Math.max($e,Math.floor(kt-$t*Xn/Gt+Xt)),Math.min(Ht,Math.floor(kt+(Gt-$t)*Xn/Gt+Xt)),pn)}var dn=Ze[2*kt+pn],on=$e,Rt=Ht;for(Ot(qe,Ze,$e,kt),Ze[2*Ht+pn]>dn&&Ot(qe,Ze,$e,Ht);on<Rt;){for(Ot(qe,Ze,on,Rt),on++,Rt--;Ze[2*on+pn]<dn;)on++;for(;Ze[2*Rt+pn]>dn;)Rt--}Ze[2*$e+pn]===dn?Ot(qe,Ze,$e,Rt):Ot(qe,Ze,++Rt,Ht),Rt<=kt&&($e=Rt+1),kt<=Rt&&(Ht=Rt-1)}})(Be,Ue,Le,Ne,at,rt%2),_e(Be,Ue,Me,Ne,Le-1,rt+1),_e(Be,Ue,Me,Le+1,at,rt+1)}})(me,X,J,0,me.length-1,0)};_i.prototype.range=function(O,N,j,J){return function(ie,de,me,X,ae,_e,Be){for(var Ue,Me,Ne=[0,ie.length-1,0],at=[];Ne.length;){var rt=Ne.pop(),Le=Ne.pop(),Je=Ne.pop();if(Le-Je<=Be)for(var qe=Je;qe<=Le;qe++)Me=de[2*qe+1],(Ue=de[2*qe])>=me&&Ue<=ae&&Me>=X&&Me<=_e&&at.push(ie[qe]);else{var Ze=Math.floor((Je+Le)/2);Me=de[2*Ze+1],(Ue=de[2*Ze])>=me&&Ue<=ae&&Me>=X&&Me<=_e&&at.push(ie[Ze]);var kt=(rt+1)%2;(rt===0?me<=Ue:X<=Me)&&(Ne.push(Je),Ne.push(Ze-1),Ne.push(kt)),(rt===0?ae>=Ue:_e>=Me)&&(Ne.push(Ze+1),Ne.push(Le),Ne.push(kt))}}return at}(this.ids,this.coords,O,N,j,J,this.nodeSize)},_i.prototype.within=function(O,N,j){return function(J,ie,de,me,X,ae){for(var _e=[0,J.length-1,0],Be=[],Ue=X*X;_e.length;){var Me=_e.pop(),Ne=_e.pop(),at=_e.pop();if(Ne-at<=ae)for(var rt=at;rt<=Ne;rt++)en(ie[2*rt],ie[2*rt+1],de,me)<=Ue&&Be.push(J[rt]);else{var Le=Math.floor((at+Ne)/2),Je=ie[2*Le],qe=ie[2*Le+1];en(Je,qe,de,me)<=Ue&&Be.push(J[Le]);var Ze=(Me+1)%2;(Me===0?de-X<=Je:me-X<=qe)&&(_e.push(at),_e.push(Le-1),_e.push(Ze)),(Me===0?de+X>=Je:me+X>=qe)&&(_e.push(Le+1),_e.push(Ne),_e.push(Ze))}}return Be}(this.ids,this.coords,O,N,j,this.nodeSize)};var Fi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(O){return O}},an=function(O){this.options=xi(Object.create(Fi),O),this.trees=new Array(this.options.maxZoom+1)};function Wr(O,N,j,J,ie){return{x:O,y:N,zoom:1/0,id:j,parentId:-1,numPoints:J,properties:ie}}function Dt(O,N){var j=O.geometry.coordinates,J=j[1];return{x:Hr(j[0]),y:Vt(J),zoom:1/0,index:N,parentId:-1}}function Dn(O){return{type:"Feature",id:O.id,properties:go(O),geometry:{type:"Point",coordinates:[(J=O.x,360*(J-.5)),(N=O.y,j=(180-360*N)*Math.PI/180,360*Math.atan(Math.exp(j))/Math.PI-90)]}};var N,j,J}function go(O){var N=O.numPoints,j=N>=1e4?Math.round(N/1e3)+"k":N>=1e3?Math.round(N/100)/10+"k":N;return xi(xi({},O.properties),{cluster:!0,cluster_id:O.id,point_count:N,point_count_abbreviated:j})}function Hr(O){return O/360+.5}function Vt(O){var N=Math.sin(O*Math.PI/180),j=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return j<0?0:j>1?1:j}function xi(O,N){for(var j in N)O[j]=N[j];return O}function hr(O){return O.x}function Zn(O){return O.y}function yo(O,N,j,J,ie,de){var me=ie-j,X=de-J;if(me!==0||X!==0){var ae=((O-j)*me+(N-J)*X)/(me*me+X*X);ae>1?(j=ie,J=de):ae>0&&(j+=me*ae,J+=X*ae)}return(me=O-j)*me+(X=N-J)*X}function bi(O,N,j,J){var ie={id:O===void 0?null:O,type:N,geometry:j,tags:J,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(de){var me=de.geometry,X=de.type;if(X==="Point"||X==="MultiPoint"||X==="LineString")Aa(de,me);else if(X==="Polygon"||X==="MultiLineString")for(var ae=0;ae<me.length;ae++)Aa(de,me[ae]);else if(X==="MultiPolygon")for(ae=0;ae<me.length;ae++)for(var _e=0;_e<me[ae].length;_e++)Aa(de,me[ae][_e])}(ie),ie}function Aa(O,N){for(var j=0;j<N.length;j+=3)O.minX=Math.min(O.minX,N[j]),O.minY=Math.min(O.minY,N[j+1]),O.maxX=Math.max(O.maxX,N[j]),O.maxY=Math.max(O.maxY,N[j+1])}function qr(O,N,j,J){if(N.geometry){var ie=N.geometry.coordinates,de=N.geometry.type,me=Math.pow(j.tolerance/((1<<j.maxZoom)*j.extent),2),X=[],ae=N.id;if(j.promoteId?ae=N.properties[j.promoteId]:j.generateId&&(ae=J||0),de==="Point")_r(ie,X);else if(de==="MultiPoint")for(var _e=0;_e<ie.length;_e++)_r(ie[_e],X);else if(de==="LineString")Pa(ie,X,me,!1);else if(de==="MultiLineString"){if(j.lineMetrics){for(_e=0;_e<ie.length;_e++)Pa(ie[_e],X=[],me,!1),O.push(bi(ae,"LineString",X,N.properties));return}wi(ie,X,me,!1)}else if(de==="Polygon")wi(ie,X,me,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(_e=0;_e<N.geometry.geometries.length;_e++)qr(O,{id:ae,geometry:N.geometry.geometries[_e],properties:N.properties},j,J);return}throw new Error("Input data is not a valid GeoJSON object.")}for(_e=0;_e<ie.length;_e++){var Be=[];wi(ie[_e],Be,me,!0),X.push(Be)}}O.push(bi(ae,de,X,N.properties))}}function _r(O,N){N.push(Ei(O[0])),N.push(ta(O[1])),N.push(0)}function Pa(O,N,j,J){for(var ie,de,me=0,X=0;X<O.length;X++){var ae=Ei(O[X][0]),_e=ta(O[X][1]);N.push(ae),N.push(_e),N.push(0),X>0&&(me+=J?(ie*_e-ae*de)/2:Math.sqrt(Math.pow(ae-ie,2)+Math.pow(_e-de,2))),ie=ae,de=_e}var Be=N.length-3;N[2]=1,function Ue(Me,Ne,at,rt){for(var Le,Je=rt,qe=at-Ne>>1,Ze=at-Ne,kt=Me[Ne],$e=Me[Ne+1],Ht=Me[at],pn=Me[at+1],Gt=Ne+3;Gt<at;Gt+=3){var $t=yo(Me[Gt],Me[Gt+1],kt,$e,Ht,pn);if($t>Je)Le=Gt,Je=$t;else if($t===Je){var Lt=Math.abs(Gt-qe);Lt<Ze&&(Le=Gt,Ze=Lt)}}Je>rt&&(Le-Ne>3&&Ue(Me,Ne,Le,rt),Me[Le+2]=Je,at-Le>3&&Ue(Me,Le,at,rt))}(N,0,Be,j),N[Be+2]=1,N.size=Math.abs(me),N.start=0,N.end=N.size}function wi(O,N,j,J){for(var ie=0;ie<O.length;ie++){var de=[];Pa(O[ie],de,j,J),N.push(de)}}function Ei(O){return O/360+.5}function ta(O){var N=Math.sin(O*Math.PI/180),j=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return j<0?0:j>1?1:j}function Ui(O,N,j,J,ie,de,me,X){if(J/=N,de>=(j/=N)&&me<J)return O;if(me<j||de>=J)return null;for(var ae=[],_e=0;_e<O.length;_e++){var Be=O[_e],Ue=Be.geometry,Me=Be.type,Ne=ie===0?Be.minX:Be.minY,at=ie===0?Be.maxX:Be.maxY;if(Ne>=j&&at<J)ae.push(Be);else if(!(at<j||Ne>=J)){var rt=[];if(Me==="Point"||Me==="MultiPoint")xs(Ue,rt,j,J,ie);else if(Me==="LineString")bs(Ue,rt,j,J,ie,!1,X.lineMetrics);else if(Me==="MultiLineString")Ca(Ue,rt,j,J,ie,!1);else if(Me==="Polygon")Ca(Ue,rt,j,J,ie,!0);else if(Me==="MultiPolygon")for(var Le=0;Le<Ue.length;Le++){var Je=[];Ca(Ue[Le],Je,j,J,ie,!0),Je.length&&rt.push(Je)}if(rt.length){if(X.lineMetrics&&Me==="LineString"){for(Le=0;Le<rt.length;Le++)ae.push(bi(Be.id,Me,rt[Le],Be.tags));continue}Me!=="LineString"&&Me!=="MultiLineString"||(rt.length===1?(Me="LineString",rt=rt[0]):Me="MultiLineString"),Me!=="Point"&&Me!=="MultiPoint"||(Me=rt.length===3?"Point":"MultiPoint"),ae.push(bi(Be.id,Me,rt,Be.tags))}}}return ae.length?ae:null}function xs(O,N,j,J,ie){for(var de=0;de<O.length;de+=3){var me=O[de+ie];me>=j&&me<=J&&(N.push(O[de]),N.push(O[de+1]),N.push(O[de+2]))}}function bs(O,N,j,J,ie,de,me){for(var X,ae,_e=Ia(O),Be=ie===0?Ma:ka,Ue=O.start,Me=0;Me<O.length-3;Me+=3){var Ne=O[Me],at=O[Me+1],rt=O[Me+2],Le=O[Me+3],Je=O[Me+4],qe=ie===0?Ne:at,Ze=ie===0?Le:Je,kt=!1;me&&(X=Math.sqrt(Math.pow(Ne-Le,2)+Math.pow(at-Je,2))),qe<j?Ze>j&&(ae=Be(_e,Ne,at,Le,Je,j),me&&(_e.start=Ue+X*ae)):qe>J?Ze<J&&(ae=Be(_e,Ne,at,Le,Je,J),me&&(_e.start=Ue+X*ae)):vo(_e,Ne,at,rt),Ze<j&&qe>=j&&(ae=Be(_e,Ne,at,Le,Je,j),kt=!0),Ze>J&&qe<=J&&(ae=Be(_e,Ne,at,Le,Je,J),kt=!0),!de&&kt&&(me&&(_e.end=Ue+X*ae),N.push(_e),_e=Ia(O)),me&&(Ue+=X)}var $e=O.length-3;Ne=O[$e],at=O[$e+1],rt=O[$e+2],(qe=ie===0?Ne:at)>=j&&qe<=J&&vo(_e,Ne,at,rt),$e=_e.length-3,de&&$e>=3&&(_e[$e]!==_e[0]||_e[$e+1]!==_e[1])&&vo(_e,_e[0],_e[1],_e[2]),_e.length&&N.push(_e)}function Ia(O){var N=[];return N.size=O.size,N.start=O.start,N.end=O.end,N}function Ca(O,N,j,J,ie,de){for(var me=0;me<O.length;me++)bs(O[me],N,j,J,ie,de,!1)}function vo(O,N,j,J){O.push(N),O.push(j),O.push(J)}function Ma(O,N,j,J,ie,de){var me=(de-N)/(J-N);return O.push(de),O.push(j+(ie-j)*me),O.push(1),me}function ka(O,N,j,J,ie,de){var me=(de-j)/(ie-j);return O.push(N+(J-N)*me),O.push(de),O.push(1),me}function ws(O,N){for(var j=[],J=0;J<O.length;J++){var ie,de=O[J],me=de.type;if(me==="Point"||me==="MultiPoint"||me==="LineString")ie=na(de.geometry,N);else if(me==="MultiLineString"||me==="Polygon"){ie=[];for(var X=0;X<de.geometry.length;X++)ie.push(na(de.geometry[X],N))}else if(me==="MultiPolygon")for(ie=[],X=0;X<de.geometry.length;X++){for(var ae=[],_e=0;_e<de.geometry[X].length;_e++)ae.push(na(de.geometry[X][_e],N));ie.push(ae)}j.push(bi(de.id,me,ie,de.tags))}return j}function na(O,N){var j=[];j.size=O.size,O.start!==void 0&&(j.start=O.start,j.end=O.end);for(var J=0;J<O.length;J+=3)j.push(O[J]+N,O[J+1],O[J+2]);return j}function Es(O,N){if(O.transformed)return O;var j,J,ie,de=1<<O.z,me=O.x,X=O.y;for(j=0;j<O.features.length;j++){var ae=O.features[j],_e=ae.geometry,Be=ae.type;if(ae.geometry=[],Be===1)for(J=0;J<_e.length;J+=2)ae.geometry.push(Ts(_e[J],_e[J+1],N,de,me,X));else for(J=0;J<_e.length;J++){var Ue=[];for(ie=0;ie<_e[J].length;ie+=2)Ue.push(Ts(_e[J][ie],_e[J][ie+1],N,de,me,X));ae.geometry.push(Ue)}}return O.transformed=!0,O}function Ts(O,N,j,J,ie,de){return[Math.round(j*(O*J-ie)),Math.round(j*(N*J-de))]}function ra(O,N,j,J,ie){for(var de=N===ie.maxZoom?0:ie.tolerance/((1<<N)*ie.extent),me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:j,y:J,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},X=0;X<O.length;X++){me.numFeatures++,_l(me,O[X],de,ie);var ae=O[X].minX,_e=O[X].minY,Be=O[X].maxX,Ue=O[X].maxY;ae<me.minX&&(me.minX=ae),_e<me.minY&&(me.minY=_e),Be>me.maxX&&(me.maxX=Be),Ue>me.maxY&&(me.maxY=Ue)}return me}function _l(O,N,j,J){var ie=N.geometry,de=N.type,me=[];if(de==="Point"||de==="MultiPoint")for(var X=0;X<ie.length;X+=3)me.push(ie[X]),me.push(ie[X+1]),O.numPoints++,O.numSimplified++;else if(de==="LineString")ia(me,ie,O,j,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(X=0;X<ie.length;X++)ia(me,ie[X],O,j,de==="Polygon",X===0);else if(de==="MultiPolygon")for(var ae=0;ae<ie.length;ae++){var _e=ie[ae];for(X=0;X<_e.length;X++)ia(me,_e[X],O,j,!0,X===0)}if(me.length){var Be=N.tags||null;if(de==="LineString"&&J.lineMetrics){for(var Ue in Be={},N.tags)Be[Ue]=N.tags[Ue];Be.mapbox_clip_start=ie.start/ie.size,Be.mapbox_clip_end=ie.end/ie.size}var Me={geometry:me,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Be};N.id!==null&&(Me.id=N.id),O.features.push(Me)}}function ia(O,N,j,J,ie,de){var me=J*J;if(J>0&&N.size<(ie?me:J))j.numPoints+=N.length/3;else{for(var X=[],ae=0;ae<N.length;ae+=3)(J===0||N[ae+2]>me)&&(j.numSimplified++,X.push(N[ae]),X.push(N[ae+1])),j.numPoints++;ie&&function(_e,Be){for(var Ue=0,Me=0,Ne=_e.length,at=Ne-2;Me<Ne;at=Me,Me+=2)Ue+=(_e[Me]-_e[at])*(_e[Me+1]+_e[at+1]);if(Ue>0===Be)for(Me=0,Ne=_e.length;Me<Ne/2;Me+=2){var rt=_e[Me],Le=_e[Me+1];_e[Me]=_e[Ne-2-Me],_e[Me+1]=_e[Ne-1-Me],_e[Ne-2-Me]=rt,_e[Ne-1-Me]=Le}}(X,de),O.push(X)}}function Qi(O,N){var j=(N=this.options=function(ie,de){for(var me in de)ie[me]=de[me];return ie}(Object.create(this.options),N)).debug;if(j&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var J=function(ie,de){var me=[];if(ie.type==="FeatureCollection")for(var X=0;X<ie.features.length;X++)qr(me,ie.features[X],de,X);else qr(me,ie.type==="Feature"?ie:{geometry:ie},de);return me}(O,N);this.tiles={},this.tileCoords=[],j&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(J=function(ie,de){var me=de.buffer/de.extent,X=ie,ae=Ui(ie,1,-1-me,me,0,-1,2,de),_e=Ui(ie,1,1-me,2+me,0,-1,2,de);return(ae||_e)&&(X=Ui(ie,1,-me,1+me,0,-1,2,de)||[],ae&&(X=ws(ae,1).concat(X)),_e&&(X=X.concat(ws(_e,-1)))),X}(J,N)).length&&this.splitTile(J,0,0,0),j&&(J.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function eo(O,N,j){return 32*((1<<O)*j+N)+O}function Fo(O,N){var j=O.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);var J=this._geoJSONIndex.getTile(j.z,j.x,j.y);if(!J)return N(null,null);var ie=new ye(J.features),de=Ve(ie);de.byteOffset===0&&de.byteLength===de.buffer.byteLength||(de=new Uint8Array(de)),N(null,{vectorTile:ie,rawData:de.buffer})}an.prototype.load=function(O){var N=this.options,j=N.log,J=N.minZoom,ie=N.maxZoom,de=N.nodeSize;j&&console.time("total time");var me="prepare "+O.length+" points";j&&console.time(me),this.points=O;for(var X=[],ae=0;ae<O.length;ae++)O[ae].geometry&&X.push(Dt(O[ae],ae));this.trees[ie+1]=new _i(X,hr,Zn,de,Float32Array),j&&console.timeEnd(me);for(var _e=ie;_e>=J;_e--){var Be=+Date.now();X=this._cluster(X,_e),this.trees[_e]=new _i(X,hr,Zn,de,Float32Array),j&&console.log("z%d: %d clusters in %dms",_e,X.length,+Date.now()-Be)}return j&&console.timeEnd("total time"),this},an.prototype.getClusters=function(O,N){var j=((O[0]+180)%360+360)%360-180,J=Math.max(-90,Math.min(90,O[1])),ie=O[2]===180?180:((O[2]+180)%360+360)%360-180,de=Math.max(-90,Math.min(90,O[3]));if(O[2]-O[0]>=360)j=-180,ie=180;else if(j>ie){var me=this.getClusters([j,J,180,de],N),X=this.getClusters([-180,J,ie,de],N);return me.concat(X)}for(var ae=this.trees[this._limitZoom(N)],_e=[],Be=0,Ue=ae.range(Hr(j),Vt(de),Hr(ie),Vt(J));Be<Ue.length;Be+=1){var Me=ae.points[Ue[Be]];_e.push(Me.numPoints?Dn(Me):this.points[Me.index])}return _e},an.prototype.getChildren=function(O){var N=this._getOriginId(O),j=this._getOriginZoom(O),J="No cluster with the specified id.",ie=this.trees[j];if(!ie)throw new Error(J);var de=ie.points[N];if(!de)throw new Error(J);for(var me=this.options.radius/(this.options.extent*Math.pow(2,j-1)),X=[],ae=0,_e=ie.within(de.x,de.y,me);ae<_e.length;ae+=1){var Be=ie.points[_e[ae]];Be.parentId===O&&X.push(Be.numPoints?Dn(Be):this.points[Be.index])}if(X.length===0)throw new Error(J);return X},an.prototype.getLeaves=function(O,N,j){var J=[];return this._appendLeaves(J,O,N=N||10,j=j||0,0),J},an.prototype.getTile=function(O,N,j){var J=this.trees[this._limitZoom(O)],ie=Math.pow(2,O),de=this.options,me=de.radius/de.extent,X=(j-me)/ie,ae=(j+1+me)/ie,_e={features:[]};return this._addTileFeatures(J.range((N-me)/ie,X,(N+1+me)/ie,ae),J.points,N,j,ie,_e),N===0&&this._addTileFeatures(J.range(1-me/ie,X,1,ae),J.points,ie,j,ie,_e),N===ie-1&&this._addTileFeatures(J.range(0,X,me/ie,ae),J.points,-1,j,ie,_e),_e.features.length?_e:null},an.prototype.getClusterExpansionZoom=function(O){for(var N=this._getOriginZoom(O)-1;N<=this.options.maxZoom;){var j=this.getChildren(O);if(N++,j.length!==1)break;O=j[0].properties.cluster_id}return N},an.prototype._appendLeaves=function(O,N,j,J,ie){for(var de=0,me=this.getChildren(N);de<me.length;de+=1){var X=me[de],ae=X.properties;if(ae&&ae.cluster?ie+ae.point_count<=J?ie+=ae.point_count:ie=this._appendLeaves(O,ae.cluster_id,j,J,ie):ie<J?ie++:O.push(X),O.length===j)break}return ie},an.prototype._addTileFeatures=function(O,N,j,J,ie,de){for(var me=0,X=O;me<X.length;me+=1){var ae=N[X[me]],_e=ae.numPoints,Be={type:1,geometry:[[Math.round(this.options.extent*(ae.x*ie-j)),Math.round(this.options.extent*(ae.y*ie-J))]],tags:_e?go(ae):this.points[ae.index].properties},Ue=void 0;_e?Ue=ae.id:this.options.generateId?Ue=ae.index:this.points[ae.index].id&&(Ue=this.points[ae.index].id),Ue!==void 0&&(Be.id=Ue),de.features.push(Be)}},an.prototype._limitZoom=function(O){return Math.max(this.options.minZoom,Math.min(+O,this.options.maxZoom+1))},an.prototype._cluster=function(O,N){for(var j=[],J=this.options,ie=J.reduce,de=J.minPoints,me=J.radius/(J.extent*Math.pow(2,N)),X=0;X<O.length;X++){var ae=O[X];if(!(ae.zoom<=N)){ae.zoom=N;for(var _e=this.trees[N+1],Be=_e.within(ae.x,ae.y,me),Ue=ae.numPoints||1,Me=Ue,Ne=0,at=Be;Ne<at.length;Ne+=1){var rt=_e.points[at[Ne]];rt.zoom>N&&(Me+=rt.numPoints||1)}if(Me>=de){for(var Le=ae.x*Ue,Je=ae.y*Ue,qe=ie&&Ue>1?this._map(ae,!0):null,Ze=(X<<5)+(N+1)+this.points.length,kt=0,$e=Be;kt<$e.length;kt+=1){var Ht=_e.points[$e[kt]];if(!(Ht.zoom<=N)){Ht.zoom=N;var pn=Ht.numPoints||1;Le+=Ht.x*pn,Je+=Ht.y*pn,Ht.parentId=Ze,ie&&(qe||(qe=this._map(ae,!0)),ie(qe,this._map(Ht)))}}ae.parentId=Ze,j.push(Wr(Le/Me,Je/Me,Ze,Me,qe))}else if(j.push(ae),Me>1)for(var Gt=0,$t=Be;Gt<$t.length;Gt+=1){var Lt=_e.points[$t[Gt]];Lt.zoom<=N||(Lt.zoom=N,j.push(Lt))}}}return j},an.prototype._getOriginId=function(O){return O-this.points.length>>5},an.prototype._getOriginZoom=function(O){return(O-this.points.length)%32},an.prototype._map=function(O,N){if(O.numPoints)return N?xi({},O.properties):O.properties;var j=this.points[O.index].properties,J=this.options.map(j);return N&&J===j?xi({},J):J},Qi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Qi.prototype.splitTile=function(O,N,j,J,ie,de,me){for(var X=[O,N,j,J],ae=this.options,_e=ae.debug;X.length;){J=X.pop(),j=X.pop(),N=X.pop(),O=X.pop();var Be=1<<N,Ue=eo(N,j,J),Me=this.tiles[Ue];if(!Me&&(_e>1&&console.time("creation"),Me=this.tiles[Ue]=ra(O,N,j,J,ae),this.tileCoords.push({z:N,x:j,y:J}),_e)){_e>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,j,J,Me.numFeatures,Me.numPoints,Me.numSimplified),console.timeEnd("creation"));var Ne="z"+N;this.stats[Ne]=(this.stats[Ne]||0)+1,this.total++}if(Me.source=O,ie){if(N===ae.maxZoom||N===ie)continue;var at=1<<ie-N;if(j!==Math.floor(de/at)||J!==Math.floor(me/at))continue}else if(N===ae.indexMaxZoom||Me.numPoints<=ae.indexMaxPoints)continue;if(Me.source=null,O.length!==0){_e>1&&console.time("clipping");var rt,Le,Je,qe,Ze,kt,$e=.5*ae.buffer/ae.extent,Ht=.5-$e,pn=.5+$e,Gt=1+$e;rt=Le=Je=qe=null,Ze=Ui(O,Be,j-$e,j+pn,0,Me.minX,Me.maxX,ae),kt=Ui(O,Be,j+Ht,j+Gt,0,Me.minX,Me.maxX,ae),O=null,Ze&&(rt=Ui(Ze,Be,J-$e,J+pn,1,Me.minY,Me.maxY,ae),Le=Ui(Ze,Be,J+Ht,J+Gt,1,Me.minY,Me.maxY,ae),Ze=null),kt&&(Je=Ui(kt,Be,J-$e,J+pn,1,Me.minY,Me.maxY,ae),qe=Ui(kt,Be,J+Ht,J+Gt,1,Me.minY,Me.maxY,ae),kt=null),_e>1&&console.timeEnd("clipping"),X.push(rt||[],N+1,2*j,2*J),X.push(Le||[],N+1,2*j,2*J+1),X.push(Je||[],N+1,2*j+1,2*J),X.push(qe||[],N+1,2*j+1,2*J+1)}}},Qi.prototype.getTile=function(O,N,j){var J=this.options,ie=J.extent,de=J.debug;if(O<0||O>24)return null;var me=1<<O,X=eo(O,N=(N%me+me)%me,j);if(this.tiles[X])return Es(this.tiles[X],ie);de>1&&console.log("drilling down to z%d-%d-%d",O,N,j);for(var ae,_e=O,Be=N,Ue=j;!ae&&_e>0;)_e--,Be=Math.floor(Be/2),Ue=Math.floor(Ue/2),ae=this.tiles[eo(_e,Be,Ue)];return ae&&ae.source?(de>1&&console.log("found parent tile z%d-%d-%d",_e,Be,Ue),de>1&&console.time("drilling down"),this.splitTile(ae.source,_e,Be,Ue,O,N,j),de>1&&console.timeEnd("drilling down"),this.tiles[X]?Es(this.tiles[X],ie):null):null};var Ss=function(O){function N(j,J,ie,de){O.call(this,j,J,ie,Fo),de&&(this.loadGeoJSON=de)}return O&&(N.__proto__=O),(N.prototype=Object.create(O&&O.prototype)).constructor=N,N.prototype.loadData=function(j,J){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=J,this._pendingLoadDataParams=j,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},N.prototype._loadData=function(){var j=this;if(this._pendingCallback&&this._pendingLoadDataParams){var J=this._pendingCallback,ie=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var de=!!(ie&&ie.request&&ie.request.collectResourceTiming)&&new s.RequestPerformance(ie.request);this.loadGeoJSON(ie,function(me,X){if(me||!X)return J(me);if(typeof X!="object")return J(new Error("Input data given to '"+ie.source+"' is not a valid GeoJSON object."));(function Me(Ne,at){var rt,Le=Ne&&Ne.type;if(Le==="FeatureCollection")for(rt=0;rt<Ne.features.length;rt++)Me(Ne.features[rt],at);else if(Le==="GeometryCollection")for(rt=0;rt<Ne.geometries.length;rt++)Me(Ne.geometries[rt],at);else if(Le==="Feature")Me(Ne.geometry,at);else if(Le==="Polygon")H(Ne.coordinates,at);else if(Le==="MultiPolygon")for(rt=0;rt<Ne.coordinates.length;rt++)H(Ne.coordinates[rt],at);return Ne})(X,!0);try{if(ie.filter){var ae=s.createExpression(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ae.result==="error")throw new Error(ae.value.map(function(Me){return Me.key+": "+Me.message}).join(", "));var _e=X.features.filter(function(Me){return ae.value.evaluate({zoom:0},Me)});X={type:"FeatureCollection",features:_e}}j._geoJSONIndex=ie.cluster?new an(function(Me){var Ne=Me.superclusterOptions,at=Me.clusterProperties;if(!at||!Ne)return Ne;for(var rt={},Le={},Je={accumulated:null,zoom:0},qe={properties:null},Ze=Object.keys(at),kt=0,$e=Ze;kt<$e.length;kt+=1){var Ht=$e[kt],pn=at[Ht],Gt=pn[0],$t=s.createExpression(pn[1]),Lt=s.createExpression(typeof Gt=="string"?[Gt,["accumulated"],["get",Ht]]:Gt);rt[Ht]=$t.value,Le[Ht]=Lt.value}return Ne.map=function(Xn){qe.properties=Xn;for(var Xt={},dn=0,on=Ze;dn<on.length;dn+=1){var Rt=on[dn];Xt[Rt]=rt[Rt].evaluate(Je,qe)}return Xt},Ne.reduce=function(Xn,Xt){qe.properties=Xt;for(var dn=0,on=Ze;dn<on.length;dn+=1){var Rt=on[dn];Je.accumulated=Xn[Rt],Xn[Rt]=Le[Rt].evaluate(Je,qe)}},Ne}(ie)).load(X.features):function(Me,Ne){return new Qi(Me,Ne)}(X,ie.geojsonVtOptions)}catch(Me){return J(Me)}j.loaded={};var Be={};if(de){var Ue=de.finish();Ue&&(Be.resourceTiming={},Be.resourceTiming[ie.source]=JSON.parse(JSON.stringify(Ue)))}J(null,Be)})}},N.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},N.prototype.reloadTile=function(j,J){var ie=this.loaded;return ie&&ie[j.uid]?O.prototype.reloadTile.call(this,j,J):this.loadTile(j,J)},N.prototype.loadGeoJSON=function(j,J){if(j.request)s.getJSON(j.request,J);else{if(typeof j.data!="string")return J(new Error("Input data given to '"+j.source+"' is not a valid GeoJSON object."));try{return J(null,JSON.parse(j.data))}catch{return J(new Error("Input data given to '"+j.source+"' is not a valid GeoJSON object."))}}},N.prototype.removeSource=function(j,J){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),J()},N.prototype.getClusterExpansionZoom=function(j,J){try{J(null,this._geoJSONIndex.getClusterExpansionZoom(j.clusterId))}catch(ie){J(ie)}},N.prototype.getClusterChildren=function(j,J){try{J(null,this._geoJSONIndex.getChildren(j.clusterId))}catch(ie){J(ie)}},N.prototype.getClusterLeaves=function(j,J){try{J(null,this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset))}catch(ie){J(ie)}},N}(G),zn=function(O){var N=this;this.self=O,this.actor=new s.Actor(O,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:G,geojson:Ss},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(j,J){if(N.workerSourceTypes[j])throw new Error('Worker source with name "'+j+'" already registered.');N.workerSourceTypes[j]=J},this.self.registerRTLTextPlugin=function(j){if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=j.applyArabicShaping,s.plugin.processBidirectionalText=j.processBidirectionalText,s.plugin.processStyledBidirectionalText=j.processStyledBidirectionalText}};return zn.prototype.setReferrer=function(O,N){this.referrer=N},zn.prototype.setImages=function(O,N,j){for(var J in this.availableImages[O]=N,this.workerSources[O]){var ie=this.workerSources[O][J];for(var de in ie)ie[de].availableImages=N}j()},zn.prototype.setLayers=function(O,N,j){this.getLayerIndex(O).replace(N),j()},zn.prototype.updateLayers=function(O,N,j){this.getLayerIndex(O).update(N.layers,N.removedIds),j()},zn.prototype.loadTile=function(O,N,j){this.getWorkerSource(O,N.type,N.source).loadTile(N,j)},zn.prototype.loadDEMTile=function(O,N,j){this.getDEMWorkerSource(O,N.source).loadTile(N,j)},zn.prototype.reloadTile=function(O,N,j){this.getWorkerSource(O,N.type,N.source).reloadTile(N,j)},zn.prototype.abortTile=function(O,N,j){this.getWorkerSource(O,N.type,N.source).abortTile(N,j)},zn.prototype.removeTile=function(O,N,j){this.getWorkerSource(O,N.type,N.source).removeTile(N,j)},zn.prototype.removeDEMTile=function(O,N){this.getDEMWorkerSource(O,N.source).removeTile(N)},zn.prototype.removeSource=function(O,N,j){if(this.workerSources[O]&&this.workerSources[O][N.type]&&this.workerSources[O][N.type][N.source]){var J=this.workerSources[O][N.type][N.source];delete this.workerSources[O][N.type][N.source],J.removeSource!==void 0?J.removeSource(N,j):j()}},zn.prototype.loadWorkerSource=function(O,N,j){try{this.self.importScripts(N.url),j()}catch(J){j(J.toString())}},zn.prototype.syncRTLPluginState=function(O,N,j){try{s.plugin.setState(N);var J=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&J!=null){this.self.importScripts(J);var ie=s.plugin.isParsed();j(ie?void 0:new Error("RTL Text Plugin failed to import scripts from "+J),ie)}}catch(de){j(de.toString())}},zn.prototype.getAvailableImages=function(O){var N=this.availableImages[O];return N||(N=[]),N},zn.prototype.getLayerIndex=function(O){var N=this.layerIndexes[O];return N||(N=this.layerIndexes[O]=new b),N},zn.prototype.getWorkerSource=function(O,N,j){var J=this;return this.workerSources[O]||(this.workerSources[O]={}),this.workerSources[O][N]||(this.workerSources[O][N]={}),this.workerSources[O][N][j]||(this.workerSources[O][N][j]=new this.workerSourceTypes[N]({send:function(ie,de,me){J.actor.send(ie,de,me,O)}},this.getLayerIndex(O),this.getAvailableImages(O))),this.workerSources[O][N][j]},zn.prototype.getDEMWorkerSource=function(O,N){return this.demWorkerSources[O]||(this.demWorkerSources[O]={}),this.demWorkerSources[O][N]||(this.demWorkerSources[O][N]=new he),this.demWorkerSources[O][N]},zn.prototype.enforceCacheSizeLimit=function(O,N){s.enforceCacheSizeLimit(N)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new zn(self)),zn}),l(["./shared"],function(s){var g=s.createCommonjsModule(function(c){function f(_){return!h(_)}function h(_){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var E,A,k=new Blob([""],{type:"text/javascript"}),z=URL.createObjectURL(k);try{A=new Worker(z),E=!0}catch{E=!1}return A&&A.terminate(),URL.revokeObjectURL(z),E}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var E=document.createElement("canvas");E.width=E.height=1;var A=E.getContext("2d");if(!A)return!1;var k=A.getImageData(0,0,1,1);return k&&k.width===E.width}()?(d[w=_&&_.failIfMajorPerformanceCaveat]===void 0&&(d[w]=function(E){var A=function(z){var Z=document.createElement("canvas"),Y=Object.create(f.webGLContextAttributes);return Y.failIfMajorPerformanceCaveat=z,Z.probablySupportsContext?Z.probablySupportsContext("webgl",Y)||Z.probablySupportsContext("experimental-webgl",Y):Z.supportsContext?Z.supportsContext("webgl",Y)||Z.supportsContext("experimental-webgl",Y):Z.getContext("webgl",Y)||Z.getContext("experimental-webgl",Y)}(E);if(!A)return!1;var k=A.createShader(A.VERTEX_SHADER);return!(!k||A.isContextLost())&&(A.shaderSource(k,"void main() {}"),A.compileShader(k),A.getShaderParameter(k,A.COMPILE_STATUS)===!0)}(w)),d[w]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var w}c.exports?c.exports=f:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=f,window.mapboxgl.notSupportedReason=h);var d={};f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),y={create:function(c,f,h){var d=s.window.document.createElement(c);return f!==void 0&&(d.className=f),h&&h.appendChild(d),d},createNS:function(c,f){return s.window.document.createElementNS(c,f)}},b=s.window.document&&s.window.document.documentElement.style;function S(c){if(!b)return c[0];for(var f=0;f<c.length;f++)if(c[f]in b)return c[f];return c[0]}var I,C=S(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);y.disableDrag=function(){b&&C&&(I=b[C],b[C]="none")},y.enableDrag=function(){b&&C&&(b[C]=I)};var B=S(["transform","WebkitTransform"]);y.setTransform=function(c,f){c.style[B]=f};var G=!1;try{var W=Object.defineProperty({},"passive",{get:function(){G=!0}});s.window.addEventListener("test",W,W),s.window.removeEventListener("test",W,W)}catch{G=!1}y.addEventListener=function(c,f,h,d){d===void 0&&(d={}),c.addEventListener(f,h,"passive"in d&&G?d:d.capture)},y.removeEventListener=function(c,f,h,d){d===void 0&&(d={}),c.removeEventListener(f,h,"passive"in d&&G?d:d.capture)};var he=function(c){c.preventDefault(),c.stopPropagation(),s.window.removeEventListener("click",he,!0)};function H(c){var f=c.userImage;return!!(f&&f.render&&f.render())&&(c.data.replace(new Uint8Array(f.data.buffer)),!0)}y.suppressClick=function(){s.window.addEventListener("click",he,!0),s.window.setTimeout(function(){s.window.removeEventListener("click",he,!0)},0)},y.mousePos=function(c,f){var h=c.getBoundingClientRect();return new s.Point(f.clientX-h.left-c.clientLeft,f.clientY-h.top-c.clientTop)},y.touchPos=function(c,f){for(var h=c.getBoundingClientRect(),d=[],_=0;_<f.length;_++)d.push(new s.Point(f[_].clientX-h.left-c.clientLeft,f[_].clientY-h.top-c.clientTop));return d},y.mouseButton=function(c){return s.window.InstallTrigger!==void 0&&c.button===2&&c.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:c.button},y.remove=function(c){c.parentNode&&c.parentNode.removeChild(c)};var U=function(c){function f(){c.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.isLoaded=function(){return this.loaded},f.prototype.setLoaded=function(h){if(this.loaded!==h&&(this.loaded=h,h)){for(var d=0,_=this.requestors;d<_.length;d+=1){var w=_[d];this._notify(w.ids,w.callback)}this.requestors=[]}},f.prototype.getImage=function(h){return this.images[h]},f.prototype.addImage=function(h,d){this._validate(h,d)&&(this.images[h]=d)},f.prototype._validate=function(h,d){var _=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new s.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchX" value'))),_=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new s.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchY" value'))),_=!1),this._validateContent(d.content,d)||(this.fire(new s.ErrorEvent(new Error('Image "'+h+'" has invalid "content" value'))),_=!1),_},f.prototype._validateStretch=function(h,d){if(!h)return!0;for(var _=0,w=0,E=h;w<E.length;w+=1){var A=E[w];if(A[0]<_||A[1]<A[0]||d<A[1])return!1;_=A[1]}return!0},f.prototype._validateContent=function(h,d){return!(h&&(h.length!==4||h[0]<0||d.data.width<h[0]||h[1]<0||d.data.height<h[1]||h[2]<0||d.data.width<h[2]||h[3]<0||d.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))},f.prototype.updateImage=function(h,d){d.version=this.images[h].version+1,this.images[h]=d,this.updatedImages[h]=!0},f.prototype.removeImage=function(h){var d=this.images[h];delete this.images[h],delete this.patterns[h],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()},f.prototype.listImages=function(){return Object.keys(this.images)},f.prototype.getImages=function(h,d){var _=!0;if(!this.isLoaded())for(var w=0,E=h;w<E.length;w+=1)this.images[E[w]]||(_=!1);this.isLoaded()||_?this._notify(h,d):this.requestors.push({ids:h,callback:d})},f.prototype._notify=function(h,d){for(var _={},w=0,E=h;w<E.length;w+=1){var A=E[w];this.images[A]||this.fire(new s.Event("styleimagemissing",{id:A}));var k=this.images[A];k?_[A]={data:k.data.clone(),pixelRatio:k.pixelRatio,sdf:k.sdf,version:k.version,stretchX:k.stretchX,stretchY:k.stretchY,content:k.content,hasRenderCallback:!!(k.userImage&&k.userImage.render)}:s.warnOnce('Image "'+A+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}d(null,_)},f.prototype.getPixelSize=function(){var h=this.atlasImage;return{width:h.width,height:h.height}},f.prototype.getPattern=function(h){var d=this.patterns[h],_=this.getImage(h);if(!_)return null;if(d&&d.position.version===_.version)return d.position;if(d)d.position.version=_.version;else{var w={w:_.data.width+2,h:_.data.height+2,x:0,y:0},E=new s.ImagePosition(w,_);this.patterns[h]={bin:w,position:E}}return this._updatePatternAtlas(),this.patterns[h].position},f.prototype.bind=function(h){var d=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(h,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)},f.prototype._updatePatternAtlas=function(){var h=[];for(var d in this.patterns)h.push(this.patterns[d].bin);var _=s.potpack(h),w=_.w,E=_.h,A=this.atlasImage;for(var k in A.resize({width:w||1,height:E||1}),this.patterns){var z=this.patterns[k].bin,Z=z.x+1,Y=z.y+1,$=this.images[k].data,oe=$.width,re=$.height;s.RGBAImage.copy($,A,{x:0,y:0},{x:Z,y:Y},{width:oe,height:re}),s.RGBAImage.copy($,A,{x:0,y:re-1},{x:Z,y:Y-1},{width:oe,height:1}),s.RGBAImage.copy($,A,{x:0,y:0},{x:Z,y:Y+re},{width:oe,height:1}),s.RGBAImage.copy($,A,{x:oe-1,y:0},{x:Z-1,y:Y},{width:1,height:re}),s.RGBAImage.copy($,A,{x:0,y:0},{x:Z+oe,y:Y},{width:1,height:re})}this.dirty=!0},f.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},f.prototype.dispatchRenderCallbacks=function(h){for(var d=0,_=h;d<_.length;d+=1){var w=_[d];if(!this.callbackDispatchedThisFrame[w]){this.callbackDispatchedThisFrame[w]=!0;var E=this.images[w];H(E)&&this.updateImage(w,E)}}},f}(s.Evented),K=xe,fe=xe,ye=1e20;function xe(c,f,h,d,_,w){this.fontSize=c||24,this.buffer=f===void 0?3:f,this.cutoff=d||.25,this.fontFamily=_||"sans-serif",this.fontWeight=w||"normal",this.radius=h||8;var E=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=E,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.d=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Int16Array(E),this.middle=Math.round(E/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Te(c,f,h,d,_,w,E){for(var A=0;A<f;A++){for(var k=0;k<h;k++)d[k]=c[k*f+A];for(De(d,_,w,E,h),k=0;k<h;k++)c[k*f+A]=_[k]}for(k=0;k<h;k++){for(A=0;A<f;A++)d[A]=c[k*f+A];for(De(d,_,w,E,f),A=0;A<f;A++)c[k*f+A]=Math.sqrt(_[A])}}function De(c,f,h,d,_){h[0]=0,d[0]=-ye,d[1]=+ye;for(var w=1,E=0;w<_;w++){for(var A=(c[w]+w*w-(c[h[E]]+h[E]*h[E]))/(2*w-2*h[E]);A<=d[E];)E--,A=(c[w]+w*w-(c[h[E]]+h[E]*h[E]))/(2*w-2*h[E]);h[++E]=w,d[E]=A,d[E+1]=+ye}for(w=0,E=0;w<_;w++){for(;d[E+1]<w;)E++;f[w]=(w-h[E])*(w-h[E])+c[h[E]]}}xe.prototype.draw=function(c){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(c,this.buffer,this.middle);for(var f=this.ctx.getImageData(0,0,this.size,this.size),h=new Uint8ClampedArray(this.size*this.size),d=0;d<this.size*this.size;d++){var _=f.data[4*d+3]/255;this.gridOuter[d]=_===1?0:_===0?ye:Math.pow(Math.max(0,.5-_),2),this.gridInner[d]=_===1?ye:_===0?0:Math.pow(Math.max(0,_-.5),2)}for(Te(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Te(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),d=0;d<this.size*this.size;d++)h[d]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[d]-this.gridInner[d])/this.radius+this.cutoff))));return h},K.default=fe;var Fe=function(c,f){this.requestManager=c,this.localIdeographFontFamily=f,this.entries={}};Fe.prototype.setURL=function(c){this.url=c},Fe.prototype.getGlyphs=function(c,f){var h=this,d=[];for(var _ in c)for(var w=0,E=c[_];w<E.length;w+=1)d.push({stack:_,id:E[w]});s.asyncAll(d,function(A,k){var z=A.stack,Z=A.id,Y=h.entries[z];Y||(Y=h.entries[z]={glyphs:{},requests:{},ranges:{}});var $=Y.glyphs[Z];if($===void 0){if($=h._tinySDF(Y,z,Z))return Y.glyphs[Z]=$,void k(null,{stack:z,id:Z,glyph:$});var oe=Math.floor(Z/256);if(256*oe>65535)k(new Error("glyphs > 65535 not supported"));else if(Y.ranges[oe])k(null,{stack:z,id:Z,glyph:$});else{var re=Y.requests[oe];re||(re=Y.requests[oe]=[],Fe.loadGlyphRange(z,oe,h.url,h.requestManager,function(ue,ee){if(ee){for(var le in ee)h._doesCharSupportLocalGlyph(+le)||(Y.glyphs[+le]=ee[+le]);Y.ranges[oe]=!0}for(var ge=0,be=re;ge<be.length;ge+=1)(0,be[ge])(ue,ee);delete Y.requests[oe]})),re.push(function(ue,ee){ue?k(ue):ee&&k(null,{stack:z,id:Z,glyph:ee[Z]||null})})}}else k(null,{stack:z,id:Z,glyph:$})},function(A,k){if(A)f(A);else if(k){for(var z={},Z=0,Y=k;Z<Y.length;Z+=1){var $=Y[Z],oe=$.stack,re=$.id,ue=$.glyph;(z[oe]||(z[oe]={}))[re]=ue&&{id:ue.id,bitmap:ue.bitmap.clone(),metrics:ue.metrics}}f(null,z)}})},Fe.prototype._doesCharSupportLocalGlyph=function(c){return!!this.localIdeographFontFamily&&(s.isChar["CJK Unified Ideographs"](c)||s.isChar["Hangul Syllables"](c)||s.isChar.Hiragana(c)||s.isChar.Katakana(c))},Fe.prototype._tinySDF=function(c,f,h){var d=this.localIdeographFontFamily;if(d&&this._doesCharSupportLocalGlyph(h)){var _=c.tinySDF;if(!_){var w="400";/bold/i.test(f)?w="900":/medium/i.test(f)?w="500":/light/i.test(f)&&(w="200"),_=c.tinySDF=new Fe.TinySDF(24,3,8,.25,d,w)}return{id:h,bitmap:new s.AlphaImage({width:30,height:30},_.draw(String.fromCharCode(h))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Fe.loadGlyphRange=function(c,f,h,d,_){var w=256*f,E=w+255,A=d.transformRequest(d.normalizeGlyphsURL(h).replace("{fontstack}",c).replace("{range}",w+"-"+E),s.ResourceType.Glyphs);s.getArrayBuffer(A,function(k,z){if(k)_(k);else if(z){for(var Z={},Y=0,$=s.parseGlyphPBF(z);Y<$.length;Y+=1){var oe=$[Y];Z[oe.id]=oe}_(null,Z)}})},Fe.TinySDF=K;var Ve=function(){this.specification=s.styleSpec.light.position};Ve.prototype.possiblyEvaluate=function(c,f){return s.sphericalToCartesian(c.expression.evaluate(f))},Ve.prototype.interpolate=function(c,f,h){return{x:s.number(c.x,f.x,h),y:s.number(c.y,f.y,h),z:s.number(c.z,f.z,h)}};var tt=new s.Properties({anchor:new s.DataConstantProperty(s.styleSpec.light.anchor),position:new Ve,color:new s.DataConstantProperty(s.styleSpec.light.color),intensity:new s.DataConstantProperty(s.styleSpec.light.intensity)}),Bt=function(c){function f(h){c.call(this),this._transitionable=new s.Transitionable(tt),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getLight=function(){return this._transitionable.serialize()},f.prototype.setLight=function(h,d){if(d===void 0&&(d={}),!this._validate(s.validateLight,h,d))for(var _ in h){var w=h[_];s.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),w):this._transitionable.setValue(_,w)}},f.prototype.updateTransitions=function(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)},f.prototype.hasTransition=function(){return this._transitioning.hasTransition()},f.prototype.recalculate=function(h){this.properties=this._transitioning.possiblyEvaluate(h)},f.prototype._validate=function(h,d,_){return(!_||_.validate!==!1)&&s.emitValidationErrors(this,h.call(s.validateStyle,s.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:s.styleSpec})))},f}(s.Evented),ft=function(c,f){this.width=c,this.height=f,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};ft.prototype.getDash=function(c,f){var h=c.join(",")+String(f);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(c,f)),this.dashEntry[h]},ft.prototype.getDashRanges=function(c,f,h){var d=[],_=c.length%2==1?-c[c.length-1]*h:0,w=c[0]*h,E=!0;d.push({left:_,right:w,isDash:E,zeroLength:c[0]===0});for(var A=c[0],k=1;k<c.length;k++){var z=c[k];d.push({left:_=A*h,right:w=(A+=z)*h,isDash:E=!E,zeroLength:z===0})}return d},ft.prototype.addRoundDash=function(c,f,h){for(var d=f/2,_=-h;_<=h;_++)for(var w=this.width*(this.nextRow+h+_),E=0,A=c[E],k=0;k<this.width;k++){k/A.right>1&&(A=c[++E]);var z=Math.abs(k-A.left),Z=Math.abs(k-A.right),Y=Math.min(z,Z),$=void 0,oe=_/h*(d+1);if(A.isDash){var re=d-Math.abs(oe);$=Math.sqrt(Y*Y+re*re)}else $=d-Math.sqrt(Y*Y+oe*oe);this.data[w+k]=Math.max(0,Math.min(255,$+128))}},ft.prototype.addRegularDash=function(c){for(var f=c.length-1;f>=0;--f){var h=c[f],d=c[f+1];h.zeroLength?c.splice(f,1):d&&d.isDash===h.isDash&&(d.left=h.left,c.splice(f,1))}var _=c[0],w=c[c.length-1];_.isDash===w.isDash&&(_.left=w.left-this.width,w.right=_.right+this.width);for(var E=this.width*this.nextRow,A=0,k=c[A],z=0;z<this.width;z++){z/k.right>1&&(k=c[++A]);var Z=Math.abs(z-k.left),Y=Math.abs(z-k.right),$=Math.min(Z,Y);this.data[E+z]=Math.max(0,Math.min(255,(k.isDash?$:-$)+128))}},ft.prototype.addDash=function(c,f){var h=f?7:0,d=2*h+1;if(this.nextRow+d>this.height)return s.warnOnce("LineAtlas out of space"),null;for(var _=0,w=0;w<c.length;w++)_+=c[w];if(_!==0){var E=this.width/_,A=this.getDashRanges(c,this.width,E);f?this.addRoundDash(A,E,h):this.addRegularDash(A)}var k={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:_};return this.nextRow+=d,this.dirty=!0,k},ft.prototype.bind=function(c){var f=c.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))};var wt=function c(f,h){this.workerPool=f,this.actors=[],this.currentActor=0,this.id=s.uniqueId();for(var d=this.workerPool.acquire(this.id),_=0;_<d.length;_++){var w=new c.Actor(d[_],h,this.id);w.name="Worker "+_,this.actors.push(w)}};function nr(c,f,h){var d=function(_,w){if(_)return h(_);if(w){var E=s.pick(s.extend(w,c),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(E.vectorLayers=w.vector_layers,E.vectorLayerIds=E.vectorLayers.map(function(A){return A.id})),E.tiles=f.canonicalizeTileset(E,c.url),h(null,E)}};return c.url?s.getJSON(f.transformRequest(f.normalizeSourceURL(c.url),s.ResourceType.Source),d):s.browser.frame(function(){return d(null,c)})}wt.prototype.broadcast=function(c,f,h){s.asyncAll(this.actors,function(d,_){d.send(c,f,_)},h=h||function(){})},wt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},wt.prototype.remove=function(){this.actors.forEach(function(c){c.remove()}),this.actors=[],this.workerPool.release(this.id)},wt.Actor=s.Actor;var rr=function(c,f,h){this.bounds=s.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=f||0,this.maxzoom=h||24};rr.prototype.validateBounds=function(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]},rr.prototype.contains=function(c){var f=Math.pow(2,c.z),h=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*f),d=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*f),_=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*f),w=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*f);return c.x>=h&&c.x<_&&c.y>=d&&c.y<w};var Pr=function(c){function f(h,d,_,w){if(c.call(this),this.id=h,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(d,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=nr(this._options,this.map._requestManager,function(d,_){h._tileJSONRequest=null,h._loaded=!0,d?h.fire(new s.ErrorEvent(d)):_&&(s.extend(h,_),_.bounds&&(h.tileBounds=new rr(_.bounds,h.minzoom,h.maxzoom)),s.postTurnstileEvent(_.tiles,h.map._requestManager._customAccessToken),s.postMapLoadEvent(_.tiles,h.map._getMapId(),h.map._requestManager._skuToken,h.map._requestManager._customAccessToken),h.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.setSourceProperty=function(h){this._tileJSONRequest&&this._tileJSONRequest.cancel(),h(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},f.prototype.setTiles=function(h){var d=this;return this.setSourceProperty(function(){d._options.tiles=h}),this},f.prototype.setUrl=function(h){var d=this;return this.setSourceProperty(function(){d.url=h,d._options.url=h}),this},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return s.extend({},this._options)},f.prototype.loadTile=function(h,d){var _=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(_,s.ResourceType.Tile),uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function E(A,k){return delete h.request,h.aborted?d(null):A&&A.status!==404?d(A):(k&&k.resourceTiming&&(h.resourceTiming=k.resourceTiming),this.map._refreshExpiredTiles&&k&&h.setExpiryData(k),h.loadVectorData(k,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),d(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired"?h.state==="loading"?h.reloadCallback=d:h.request=h.actor.send("reloadTile",w,E.bind(this)):(h.actor=this.dispatcher.getActor(),h.request=h.actor.send("loadTile",w,E.bind(this)))},f.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id},void 0)},f.prototype.unloadTile=function(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id},void 0)},f.prototype.hasTransition=function(){return!1},f}(s.Evented),ut=function(c){function f(h,d,_,w){c.call(this),this.id=h,this.dispatcher=_,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},d),s.extend(this,s.pick(d,["url","scheme","tileSize"]))}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=nr(this._options,this.map._requestManager,function(d,_){h._tileJSONRequest=null,h._loaded=!0,d?h.fire(new s.ErrorEvent(d)):_&&(s.extend(h,_),_.bounds&&(h.tileBounds=new rr(_.bounds,h.minzoom,h.maxzoom)),s.postTurnstileEvent(_.tiles),s.postMapLoadEvent(_.tiles,h.map._getMapId(),h.map._requestManager._skuToken),h.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return s.extend({},this._options)},f.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},f.prototype.loadTile=function(h,d){var _=this,w=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);h.request=s.getImage(this.map._requestManager.transformRequest(w,s.ResourceType.Tile),function(E,A){if(delete h.request,h.aborted)h.state="unloaded",d(null);else if(E)h.state="errored",d(E);else if(A){_.map._refreshExpiredTiles&&h.setExpiryData(A),delete A.cacheControl,delete A.expires;var k=_.map.painter.context,z=k.gl;h.texture=_.map.painter.getTileTexture(A.width),h.texture?h.texture.update(A,{useMipmap:!0}):(h.texture=new s.Texture(k,A,z.RGBA,{useMipmap:!0}),h.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),k.extTextureFilterAnisotropic&&z.texParameterf(z.TEXTURE_2D,k.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,k.extTextureFilterAnisotropicMax)),h.state="loaded",s.cacheEntryPossiblyAdded(_.dispatcher),d(null)}})},f.prototype.abortTile=function(h,d){h.request&&(h.request.cancel(),delete h.request),d()},f.prototype.unloadTile=function(h,d){h.texture&&this.map.painter.saveTileTexture(h.texture),d()},f.prototype.hasTransition=function(){return!1},f}(s.Evented),Mt=function(c){function f(h,d,_,w){c.call(this,h,d,_,w),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},f.prototype.loadTile=function(h,d){var _=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function w(E,A){E&&(h.state="errored",d(E)),A&&(h.dem=A,h.needsHillshadePrepare=!0,h.state="loaded",d(null))}h.request=s.getImage(this.map._requestManager.transformRequest(_,s.ResourceType.Tile),(function(E,A){if(delete h.request,h.aborted)h.state="unloaded",d(null);else if(E)h.state="errored",d(E);else if(A){this.map._refreshExpiredTiles&&h.setExpiryData(A),delete A.cacheControl,delete A.expires;var k=s.window.ImageBitmap&&A instanceof s.window.ImageBitmap&&s.offscreenCanvasSupported()?A:s.browser.getImageData(A,1),z={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:k,encoding:this.encoding};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",z,w.bind(this)))}}).bind(this)),h.neighboringTiles=this._getNeighboringTiles(h.tileID)},f.prototype._getNeighboringTiles=function(h){var d=h.canonical,_=Math.pow(2,d.z),w=(d.x-1+_)%_,E=d.x===0?h.wrap-1:h.wrap,A=(d.x+1+_)%_,k=d.x+1===_?h.wrap+1:h.wrap,z={};return z[new s.OverscaledTileID(h.overscaledZ,E,d.z,w,d.y).key]={backfilled:!1},z[new s.OverscaledTileID(h.overscaledZ,k,d.z,A,d.y).key]={backfilled:!1},d.y>0&&(z[new s.OverscaledTileID(h.overscaledZ,E,d.z,w,d.y-1).key]={backfilled:!1},z[new s.OverscaledTileID(h.overscaledZ,h.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},z[new s.OverscaledTileID(h.overscaledZ,k,d.z,A,d.y-1).key]={backfilled:!1}),d.y+1<_&&(z[new s.OverscaledTileID(h.overscaledZ,E,d.z,w,d.y+1).key]={backfilled:!1},z[new s.OverscaledTileID(h.overscaledZ,h.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},z[new s.OverscaledTileID(h.overscaledZ,k,d.z,A,d.y+1).key]={backfilled:!1}),z},f.prototype.unloadTile=function(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded",h.actor&&h.actor.send("removeDEMTile",{uid:h.uid,source:this.id})},f}(ut),Ot=function(c){function f(h,d,_,w){c.call(this),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=_.getActor(),this.setEventedParent(w),this._data=d.data,this._options=s.extend({},d),this._collectResourceTiming=d.collectResourceTiming,this._resourceTiming=[],d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;var E=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*E,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*E,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?Math.min(d.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:s.EXTENT,radius:(d.clusterRadius||50)*E,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.load=function(){var h=this;this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(d){if(d)h.fire(new s.ErrorEvent(d));else{var _={dataType:"source",sourceDataType:"metadata"};h._collectResourceTiming&&h._resourceTiming&&h._resourceTiming.length>0&&(_.resourceTiming=h._resourceTiming,h._resourceTiming=[]),h.fire(new s.Event("data",_))}})},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.setData=function(h){var d=this;return this._data=h,this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(_){if(_)d.fire(new s.ErrorEvent(_));else{var w={dataType:"source",sourceDataType:"content"};d._collectResourceTiming&&d._resourceTiming&&d._resourceTiming.length>0&&(w.resourceTiming=d._resourceTiming,d._resourceTiming=[]),d.fire(new s.Event("data",w))}}),this},f.prototype.getClusterExpansionZoom=function(h,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},d),this},f.prototype.getClusterChildren=function(h,d){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},d),this},f.prototype.getClusterLeaves=function(h,d,_,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:d,offset:_},w),this},f.prototype._updateWorkerData=function(h){var d=this;this._loaded=!1;var _=s.extend({},this.workerOptions),w=this._data;typeof w=="string"?(_.request=this.map._requestManager.transformRequest(s.browser.resolveURL(w),s.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(w),this.actor.send(this.type+".loadData",_,function(E,A){d._removed||A&&A.abandoned||(d._loaded=!0,A&&A.resourceTiming&&A.resourceTiming[d.id]&&(d._resourceTiming=A.resourceTiming[d.id].slice(0)),d.actor.send(d.type+".coalesce",{source:_.source},null),h(E))})},f.prototype.loaded=function(){return this._loaded},f.prototype.loadTile=function(h,d){var _=this,w=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(w,{type:this.type,uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(E,A){return delete h.request,h.unloadVectorData(),h.aborted?d(null):E?d(E):(h.loadVectorData(A,_.map.painter,w==="reloadTile"),d(null))})},f.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0},f.prototype.unloadTile=function(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})},f.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},f.prototype.serialize=function(){return s.extend({},this._options,{type:this.type,data:this._data})},f.prototype.hasTransition=function(){return!1},f}(s.Evented),Qt=s.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),en=function(c){function f(h,d,_,w){c.call(this),this.id=h,this.dispatcher=_,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=d}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.load=function(h,d){var _=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),function(w,E){_._loaded=!0,w?_.fire(new s.ErrorEvent(w)):E&&(_.image=E,h&&(_.coordinates=h),d&&d(),_._finishLoading())})},f.prototype.loaded=function(){return this._loaded},f.prototype.updateImage=function(h){var d=this;return this.image&&h.url?(this.options.url=h.url,this.load(h.coordinates,function(){d.texture=null}),this):this},f.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.setCoordinates=function(h){var d=this;this.coordinates=h;var _=h.map(s.MercatorCoordinate.fromLngLat);this.tileID=function(E){for(var A=1/0,k=1/0,z=-1/0,Z=-1/0,Y=0,$=E;Y<$.length;Y+=1){var oe=$[Y];A=Math.min(A,oe.x),k=Math.min(k,oe.y),z=Math.max(z,oe.x),Z=Math.max(Z,oe.y)}var re=Math.max(z-A,Z-k),ue=Math.max(0,Math.floor(-Math.log(re)/Math.LN2)),ee=Math.pow(2,ue);return new s.CanonicalTileID(ue,Math.floor((A+z)/2*ee),Math.floor((k+Z)/2*ee))}(_),this.minzoom=this.maxzoom=this.tileID.z;var w=_.map(function(E){return d.tileID.getTilePoint(E)._round()});return this._boundsArray=new s.StructArrayLayout4i8,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,s.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,s.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,s.EXTENT,s.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this},f.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var h=this.map.painter.context,d=h.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Qt.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new s.Texture(h,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},f.prototype.loadTile=function(h,d){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},d(null)):(h.state="errored",d(null))},f.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return!1},f}(s.Evented),vi=function(c){function f(h,d,_,w){c.call(this,h,d,_,w),this.roundZoom=!0,this.type="video",this.options=d}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.load=function(){var h=this;this._loaded=!1;var d=this.options;this.urls=[];for(var _=0,w=d.urls;_<w.length;_+=1)this.urls.push(this.map._requestManager.transformRequest(w[_],s.ResourceType.Source).url);s.getVideo(this.urls,function(E,A){h._loaded=!0,E?h.fire(new s.ErrorEvent(E)):A&&(h.video=A,h.video.loop=!0,h.video.setAttribute("playsinline",""),h.video.addEventListener("playing",function(){h.map.triggerRepaint()}),h.map&&h.video.play(),h._finishLoading())})},f.prototype.pause=function(){this.video&&this.video.pause()},f.prototype.play=function(){this.video&&this.video.play()},f.prototype.seek=function(h){if(this.video){var d=this.video.seekable;h<d.start(0)||h>d.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+d.start(0)+" and "+d.end(0)+"-second mark."))):this.video.currentTime=h}},f.prototype.getVideo=function(){return this.video},f.prototype.onAdd=function(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},f.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var h=this.map.painter.context,d=h.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Qt.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(h,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this.tiles){var w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this.video&&!this.video.paused},f}(en),Ir=function(c){function f(h,d,_,w){c.call(this,h,d,_,w),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(function(E){return!Array.isArray(E)||E.length!==2||E.some(function(A){return typeof A!="number"})})||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+h,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+h,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError("sources."+h,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+h,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+h,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},f.prototype.getCanvas=function(){return this.canvas},f.prototype.onAdd=function(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()},f.prototype.onRemove=function(){this.pause()},f.prototype.prepare=function(){var h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var d=this.map.painter.context,_=d.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,Qt.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(d,this.canvas,_.RGBA,{premultiply:!0}),this.tiles){var E=this.tiles[w];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this._playing},f.prototype._hasInvalidDimensions=function(){for(var h=0,d=[this.canvas.width,this.canvas.height];h<d.length;h+=1){var _=d[h];if(isNaN(_)||_<=0)return!0}return!1},f}(en),_i={vector:Pr,raster:ut,"raster-dem":Mt,geojson:Ot,video:vi,image:en,canvas:Ir};function Fi(c,f){var h=s.identity([]);return s.translate(h,h,[1,1,0]),s.scale(h,h,[.5*c.width,.5*c.height,1]),s.multiply(h,h,c.calculatePosMatrix(f.toUnwrapped()))}function an(c,f,h,d,_,w){var E=function(ue,ee,le){if(ue)for(var ge=0,be=ue;ge<be.length;ge+=1){var Ce=ee[be[ge]];if(Ce&&Ce.source===le&&Ce.type==="fill-extrusion")return!0}else for(var Pe in ee){var ke=ee[Pe];if(ke.source===le&&ke.type==="fill-extrusion")return!0}return!1}(_&&_.layers,f,c.id),A=w.maxPitchScaleFactor(),k=c.tilesIn(d,A,E);k.sort(Wr);for(var z=[],Z=0,Y=k;Z<Y.length;Z+=1){var $=Y[Z];z.push({wrappedTileID:$.tileID.wrapped().key,queryResults:$.tile.queryRenderedFeatures(f,h,c._state,$.queryGeometry,$.cameraQueryGeometry,$.scale,_,w,A,Fi(c.transform,$.tileID))})}var oe=function(ue){for(var ee={},le={},ge=0,be=ue;ge<be.length;ge+=1){var Ce=be[ge],Pe=Ce.queryResults,ke=Ce.wrappedTileID,ze=le[ke]=le[ke]||{};for(var He in Pe)for(var We=Pe[He],nt=ze[He]=ze[He]||{},dt=ee[He]=ee[He]||[],vt=0,yt=We;vt<yt.length;vt+=1){var nn=yt[vt];nt[nn.featureIndex]||(nt[nn.featureIndex]=!0,dt.push(nn))}}return ee}(z);for(var re in oe)oe[re].forEach(function(ue){var ee=ue.feature,le=c.getFeatureState(ee.layer["source-layer"],ee.id);ee.source=ee.layer.source,ee.layer["source-layer"]&&(ee.sourceLayer=ee.layer["source-layer"]),ee.state=le});return oe}function Wr(c,f){var h=c.tileID,d=f.tileID;return h.overscaledZ-d.overscaledZ||h.canonical.y-d.canonical.y||h.wrap-d.wrap||h.canonical.x-d.canonical.x}var Dt=function(c,f){this.max=c,this.onRemove=f,this.reset()};Dt.prototype.reset=function(){for(var c in this.data)for(var f=0,h=this.data[c];f<h.length;f+=1){var d=h[f];d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value)}return this.data={},this.order=[],this},Dt.prototype.add=function(c,f,h){var d=this,_=c.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);var w={value:f,timeout:void 0};if(h!==void 0&&(w.timeout=setTimeout(function(){d.remove(c,w)},h)),this.data[_].push(w),this.order.push(_),this.order.length>this.max){var E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this},Dt.prototype.has=function(c){return c.wrapped().key in this.data},Dt.prototype.getAndRemove=function(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null},Dt.prototype._getAndRemoveByKey=function(c){var f=this.data[c].shift();return f.timeout&&clearTimeout(f.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),f.value},Dt.prototype.getByKey=function(c){var f=this.data[c];return f?f[0].value:null},Dt.prototype.get=function(c){return this.has(c)?this.data[c.wrapped().key][0].value:null},Dt.prototype.remove=function(c,f){if(!this.has(c))return this;var h=c.wrapped().key,d=f===void 0?0:this.data[h].indexOf(f),_=this.data[h][d];return this.data[h].splice(d,1),_.timeout&&clearTimeout(_.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(_.value),this.order.splice(this.order.indexOf(h),1),this},Dt.prototype.setMaxSize=function(c){for(this.max=c;this.order.length>this.max;){var f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this},Dt.prototype.filter=function(c){var f=[];for(var h in this.data)for(var d=0,_=this.data[h];d<_.length;d+=1){var w=_[d];c(w.value)||f.push(w)}for(var E=0,A=f;E<A.length;E+=1){var k=A[E];this.remove(k.value.tileID,k)}};var Dn=function(c,f,h){this.context=c;var d=c.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer};Dn.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Dn.prototype.updateData=function(c){var f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)},Dn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var go={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Hr=function(c,f,h,d){this.length=f.length,this.attributes=h,this.itemSize=f.bytesPerElement,this.dynamicDraw=d,this.context=c;var _=c.gl;this.buffer=_.createBuffer(),c.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer};Hr.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Hr.prototype.updateData=function(c){var f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,c.arrayBuffer)},Hr.prototype.enableAttributes=function(c,f){for(var h=0;h<this.attributes.length;h++){var d=f.attributes[this.attributes[h].name];d!==void 0&&c.enableVertexAttribArray(d)}},Hr.prototype.setVertexAttribPointers=function(c,f,h){for(var d=0;d<this.attributes.length;d++){var _=this.attributes[d],w=f.attributes[_.name];w!==void 0&&c.vertexAttribPointer(w,_.components,c[go[_.type]],!1,this.itemSize,_.offset+this.itemSize*(h||0))}},Hr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Vt=function(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Vt.prototype.get=function(){return this.current},Vt.prototype.set=function(c){},Vt.prototype.getDefault=function(){return this.default},Vt.prototype.setDefault=function(){this.set(this.default)};var xi=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return s.Color.transparent},f.prototype.set=function(h){var d=this.current;(h.r!==d.r||h.g!==d.g||h.b!==d.b||h.a!==d.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},f}(Vt),hr=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return 1},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)},f}(Vt),Zn=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return 0},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)},f}(Vt),yo=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return[!0,!0,!0,!0]},f.prototype.set=function(h){var d=this.current;(h[0]!==d[0]||h[1]!==d[1]||h[2]!==d[2]||h[3]!==d[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},f}(Vt),bi=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return!0},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)},f}(Vt),Aa=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return 255},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)},f}(Vt),qr=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},f.prototype.set=function(h){var d=this.current;(h.func!==d.func||h.ref!==d.ref||h.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)},f}(Vt),_r=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){var h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]},f.prototype.set=function(h){var d=this.current;(h[0]!==d[0]||h[1]!==d[1]||h[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)},f}(Vt),Pa=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;h?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=h,this.dirty=!1}},f}(Vt),wi=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return[0,1]},f.prototype.set=function(h){var d=this.current;(h[0]!==d[0]||h[1]!==d[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)},f}(Vt),Ei=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;h?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=h,this.dirty=!1}},f}(Vt),ta=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.LESS},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)},f}(Vt),Ui=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;h?d.enable(d.BLEND):d.disable(d.BLEND),this.current=h,this.dirty=!1}},f}(Vt),xs=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){var h=this.gl;return[h.ONE,h.ZERO]},f.prototype.set=function(h){var d=this.current;(h[0]!==d[0]||h[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)},f}(Vt),bs=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return s.Color.transparent},f.prototype.set=function(h){var d=this.current;(h.r!==d.r||h.g!==d.g||h.b!==d.b||h.a!==d.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},f}(Vt),Ia=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.FUNC_ADD},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)},f}(Vt),Ca=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;h?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=h,this.dirty=!1}},f}(Vt),vo=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.BACK},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)},f}(Vt),Ma=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.CCW},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)},f}(Vt),ka=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)},f}(Vt),ws=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.TEXTURE0},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)},f}(Vt),na=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){var h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]},f.prototype.set=function(h){var d=this.current;(h[0]!==d[0]||h[1]!==d[1]||h[2]!==d[2]||h[3]!==d[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},f}(Vt),Es=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,h),this.current=h,this.dirty=!1}},f}(Vt),Ts=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,h),this.current=h,this.dirty=!1}},f}(Vt),ra=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.bindTexture(d.TEXTURE_2D,h),this.current=h,this.dirty=!1}},f}(Vt),_l=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}},f}(Vt),ia=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){var d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1},f}(Vt),Qi=function(c){function f(h){c.call(this,h),this.vao=h.extVertexArrayObject}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)},f}(Vt),eo=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return 4},f.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}},f}(Vt),Fo=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}},f}(Vt),Ss=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}},f}(Vt),zn=function(c){function f(h,d){c.call(this,h),this.context=h,this.parent=d}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f}(Vt),O=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.setDirty=function(){this.dirty=!0},f.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}},f}(zn),N=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,h),this.current=h,this.dirty=!1}},f}(zn),j=function(c,f,h,d){this.context=c,this.width=f,this.height=h;var _=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new O(c,_),d&&(this.depthAttachment=new N(c,_))};j.prototype.destroy=function(){var c=this.context.gl,f=this.colorAttachment.get();if(f&&c.deleteTexture(f),this.depthAttachment){var h=this.depthAttachment.get();h&&c.deleteRenderbuffer(h)}c.deleteFramebuffer(this.framebuffer)};var J=function(c,f,h){this.func=c,this.mask=f,this.range=h};J.ReadOnly=!1,J.ReadWrite=!0,J.disabled=new J(519,J.ReadOnly,[0,1]);var ie=function(c,f,h,d,_,w){this.test=c,this.ref=f,this.mask=h,this.fail=d,this.depthFail=_,this.pass=w};ie.disabled=new ie({func:519,mask:0},0,0,7680,7680,7680);var de=function(c,f,h){this.blendFunction=c,this.blendColor=f,this.mask=h};de.disabled=new de(de.Replace=[1,0],s.Color.transparent,[!1,!1,!1,!1]),de.unblended=new de(de.Replace,s.Color.transparent,[!0,!0,!0,!0]),de.alphaBlended=new de([1,771],s.Color.transparent,[!0,!0,!0,!0]);var me=function(c,f,h){this.enable=c,this.mode=f,this.frontFace=h};me.disabled=new me(!1,1029,2305),me.backCCW=new me(!0,1029,2305);var X=function(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new xi(this),this.clearDepth=new hr(this),this.clearStencil=new Zn(this),this.colorMask=new yo(this),this.depthMask=new bi(this),this.stencilMask=new Aa(this),this.stencilFunc=new qr(this),this.stencilOp=new _r(this),this.stencilTest=new Pa(this),this.depthRange=new wi(this),this.depthTest=new Ei(this),this.depthFunc=new ta(this),this.blend=new Ui(this),this.blendFunc=new xs(this),this.blendColor=new bs(this),this.blendEquation=new Ia(this),this.cullFace=new Ca(this),this.cullFaceSide=new vo(this),this.frontFace=new Ma(this),this.program=new ka(this),this.activeTexture=new ws(this),this.viewport=new na(this),this.bindFramebuffer=new Es(this),this.bindRenderbuffer=new Ts(this),this.bindTexture=new ra(this),this.bindVertexBuffer=new _l(this),this.bindElementBuffer=new ia(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Qi(this),this.pixelStoreUnpack=new eo(this),this.pixelStoreUnpackPremultiplyAlpha=new Fo(this),this.pixelStoreUnpackFlipY=new Ss(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)};X.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},X.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},X.prototype.createIndexBuffer=function(c,f){return new Dn(this,c,f)},X.prototype.createVertexBuffer=function(c,f,h){return new Hr(this,c,f,h)},X.prototype.createRenderbuffer=function(c,f,h){var d=this.gl,_=d.createRenderbuffer();return this.bindRenderbuffer.set(_),d.renderbufferStorage(d.RENDERBUFFER,c,f,h),this.bindRenderbuffer.set(null),_},X.prototype.createFramebuffer=function(c,f,h){return new j(this,c,f,h)},X.prototype.clear=function(c){var f=c.color,h=c.depth,d=this.gl,_=0;f&&(_|=d.COLOR_BUFFER_BIT,this.clearColor.set(f),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(_|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),d.clear(_)},X.prototype.setCullFace=function(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))},X.prototype.setDepthMode=function(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)},X.prototype.setStencilMode=function(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)},X.prototype.setColorMode=function(c){s.deepEqual(c.blendFunction,de.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)},X.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ae=function(c){function f(h,d,_){var w=this;c.call(this),this.id=h,this.dispatcher=_,this.on("data",function(E){E.dataType==="source"&&E.sourceDataType==="metadata"&&(w._sourceLoaded=!0),w._sourceLoaded&&!w._paused&&E.dataType==="source"&&E.sourceDataType==="content"&&(w.reload(),w.transform&&w.update(w.transform))}),this.on("error",function(){w._sourceErrored=!0}),this._source=function(E,A,k,z){var Z=new _i[A.type](E,A,k,z);if(Z.id!==E)throw new Error("Expected Source id to be "+E+" instead of "+Z.id);return s.bindAll(["load","abort","unload","serialize","prepare"],Z),Z}(h,d,_,this),this._tiles={},this._cache=new Dt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new s.SourceFeatureState}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.onAdd=function(h){this.map=h,this._maxTileCacheSize=h?h._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(h)},f.prototype.onRemove=function(h){this._source&&this._source.onRemove&&this._source.onRemove(h)},f.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var h in this._tiles){var d=this._tiles[h];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0},f.prototype.getSource=function(){return this._source},f.prototype.pause=function(){this._paused=!0},f.prototype.resume=function(){if(this._paused){var h=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,h&&this.reload(),this.transform&&this.update(this.transform)}},f.prototype._loadTile=function(h,d){return this._source.loadTile(h,d)},f.prototype._unloadTile=function(h){if(this._source.unloadTile)return this._source.unloadTile(h,function(){})},f.prototype._abortTile=function(h){if(this._source.abortTile)return this._source.abortTile(h,function(){})},f.prototype.serialize=function(){return this._source.serialize()},f.prototype.prepare=function(h){for(var d in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var _=this._tiles[d];_.upload(h),_.prepare(this.map.style.imageManager)}},f.prototype.getIds=function(){return s.values(this._tiles).map(function(h){return h.tileID}).sort(_e).map(function(h){return h.key})},f.prototype.getRenderableIds=function(h){var d=this,_=[];for(var w in this._tiles)this._isIdRenderable(w,h)&&_.push(this._tiles[w]);return h?_.sort(function(E,A){var k=E.tileID,z=A.tileID,Z=new s.Point(k.canonical.x,k.canonical.y)._rotate(d.transform.angle),Y=new s.Point(z.canonical.x,z.canonical.y)._rotate(d.transform.angle);return k.overscaledZ-z.overscaledZ||Y.y-Z.y||Y.x-Z.x}).map(function(E){return E.tileID.key}):_.map(function(E){return E.tileID}).sort(_e).map(function(E){return E.key})},f.prototype.hasRenderableParent=function(h){var d=this.findLoadedParent(h,0);return!!d&&this._isIdRenderable(d.tileID.key)},f.prototype._isIdRenderable=function(h,d){return this._tiles[h]&&this._tiles[h].hasData()&&!this._coveredTiles[h]&&(d||!this._tiles[h].holdingForFade())},f.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var h in this._cache.reset(),this._tiles)this._tiles[h].state!=="errored"&&this._reloadTile(h,"reloading")},f.prototype._reloadTile=function(h,d){var _=this._tiles[h];_&&(_.state!=="loading"&&(_.state=d),this._loadTile(_,this._tileLoaded.bind(this,_,h,d)))},f.prototype._tileLoaded=function(h,d,_,w){if(w)return h.state="errored",void(w.status!==404?this._source.fire(new s.ErrorEvent(w,{tile:h})):this.update(this.transform));h.timeAdded=s.browser.now(),_==="expired"&&(h.refreshedUponExpiration=!0),this._setTileReloadTimer(d,h),this.getSource().type==="raster-dem"&&h.dem&&this._backfillDEM(h),this._state.initializeTileState(h,this.map?this.map.painter:null),this._source.fire(new s.Event("data",{dataType:"source",tile:h,coord:h.tileID}))},f.prototype._backfillDEM=function(h){for(var d=this.getRenderableIds(),_=0;_<d.length;_++){var w=d[_];if(h.neighboringTiles&&h.neighboringTiles[w]){var E=this.getTileByID(w);A(h,E),A(E,h)}}function A(k,z){k.needsHillshadePrepare=!0;var Z=z.tileID.canonical.x-k.tileID.canonical.x,Y=z.tileID.canonical.y-k.tileID.canonical.y,$=Math.pow(2,k.tileID.canonical.z),oe=z.tileID.key;Z===0&&Y===0||Math.abs(Y)>1||(Math.abs(Z)>1&&(Math.abs(Z+$)===1?Z+=$:Math.abs(Z-$)===1&&(Z-=$)),z.dem&&k.dem&&(k.dem.backfillBorder(z.dem,Z,Y),k.neighboringTiles&&k.neighboringTiles[oe]&&(k.neighboringTiles[oe].backfilled=!0)))}},f.prototype.getTile=function(h){return this.getTileByID(h.key)},f.prototype.getTileByID=function(h){return this._tiles[h]},f.prototype._retainLoadedChildren=function(h,d,_,w){for(var E in this._tiles){var A=this._tiles[E];if(!(w[E]||!A.hasData()||A.tileID.overscaledZ<=d||A.tileID.overscaledZ>_)){for(var k=A.tileID;A&&A.tileID.overscaledZ>d+1;){var z=A.tileID.scaledTo(A.tileID.overscaledZ-1);(A=this._tiles[z.key])&&A.hasData()&&(k=z)}for(var Z=k;Z.overscaledZ>d;)if(h[(Z=Z.scaledTo(Z.overscaledZ-1)).key]){w[k.key]=k;break}}}},f.prototype.findLoadedParent=function(h,d){if(h.key in this._loadedParentTiles){var _=this._loadedParentTiles[h.key];return _&&_.tileID.overscaledZ>=d?_:null}for(var w=h.overscaledZ-1;w>=d;w--){var E=h.scaledTo(w),A=this._getLoadedTile(E);if(A)return A}},f.prototype._getLoadedTile=function(h){var d=this._tiles[h.key];return d&&d.hasData()?d:this._cache.getByKey(h.wrapped().key)},f.prototype.updateCacheSize=function(h){var d=Math.ceil(h.width/this._source.tileSize)+1,_=Math.ceil(h.height/this._source.tileSize)+1,w=Math.floor(d*_*5),E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(E)},f.prototype.handleWrapJump=function(h){var d=Math.round((h-(this._prevLng===void 0?h:this._prevLng))/360);if(this._prevLng=h,d){var _={};for(var w in this._tiles){var E=this._tiles[w];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+d),_[E.tileID.key]=E}for(var A in this._tiles=_,this._timers)clearTimeout(this._timers[A]),delete this._timers[A];for(var k in this._tiles)this._setTileReloadTimer(k,this._tiles[k])}},f.prototype.update=function(h){var d=this;if(this.transform=h,this._sourceLoaded&&!this._paused){var _;this.updateCacheSize(h),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?_=h.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(ze){return new s.OverscaledTileID(ze.canonical.z,ze.wrap,ze.canonical.z,ze.canonical.x,ze.canonical.y)}):(_=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(_=_.filter(function(ze){return d._source.hasTile(ze)}))):_=[];var w=h.coveringZoomLevel(this._source),E=Math.max(w-f.maxOverzooming,this._source.minzoom),A=Math.max(w+f.maxUnderzooming,this._source.minzoom),k=this._updateRetainedTiles(_,w);if(Be(this._source.type)){for(var z={},Z={},Y=0,$=Object.keys(k);Y<$.length;Y+=1){var oe=$[Y],re=k[oe],ue=this._tiles[oe];if(ue&&!(ue.fadeEndTime&&ue.fadeEndTime<=s.browser.now())){var ee=this.findLoadedParent(re,E);ee&&(this._addTile(ee.tileID),z[ee.tileID.key]=ee.tileID),Z[oe]=re}}for(var le in this._retainLoadedChildren(Z,w,A,k),z)k[le]||(this._coveredTiles[le]=!0,k[le]=z[le])}for(var ge in k)this._tiles[ge].clearFadeHold();for(var be=0,Ce=s.keysDifference(this._tiles,k);be<Ce.length;be+=1){var Pe=Ce[be],ke=this._tiles[Pe];ke.hasSymbolBuckets&&!ke.holdingForFade()?ke.setHoldDuration(this.map._fadeDuration):ke.hasSymbolBuckets&&!ke.symbolFadeFinished()||this._removeTile(Pe)}this._updateLoadedParentTileCache()}},f.prototype.releaseSymbolFadeTiles=function(){for(var h in this._tiles)this._tiles[h].holdingForFade()&&this._removeTile(h)},f.prototype._updateRetainedTiles=function(h,d){for(var _={},w={},E=Math.max(d-f.maxOverzooming,this._source.minzoom),A=Math.max(d+f.maxUnderzooming,this._source.minzoom),k={},z=0,Z=h;z<Z.length;z+=1){var Y=Z[z],$=this._addTile(Y);_[Y.key]=Y,$.hasData()||d<this._source.maxzoom&&(k[Y.key]=Y)}this._retainLoadedChildren(k,d,A,_);for(var oe=0,re=h;oe<re.length;oe+=1){var ue=re[oe],ee=this._tiles[ue.key];if(!ee.hasData()){if(d+1>this._source.maxzoom){var le=ue.children(this._source.maxzoom)[0],ge=this.getTile(le);if(ge&&ge.hasData()){_[le.key]=le;continue}}else{var be=ue.children(this._source.maxzoom);if(_[be[0].key]&&_[be[1].key]&&_[be[2].key]&&_[be[3].key])continue}for(var Ce=ee.wasRequested(),Pe=ue.overscaledZ-1;Pe>=E;--Pe){var ke=ue.scaledTo(Pe);if(w[ke.key]||(w[ke.key]=!0,!(ee=this.getTile(ke))&&Ce&&(ee=this._addTile(ke)),ee&&(_[ke.key]=ke,Ce=ee.wasRequested(),ee.hasData())))break}}}return _},f.prototype._updateLoadedParentTileCache=function(){for(var h in this._loadedParentTiles={},this._tiles){for(var d=[],_=void 0,w=this._tiles[h].tileID;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){_=this._loadedParentTiles[w.key];break}d.push(w.key);var E=w.scaledTo(w.overscaledZ-1);if(_=this._getLoadedTile(E))break;w=E}for(var A=0,k=d;A<k.length;A+=1)this._loadedParentTiles[k[A]]=_}},f.prototype._addTile=function(h){var d=this._tiles[h.key];if(d)return d;(d=this._cache.getAndRemove(h))&&(this._setTileReloadTimer(h.key,d),d.tileID=h,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[h.key]&&(clearTimeout(this._cacheTimers[h.key]),delete this._cacheTimers[h.key],this._setTileReloadTimer(h.key,d)));var _=!!d;return _||(d=new s.Tile(h,this._source.tileSize*h.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,h.key,d.state))),d?(d.uses++,this._tiles[h.key]=d,_||this._source.fire(new s.Event("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d):null},f.prototype._setTileReloadTimer=function(h,d){var _=this;h in this._timers&&(clearTimeout(this._timers[h]),delete this._timers[h]);var w=d.getExpiryTimeout();w&&(this._timers[h]=setTimeout(function(){_._reloadTile(h,"expired"),delete _._timers[h]},w))},f.prototype._removeTile=function(h){var d=this._tiles[h];d&&(d.uses--,delete this._tiles[h],this._timers[h]&&(clearTimeout(this._timers[h]),delete this._timers[h]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))},f.prototype.clearTiles=function(){for(var h in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(h);this._cache.reset()},f.prototype.tilesIn=function(h,d,_){var w=this,E=[],A=this.transform;if(!A)return E;for(var k=_?A.getCameraQueryGeometry(h):h,z=h.map(function(Pe){return A.pointCoordinate(Pe)}),Z=k.map(function(Pe){return A.pointCoordinate(Pe)}),Y=this.getIds(),$=1/0,oe=1/0,re=-1/0,ue=-1/0,ee=0,le=Z;ee<le.length;ee+=1){var ge=le[ee];$=Math.min($,ge.x),oe=Math.min(oe,ge.y),re=Math.max(re,ge.x),ue=Math.max(ue,ge.y)}for(var be=function(Pe){var ke=w._tiles[Y[Pe]];if(!ke.holdingForFade()){var ze=ke.tileID,He=Math.pow(2,A.zoom-ke.tileID.overscaledZ),We=d*ke.queryPadding*s.EXTENT/ke.tileSize/He,nt=[ze.getTilePoint(new s.MercatorCoordinate($,oe)),ze.getTilePoint(new s.MercatorCoordinate(re,ue))];if(nt[0].x-We<s.EXTENT&&nt[0].y-We<s.EXTENT&&nt[1].x+We>=0&&nt[1].y+We>=0){var dt=z.map(function(yt){return ze.getTilePoint(yt)}),vt=Z.map(function(yt){return ze.getTilePoint(yt)});E.push({tile:ke,tileID:ze,queryGeometry:dt,cameraQueryGeometry:vt,scale:He})}}},Ce=0;Ce<Y.length;Ce++)be(Ce);return E},f.prototype.getVisibleCoordinates=function(h){for(var d=this,_=this.getRenderableIds(h).map(function(k){return d._tiles[k].tileID}),w=0,E=_;w<E.length;w+=1){var A=E[w];A.posMatrix=this.transform.calculatePosMatrix(A.toUnwrapped())}return _},f.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Be(this._source.type))for(var h in this._tiles){var d=this._tiles[h];if(d.fadeEndTime!==void 0&&d.fadeEndTime>=s.browser.now())return!0}return!1},f.prototype.setFeatureState=function(h,d,_){this._state.updateState(h=h||"_geojsonTileLayer",d,_)},f.prototype.removeFeatureState=function(h,d,_){this._state.removeFeatureState(h=h||"_geojsonTileLayer",d,_)},f.prototype.getFeatureState=function(h,d){return this._state.getState(h=h||"_geojsonTileLayer",d)},f.prototype.setDependencies=function(h,d,_){var w=this._tiles[h];w&&w.setDependencies(d,_)},f.prototype.reloadTilesForDependencies=function(h,d){for(var _ in this._tiles)this._tiles[_].hasDependency(h,d)&&this._reloadTile(_,"reloading");this._cache.filter(function(w){return!w.hasDependency(h,d)})},f}(s.Evented);function _e(c,f){var h=Math.abs(2*c.wrap)-+(c.wrap<0),d=Math.abs(2*f.wrap)-+(f.wrap<0);return c.overscaledZ-f.overscaledZ||d-h||f.canonical.y-c.canonical.y||f.canonical.x-c.canonical.x}function Be(c){return c==="raster"||c==="image"||c==="video"}function Ue(){return new s.window.Worker(Vc.workerUrl)}ae.maxOverzooming=10,ae.maxUnderzooming=3;var Me="mapboxgl_preloaded_worker_pool",Ne=function(){this.active={}};Ne.prototype.acquire=function(c){if(!this.workers)for(this.workers=[];this.workers.length<Ne.workerCount;)this.workers.push(new Ue);return this.active[c]=!0,this.workers.slice()},Ne.prototype.release=function(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(function(f){f.terminate()}),this.workers=null)},Ne.prototype.isPreloaded=function(){return!!this.active[Me]},Ne.prototype.numActive=function(){return Object.keys(this.active).length};var at,rt=Math.floor(s.browser.hardwareConcurrency/2);function Le(){return at||(at=new Ne),at}function Je(c,f){var h={};for(var d in c)d!=="ref"&&(h[d]=c[d]);return s.refProperties.forEach(function(_){_ in f&&(h[_]=f[_])}),h}function qe(c){c=c.slice();for(var f=Object.create(null),h=0;h<c.length;h++)f[c[h].id]=c[h];for(var d=0;d<c.length;d++)"ref"in c[d]&&(c[d]=Je(c[d],f[c[d].ref]));return c}Ne.workerCount=Math.max(Math.min(rt,6),1);var Ze={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function kt(c,f,h){h.push({command:Ze.addSource,args:[c,f[c]]})}function $e(c,f,h){f.push({command:Ze.removeSource,args:[c]}),h[c]=!0}function Ht(c,f,h,d){$e(c,h,d),kt(c,f,h)}function pn(c,f,h){var d;for(d in c[h])if(c[h].hasOwnProperty(d)&&d!=="data"&&!s.deepEqual(c[h][d],f[h][d]))return!1;for(d in f[h])if(f[h].hasOwnProperty(d)&&d!=="data"&&!s.deepEqual(c[h][d],f[h][d]))return!1;return!0}function Gt(c,f,h,d,_,w){var E;for(E in f=f||{},c=c||{})c.hasOwnProperty(E)&&(s.deepEqual(c[E],f[E])||h.push({command:w,args:[d,E,f[E],_]}));for(E in f)f.hasOwnProperty(E)&&!c.hasOwnProperty(E)&&(s.deepEqual(c[E],f[E])||h.push({command:w,args:[d,E,f[E],_]}))}function $t(c){return c.id}function Lt(c,f){return c[f.id]=f,c}var Xn=function(c,f){this.reset(c,f)};Xn.prototype.reset=function(c,f){this.points=c||[],this._distances=[0];for(var h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Xn.prototype.lerp=function(c){if(this.points.length===1)return this.points[0];c=s.clamp(c,0,1);for(var f=1,h=this._distances[f],d=c*this.paddedLength+this.padding;h<d&&f<this._distances.length;)h=this._distances[++f];var _=f-1,w=this._distances[_],E=h-w,A=E>0?(d-w)/E:0;return this.points[_].mult(1-A).add(this.points[f].mult(A))};var Xt=function(c,f,h){var d=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(c/h),this.yCellCount=Math.ceil(f/h);for(var w=0;w<this.xCellCount*this.yCellCount;w++)d.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=f,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0};function dn(c,f,h,d,_){var w=s.create();return f?(s.scale(w,w,[1/_,1/_,1]),h||s.rotateZ(w,w,d.angle)):s.multiply(w,d.labelPlaneMatrix,c),w}function on(c,f,h,d,_){if(f){var w=s.clone(c);return s.scale(w,w,[_,_,1]),h||s.rotateZ(w,w,-d.angle),w}return d.glCoordMatrix}function Rt(c,f){var h=[c.x,c.y,0,1];jn(h,h,f);var d=h[3];return{point:new s.Point(h[0]/d,h[1]/d),signedDistanceFromCamera:d}}function Wt(c,f){return .5+c/f*.5}function zr(c,f){var h=c[0]/c[3],d=c[1]/c[3];return h>=-f[0]&&h<=f[0]&&d>=-f[1]&&d<=f[1]}function La(c,f,h,d,_,w,E,A){var k=d?c.textSizeData:c.iconSizeData,z=s.evaluateSizeForZoom(k,h.transform.zoom),Z=[256/h.width*2+1,256/h.height*2+1],Y=d?c.text.dynamicLayoutVertexArray:c.icon.dynamicLayoutVertexArray;Y.clear();for(var $=c.lineVertexArray,oe=d?c.text.placedSymbolArray:c.icon.placedSymbolArray,re=h.transform.width/h.transform.height,ue=!1,ee=0;ee<oe.length;ee++){var le=oe.get(ee);if(le.hidden||le.writingMode===s.WritingMode.vertical&&!ue)xr(le.numGlyphs,Y);else{ue=!1;var ge=[le.anchorX,le.anchorY,0,1];if(s.transformMat4(ge,ge,f),zr(ge,Z)){var be=Wt(h.transform.cameraToCenterDistance,ge[3]),Ce=s.evaluateSizeForFeature(k,z,le),Pe=E?Ce/be:Ce*be,ke=new s.Point(le.anchorX,le.anchorY),ze=Rt(ke,_).point,He={},We=Ra(le,Pe,!1,A,f,_,w,c.glyphOffsetArray,$,Y,ze,ke,He,re);ue=We.useVertical,(We.notEnoughRoom||ue||We.needsFlipping&&Ra(le,Pe,!0,A,f,_,w,c.glyphOffsetArray,$,Y,ze,ke,He,re).notEnoughRoom)&&xr(le.numGlyphs,Y)}else xr(le.numGlyphs,Y)}}d?c.text.dynamicLayoutVertexBuffer.updateData(Y):c.icon.dynamicLayoutVertexBuffer.updateData(Y)}function Un(c,f,h,d,_,w,E,A,k,z,Z){var Y=A.glyphStartIndex+A.numGlyphs,$=A.lineStartIndex,oe=A.lineStartIndex+A.lineLength,re=f.getoffsetX(A.glyphStartIndex),ue=f.getoffsetX(Y-1),ee=In(c*re,h,d,_,w,E,A.segment,$,oe,k,z,Z);if(!ee)return null;var le=In(c*ue,h,d,_,w,E,A.segment,$,oe,k,z,Z);return le?{first:ee,last:le}:null}function Pn(c,f,h,d){return c===s.WritingMode.horizontal&&Math.abs(h.y-f.y)>Math.abs(h.x-f.x)*d?{useVertical:!0}:(c===s.WritingMode.vertical?f.y<h.y:f.x>h.x)?{needsFlipping:!0}:null}function Ra(c,f,h,d,_,w,E,A,k,z,Z,Y,$,oe){var re,ue=f/24,ee=c.lineOffsetX*ue,le=c.lineOffsetY*ue;if(c.numGlyphs>1){var ge=c.glyphStartIndex+c.numGlyphs,be=c.lineStartIndex,Ce=c.lineStartIndex+c.lineLength,Pe=Un(ue,A,ee,le,h,Z,Y,c,k,w,$);if(!Pe)return{notEnoughRoom:!0};var ke=Rt(Pe.first.point,E).point,ze=Rt(Pe.last.point,E).point;if(d&&!h){var He=Pn(c.writingMode,ke,ze,oe);if(He)return He}re=[Pe.first];for(var We=c.glyphStartIndex+1;We<ge-1;We++)re.push(In(ue*A.getoffsetX(We),ee,le,h,Z,Y,c.segment,be,Ce,k,w,$));re.push(Pe.last)}else{if(d&&!h){var nt=Rt(Y,_).point,dt=c.lineStartIndex+c.segment+1,vt=new s.Point(k.getx(dt),k.gety(dt)),yt=Rt(vt,_),nn=yt.signedDistanceFromCamera>0?yt.point:oa(Y,vt,nt,1,_),it=Pn(c.writingMode,nt,nn,oe);if(it)return it}var It=In(ue*A.getoffsetX(c.glyphStartIndex),ee,le,h,Z,Y,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,k,w,$);if(!It)return{notEnoughRoom:!0};re=[It]}for(var Ut=0,Pt=re;Ut<Pt.length;Ut+=1){var At=Pt[Ut];s.addDynamicAttributes(z,At.point,At.angle)}return{}}function oa(c,f,h,d,_){var w=Rt(c.add(c.sub(f)._unit()),_).point,E=h.sub(w);return h.add(E._mult(d/E.mag()))}function In(c,f,h,d,_,w,E,A,k,z,Z,Y){var $=d?c-f:c+f,oe=$>0?1:-1,re=0;d&&(oe*=-1,re=Math.PI),oe<0&&(re+=Math.PI);for(var ue=oe>0?A+E:A+E+1,ee=_,le=_,ge=0,be=0,Ce=Math.abs($),Pe=[];ge+be<=Ce;){if((ue+=oe)<A||ue>=k)return null;if(le=ee,Pe.push(ee),(ee=Y[ue])===void 0){var ke=new s.Point(z.getx(ue),z.gety(ue)),ze=Rt(ke,Z);if(ze.signedDistanceFromCamera>0)ee=Y[ue]=ze.point;else{var He=ue-oe;ee=oa(ge===0?w:new s.Point(z.getx(He),z.gety(He)),ke,le,Ce-ge+1,Z)}}ge+=be,be=le.dist(ee)}var We=(Ce-ge)/be,nt=ee.sub(le),dt=nt.mult(We)._add(le);dt._add(nt._unit()._perp()._mult(h*oe));var vt=re+Math.atan2(ee.y-le.y,ee.x-le.x);return Pe.push(dt),{point:dt,angle:vt,path:Pe}}Xt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Xt.prototype.insert=function(c,f,h,d,_){this._forEachCell(f,h,d,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(f),this.bboxes.push(h),this.bboxes.push(d),this.bboxes.push(_)},Xt.prototype.insertCircle=function(c,f,h,d){this._forEachCell(f-d,h-d,f+d,h+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(f),this.circles.push(h),this.circles.push(d)},Xt.prototype._insertBoxCell=function(c,f,h,d,_,w){this.boxCells[_].push(w)},Xt.prototype._insertCircleCell=function(c,f,h,d,_,w){this.circleCells[_].push(w)},Xt.prototype._query=function(c,f,h,d,_,w){if(h<0||c>this.width||d<0||f>this.height)return!_&&[];var E=[];if(c<=0&&f<=0&&this.width<=h&&this.height<=d){if(_)return!0;for(var A=0;A<this.boxKeys.length;A++)E.push({key:this.boxKeys[A],x1:this.bboxes[4*A],y1:this.bboxes[4*A+1],x2:this.bboxes[4*A+2],y2:this.bboxes[4*A+3]});for(var k=0;k<this.circleKeys.length;k++){var z=this.circles[3*k],Z=this.circles[3*k+1],Y=this.circles[3*k+2];E.push({key:this.circleKeys[k],x1:z-Y,y1:Z-Y,x2:z+Y,y2:Z+Y})}return w?E.filter(w):E}return this._forEachCell(c,f,h,d,this._queryCell,E,{hitTest:_,seenUids:{box:{},circle:{}}},w),_?E.length>0:E},Xt.prototype._queryCircle=function(c,f,h,d,_){var w=c-h,E=c+h,A=f-h,k=f+h;if(E<0||w>this.width||k<0||A>this.height)return!d&&[];var z=[];return this._forEachCell(w,A,E,k,this._queryCellCircle,z,{hitTest:d,circle:{x:c,y:f,radius:h},seenUids:{box:{},circle:{}}},_),d?z.length>0:z},Xt.prototype.query=function(c,f,h,d,_){return this._query(c,f,h,d,!1,_)},Xt.prototype.hitTest=function(c,f,h,d,_){return this._query(c,f,h,d,!0,_)},Xt.prototype.hitTestCircle=function(c,f,h,d){return this._queryCircle(c,f,h,!0,d)},Xt.prototype._queryCell=function(c,f,h,d,_,w,E,A){var k=E.seenUids,z=this.boxCells[_];if(z!==null)for(var Z=this.bboxes,Y=0,$=z;Y<$.length;Y+=1){var oe=$[Y];if(!k.box[oe]){k.box[oe]=!0;var re=4*oe;if(c<=Z[re+2]&&f<=Z[re+3]&&h>=Z[re+0]&&d>=Z[re+1]&&(!A||A(this.boxKeys[oe]))){if(E.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[oe],x1:Z[re],y1:Z[re+1],x2:Z[re+2],y2:Z[re+3]})}}}var ue=this.circleCells[_];if(ue!==null)for(var ee=this.circles,le=0,ge=ue;le<ge.length;le+=1){var be=ge[le];if(!k.circle[be]){k.circle[be]=!0;var Ce=3*be;if(this._circleAndRectCollide(ee[Ce],ee[Ce+1],ee[Ce+2],c,f,h,d)&&(!A||A(this.circleKeys[be]))){if(E.hitTest)return w.push(!0),!0;var Pe=ee[Ce],ke=ee[Ce+1],ze=ee[Ce+2];w.push({key:this.circleKeys[be],x1:Pe-ze,y1:ke-ze,x2:Pe+ze,y2:ke+ze})}}}},Xt.prototype._queryCellCircle=function(c,f,h,d,_,w,E,A){var k=E.circle,z=E.seenUids,Z=this.boxCells[_];if(Z!==null)for(var Y=this.bboxes,$=0,oe=Z;$<oe.length;$+=1){var re=oe[$];if(!z.box[re]){z.box[re]=!0;var ue=4*re;if(this._circleAndRectCollide(k.x,k.y,k.radius,Y[ue+0],Y[ue+1],Y[ue+2],Y[ue+3])&&(!A||A(this.boxKeys[re])))return w.push(!0),!0}}var ee=this.circleCells[_];if(ee!==null)for(var le=this.circles,ge=0,be=ee;ge<be.length;ge+=1){var Ce=be[ge];if(!z.circle[Ce]){z.circle[Ce]=!0;var Pe=3*Ce;if(this._circlesCollide(le[Pe],le[Pe+1],le[Pe+2],k.x,k.y,k.radius)&&(!A||A(this.circleKeys[Ce])))return w.push(!0),!0}}},Xt.prototype._forEachCell=function(c,f,h,d,_,w,E,A){for(var k=this._convertToXCellCoord(c),z=this._convertToYCellCoord(f),Z=this._convertToXCellCoord(h),Y=this._convertToYCellCoord(d),$=k;$<=Z;$++)for(var oe=z;oe<=Y;oe++)if(_.call(this,c,f,h,d,this.xCellCount*oe+$,w,E,A))return},Xt.prototype._convertToXCellCoord=function(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))},Xt.prototype._convertToYCellCoord=function(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))},Xt.prototype._circlesCollide=function(c,f,h,d,_,w){var E=d-c,A=_-f,k=h+w;return k*k>E*E+A*A},Xt.prototype._circleAndRectCollide=function(c,f,h,d,_,w,E){var A=(w-d)/2,k=Math.abs(c-(d+A));if(k>A+h)return!1;var z=(E-_)/2,Z=Math.abs(f-(_+z));if(Z>z+h)return!1;if(k<=A||Z<=z)return!0;var Y=k-A,$=Z-z;return Y*Y+$*$<=h*h};var aa=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function xr(c,f){for(var h=0;h<c;h++){var d=f.length;f.resize(d+4),f.float32.set(aa,3*d)}}function jn(c,f,h){var d=f[0],_=f[1];return c[0]=h[0]*d+h[4]*_+h[12],c[1]=h[1]*d+h[5]*_+h[13],c[3]=h[3]*d+h[7]*_+h[15],c}var ir=function(c,f,h){f===void 0&&(f=new Xt(c.width+200,c.height+200,25)),h===void 0&&(h=new Xt(c.width+200,c.height+200,25)),this.transform=c,this.grid=f,this.ignoredGrid=h,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+100,this.screenBottomBoundary=c.height+100,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200};function bn(c,f,h){return f*(s.EXTENT/(c.tileSize*Math.pow(2,h-c.tileID.overscaledZ)))}ir.prototype.placeCollisionBox=function(c,f,h,d,_){var w=this.projectAndGetPerspectiveRatio(d,c.anchorPointX,c.anchorPointY),E=h*w.perspectiveRatio,A=c.x1*E+w.point.x,k=c.y1*E+w.point.y,z=c.x2*E+w.point.x,Z=c.y2*E+w.point.y;return!this.isInsideGrid(A,k,z,Z)||!f&&this.grid.hitTest(A,k,z,Z,_)?{box:[],offscreen:!1}:{box:[A,k,z,Z],offscreen:this.isOffscreen(A,k,z,Z)}},ir.prototype.placeCollisionCircles=function(c,f,h,d,_,w,E,A,k,z,Z,Y,$){var oe=[],re=new s.Point(f.anchorX,f.anchorY),ue=Rt(re,w),ee=Wt(this.transform.cameraToCenterDistance,ue.signedDistanceFromCamera),le=(z?_/ee:_*ee)/s.ONE_EM,ge=Rt(re,E).point,be=Un(le,d,f.lineOffsetX*le,f.lineOffsetY*le,!1,ge,re,f,h,E,{}),Ce=!1,Pe=!1,ke=!0;if(be){for(var ze=.5*Y*ee+$,He=new s.Point(-100,-100),We=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),nt=new Xn,dt=be.first,vt=be.last,yt=[],nn=dt.path.length-1;nn>=1;nn--)yt.push(dt.path[nn]);for(var it=1;it<vt.path.length;it++)yt.push(vt.path[it]);var It=2.5*ze;if(A){var Ut=yt.map(function(ao){return Rt(ao,A)});yt=Ut.some(function(ao){return ao.signedDistanceFromCamera<=0})?[]:Ut.map(function(ao){return ao.point})}var Pt=[];if(yt.length>0){for(var At=yt[0].clone(),Nt=yt[0].clone(),St=1;St<yt.length;St++)At.x=Math.min(At.x,yt[St].x),At.y=Math.min(At.y,yt[St].y),Nt.x=Math.max(Nt.x,yt[St].x),Nt.y=Math.max(Nt.y,yt[St].y);Pt=At.x>=He.x&&Nt.x<=We.x&&At.y>=He.y&&Nt.y<=We.y?[yt]:Nt.x<He.x||At.x>We.x||Nt.y<He.y||At.y>We.y?[]:s.clipLine([yt],He.x,He.y,We.x,We.y)}for(var Et=0,br=Pt;Et<br.length;Et+=1){var Vn;nt.reset(br[Et],.25*ze),Vn=nt.length<=.5*ze?1:Math.ceil(nt.paddedLength/It)+1;for(var Xr=0;Xr<Vn;Xr++){var kr=Xr/Math.max(Vn-1,1),Bn=nt.lerp(kr),Yn=Bn.x+100,Li=Bn.y+100;oe.push(Yn,Li,ze,0);var ri=Yn-ze,Xa=Li-ze,ui=Yn+ze,To=Li+ze;if(ke=ke&&this.isOffscreen(ri,Xa,ui,To),Pe=Pe||this.isInsideGrid(ri,Xa,ui,To),!c&&this.grid.hitTestCircle(Yn,Li,ze,Z)&&(Ce=!0,!k))return{circles:[],offscreen:!1,collisionDetected:Ce}}}}return{circles:!k&&Ce||!Pe?[]:oe,offscreen:ke,collisionDetected:Ce}},ir.prototype.queryRenderedSymbols=function(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var f=[],h=1/0,d=1/0,_=-1/0,w=-1/0,E=0,A=c;E<A.length;E+=1){var k=A[E],z=new s.Point(k.x+100,k.y+100);h=Math.min(h,z.x),d=Math.min(d,z.y),_=Math.max(_,z.x),w=Math.max(w,z.y),f.push(z)}for(var Z={},Y={},$=0,oe=this.grid.query(h,d,_,w).concat(this.ignoredGrid.query(h,d,_,w));$<oe.length;$+=1){var re=oe[$],ue=re.key;if(Z[ue.bucketInstanceId]===void 0&&(Z[ue.bucketInstanceId]={}),!Z[ue.bucketInstanceId][ue.featureIndex]){var ee=[new s.Point(re.x1,re.y1),new s.Point(re.x2,re.y1),new s.Point(re.x2,re.y2),new s.Point(re.x1,re.y2)];s.polygonIntersectsPolygon(f,ee)&&(Z[ue.bucketInstanceId][ue.featureIndex]=!0,Y[ue.bucketInstanceId]===void 0&&(Y[ue.bucketInstanceId]=[]),Y[ue.bucketInstanceId].push(ue.featureIndex))}}return Y},ir.prototype.insertCollisionBox=function(c,f,h,d,_){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:d,collisionGroupID:_},c[0],c[1],c[2],c[3])},ir.prototype.insertCollisionCircles=function(c,f,h,d,_){for(var w=f?this.ignoredGrid:this.grid,E={bucketInstanceId:h,featureIndex:d,collisionGroupID:_},A=0;A<c.length;A+=4)w.insertCircle(E,c[A],c[A+1],c[A+2])},ir.prototype.projectAndGetPerspectiveRatio=function(c,f,h){var d=[f,h,0,1];return jn(d,d,c),{point:new s.Point((d[0]/d[3]+1)/2*this.transform.width+100,(-d[1]/d[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}},ir.prototype.isOffscreen=function(c,f,h,d){return h<100||c>=this.screenRightBoundary||d<100||f>this.screenBottomBoundary},ir.prototype.isInsideGrid=function(c,f,h,d){return h>=0&&c<this.gridRightBoundary&&d>=0&&f<this.gridBottomBoundary},ir.prototype.getViewportMatrix=function(){var c=s.identity([]);return s.translate(c,c,[-100,-100,0]),c};var Ti=function(c,f,h,d){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?f:-f))):d&&h?1:0,this.placed=h};Ti.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Zr=function(c,f,h,d,_){this.text=new Ti(c?c.text:null,f,h,_),this.icon=new Ti(c?c.icon:null,f,d,_)};Zr.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var yu=function(c,f,h){this.text=c,this.icon=f,this.skipFade=h},Si=function(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]},Tf=function(c,f,h,d,_){this.bucketInstanceId=c,this.featureIndex=f,this.sourceLayerIndex=h,this.bucketIndex=d,this.tileID=_},q=function(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}};function Q(c,f,h,d,_){var w=s.getAnchorAlignment(c),E=-(w.horizontalAlign-.5)*f,A=-(w.verticalAlign-.5)*h,k=s.evaluateVariableOffset(c,d);return new s.Point(E+k[0]*_,A+k[1]*_)}function pe(c,f,h,d,_,w){var E=c.x1,A=c.x2,k=c.y1,z=c.y2,Z=c.anchorPointX,Y=c.anchorPointY,$=new s.Point(f,h);return d&&$._rotate(_?w:-w),{x1:E+$.x,y1:k+$.y,x2:A+$.x,y2:z+$.y,anchorPointX:Z,anchorPointY:Y}}q.prototype.get=function(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){var f=++this.maxGroupID;this.collisionGroups[c]={ID:f,predicate:function(h){return h.collisionGroupID===f}}}return this.collisionGroups[c]};var Se=function(c,f,h,d){this.transform=c.clone(),this.collisionIndex=new ir(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new q(h),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}};function Ge(c,f,h,d,_){c.emplaceBack(f?1:0,h?1:0,d||0,_||0),c.emplaceBack(f?1:0,h?1:0,d||0,_||0),c.emplaceBack(f?1:0,h?1:0,d||0,_||0),c.emplaceBack(f?1:0,h?1:0,d||0,_||0)}Se.prototype.getBucketParts=function(c,f,h,d){var _=h.getBucket(f),w=h.latestFeatureIndex;if(_&&w&&f.id===_.layerIds[0]){var E=h.collisionBoxArray,A=_.layers[0].layout,k=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),z=h.tileSize/s.EXTENT,Z=this.transform.calculatePosMatrix(h.tileID.toUnwrapped()),Y=A.get("text-pitch-alignment")==="map",$=A.get("text-rotation-alignment")==="map",oe=bn(h,1,this.transform.zoom),re=dn(Z,Y,$,this.transform,oe),ue=null;if(Y){var ee=on(Z,Y,$,this.transform,oe);ue=s.multiply([],this.transform.labelPlaneMatrix,ee)}this.retainedQueryData[_.bucketInstanceId]=new Tf(_.bucketInstanceId,w,_.sourceLayerIndex,_.index,h.tileID);var le={bucket:_,layout:A,posMatrix:Z,textLabelPlaneMatrix:re,labelToScreenMatrix:ue,scale:k,textPixelRatio:z,holdingForFade:h.holdingForFade(),collisionBoxArray:E,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(d)for(var ge=0,be=_.sortKeyRanges;ge<be.length;ge+=1){var Ce=be[ge];c.push({sortKey:Ce.sortKey,symbolInstanceStart:Ce.symbolInstanceStart,symbolInstanceEnd:Ce.symbolInstanceEnd,parameters:le})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:le})}},Se.prototype.attemptAnchorPlacement=function(c,f,h,d,_,w,E,A,k,z,Z,Y,$,oe,re){var ue,ee=[Y.textOffset0,Y.textOffset1],le=Q(c,h,d,ee,_),ge=this.collisionIndex.placeCollisionBox(pe(f,le.x,le.y,w,E,this.transform.angle),Z,A,k,z.predicate);if(!re||this.collisionIndex.placeCollisionBox(pe(re,le.x,le.y,w,E,this.transform.angle),Z,A,k,z.predicate).box.length!==0)return ge.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID].text&&(ue=this.prevPlacement.variableOffsets[Y.crossTileID].anchor),this.variableOffsets[Y.crossTileID]={textOffset:ee,width:h,height:d,anchor:c,textBoxScale:_,prevAnchor:ue},this.markUsedJustification($,c,Y,oe),$.allowVerticalPlacement&&(this.markUsedOrientation($,oe,Y),this.placedOrientations[Y.crossTileID]=oe),{shift:le,placedGlyphBoxes:ge}):void 0},Se.prototype.placeLayerBucketPart=function(c,f,h){var d=this,_=c.parameters,w=_.bucket,E=_.layout,A=_.posMatrix,k=_.textLabelPlaneMatrix,z=_.labelToScreenMatrix,Z=_.textPixelRatio,Y=_.holdingForFade,$=_.collisionBoxArray,oe=_.partiallyEvaluatedTextSize,re=_.collisionGroup,ue=E.get("text-optional"),ee=E.get("icon-optional"),le=E.get("text-allow-overlap"),ge=E.get("icon-allow-overlap"),be=E.get("text-rotation-alignment")==="map",Ce=E.get("text-pitch-alignment")==="map",Pe=E.get("icon-text-fit")!=="none",ke=E.get("symbol-z-order")==="viewport-y",ze=le&&(ge||!w.hasIconData()||ee),He=ge&&(le||!w.hasTextData()||ue);!w.collisionArrays&&$&&w.deserializeCollisionBoxes($);var We=function(it,It){if(!f[it.crossTileID])if(Y)d.placements[it.crossTileID]=new yu(!1,!1,!1);else{var Ut,Pt=!1,At=!1,Nt=!0,St=null,Et={box:null,offscreen:null},br={box:null,offscreen:null},Vn=null,Xr=null,kr=0,Bn=0,Yn=0;It.textFeatureIndex?kr=It.textFeatureIndex:it.useRuntimeCollisionCircles&&(kr=it.featureIndex),It.verticalTextFeatureIndex&&(Bn=It.verticalTextFeatureIndex);var Li=It.textBox;if(Li){var ri=function(un){var Gi=s.WritingMode.horizontal;if(w.allowVerticalPlacement&&!un&&d.prevPlacement){var ci=d.prevPlacement.placedOrientations[it.crossTileID];ci&&(d.placedOrientations[it.crossTileID]=ci,d.markUsedOrientation(w,Gi=ci,it))}return Gi},Xa=function(un,Gi){if(w.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&It.verticalTextBox)for(var ci=0,Gs=w.writingModes;ci<Gs.length&&(Gs[ci]===s.WritingMode.vertical?(Et=Gi(),br=Et):Et=un(),!(Et&&Et.box&&Et.box.length));ci+=1);else Et=un()};if(E.get("text-variable-anchor")){var ui=E.get("text-variable-anchor");if(d.prevPlacement&&d.prevPlacement.variableOffsets[it.crossTileID]){var To=d.prevPlacement.variableOffsets[it.crossTileID];ui.indexOf(To.anchor)>0&&(ui=ui.filter(function(un){return un!==To.anchor})).unshift(To.anchor)}var ao=function(un,Gi,ci){for(var Gs=un.x2-un.x1,Tv=un.y2-un.y1,Gc=it.textBoxScale,Sv=Pe&&!ge?Gi:null,Nu={box:[],offscreen:!1},bm=le?2*ui.length:ui.length,Rl=0;Rl<bm;++Rl){var Wc=d.attemptAnchorPlacement(ui[Rl%ui.length],un,Gs,Tv,Gc,be,Ce,Z,A,re,Rl>=ui.length,it,w,ci,Sv);if(Wc&&(Nu=Wc.placedGlyphBoxes)&&Nu.box&&Nu.box.length){Pt=!0,St=Wc.shift;break}}return Nu};Xa(function(){return ao(Li,It.iconBox,s.WritingMode.horizontal)},function(){var un=It.verticalTextBox;return w.allowVerticalPlacement&&!(Et&&Et.box&&Et.box.length)&&it.numVerticalGlyphVertices>0&&un?ao(un,It.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null}}),Et&&(Pt=Et.box,Nt=Et.offscreen);var Du=ri(Et&&Et.box);if(!Pt&&d.prevPlacement){var kl=d.prevPlacement.variableOffsets[it.crossTileID];kl&&(d.variableOffsets[it.crossTileID]=kl,d.markUsedJustification(w,kl.anchor,it,Du))}}else{var Ya=function(un,Gi){var ci=d.collisionIndex.placeCollisionBox(un,le,Z,A,re.predicate);return ci&&ci.box&&ci.box.length&&(d.markUsedOrientation(w,Gi,it),d.placedOrientations[it.crossTileID]=Gi),ci};Xa(function(){return Ya(Li,s.WritingMode.horizontal)},function(){var un=It.verticalTextBox;return w.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&un?Ya(un,s.WritingMode.vertical):{box:null,offscreen:null}}),ri(Et&&Et.box&&Et.box.length)}}if(Pt=(Ut=Et)&&Ut.box&&Ut.box.length>0,Nt=Ut&&Ut.offscreen,it.useRuntimeCollisionCircles){var Ll=w.text.placedSymbolArray.get(it.centerJustifiedTextSymbolIndex),zu=s.evaluateSizeForFeature(w.textSizeData,oe,Ll),Go=E.get("text-padding");Vn=d.collisionIndex.placeCollisionCircles(le,Ll,w.lineVertexArray,w.glyphOffsetArray,zu,A,k,z,h,Ce,re.predicate,it.collisionCircleDiameter,Go),Pt=le||Vn.circles.length>0&&!Vn.collisionDetected,Nt=Nt&&Vn.offscreen}if(It.iconFeatureIndex&&(Yn=It.iconFeatureIndex),It.iconBox){var Bu=function(un){var Gi=Pe&&St?pe(un,St.x,St.y,be,Ce,d.transform.angle):un;return d.collisionIndex.placeCollisionBox(Gi,ge,Z,A,re.predicate)};At=br&&br.box&&br.box.length&&It.verticalIconBox?(Xr=Bu(It.verticalIconBox)).box.length>0:(Xr=Bu(It.iconBox)).box.length>0,Nt=Nt&&Xr.offscreen}var Wo=ue||it.numHorizontalGlyphVertices===0&&it.numVerticalGlyphVertices===0,wr=ee||it.numIconVertices===0;if(Wo||wr?wr?Wo||(At=At&&Pt):Pt=At&&Pt:At=Pt=At&&Pt,Pt&&Ut&&Ut.box&&d.collisionIndex.insertCollisionBox(Ut.box,E.get("text-ignore-placement"),w.bucketInstanceId,br&&br.box&&Bn?Bn:kr,re.ID),At&&Xr&&d.collisionIndex.insertCollisionBox(Xr.box,E.get("icon-ignore-placement"),w.bucketInstanceId,Yn,re.ID),Vn&&(Pt&&d.collisionIndex.insertCollisionCircles(Vn.circles,E.get("text-ignore-placement"),w.bucketInstanceId,kr,re.ID),h)){var ca=w.bucketInstanceId,$a=d.collisionCircleArrays[ca];$a===void 0&&($a=d.collisionCircleArrays[ca]=new Si);for(var Vs=0;Vs<Vn.circles.length;Vs+=4)$a.circles.push(Vn.circles[Vs+0]),$a.circles.push(Vn.circles[Vs+1]),$a.circles.push(Vn.circles[Vs+2]),$a.circles.push(Vn.collisionDetected?1:0)}d.placements[it.crossTileID]=new yu(Pt||ze,At||He,Nt||w.justReloaded),f[it.crossTileID]=!0}};if(ke)for(var nt=w.getSortedSymbolIndexes(this.transform.angle),dt=nt.length-1;dt>=0;--dt){var vt=nt[dt];We(w.symbolInstances.get(vt),w.collisionArrays[vt])}else for(var yt=c.symbolInstanceStart;yt<c.symbolInstanceEnd;yt++)We(w.symbolInstances.get(yt),w.collisionArrays[yt]);if(h&&w.bucketInstanceId in this.collisionCircleArrays){var nn=this.collisionCircleArrays[w.bucketInstanceId];s.invert(nn.invProjMatrix,A),nn.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1},Se.prototype.markUsedJustification=function(c,f,h,d){var _;_=d===s.WritingMode.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(f)];for(var w=0,E=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];w<E.length;w+=1){var A=E[w];A>=0&&(c.text.placedSymbolArray.get(A).crossTileID=_>=0&&A!==_?0:h.crossTileID)}},Se.prototype.markUsedOrientation=function(c,f,h){for(var d=f===s.WritingMode.horizontal||f===s.WritingMode.horizontalOnly?f:0,_=f===s.WritingMode.vertical?f:0,w=0,E=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];w<E.length;w+=1)c.text.placedSymbolArray.get(E[w]).placedOrientation=d;h.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=_)},Se.prototype.commit=function(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;var f=this.prevPlacement,h=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;var d=f?f.symbolFadeChange(c):1,_=f?f.opacities:{},w=f?f.variableOffsets:{},E=f?f.placedOrientations:{};for(var A in this.placements){var k=this.placements[A],z=_[A];z?(this.opacities[A]=new Zr(z,d,k.text,k.icon),h=h||k.text!==z.text.placed||k.icon!==z.icon.placed):(this.opacities[A]=new Zr(null,d,k.text,k.icon,k.skipFade),h=h||k.text||k.icon)}for(var Z in _){var Y=_[Z];if(!this.opacities[Z]){var $=new Zr(Y,d,!1,!1);$.isHidden()||(this.opacities[Z]=$,h=h||Y.text.placed||Y.icon.placed)}}for(var oe in w)this.variableOffsets[oe]||!this.opacities[oe]||this.opacities[oe].isHidden()||(this.variableOffsets[oe]=w[oe]);for(var re in E)this.placedOrientations[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.placedOrientations[re]=E[re]);h?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:c)},Se.prototype.updateLayerOpacities=function(c,f){for(var h={},d=0,_=f;d<_.length;d+=1){var w=_[d],E=w.getBucket(c);E&&w.latestFeatureIndex&&c.id===E.layerIds[0]&&this.updateBucketOpacities(E,h,w.collisionBoxArray)}},Se.prototype.updateBucketOpacities=function(c,f,h){var d=this;c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();var _=c.layers[0].layout,w=new Zr(null,0,!1,!1,!0),E=_.get("text-allow-overlap"),A=_.get("icon-allow-overlap"),k=_.get("text-variable-anchor"),z=_.get("text-rotation-alignment")==="map",Z=_.get("text-pitch-alignment")==="map",Y=_.get("icon-text-fit")!=="none",$=new Zr(null,0,E&&(A||!c.hasIconData()||_.get("icon-optional")),A&&(E||!c.hasTextData()||_.get("text-optional")),!0);!c.collisionArrays&&h&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(h);for(var oe=function(le,ge,be){for(var Ce=0;Ce<ge/4;Ce++)le.opacityVertexArray.emplaceBack(be)},re=function(le){var ge=c.symbolInstances.get(le),be=ge.numHorizontalGlyphVertices,Ce=ge.numVerticalGlyphVertices,Pe=ge.crossTileID,ke=d.opacities[Pe];f[Pe]?ke=w:ke||(d.opacities[Pe]=ke=$),f[Pe]=!0;var ze=ge.numIconVertices>0,He=d.placedOrientations[ge.crossTileID],We=He===s.WritingMode.vertical,nt=He===s.WritingMode.horizontal||He===s.WritingMode.horizontalOnly;if(be>0||Ce>0){var dt=Zd(ke.text);oe(c.text,be,We?xl:dt),oe(c.text,Ce,nt?xl:dt);var vt=ke.text.isHidden();[ge.rightJustifiedTextSymbolIndex,ge.centerJustifiedTextSymbolIndex,ge.leftJustifiedTextSymbolIndex].forEach(function(Et){Et>=0&&(c.text.placedSymbolArray.get(Et).hidden=vt||We?1:0)}),ge.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(ge.verticalPlacedTextSymbolIndex).hidden=vt||nt?1:0);var yt=d.variableOffsets[ge.crossTileID];yt&&d.markUsedJustification(c,yt.anchor,ge,He);var nn=d.placedOrientations[ge.crossTileID];nn&&(d.markUsedJustification(c,"left",ge,nn),d.markUsedOrientation(c,nn,ge))}if(ze){var it=Zd(ke.icon),It=!(Y&&ge.verticalPlacedIconSymbolIndex&&We);ge.placedIconSymbolIndex>=0&&(oe(c.icon,ge.numIconVertices,It?it:xl),c.icon.placedSymbolArray.get(ge.placedIconSymbolIndex).hidden=ke.icon.isHidden()),ge.verticalPlacedIconSymbolIndex>=0&&(oe(c.icon,ge.numVerticalIconVertices,It?xl:it),c.icon.placedSymbolArray.get(ge.verticalPlacedIconSymbolIndex).hidden=ke.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){var Ut=c.collisionArrays[le];if(Ut){var Pt=new s.Point(0,0);if(Ut.textBox||Ut.verticalTextBox){var At=!0;if(k){var Nt=d.variableOffsets[Pe];Nt?(Pt=Q(Nt.anchor,Nt.width,Nt.height,Nt.textOffset,Nt.textBoxScale),z&&Pt._rotate(Z?d.transform.angle:-d.transform.angle)):At=!1}Ut.textBox&&Ge(c.textCollisionBox.collisionVertexArray,ke.text.placed,!At||We,Pt.x,Pt.y),Ut.verticalTextBox&&Ge(c.textCollisionBox.collisionVertexArray,ke.text.placed,!At||nt,Pt.x,Pt.y)}var St=!!(!nt&&Ut.verticalIconBox);Ut.iconBox&&Ge(c.iconCollisionBox.collisionVertexArray,ke.icon.placed,St,Y?Pt.x:0,Y?Pt.y:0),Ut.verticalIconBox&&Ge(c.iconCollisionBox.collisionVertexArray,ke.icon.placed,!St,Y?Pt.x:0,Y?Pt.y:0)}}},ue=0;ue<c.symbolInstances.length;ue++)re(ue);if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){var ee=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=ee.invProjMatrix,c.placementViewportMatrix=ee.viewportMatrix,c.collisionCircleArray=ee.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}},Se.prototype.symbolFadeChange=function(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Se.prototype.zoomAdjustment=function(c){return Math.max(0,(this.transform.zoom-c)/1.5)},Se.prototype.hasTransitions=function(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration},Se.prototype.stillRecent=function(c,f){var h=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*h>c},Se.prototype.setStale=function(){this.stale=!0};var ht=Math.pow(2,25),tn=Math.pow(2,24),or=Math.pow(2,17),Cr=Math.pow(2,16),Br=Math.pow(2,9),to=Math.pow(2,8),qd=Math.pow(2,1);function Zd(c){if(c.opacity===0&&!c.placed)return 0;if(c.opacity===1&&c.placed)return 4294967295;var f=c.placed?1:0,h=Math.floor(127*c.opacity);return h*ht+f*tn+h*or+f*Cr+h*Br+f*to+h*qd+f}var xl=0,Sf=function(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&c.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Sf.prototype.continuePlacement=function(c,f,h,d,_){for(var w=this._bucketParts;this._currentTileIndex<c.length;)if(f.getBucketParts(w,d,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort(function(E,A){return E.sortKey-A.sortKey}));this._currentPartIndex<w.length;)if(f.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,_())return!0;return!1};var vu=function(c,f,h,d,_,w,E){this.placement=new Se(c,_,w,E),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=d,this._done=!1};vu.prototype.isDone=function(){return this._done},vu.prototype.continuePlacement=function(c,f,h){for(var d=this,_=s.browser.now(),w=function(){var k=s.browser.now()-_;return!d._forceFullPlacement&&k>2};this._currentPlacementIndex>=0;){var E=f[c[this._currentPlacementIndex]],A=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=A)&&(!E.maxzoom||E.maxzoom>A)){if(this._inProgressLayer||(this._inProgressLayer=new Sf(E)),this._inProgressLayer.continuePlacement(h[E.source],this.placement,this._showCollisionBoxes,E,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},vu.prototype.commit=function(c){return this.placement.commit(c),this.placement};var Xd=512/s.EXTENT/2,Ec=function(c,f,h){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=h;for(var d=0;d<f.length;d++){var _=f.get(d),w=_.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:_.crossTileID,coord:this.getScaledCoordinates(_,c)})}};Ec.prototype.getScaledCoordinates=function(c,f){var h=Xd/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*s.EXTENT+c.anchorX)*h),y:Math.floor((f.canonical.y*s.EXTENT+c.anchorY)*h)}},Ec.prototype.findMatches=function(c,f,h){for(var d=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),_=0;_<c.length;_++){var w=c.get(_);if(!w.crossTileID){var E=this.indexedSymbolInstances[w.key];if(E)for(var A=this.getScaledCoordinates(w,f),k=0,z=E;k<z.length;k+=1){var Z=z[k];if(Math.abs(Z.coord.x-A.x)<=d&&Math.abs(Z.coord.y-A.y)<=d&&!h[Z.crossTileID]){h[Z.crossTileID]=!0,w.crossTileID=Z.crossTileID;break}}}}};var no=function(){this.maxCrossTileID=0};no.prototype.generate=function(){return++this.maxCrossTileID};var Oa=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Oa.prototype.handleWrapJump=function(c){var f=Math.round((c-this.lng)/360);if(f!==0)for(var h in this.indexes){var d=this.indexes[h],_={};for(var w in d){var E=d[w];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+f),_[E.tileID.key]=E}this.indexes[h]=_}this.lng=c},Oa.prototype.addBucket=function(c,f,h){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(var d=0;d<f.symbolInstances.length;d++)f.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});var _=this.usedCrossTileIDs[c.overscaledZ];for(var w in this.indexes){var E=this.indexes[w];if(Number(w)>c.overscaledZ)for(var A in E){var k=E[A];k.tileID.isChildOf(c)&&k.findMatches(f.symbolInstances,c,_)}else{var z=E[c.scaledTo(Number(w)).key];z&&z.findMatches(f.symbolInstances,c,_)}}for(var Z=0;Z<f.symbolInstances.length;Z++){var Y=f.symbolInstances.get(Z);Y.crossTileID||(Y.crossTileID=h.generate(),_[Y.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Ec(c,f.symbolInstances,f.bucketInstanceId),!0},Oa.prototype.removeBucketCrossTileIDs=function(c,f){for(var h in f.indexedSymbolInstances)for(var d=0,_=f.indexedSymbolInstances[h];d<_.length;d+=1)delete this.usedCrossTileIDs[c][_[d].crossTileID]},Oa.prototype.removeStaleBuckets=function(c){var f=!1;for(var h in this.indexes){var d=this.indexes[h];for(var _ in d)c[d[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,d[_]),delete d[_],f=!0)}return f};var Da=function(){this.layerIndexes={},this.crossTileIDs=new no,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Da.prototype.addLayer=function(c,f,h){var d=this.layerIndexes[c.id];d===void 0&&(d=this.layerIndexes[c.id]=new Oa);var _=!1,w={};d.handleWrapJump(h);for(var E=0,A=f;E<A.length;E+=1){var k=A[E],z=k.getBucket(c);z&&c.id===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(k.tileID,z,this.crossTileIDs)&&(_=!0),w[z.bucketInstanceId]=!0)}return d.removeStaleBuckets(w)&&(_=!0),_},Da.prototype.pruneUnusedLayers=function(c){var f={};for(var h in c.forEach(function(d){f[d]=!0}),this.layerIndexes)f[h]||delete this.layerIndexes[h]};var As=function(c,f){return s.emitValidationErrors(c,f&&f.filter(function(h){return h.identifier!=="source.canvas"}))},za=s.pick(Ze,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ba=s.pick(Ze,["setCenter","setZoom","setBearing","setPitch"]),Tc=function(){var c={},f=s.styleSpec.$version;for(var h in s.styleSpec.$root){var d,_=s.styleSpec.$root[h];_.required&&(d=h==="version"?f:_.type==="array"?[]:{})!=null&&(c[h]=d)}return c}(),Ai=function(c){function f(h,d){var _=this;d===void 0&&(d={}),c.call(this),this.map=h,this.dispatcher=new wt(Le(),this),this.imageManager=new U,this.imageManager.setEventedParent(this),this.glyphManager=new Fe(h._requestManager,d.localIdeographFontFamily),this.lineAtlas=new ft(256,512),this.crossTileSymbolIndex=new Da,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());var w=this;this._rtlTextPluginCallback=f.registerForPluginStateChange(function(E){w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:E.pluginStatus,pluginURL:E.pluginURL},function(A,k){if(s.triggerPluginCompletionEvent(A),k&&k.every(function(Z){return Z}))for(var z in w.sourceCaches)w.sourceCaches[z].reload()})}),this.on("data",function(E){if(E.dataType==="source"&&E.sourceDataType==="metadata"){var A=_.sourceCaches[E.sourceId];if(A){var k=A.getSource();if(k&&k.vectorLayerIds)for(var z in _._layers){var Z=_._layers[z];Z.source===k.id&&_._validateLayer(Z)}}}})}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.loadURL=function(h,d){var _=this;d===void 0&&(d={}),this.fire(new s.Event("dataloading",{dataType:"style"}));var w=typeof d.validate=="boolean"?d.validate:!s.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,d.accessToken);var E=this.map._requestManager.transformRequest(h,s.ResourceType.Style);this._request=s.getJSON(E,function(A,k){_._request=null,A?_.fire(new s.ErrorEvent(A)):k&&_._load(k,w)})},f.prototype.loadJSON=function(h,d){var _=this;d===void 0&&(d={}),this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.browser.frame(function(){_._request=null,_._load(h,d.validate!==!1)})},f.prototype.loadEmpty=function(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Tc,!1)},f.prototype._load=function(h,d){if(!d||!As(this,s.validateStyle(h))){for(var _ in this._loaded=!0,this.stylesheet=h,h.sources)this.addSource(_,h.sources[_],{validate:!1});h.sprite?this._loadSprite(h.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(h.glyphs);var w=qe(this.stylesheet.layers);this._order=w.map(function(z){return z.id}),this._layers={},this._serializedLayers={};for(var E=0,A=w;E<A.length;E+=1){var k=A[E];(k=s.createStyleLayer(k)).setEventedParent(this,{layer:{id:k.id}}),this._layers[k.id]=k,this._serializedLayers[k.id]=k.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Bt(this.stylesheet.light),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}},f.prototype._loadSprite=function(h){var d=this;this._spriteRequest=function(_,w,E){var A,k,z,Z=s.browser.devicePixelRatio>1?"@2x":"",Y=s.getJSON(w.transformRequest(w.normalizeSpriteURL(_,Z,".json"),s.ResourceType.SpriteJSON),function(re,ue){Y=null,z||(z=re,A=ue,oe())}),$=s.getImage(w.transformRequest(w.normalizeSpriteURL(_,Z,".png"),s.ResourceType.SpriteImage),function(re,ue){$=null,z||(z=re,k=ue,oe())});function oe(){if(z)E(z);else if(A&&k){var re=s.browser.getImageData(k),ue={};for(var ee in A){var le=A[ee],ge=le.width,be=le.height,Ce=le.x,Pe=le.y,ke=le.sdf,ze=le.pixelRatio,He=le.stretchX,We=le.stretchY,nt=le.content,dt=new s.RGBAImage({width:ge,height:be});s.RGBAImage.copy(re,dt,{x:Ce,y:Pe},{x:0,y:0},{width:ge,height:be}),ue[ee]={data:dt,pixelRatio:ze,sdf:ke,stretchX:He,stretchY:We,content:nt}}E(null,ue)}}return{cancel:function(){Y&&(Y.cancel(),Y=null),$&&($.cancel(),$=null)}}}(h,this.map._requestManager,function(_,w){if(d._spriteRequest=null,_)d.fire(new s.ErrorEvent(_));else if(w)for(var E in w)d.imageManager.addImage(E,w[E]);d.imageManager.setLoaded(!0),d._availableImages=d.imageManager.listImages(),d.dispatcher.broadcast("setImages",d._availableImages),d.fire(new s.Event("data",{dataType:"style"}))})},f.prototype._validateLayer=function(h){var d=this.sourceCaches[h.source];if(d){var _=h.sourceLayer;if(_){var w=d.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(_)===-1)&&this.fire(new s.ErrorEvent(new Error('Source layer "'+_+'" does not exist on source "'+w.id+'" as specified by style layer "'+h.id+'"')))}}},f.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var h in this.sourceCaches)if(!this.sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()},f.prototype._serializeLayers=function(h){for(var d=[],_=0,w=h;_<w.length;_+=1){var E=this._layers[w[_]];E.type!=="custom"&&d.push(E.serialize())}return d},f.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(var d in this._layers)if(this._layers[d].hasTransition())return!0;return!1},f.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},f.prototype.update=function(h){if(this._loaded){var d=this._changed;if(this._changed){var _=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);for(var E in(_.length||w.length)&&this._updateWorkerLayers(_,w),this._updatedSources){var A=this._updatedSources[E];A==="reload"?this._reloadSource(E):A==="clear"&&this._clearSource(E)}for(var k in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[k].updateTransitions(h);this.light.updateTransitions(h),this._resetUpdates()}var z={};for(var Z in this.sourceCaches){var Y=this.sourceCaches[Z];z[Z]=Y.used,Y.used=!1}for(var $=0,oe=this._order;$<oe.length;$+=1){var re=this._layers[oe[$]];re.recalculate(h,this._availableImages),!re.isHidden(h.zoom)&&re.source&&(this.sourceCaches[re.source].used=!0)}for(var ue in z){var ee=this.sourceCaches[ue];z[ue]!==ee.used&&ee.fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ue}))}this.light.recalculate(h),this.z=h.zoom,d&&this.fire(new s.Event("data",{dataType:"style"}))}},f.prototype._updateTilesForChangedImages=function(){var h=Object.keys(this._changedImages);if(h.length){for(var d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}},f.prototype._updateWorkerLayers=function(h,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:d})},f.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},f.prototype.setState=function(h){var d=this;if(this._checkLoaded(),As(this,s.validateStyle(h)))return!1;(h=s.clone$1(h)).layers=qe(h.layers);var _=function(E,A){if(!E)return[{command:Ze.setStyle,args:[A]}];var k=[];try{if(!s.deepEqual(E.version,A.version))return[{command:Ze.setStyle,args:[A]}];s.deepEqual(E.center,A.center)||k.push({command:Ze.setCenter,args:[A.center]}),s.deepEqual(E.zoom,A.zoom)||k.push({command:Ze.setZoom,args:[A.zoom]}),s.deepEqual(E.bearing,A.bearing)||k.push({command:Ze.setBearing,args:[A.bearing]}),s.deepEqual(E.pitch,A.pitch)||k.push({command:Ze.setPitch,args:[A.pitch]}),s.deepEqual(E.sprite,A.sprite)||k.push({command:Ze.setSprite,args:[A.sprite]}),s.deepEqual(E.glyphs,A.glyphs)||k.push({command:Ze.setGlyphs,args:[A.glyphs]}),s.deepEqual(E.transition,A.transition)||k.push({command:Ze.setTransition,args:[A.transition]}),s.deepEqual(E.light,A.light)||k.push({command:Ze.setLight,args:[A.light]});var z={},Z=[];(function($,oe,re,ue){var ee;for(ee in oe=oe||{},$=$||{})$.hasOwnProperty(ee)&&(oe.hasOwnProperty(ee)||$e(ee,re,ue));for(ee in oe)oe.hasOwnProperty(ee)&&($.hasOwnProperty(ee)?s.deepEqual($[ee],oe[ee])||($[ee].type==="geojson"&&oe[ee].type==="geojson"&&pn($,oe,ee)?re.push({command:Ze.setGeoJSONSourceData,args:[ee,oe[ee].data]}):Ht(ee,oe,re,ue)):kt(ee,oe,re))})(E.sources,A.sources,Z,z);var Y=[];E.layers&&E.layers.forEach(function($){z[$.source]?k.push({command:Ze.removeLayer,args:[$.id]}):Y.push($)}),k=k.concat(Z),function($,oe,re){oe=oe||[];var ue,ee,le,ge,be,Ce,Pe,ke=($=$||[]).map($t),ze=oe.map($t),He=$.reduce(Lt,{}),We=oe.reduce(Lt,{}),nt=ke.slice(),dt=Object.create(null);for(ue=0,ee=0;ue<ke.length;ue++)We.hasOwnProperty(le=ke[ue])?ee++:(re.push({command:Ze.removeLayer,args:[le]}),nt.splice(nt.indexOf(le,ee),1));for(ue=0,ee=0;ue<ze.length;ue++)nt[nt.length-1-ue]!==(le=ze[ze.length-1-ue])&&(He.hasOwnProperty(le)?(re.push({command:Ze.removeLayer,args:[le]}),nt.splice(nt.lastIndexOf(le,nt.length-ee),1)):ee++,re.push({command:Ze.addLayer,args:[We[le],Ce=nt[nt.length-ue]]}),nt.splice(nt.length-ue,0,le),dt[le]=!0);for(ue=0;ue<ze.length;ue++)if(ge=He[le=ze[ue]],be=We[le],!dt[le]&&!s.deepEqual(ge,be))if(s.deepEqual(ge.source,be.source)&&s.deepEqual(ge["source-layer"],be["source-layer"])&&s.deepEqual(ge.type,be.type)){for(Pe in Gt(ge.layout,be.layout,re,le,null,Ze.setLayoutProperty),Gt(ge.paint,be.paint,re,le,null,Ze.setPaintProperty),s.deepEqual(ge.filter,be.filter)||re.push({command:Ze.setFilter,args:[le,be.filter]}),s.deepEqual(ge.minzoom,be.minzoom)&&s.deepEqual(ge.maxzoom,be.maxzoom)||re.push({command:Ze.setLayerZoomRange,args:[le,be.minzoom,be.maxzoom]}),ge)ge.hasOwnProperty(Pe)&&Pe!=="layout"&&Pe!=="paint"&&Pe!=="filter"&&Pe!=="metadata"&&Pe!=="minzoom"&&Pe!=="maxzoom"&&(Pe.indexOf("paint.")===0?Gt(ge[Pe],be[Pe],re,le,Pe.slice(6),Ze.setPaintProperty):s.deepEqual(ge[Pe],be[Pe])||re.push({command:Ze.setLayerProperty,args:[le,Pe,be[Pe]]}));for(Pe in be)be.hasOwnProperty(Pe)&&!ge.hasOwnProperty(Pe)&&Pe!=="layout"&&Pe!=="paint"&&Pe!=="filter"&&Pe!=="metadata"&&Pe!=="minzoom"&&Pe!=="maxzoom"&&(Pe.indexOf("paint.")===0?Gt(ge[Pe],be[Pe],re,le,Pe.slice(6),Ze.setPaintProperty):s.deepEqual(ge[Pe],be[Pe])||re.push({command:Ze.setLayerProperty,args:[le,Pe,be[Pe]]}))}else re.push({command:Ze.removeLayer,args:[le]}),Ce=nt[nt.lastIndexOf(le)+1],re.push({command:Ze.addLayer,args:[be,Ce]})}(Y,A.layers,k)}catch($){console.warn("Unable to compute style diff:",$),k=[{command:Ze.setStyle,args:[A]}]}return k}(this.serialize(),h).filter(function(E){return!(E.command in Ba)});if(_.length===0)return!1;var w=_.filter(function(E){return!(E.command in za)});if(w.length>0)throw new Error("Unimplemented: "+w.map(function(E){return E.command}).join(", ")+".");return _.forEach(function(E){E.command!=="setTransition"&&d[E.command].apply(d,E.args)}),this.stylesheet=h,!0},f.prototype.addImage=function(h,d){if(this.getImage(h))return this.fire(new s.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(h,d),this._afterImageUpdated(h)},f.prototype.updateImage=function(h,d){this.imageManager.updateImage(h,d)},f.prototype.getImage=function(h){return this.imageManager.getImage(h)},f.prototype.removeImage=function(h){if(!this.getImage(h))return this.fire(new s.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(h),this._afterImageUpdated(h)},f.prototype._afterImageUpdated=function(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))},f.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},f.prototype.addSource=function(h,d,_){var w=this;if(_===void 0&&(_={}),this._checkLoaded(),this.sourceCaches[h]!==void 0)throw new Error("There is already a source with this ID");if(!d.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(d).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(s.validateStyle.source,"sources."+h,d,null,_))){this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);var E=this.sourceCaches[h]=new ae(h,d,this.dispatcher);E.style=this,E.setEventedParent(this,function(){return{isSourceLoaded:w.loaded(),source:E.serialize(),sourceId:h}}),E.onAdd(this.map),this._changed=!0}},f.prototype.removeSource=function(h){if(this._checkLoaded(),this.sourceCaches[h]===void 0)throw new Error("There is no source with this ID");for(var d in this._layers)if(this._layers[d].source===h)return this.fire(new s.ErrorEvent(new Error('Source "'+h+'" cannot be removed while layer "'+d+'" is using it.')));var _=this.sourceCaches[h];delete this.sourceCaches[h],delete this._updatedSources[h],_.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:h})),_.setEventedParent(null),_.clearTiles(),_.onRemove&&_.onRemove(this.map),this._changed=!0},f.prototype.setGeoJSONSourceData=function(h,d){this._checkLoaded(),this.sourceCaches[h].getSource().setData(d),this._changed=!0},f.prototype.getSource=function(h){return this.sourceCaches[h]&&this.sourceCaches[h].getSource()},f.prototype.addLayer=function(h,d,_){_===void 0&&(_={}),this._checkLoaded();var w=h.id;if(this.getLayer(w))this.fire(new s.ErrorEvent(new Error('Layer with id "'+w+'" already exists on this map')));else{var E;if(h.type==="custom"){if(As(this,s.validateCustomStyleLayer(h)))return;E=s.createStyleLayer(h)}else{if(typeof h.source=="object"&&(this.addSource(w,h.source),h=s.clone$1(h),h=s.extend(h,{source:w})),this._validate(s.validateStyle.layer,"layers."+w,h,{arrayIndex:-1},_))return;E=s.createStyleLayer(h),this._validateLayer(E),E.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[E.id]=E.serialize()}var A=d?this._order.indexOf(d):this._order.length;if(d&&A===-1)this.fire(new s.ErrorEvent(new Error('Layer with id "'+d+'" does not exist on this map.')));else{if(this._order.splice(A,0,w),this._layerOrderChanged=!0,this._layers[w]=E,this._removedLayers[w]&&E.source&&E.type!=="custom"){var k=this._removedLayers[w];delete this._removedLayers[w],k.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",this.sourceCaches[E.source].pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map)}}},f.prototype.moveLayer=function(h,d){if(this._checkLoaded(),this._changed=!0,this._layers[h]){if(h!==d){var _=this._order.indexOf(h);this._order.splice(_,1);var w=d?this._order.indexOf(d):this._order.length;d&&w===-1?this.fire(new s.ErrorEvent(new Error('Layer with id "'+d+'" does not exist on this map.'))):(this._order.splice(w,0,h),this._layerOrderChanged=!0)}}else this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be moved.")))},f.prototype.removeLayer=function(h){this._checkLoaded();var d=this._layers[h];if(d){d.setEventedParent(null);var _=this._order.indexOf(h);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=d,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],d.onRemove&&d.onRemove(this.map)}else this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be removed.")))},f.prototype.getLayer=function(h){return this._layers[h]},f.prototype.hasLayer=function(h){return h in this._layers},f.prototype.setLayerZoomRange=function(h,d,_){this._checkLoaded();var w=this.getLayer(h);w?w.minzoom===d&&w.maxzoom===_||(d!=null&&(w.minzoom=d),_!=null&&(w.maxzoom=_),this._updateLayer(w)):this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot have zoom extent.")))},f.prototype.setFilter=function(h,d,_){_===void 0&&(_={}),this._checkLoaded();var w=this.getLayer(h);if(w){if(!s.deepEqual(w.filter,d))return d==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(s.validateStyle.filter,"layers."+w.id+".filter",d,null,_)||(w.filter=s.clone$1(d),this._updateLayer(w)))}else this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be filtered.")))},f.prototype.getFilter=function(h){return s.clone$1(this.getLayer(h).filter)},f.prototype.setLayoutProperty=function(h,d,_,w){w===void 0&&(w={}),this._checkLoaded();var E=this.getLayer(h);E?s.deepEqual(E.getLayoutProperty(d),_)||(E.setLayoutProperty(d,_,w),this._updateLayer(E)):this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getLayoutProperty=function(h,d){var _=this.getLayer(h);if(_)return _.getLayoutProperty(d);this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style.")))},f.prototype.setPaintProperty=function(h,d,_,w){w===void 0&&(w={}),this._checkLoaded();var E=this.getLayer(h);E?s.deepEqual(E.getPaintProperty(d),_)||(E.setPaintProperty(d,_,w)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getPaintProperty=function(h,d){return this.getLayer(h).getPaintProperty(d)},f.prototype.setFeatureState=function(h,d){this._checkLoaded();var _=h.source,w=h.sourceLayer,E=this.sourceCaches[_];if(E!==void 0){var A=E.getSource().type;A==="geojson"&&w?this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):A!=="vector"||w?(h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),E.setFeatureState(w,h.id,d)):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},f.prototype.removeFeatureState=function(h,d){this._checkLoaded();var _=h.source,w=this.sourceCaches[_];if(w!==void 0){var E=w.getSource().type,A=E==="vector"?h.sourceLayer:void 0;E!=="vector"||A?d&&typeof h.id!="string"&&typeof h.id!="number"?this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(A,h.id,d):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},f.prototype.getFeatureState=function(h){this._checkLoaded();var d=h.source,_=h.sourceLayer,w=this.sourceCaches[d];if(w!==void 0){if(w.getSource().type!=="vector"||_)return h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(_,h.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},f.prototype.getTransition=function(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},f.prototype.serialize=function(){return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:s.mapObject(this.sourceCaches,function(h){return h.serialize()}),layers:this._serializeLayers(this._order)},function(h){return h!==void 0})},f.prototype._updateLayer=function(h){this._updatedLayers[h.id]=!0,h.source&&!this._updatedSources[h.source]&&this.sourceCaches[h.source].getSource().type!=="raster"&&(this._updatedSources[h.source]="reload",this.sourceCaches[h.source].pause()),this._changed=!0},f.prototype._flattenAndSortRenderedFeatures=function(h){for(var d=this,_=function(He){return d._layers[He].type==="fill-extrusion"},w={},E=[],A=this._order.length-1;A>=0;A--){var k=this._order[A];if(_(k)){w[k]=A;for(var z=0,Z=h;z<Z.length;z+=1){var Y=Z[z][k];if(Y)for(var $=0,oe=Y;$<oe.length;$+=1)E.push(oe[$])}}}E.sort(function(He,We){return We.intersectionZ-He.intersectionZ});for(var re=[],ue=this._order.length-1;ue>=0;ue--){var ee=this._order[ue];if(_(ee))for(var le=E.length-1;le>=0;le--){var ge=E[le].feature;if(w[ge.layer.id]<ue)break;re.push(ge),E.pop()}else for(var be=0,Ce=h;be<Ce.length;be+=1){var Pe=Ce[be][ee];if(Pe)for(var ke=0,ze=Pe;ke<ze.length;ke+=1)re.push(ze[ke].feature)}}return re},f.prototype.queryRenderedFeatures=function(h,d,_){d&&d.filter&&this._validate(s.validateStyle.filter,"queryRenderedFeatures.filter",d.filter,null,d);var w={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var E=0,A=d.layers;E<A.length;E+=1){var k=A[E],z=this._layers[k];if(!z)return this.fire(new s.ErrorEvent(new Error("The layer '"+k+"' does not exist in the map's style and cannot be queried for features."))),[];w[z.source]=!0}}var Z=[];for(var Y in d.availableImages=this._availableImages,this.sourceCaches)d.layers&&!w[Y]||Z.push(an(this.sourceCaches[Y],this._layers,this._serializedLayers,h,d,_));return this.placement&&Z.push(function($,oe,re,ue,ee,le,ge){for(var be={},Ce=le.queryRenderedSymbols(ue),Pe=[],ke=0,ze=Object.keys(Ce).map(Number);ke<ze.length;ke+=1)Pe.push(ge[ze[ke]]);Pe.sort(Wr);for(var He=function(){var yt=nt[We],nn=yt.featureIndex.lookupSymbolFeatures(Ce[yt.bucketInstanceId],oe,yt.bucketIndex,yt.sourceLayerIndex,ee.filter,ee.layers,ee.availableImages,$);for(var it in nn){var It=be[it]=be[it]||[],Ut=nn[it];Ut.sort(function(Nt,St){var Et=yt.featureSortOrder;if(Et){var br=Et.indexOf(Nt.featureIndex);return Et.indexOf(St.featureIndex)-br}return St.featureIndex-Nt.featureIndex});for(var Pt=0,At=Ut;Pt<At.length;Pt+=1)It.push(At[Pt])}},We=0,nt=Pe;We<nt.length;We+=1)He();var dt=function(yt){be[yt].forEach(function(nn){var it=nn.feature,It=re[$[yt].source].getFeatureState(it.layer["source-layer"],it.id);it.source=it.layer.source,it.layer["source-layer"]&&(it.sourceLayer=it.layer["source-layer"]),it.state=It})};for(var vt in be)dt(vt);return be}(this._layers,this._serializedLayers,this.sourceCaches,h,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Z)},f.prototype.querySourceFeatures=function(h,d){d&&d.filter&&this._validate(s.validateStyle.filter,"querySourceFeatures.filter",d.filter,null,d);var _=this.sourceCaches[h];return _?function(w,E){for(var A=w.getRenderableIds().map(function(oe){return w.getTileByID(oe)}),k=[],z={},Z=0;Z<A.length;Z++){var Y=A[Z],$=Y.tileID.canonical.key;z[$]||(z[$]=!0,Y.querySourceFeatures(k,E))}return k}(_,d):[]},f.prototype.addSourceType=function(h,d,_){return f.getSourceType(h)?_(new Error('A source type called "'+h+'" already exists.')):(f.setSourceType(h,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:d.workerSourceURL},_):_(null,null))},f.prototype.getLight=function(){return this.light.getLight()},f.prototype.setLight=function(h,d){d===void 0&&(d={}),this._checkLoaded();var _=this.light.getLight(),w=!1;for(var E in h)if(!s.deepEqual(h[E],_[E])){w=!0;break}if(w){var A={now:s.browser.now(),transition:s.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(h,d),this.light.updateTransitions(A)}},f.prototype._validate=function(h,d,_,w,E){return E===void 0&&(E={}),(!E||E.validate!==!1)&&As(this,h.call(s.validateStyle,s.extend({key:d,style:this.serialize(),value:_,styleSpec:s.styleSpec},w)))},f.prototype._remove=function(){for(var h in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[h].setEventedParent(null);for(var d in this.sourceCaches)this.sourceCaches[d].clearTiles(),this.sourceCaches[d].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},f.prototype._clearSource=function(h){this.sourceCaches[h].clearTiles()},f.prototype._reloadSource=function(h){this.sourceCaches[h].resume(),this.sourceCaches[h].reload()},f.prototype._updateSources=function(h){for(var d in this.sourceCaches)this.sourceCaches[d].update(h)},f.prototype._generateCollisionBoxes=function(){for(var h in this.sourceCaches)this._reloadSource(h)},f.prototype._updatePlacement=function(h,d,_,w,E){E===void 0&&(E=!1);for(var A=!1,k=!1,z={},Z=0,Y=this._order;Z<Y.length;Z+=1){var $=this._layers[Y[Z]];if($.type==="symbol"){if(!z[$.source]){var oe=this.sourceCaches[$.source];z[$.source]=oe.getRenderableIds(!0).map(function(ge){return oe.getTileByID(ge)}).sort(function(ge,be){return be.tileID.overscaledZ-ge.tileID.overscaledZ||(ge.tileID.isLessThan(be.tileID)?-1:1)})}var re=this.crossTileSymbolIndex.addLayer($,z[$.source],h.center.lng);A=A||re}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((E=E||this._layerOrderChanged||_===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.browser.now(),h.zoom))&&(this.pauseablePlacement=new vu(h,this._order,E,d,_,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.browser.now()),k=!0),A&&this.pauseablePlacement.placement.setStale()),k||A)for(var ue=0,ee=this._order;ue<ee.length;ue+=1){var le=this._layers[ee[ue]];le.type==="symbol"&&this.placement.updateLayerOpacities(le,z[le.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.browser.now())},f.prototype._releaseSymbolFadeTiles=function(){for(var h in this.sourceCaches)this.sourceCaches[h].releaseSymbolFadeTiles()},f.prototype.getImages=function(h,d,_){this.imageManager.getImages(d.icons,_),this._updateTilesForChangedImages();var w=this.sourceCaches[d.source];w&&w.setDependencies(d.tileID.key,d.type,d.icons)},f.prototype.getGlyphs=function(h,d,_){this.glyphManager.getGlyphs(d.stacks,_)},f.prototype.getResource=function(h,d,_){return s.makeRequest(d,_)},f}(s.Evented);Ai.getSourceType=function(c){return _i[c]},Ai.setSourceType=function(c,f){_i[c]=f},Ai.registerForPluginStateChange=s.registerForPluginStateChange;var ar=s.createLayout([{name:"a_pos",type:"Int16",components:2}]),bl=vn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Yd=vn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),mv=vn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),gv=vn(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Af=vn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Pf=vn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),If=vn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Cf=vn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),$d=vn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Kd=vn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),yv=vn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),_u=vn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),xu=vn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Jd=vn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Nr=vn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Mf=vn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Na=vn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Fa=vn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ps=vn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Is=vn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ua=vn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Cs=vn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Ms=vn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ja=vn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Qd=vn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),em=vn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function vn(c,f){var h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=f.match(/attribute ([\w]+) ([\w]+)/g),_=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=w?w.concat(_):_,A={};return{fragmentSource:c=c.replace(h,function(k,z,Z,Y,$){return A[$]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_`+$+`
varying `+Z+" "+Y+" "+$+`;
#else
uniform `+Z+" "+Y+" u_"+$+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+$+`
    `+Z+" "+Y+" "+$+" = u_"+$+`;
#endif
`}),vertexSource:f=f.replace(h,function(k,z,Z,Y,$){var oe=Y==="float"?"vec2":"vec4",re=$.match(/color/)?"color":oe;return A[$]?z==="define"?`
#ifndef HAS_UNIFORM_u_`+$+`
uniform lowp float u_`+$+`_t;
attribute `+Z+" "+oe+" a_"+$+`;
varying `+Z+" "+Y+" "+$+`;
#else
uniform `+Z+" "+Y+" u_"+$+`;
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_`+$+`
    `+$+" = a_"+$+`;
#else
    `+Z+" "+Y+" "+$+" = u_"+$+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+$+`
    `+$+" = unpack_mix_"+re+"(a_"+$+", u_"+$+`_t);
#else
    `+Z+" "+Y+" "+$+" = u_"+$+`;
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_`+$+`
uniform lowp float u_`+$+`_t;
attribute `+Z+" "+oe+" a_"+$+`;
#else
uniform `+Z+" "+Y+" u_"+$+`;
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_`+$+`
    `+Z+" "+Y+" "+$+" = a_"+$+`;
#else
    `+Z+" "+Y+" "+$+" = u_"+$+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+$+`
    `+Z+" "+Y+" "+$+" = unpack_mix_"+re+"(a_"+$+", u_"+$+`_t);
#else
    `+Z+" "+Y+" "+$+" = u_"+$+`;
#endif
`}),staticAttributes:d,staticUniforms:E}}var vv=Object.freeze({__proto__:null,prelude:bl,background:Yd,backgroundPattern:mv,circle:gv,clippingMask:Af,heatmap:Pf,heatmapTexture:If,collisionBox:Cf,collisionCircle:$d,debug:Kd,fill:yv,fillOutline:_u,fillOutlinePattern:xu,fillPattern:Jd,fillExtrusion:Nr,fillExtrusionPattern:Mf,hillshadePrepare:Na,hillshade:Fa,line:Ps,lineGradient:Is,linePattern:Ua,lineSDF:Cs,raster:Ms,symbolIcon:ja,symbolSDF:Qd,symbolTextAndIcon:em}),Sc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function tm(c){for(var f=[],h=0;h<c.length;h++)if(c[h]!==null){var d=c[h].split(" ");f.push(d.pop())}return f}Sc.prototype.bind=function(c,f,h,d,_,w,E,A){this.context=c;for(var k=this.boundPaintVertexBuffers.length!==d.length,z=0;!k&&z<d.length;z++)this.boundPaintVertexBuffers[z]!==d[z]&&(k=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===f&&this.boundLayoutVertexBuffer===h&&!k&&this.boundIndexBuffer===_&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===E&&this.boundDynamicVertexBuffer2===A?(c.bindVertexArrayOES.set(this.vao),E&&E.bind(),_&&_.dynamicDraw&&_.bind(),A&&A.bind()):this.freshBind(f,h,d,_,w,E,A)},Sc.prototype.freshBind=function(c,f,h,d,_,w,E){var A,k=c.numAttributes,z=this.context,Z=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),A=0,this.boundProgram=c,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=d,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=E;else{A=z.currentNumAttributes||0;for(var Y=k;Y<A;Y++)Z.disableVertexAttribArray(Y)}f.enableAttributes(Z,c);for(var $=0,oe=h;$<oe.length;$+=1)oe[$].enableAttributes(Z,c);w&&w.enableAttributes(Z,c),E&&E.enableAttributes(Z,c),f.bind(),f.setVertexAttribPointers(Z,c,_);for(var re=0,ue=h;re<ue.length;re+=1){var ee=ue[re];ee.bind(),ee.setVertexAttribPointers(Z,c,_)}w&&(w.bind(),w.setVertexAttribPointers(Z,c,_)),d&&d.bind(),E&&(E.bind(),E.setVertexAttribPointers(Z,c,_)),z.currentNumAttributes=k},Sc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var nm=function(c,f,h,d,_,w){var E=c.gl;this.program=E.createProgram();for(var A=tm(h.staticAttributes),k=d?d.getBinderAttributes():[],z=A.concat(k),Z=h.staticUniforms?tm(h.staticUniforms):[],Y=d?d.getBinderUniforms():[],$=[],oe=0,re=Z.concat(Y);oe<re.length;oe+=1){var ue=re[oe];$.indexOf(ue)<0&&$.push(ue)}var ee=d?d.defines():[];w&&ee.push("#define OVERDRAW_INSPECTOR;");var le=ee.concat(bl.fragmentSource,h.fragmentSource).join(`
`),ge=ee.concat(bl.vertexSource,h.vertexSource).join(`
`),be=E.createShader(E.FRAGMENT_SHADER);if(E.isContextLost())this.failedToCreate=!0;else{E.shaderSource(be,le),E.compileShader(be),E.attachShader(this.program,be);var Ce=E.createShader(E.VERTEX_SHADER);if(E.isContextLost())this.failedToCreate=!0;else{E.shaderSource(Ce,ge),E.compileShader(Ce),E.attachShader(this.program,Ce),this.attributes={};var Pe={};this.numAttributes=z.length;for(var ke=0;ke<this.numAttributes;ke++)z[ke]&&(E.bindAttribLocation(this.program,ke,z[ke]),this.attributes[z[ke]]=ke);E.linkProgram(this.program),E.deleteShader(Ce),E.deleteShader(be);for(var ze=0;ze<$.length;ze++){var He=$[ze];if(He&&!Pe[He]){var We=E.getUniformLocation(this.program,He);We&&(Pe[He]=We)}}this.fixedUniforms=_(c,Pe),this.binderUniforms=d?d.getUniforms(c,Pe):[]}}};function rm(c,f,h){var d=1/bn(h,1,f.transform.tileZoom),_=Math.pow(2,h.tileID.overscaledZ),w=h.tileSize*Math.pow(2,f.transform.tileZoom)/_,E=w*(h.tileID.canonical.x+h.tileID.wrap*_),A=w*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[d,c.fromScale,c.toScale],u_fade:c.t,u_pixel_coord_upper:[E>>16,A>>16],u_pixel_coord_lower:[65535&E,65535&A]}}nm.prototype.draw=function(c,f,h,d,_,w,E,A,k,z,Z,Y,$,oe,re,ue){var ee,le=c.gl;if(!this.failedToCreate){for(var ge in c.program.set(this.program),c.setDepthMode(h),c.setStencilMode(d),c.setColorMode(_),c.setCullFace(w),this.fixedUniforms)this.fixedUniforms[ge].set(E[ge]);oe&&oe.setUniforms(c,this.binderUniforms,Y,{zoom:$});for(var be=(ee={},ee[le.LINES]=2,ee[le.TRIANGLES]=3,ee[le.LINE_STRIP]=1,ee)[f],Ce=0,Pe=Z.get();Ce<Pe.length;Ce+=1){var ke=Pe[Ce],ze=ke.vaos||(ke.vaos={});(ze[A]||(ze[A]=new Sc)).bind(c,this,k,oe?oe.getPaintVertexBuffers():[],z,ke.vertexOffset,re,ue),le.drawElements(f,ke.primitiveLength*be,le.UNSIGNED_SHORT,ke.primitiveOffset*be*2)}}};var im=function(c,f,h,d){var _=f.style.light,w=_.properties.get("position"),E=[w.x,w.y,w.z],A=s.create$1();_.properties.get("anchor")==="viewport"&&s.fromRotation(A,-f.transform.angle),s.transformMat3(E,E,A);var k=_.properties.get("color");return{u_matrix:c,u_lightpos:E,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+h,u_opacity:d}},ks=function(c,f,h,d,_,w,E){return s.extend(im(c,f,h,d),rm(w,f,E),{u_height_factor:-Math.pow(2,_.overscaledZ)/E.tileSize/8})},Va=function(c){return{u_matrix:c}},Ls=function(c,f,h,d){return s.extend(Va(c),rm(h,f,d))},om=function(c,f){return{u_matrix:c,u_world:f}},am=function(c,f,h,d,_){return s.extend(Ls(c,f,h,d),{u_world:_})},kf=function(c,f,h,d){var _,w,E=c.transform;if(d.paint.get("circle-pitch-alignment")==="map"){var A=bn(h,1,E.zoom);_=!0,w=[A,A]}else _=!1,w=E.pixelsToGLUnits;return{u_camera_to_center_distance:E.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:c.translatePosMatrix(f.posMatrix,h,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:s.browser.devicePixelRatio,u_extrude_scale:w}},Rs=function(c,f,h){var d=bn(h,1,f.zoom),_=Math.pow(2,f.zoom-h.tileID.overscaledZ),w=h.tileID.overscaleFactor();return{u_matrix:c,u_camera_to_center_distance:f.cameraToCenterDistance,u_pixels_to_tile_units:d,u_extrude_scale:[f.pixelsToGLUnits[0]/(d*_),f.pixelsToGLUnits[1]/(d*_)],u_overscale_factor:w}},sm=function(c,f,h){return{u_matrix:c,u_inv_matrix:f,u_camera_to_center_distance:h.cameraToCenterDistance,u_viewport_size:[h.width,h.height]}},Os=function(c,f,h){return h===void 0&&(h=1),{u_matrix:c,u_color:f,u_overlay:0,u_overlay_scale:h}},Ds=function(c){return{u_matrix:c}},lm=function(c,f,h,d){return{u_matrix:c,u_extrude_scale:bn(f,1,h),u_intensity:d}},bu=function(c,f,h){var d=c.transform;return{u_matrix:um(c,f,h),u_ratio:1/bn(f,1,d.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},wn=function(c,f,h,d){return s.extend(bu(c,f,h),{u_image:0,u_image_height:d})},Ac=function(c,f,h,d){var _=c.transform,w=wl(f,_);return{u_matrix:um(c,f,h),u_texsize:f.imageAtlasTexture.size,u_ratio:1/bn(f,1,_.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_image:0,u_scale:[w,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},_v=function(c,f,h,d,_){var w=c.lineAtlas,E=wl(f,c.transform),A=h.layout.get("line-cap")==="round",k=w.getDash(d.from,A),z=w.getDash(d.to,A),Z=k.width*_.fromScale,Y=z.width*_.toScale;return s.extend(bu(c,f,h),{u_patternscale_a:[E/Z,-k.height/2],u_patternscale_b:[E/Y,-z.height/2],u_sdfgamma:w.width/(256*Math.min(Z,Y)*s.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:z.y,u_mix:_.t})};function wl(c,f){return 1/bn(c,1,f.tileZoom)}function um(c,f,h){return c.translatePosMatrix(f.tileID.posMatrix,f,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}var xv=function(c,f,h,d,_){return{u_matrix:c,u_tl_parent:f,u_scale_parent:h,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(E=_.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(w=_.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:cm(_.paint.get("raster-hue-rotate"))};var w,E};function cm(c){c*=Math.PI/180;var f=Math.sin(c),h=Math.cos(c);return[(2*h+1)/3,(-Math.sqrt(3)*f-h+1)/3,(Math.sqrt(3)*f-h+1)/3]}var Pc,El=function(c,f,h,d,_,w,E,A,k,z){var Z=_.transform;return{u_is_size_zoom_constant:+(c==="constant"||c==="source"),u_is_size_feature_constant:+(c==="constant"||c==="camera"),u_size_t:f?f.uSizeT:0,u_size:f?f.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:Z.width/Z.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:E,u_coord_matrix:A,u_is_text:+k,u_pitch_with_map:+d,u_texsize:z,u_texture:0}},wu=function(c,f,h,d,_,w,E,A,k,z,Z){var Y=_.transform;return s.extend(El(c,f,h,d,_,w,E,A,k,z),{u_gamma_scale:d?Math.cos(Y._pitch)*Y.cameraToCenterDistance:1,u_device_pixel_ratio:s.browser.devicePixelRatio,u_is_halo:+Z})},Ic=function(c,f,h,d,_,w,E,A,k,z){return s.extend(wu(c,f,h,d,_,w,E,A,!0,k,!0),{u_texsize_icon:z,u_texture_icon:1})},Eu=function(c,f,h){return{u_matrix:c,u_opacity:f,u_color:h}},Tl=function(c,f,h,d,_,w){return s.extend(function(E,A,k,z){var Z=k.imageManager.getPattern(E.from.toString()),Y=k.imageManager.getPattern(E.to.toString()),$=k.imageManager.getPixelSize(),oe=$.width,re=$.height,ue=Math.pow(2,z.tileID.overscaledZ),ee=z.tileSize*Math.pow(2,k.transform.tileZoom)/ue,le=ee*(z.tileID.canonical.x+z.tileID.wrap*ue),ge=ee*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:Y.tl,u_pattern_br_b:Y.br,u_texsize:[oe,re],u_mix:A.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:Y.displaySize,u_scale_a:A.fromScale,u_scale_b:A.toScale,u_tile_units_to_pixels:1/bn(z,1,k.transform.tileZoom),u_pixel_coord_upper:[le>>16,ge>>16],u_pixel_coord_lower:[65535&le,65535&ge]}}(d,w,h,_),{u_matrix:c,u_opacity:f})},hm={fillExtrusion:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_lightpos:new s.Uniform3f(c,f.u_lightpos),u_lightintensity:new s.Uniform1f(c,f.u_lightintensity),u_lightcolor:new s.Uniform3f(c,f.u_lightcolor),u_vertical_gradient:new s.Uniform1f(c,f.u_vertical_gradient),u_opacity:new s.Uniform1f(c,f.u_opacity)}},fillExtrusionPattern:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_lightpos:new s.Uniform3f(c,f.u_lightpos),u_lightintensity:new s.Uniform1f(c,f.u_lightintensity),u_lightcolor:new s.Uniform3f(c,f.u_lightcolor),u_vertical_gradient:new s.Uniform1f(c,f.u_vertical_gradient),u_height_factor:new s.Uniform1f(c,f.u_height_factor),u_image:new s.Uniform1i(c,f.u_image),u_texsize:new s.Uniform2f(c,f.u_texsize),u_pixel_coord_upper:new s.Uniform2f(c,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(c,f.u_pixel_coord_lower),u_scale:new s.Uniform3f(c,f.u_scale),u_fade:new s.Uniform1f(c,f.u_fade),u_opacity:new s.Uniform1f(c,f.u_opacity)}},fill:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix)}},fillPattern:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_image:new s.Uniform1i(c,f.u_image),u_texsize:new s.Uniform2f(c,f.u_texsize),u_pixel_coord_upper:new s.Uniform2f(c,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(c,f.u_pixel_coord_lower),u_scale:new s.Uniform3f(c,f.u_scale),u_fade:new s.Uniform1f(c,f.u_fade)}},fillOutline:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_world:new s.Uniform2f(c,f.u_world)}},fillOutlinePattern:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_world:new s.Uniform2f(c,f.u_world),u_image:new s.Uniform1i(c,f.u_image),u_texsize:new s.Uniform2f(c,f.u_texsize),u_pixel_coord_upper:new s.Uniform2f(c,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(c,f.u_pixel_coord_lower),u_scale:new s.Uniform3f(c,f.u_scale),u_fade:new s.Uniform1f(c,f.u_fade)}},circle:function(c,f){return{u_camera_to_center_distance:new s.Uniform1f(c,f.u_camera_to_center_distance),u_scale_with_map:new s.Uniform1i(c,f.u_scale_with_map),u_pitch_with_map:new s.Uniform1i(c,f.u_pitch_with_map),u_extrude_scale:new s.Uniform2f(c,f.u_extrude_scale),u_device_pixel_ratio:new s.Uniform1f(c,f.u_device_pixel_ratio),u_matrix:new s.UniformMatrix4f(c,f.u_matrix)}},collisionBox:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_camera_to_center_distance:new s.Uniform1f(c,f.u_camera_to_center_distance),u_pixels_to_tile_units:new s.Uniform1f(c,f.u_pixels_to_tile_units),u_extrude_scale:new s.Uniform2f(c,f.u_extrude_scale),u_overscale_factor:new s.Uniform1f(c,f.u_overscale_factor)}},collisionCircle:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_inv_matrix:new s.UniformMatrix4f(c,f.u_inv_matrix),u_camera_to_center_distance:new s.Uniform1f(c,f.u_camera_to_center_distance),u_viewport_size:new s.Uniform2f(c,f.u_viewport_size)}},debug:function(c,f){return{u_color:new s.UniformColor(c,f.u_color),u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_overlay:new s.Uniform1i(c,f.u_overlay),u_overlay_scale:new s.Uniform1f(c,f.u_overlay_scale)}},clippingMask:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix)}},heatmap:function(c,f){return{u_extrude_scale:new s.Uniform1f(c,f.u_extrude_scale),u_intensity:new s.Uniform1f(c,f.u_intensity),u_matrix:new s.UniformMatrix4f(c,f.u_matrix)}},heatmapTexture:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_world:new s.Uniform2f(c,f.u_world),u_image:new s.Uniform1i(c,f.u_image),u_color_ramp:new s.Uniform1i(c,f.u_color_ramp),u_opacity:new s.Uniform1f(c,f.u_opacity)}},hillshade:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_image:new s.Uniform1i(c,f.u_image),u_latrange:new s.Uniform2f(c,f.u_latrange),u_light:new s.Uniform2f(c,f.u_light),u_shadow:new s.UniformColor(c,f.u_shadow),u_highlight:new s.UniformColor(c,f.u_highlight),u_accent:new s.UniformColor(c,f.u_accent)}},hillshadePrepare:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_image:new s.Uniform1i(c,f.u_image),u_dimension:new s.Uniform2f(c,f.u_dimension),u_zoom:new s.Uniform1f(c,f.u_zoom),u_unpack:new s.Uniform4f(c,f.u_unpack)}},line:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_ratio:new s.Uniform1f(c,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(c,f.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(c,f.u_units_to_pixels)}},lineGradient:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_ratio:new s.Uniform1f(c,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(c,f.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(c,f.u_units_to_pixels),u_image:new s.Uniform1i(c,f.u_image),u_image_height:new s.Uniform1f(c,f.u_image_height)}},linePattern:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_texsize:new s.Uniform2f(c,f.u_texsize),u_ratio:new s.Uniform1f(c,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(c,f.u_device_pixel_ratio),u_image:new s.Uniform1i(c,f.u_image),u_units_to_pixels:new s.Uniform2f(c,f.u_units_to_pixels),u_scale:new s.Uniform3f(c,f.u_scale),u_fade:new s.Uniform1f(c,f.u_fade)}},lineSDF:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_ratio:new s.Uniform1f(c,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(c,f.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(c,f.u_units_to_pixels),u_patternscale_a:new s.Uniform2f(c,f.u_patternscale_a),u_patternscale_b:new s.Uniform2f(c,f.u_patternscale_b),u_sdfgamma:new s.Uniform1f(c,f.u_sdfgamma),u_image:new s.Uniform1i(c,f.u_image),u_tex_y_a:new s.Uniform1f(c,f.u_tex_y_a),u_tex_y_b:new s.Uniform1f(c,f.u_tex_y_b),u_mix:new s.Uniform1f(c,f.u_mix)}},raster:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_tl_parent:new s.Uniform2f(c,f.u_tl_parent),u_scale_parent:new s.Uniform1f(c,f.u_scale_parent),u_buffer_scale:new s.Uniform1f(c,f.u_buffer_scale),u_fade_t:new s.Uniform1f(c,f.u_fade_t),u_opacity:new s.Uniform1f(c,f.u_opacity),u_image0:new s.Uniform1i(c,f.u_image0),u_image1:new s.Uniform1i(c,f.u_image1),u_brightness_low:new s.Uniform1f(c,f.u_brightness_low),u_brightness_high:new s.Uniform1f(c,f.u_brightness_high),u_saturation_factor:new s.Uniform1f(c,f.u_saturation_factor),u_contrast_factor:new s.Uniform1f(c,f.u_contrast_factor),u_spin_weights:new s.Uniform3f(c,f.u_spin_weights)}},symbolIcon:function(c,f){return{u_is_size_zoom_constant:new s.Uniform1i(c,f.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(c,f.u_is_size_feature_constant),u_size_t:new s.Uniform1f(c,f.u_size_t),u_size:new s.Uniform1f(c,f.u_size),u_camera_to_center_distance:new s.Uniform1f(c,f.u_camera_to_center_distance),u_pitch:new s.Uniform1f(c,f.u_pitch),u_rotate_symbol:new s.Uniform1i(c,f.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(c,f.u_aspect_ratio),u_fade_change:new s.Uniform1f(c,f.u_fade_change),u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(c,f.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(c,f.u_coord_matrix),u_is_text:new s.Uniform1i(c,f.u_is_text),u_pitch_with_map:new s.Uniform1i(c,f.u_pitch_with_map),u_texsize:new s.Uniform2f(c,f.u_texsize),u_texture:new s.Uniform1i(c,f.u_texture)}},symbolSDF:function(c,f){return{u_is_size_zoom_constant:new s.Uniform1i(c,f.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(c,f.u_is_size_feature_constant),u_size_t:new s.Uniform1f(c,f.u_size_t),u_size:new s.Uniform1f(c,f.u_size),u_camera_to_center_distance:new s.Uniform1f(c,f.u_camera_to_center_distance),u_pitch:new s.Uniform1f(c,f.u_pitch),u_rotate_symbol:new s.Uniform1i(c,f.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(c,f.u_aspect_ratio),u_fade_change:new s.Uniform1f(c,f.u_fade_change),u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(c,f.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(c,f.u_coord_matrix),u_is_text:new s.Uniform1i(c,f.u_is_text),u_pitch_with_map:new s.Uniform1i(c,f.u_pitch_with_map),u_texsize:new s.Uniform2f(c,f.u_texsize),u_texture:new s.Uniform1i(c,f.u_texture),u_gamma_scale:new s.Uniform1f(c,f.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(c,f.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(c,f.u_is_halo)}},symbolTextAndIcon:function(c,f){return{u_is_size_zoom_constant:new s.Uniform1i(c,f.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(c,f.u_is_size_feature_constant),u_size_t:new s.Uniform1f(c,f.u_size_t),u_size:new s.Uniform1f(c,f.u_size),u_camera_to_center_distance:new s.Uniform1f(c,f.u_camera_to_center_distance),u_pitch:new s.Uniform1f(c,f.u_pitch),u_rotate_symbol:new s.Uniform1i(c,f.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(c,f.u_aspect_ratio),u_fade_change:new s.Uniform1f(c,f.u_fade_change),u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(c,f.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(c,f.u_coord_matrix),u_is_text:new s.Uniform1i(c,f.u_is_text),u_pitch_with_map:new s.Uniform1i(c,f.u_pitch_with_map),u_texsize:new s.Uniform2f(c,f.u_texsize),u_texsize_icon:new s.Uniform2f(c,f.u_texsize_icon),u_texture:new s.Uniform1i(c,f.u_texture),u_texture_icon:new s.Uniform1i(c,f.u_texture_icon),u_gamma_scale:new s.Uniform1f(c,f.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(c,f.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(c,f.u_is_halo)}},background:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_opacity:new s.Uniform1f(c,f.u_opacity),u_color:new s.UniformColor(c,f.u_color)}},backgroundPattern:function(c,f){return{u_matrix:new s.UniformMatrix4f(c,f.u_matrix),u_opacity:new s.Uniform1f(c,f.u_opacity),u_image:new s.Uniform1i(c,f.u_image),u_pattern_tl_a:new s.Uniform2f(c,f.u_pattern_tl_a),u_pattern_br_a:new s.Uniform2f(c,f.u_pattern_br_a),u_pattern_tl_b:new s.Uniform2f(c,f.u_pattern_tl_b),u_pattern_br_b:new s.Uniform2f(c,f.u_pattern_br_b),u_texsize:new s.Uniform2f(c,f.u_texsize),u_mix:new s.Uniform1f(c,f.u_mix),u_pattern_size_a:new s.Uniform2f(c,f.u_pattern_size_a),u_pattern_size_b:new s.Uniform2f(c,f.u_pattern_size_b),u_scale_a:new s.Uniform1f(c,f.u_scale_a),u_scale_b:new s.Uniform1f(c,f.u_scale_b),u_pixel_coord_upper:new s.Uniform2f(c,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(c,f.u_pixel_coord_lower),u_tile_units_to_pixels:new s.Uniform1f(c,f.u_tile_units_to_pixels)}}};function Sl(c,f,h,d,_,w,E){for(var A=c.context,k=A.gl,z=c.useProgram("collisionBox"),Z=[],Y=0,$=0,oe=0;oe<d.length;oe++){var re=d[oe],ue=f.getTile(re),ee=ue.getBucket(h);if(ee){var le=re.posMatrix;_[0]===0&&_[1]===0||(le=c.translatePosMatrix(re.posMatrix,ue,_,w));var ge=E?ee.textCollisionBox:ee.iconCollisionBox,be=ee.collisionCircleArray;if(be.length>0){var Ce=s.create(),Pe=le;s.mul(Ce,ee.placementInvProjMatrix,c.transform.glCoordMatrix),s.mul(Ce,Ce,ee.placementViewportMatrix),Z.push({circleArray:be,circleOffset:$,transform:Pe,invTransform:Ce}),$=Y+=be.length/4}ge&&z.draw(A,k.LINES,J.disabled,ie.disabled,c.colorModeForRenderPass(),me.disabled,Rs(le,c.transform,ue),h.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,null,c.transform.zoom,null,null,ge.collisionVertexBuffer)}}if(E&&Z.length){var ke=c.useProgram("collisionCircle"),ze=new s.StructArrayLayout2f1f2i16;ze.resize(4*Y),ze._trim();for(var He=0,We=0,nt=Z;We<nt.length;We+=1)for(var dt=nt[We],vt=0;vt<dt.circleArray.length/4;vt++){var yt=4*vt,nn=dt.circleArray[yt+0],it=dt.circleArray[yt+1],It=dt.circleArray[yt+2],Ut=dt.circleArray[yt+3];ze.emplace(He++,nn,it,It,Ut,0),ze.emplace(He++,nn,it,It,Ut,1),ze.emplace(He++,nn,it,It,Ut,2),ze.emplace(He++,nn,it,It,Ut,3)}(!Pc||Pc.length<2*Y)&&(Pc=function(Vn){var Xr=2*Vn,kr=new s.StructArrayLayout3ui6;kr.resize(Xr),kr._trim();for(var Bn=0;Bn<Xr;Bn++){var Yn=6*Bn;kr.uint16[Yn+0]=4*Bn+0,kr.uint16[Yn+1]=4*Bn+1,kr.uint16[Yn+2]=4*Bn+2,kr.uint16[Yn+3]=4*Bn+2,kr.uint16[Yn+4]=4*Bn+3,kr.uint16[Yn+5]=4*Bn+0}return kr}(Y));for(var Pt=A.createIndexBuffer(Pc,!0),At=A.createVertexBuffer(ze,s.collisionCircleLayout.members,!0),Nt=0,St=Z;Nt<St.length;Nt+=1){var Et=St[Nt],br=sm(Et.transform,Et.invTransform,c.transform);ke.draw(A,k.TRIANGLES,J.disabled,ie.disabled,c.colorModeForRenderPass(),me.disabled,br,h.id,At,Pt,s.SegmentVector.simpleSegment(0,2*Et.circleOffset,Et.circleArray.length,Et.circleArray.length/2),null,c.transform.zoom,null,null,null)}At.destroy(),Pt.destroy()}}var _o=s.identity(new Float32Array(16));function fm(c,f,h,d,_,w){var E=s.getAnchorAlignment(c),A=-(E.horizontalAlign-.5)*f,k=-(E.verticalAlign-.5)*h,z=s.evaluateVariableOffset(c,d);return new s.Point((A/_+z[0])*w,(k/_+z[1])*w)}function pm(c,f,h,d,_,w,E,A,k,z,Z){var Y=c.text.placedSymbolArray,$=c.text.dynamicLayoutVertexArray,oe=c.icon.dynamicLayoutVertexArray,re={};$.clear();for(var ue=0;ue<Y.length;ue++){var ee=Y.get(ue),le=ee.hidden||!ee.crossTileID||c.allowVerticalPlacement&&!ee.placedOrientation?null:d[ee.crossTileID];if(le){var ge=new s.Point(ee.anchorX,ee.anchorY),be=Rt(ge,h?A:E),Ce=Wt(w.cameraToCenterDistance,be.signedDistanceFromCamera),Pe=_.evaluateSizeForFeature(c.textSizeData,z,ee)*Ce/s.ONE_EM;h&&(Pe*=c.tilePixelRatio/k);for(var ke=fm(le.anchor,le.width,le.height,le.textOffset,le.textBoxScale,Pe),ze=h?Rt(ge.add(ke),E).point:be.point.add(f?ke.rotate(-w.angle):ke),He=c.allowVerticalPlacement&&ee.placedOrientation===s.WritingMode.vertical?Math.PI/2:0,We=0;We<ee.numGlyphs;We++)s.addDynamicAttributes($,ze,He);Z&&ee.associatedIconIndex>=0&&(re[ee.associatedIconIndex]={shiftedAnchor:ze,angle:He})}else xr(ee.numGlyphs,$)}if(Z){oe.clear();for(var nt=c.icon.placedSymbolArray,dt=0;dt<nt.length;dt++){var vt=nt.get(dt);if(vt.hidden)xr(vt.numGlyphs,oe);else{var yt=re[dt];if(yt)for(var nn=0;nn<vt.numGlyphs;nn++)s.addDynamicAttributes(oe,yt.shiftedAnchor,yt.angle);else xr(vt.numGlyphs,oe)}}c.icon.dynamicLayoutVertexBuffer.updateData(oe)}c.text.dynamicLayoutVertexBuffer.updateData($)}function dm(c,f,h){return h.iconsInText&&f?"symbolTextAndIcon":c?"symbolSDF":"symbolIcon"}function zs(c,f,h,d,_,w,E,A,k,z,Z,Y){for(var $=c.context,oe=$.gl,re=c.transform,ue=A==="map",ee=k==="map",le=ue&&h.layout.get("symbol-placement")!=="point",ge=ue&&!ee&&!le,be=h.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ce=!1,Pe=c.depthModeForSublayer(0,J.ReadOnly),ke=h.layout.get("text-variable-anchor"),ze=[],He=0,We=d;He<We.length;He+=1){var nt=We[He],dt=f.getTile(nt),vt=dt.getBucket(h);if(vt){var yt=_?vt.text:vt.icon;if(yt&&yt.segments.get().length){var nn=yt.programConfigurations.get(h.id),it=_||vt.sdfIcons,It=_?vt.textSizeData:vt.iconSizeData,Ut=ee||re.pitch!==0,Pt=c.useProgram(dm(it,_,vt),nn),At=s.evaluateSizeForZoom(It,re.zoom),Nt=void 0,St=[0,0],Et=void 0,br=void 0,Vn=null,Xr=void 0;if(_)Et=dt.glyphAtlasTexture,br=oe.LINEAR,Nt=dt.glyphAtlasTexture.size,vt.iconsInText&&(St=dt.imageAtlasTexture.size,Vn=dt.imageAtlasTexture,Xr=Ut||c.options.rotating||c.options.zooming||It.kind==="composite"||It.kind==="camera"?oe.LINEAR:oe.NEAREST);else{var kr=h.layout.get("icon-size").constantOr(0)!==1||vt.iconsNeedLinear;Et=dt.imageAtlasTexture,br=it||c.options.rotating||c.options.zooming||kr||Ut?oe.LINEAR:oe.NEAREST,Nt=dt.imageAtlasTexture.size}var Bn=bn(dt,1,c.transform.zoom),Yn=dn(nt.posMatrix,ee,ue,c.transform,Bn),Li=on(nt.posMatrix,ee,ue,c.transform,Bn),ri=ke&&vt.hasTextData(),Xa=h.layout.get("icon-text-fit")!=="none"&&ri&&vt.hasIconData();le&&La(vt,nt.posMatrix,c,_,Yn,Li,ee,z);var ui=c.translatePosMatrix(nt.posMatrix,dt,w,E),To=le||_&&ke||Xa?_o:Yn,ao=c.translatePosMatrix(Li,dt,w,E,!0),Du=it&&h.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0,kl={program:Pt,buffers:yt,uniformValues:it?vt.iconsInText?Ic(It.kind,At,ge,ee,c,ui,To,ao,Nt,St):wu(It.kind,At,ge,ee,c,ui,To,ao,_,Nt,!0):El(It.kind,At,ge,ee,c,ui,To,ao,_,Nt),atlasTexture:Et,atlasTextureIcon:Vn,atlasInterpolation:br,atlasInterpolationIcon:Xr,isSDF:it,hasHalo:Du};if(be&&vt.canOverlap){Ce=!0;for(var Ya=0,Ll=yt.segments.get();Ya<Ll.length;Ya+=1){var zu=Ll[Ya];ze.push({segments:new s.SegmentVector([zu]),sortKey:zu.sortKey,state:kl})}}else ze.push({segments:yt.segments,sortKey:0,state:kl})}}}Ce&&ze.sort(function($a,Vs){return $a.sortKey-Vs.sortKey});for(var Go=0,Bu=ze;Go<Bu.length;Go+=1){var Wo=Bu[Go],wr=Wo.state;if($.activeTexture.set(oe.TEXTURE0),wr.atlasTexture.bind(wr.atlasInterpolation,oe.CLAMP_TO_EDGE),wr.atlasTextureIcon&&($.activeTexture.set(oe.TEXTURE1),wr.atlasTextureIcon&&wr.atlasTextureIcon.bind(wr.atlasInterpolationIcon,oe.CLAMP_TO_EDGE)),wr.isSDF){var ca=wr.uniformValues;wr.hasHalo&&(ca.u_is_halo=1,Tu(wr.buffers,Wo.segments,h,c,wr.program,Pe,Z,Y,ca)),ca.u_is_halo=0}Tu(wr.buffers,Wo.segments,h,c,wr.program,Pe,Z,Y,wr.uniformValues)}}function Tu(c,f,h,d,_,w,E,A,k){var z=d.context;_.draw(z,z.gl.TRIANGLES,w,E,A,me.disabled,k,h.id,c.layoutVertexBuffer,c.indexBuffer,f,h.paint,d.transform.zoom,c.programConfigurations.get(h.id),c.dynamicLayoutVertexBuffer,c.opacityVertexBuffer)}function Cc(c,f,h,d,_,w,E){var A,k,z,Z,Y,$=c.context.gl,oe=h.paint.get("fill-pattern"),re=oe&&oe.constantOr(1),ue=h.getCrossfadeParameters();E?(k=re&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",A=$.LINES):(k=re?"fillPattern":"fill",A=$.TRIANGLES);for(var ee=0,le=d;ee<le.length;ee+=1){var ge=le[ee],be=f.getTile(ge);if(!re||be.patternsLoaded()){var Ce=be.getBucket(h);if(Ce){var Pe=Ce.programConfigurations.get(h.id),ke=c.useProgram(k,Pe);re&&(c.context.activeTexture.set($.TEXTURE0),be.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Pe.updatePaintBuffers(ue));var ze=oe.constantOr(null);if(ze&&be.imageAtlas){var He=be.imageAtlas,We=He.patternPositions[ze.to.toString()],nt=He.patternPositions[ze.from.toString()];We&&nt&&Pe.setConstantPatternPositions(We,nt)}var dt=c.translatePosMatrix(ge.posMatrix,be,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(E){Z=Ce.indexBuffer2,Y=Ce.segments2;var vt=[$.drawingBufferWidth,$.drawingBufferHeight];z=k==="fillOutlinePattern"&&re?am(dt,c,ue,be,vt):om(dt,vt)}else Z=Ce.indexBuffer,Y=Ce.segments,z=re?Ls(dt,c,ue,be):Va(dt);ke.draw(c.context,A,_,c.stencilModeForClipping(ge),w,me.disabled,z,h.id,Ce.layoutVertexBuffer,Z,Y,h.paint,c.transform.zoom,Pe)}}}}function Lf(c,f,h,d,_,w,E){for(var A=c.context,k=A.gl,z=h.paint.get("fill-extrusion-pattern"),Z=z.constantOr(1),Y=h.getCrossfadeParameters(),$=h.paint.get("fill-extrusion-opacity"),oe=0,re=d;oe<re.length;oe+=1){var ue=re[oe],ee=f.getTile(ue),le=ee.getBucket(h);if(le){var ge=le.programConfigurations.get(h.id),be=c.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",ge);Z&&(c.context.activeTexture.set(k.TEXTURE0),ee.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ge.updatePaintBuffers(Y));var Ce=z.constantOr(null);if(Ce&&ee.imageAtlas){var Pe=ee.imageAtlas,ke=Pe.patternPositions[Ce.to.toString()],ze=Pe.patternPositions[Ce.from.toString()];ke&&ze&&ge.setConstantPatternPositions(ke,ze)}var He=c.translatePosMatrix(ue.posMatrix,ee,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),We=h.paint.get("fill-extrusion-vertical-gradient"),nt=Z?ks(He,c,We,$,ue,Y,ee):im(He,c,We,$);be.draw(A,A.gl.TRIANGLES,_,w,E,me.backCCW,nt,h.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,h.paint,c.transform.zoom,ge)}}}function Mc(c,f,h,d,_,w){var E=c.context,A=E.gl,k=f.fbo;if(k){var z=c.useProgram("hillshade");E.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,k.colorAttachment.get());var Z=function(Y,$,oe){var re=oe.paint.get("hillshade-shadow-color"),ue=oe.paint.get("hillshade-highlight-color"),ee=oe.paint.get("hillshade-accent-color"),le=oe.paint.get("hillshade-illumination-direction")*(Math.PI/180);oe.paint.get("hillshade-illumination-anchor")==="viewport"&&(le-=Y.transform.angle);var ge,be,Ce,Pe=!Y.options.moving;return{u_matrix:Y.transform.calculatePosMatrix($.tileID.toUnwrapped(),Pe),u_image:0,u_latrange:(ge=$.tileID,be=Math.pow(2,ge.canonical.z),Ce=ge.canonical.y,[new s.MercatorCoordinate(0,Ce/be).toLngLat().lat,new s.MercatorCoordinate(0,(Ce+1)/be).toLngLat().lat]),u_light:[oe.paint.get("hillshade-exaggeration"),le],u_shadow:re,u_highlight:ue,u_accent:ee}}(c,f,h);z.draw(E,A.TRIANGLES,d,_,w,me.disabled,Z,h.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments)}}function bv(c,f,h,d,_,w){var E=c.context,A=E.gl,k=f.dem;if(k&&k.data){var z=k.dim,Z=k.stride,Y=k.getPixels();if(E.activeTexture.set(A.TEXTURE1),E.pixelStoreUnpackPremultiplyAlpha.set(!1),f.demTexture=f.demTexture||c.getTileTexture(Z),f.demTexture){var $=f.demTexture;$.update(Y,{premultiply:!1}),$.bind(A.NEAREST,A.CLAMP_TO_EDGE)}else f.demTexture=new s.Texture(E,Y,A.RGBA,{premultiply:!1}),f.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE);E.activeTexture.set(A.TEXTURE0);var oe=f.fbo;if(!oe){var re=new s.Texture(E,{width:z,height:z,data:null},A.RGBA);re.bind(A.LINEAR,A.CLAMP_TO_EDGE),(oe=f.fbo=E.createFramebuffer(z,z,!0)).colorAttachment.set(re.texture)}E.bindFramebuffer.set(oe.framebuffer),E.viewport.set([0,0,z,z]),c.useProgram("hillshadePrepare").draw(E,A.TRIANGLES,d,_,w,me.disabled,function(ue,ee){var le=ee.stride,ge=s.create();return s.ortho(ge,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(ge,ge,[0,-s.EXTENT,0]),{u_matrix:ge,u_image:1,u_dimension:[le,le],u_zoom:ue.overscaledZ,u_unpack:ee.getUnpackVector()}}(f.tileID,k),h.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments),f.needsHillshadePrepare=!1}}function kc(c,f,h,d,_){var w=d.paint.get("raster-fade-duration");if(w>0){var E=s.browser.now(),A=(E-c.timeAdded)/w,k=f?(E-f.timeAdded)/w:-1,z=h.getSource(),Z=_.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),Y=!f||Math.abs(f.tileID.overscaledZ-Z)>Math.abs(c.tileID.overscaledZ-Z),$=Y&&c.refreshedUponExpiration?1:s.clamp(Y?A:1-k,0,1);return c.refreshedUponExpiration&&A>=1&&(c.refreshedUponExpiration=!1),f?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}var Rf=new s.Color(1,0,0,1),mm=new s.Color(0,1,0,1),gm=new s.Color(0,0,1,1),Lc=new s.Color(1,0,1,1),Of=new s.Color(0,1,1,1);function Df(c,f,h,d){Su(c,0,f+h/2,c.transform.width,h,d)}function zf(c,f,h,d){Su(c,f-h/2,0,h,c.transform.height,d)}function Su(c,f,h,d,_,w){var E=c.context,A=E.gl;A.enable(A.SCISSOR_TEST),A.scissor(f*s.browser.devicePixelRatio,h*s.browser.devicePixelRatio,d*s.browser.devicePixelRatio,_*s.browser.devicePixelRatio),E.clear({color:w}),A.disable(A.SCISSOR_TEST)}function ym(c,f,h){var d=c.context,_=d.gl,w=h.posMatrix,E=c.useProgram("debug"),A=J.disabled,k=ie.disabled,z=c.colorModeForRenderPass();d.activeTexture.set(_.TEXTURE0),c.emptyTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),E.draw(d,_.LINE_STRIP,A,k,z,me.disabled,Os(w,s.Color.red),"$debug",c.debugBuffer,c.tileBorderIndexBuffer,c.debugSegments);var Z=f.getTileByID(h.key).latestRawTileData,Y=Math.floor((Z&&Z.byteLength||0)/1024),$=f.getTile(h).tileSize,oe=512/Math.min($,512)*(h.overscaledZ/c.transform.zoom)*.5,re=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(re+=" => "+h.overscaledZ),function(ue,ee){ue.initDebugOverlayCanvas();var le=ue.debugOverlayCanvas,ge=ue.context.gl,be=ue.debugOverlayCanvas.getContext("2d");be.clearRect(0,0,le.width,le.height),be.shadowColor="white",be.shadowBlur=2,be.lineWidth=1.5,be.strokeStyle="white",be.textBaseline="top",be.font="bold 36px Open Sans, sans-serif",be.fillText(ee,5,5),be.strokeText(ee,5,5),ue.debugOverlayTexture.update(le),ue.debugOverlayTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE)}(c,re+" "+Y+"kb"),E.draw(d,_.TRIANGLES,A,k,de.alphaBlended,me.disabled,Os(w,s.Color.transparent,oe),"$debug",c.debugBuffer,c.quadTriangleIndexBuffer,c.debugSegments)}var Bs={symbol:function(c,f,h,d,_){if(c.renderPass==="translucent"){var w=ie.disabled,E=c.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(A,k,z,Z,Y,$,oe){for(var re=k.transform,ue=Y==="map",ee=$==="map",le=0,ge=A;le<ge.length;le+=1){var be=ge[le],Ce=Z.getTile(be),Pe=Ce.getBucket(z);if(Pe&&Pe.text&&Pe.text.segments.get().length){var ke=s.evaluateSizeForZoom(Pe.textSizeData,re.zoom),ze=bn(Ce,1,k.transform.zoom),He=dn(be.posMatrix,ee,ue,k.transform,ze),We=z.layout.get("icon-text-fit")!=="none"&&Pe.hasIconData();if(ke){var nt=Math.pow(2,re.zoom-Ce.tileID.overscaledZ);pm(Pe,ue,ee,oe,s.symbolSize,re,He,be.posMatrix,nt,ke,We)}}}}(d,c,h,f,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),_),h.paint.get("icon-opacity").constantOr(1)!==0&&zs(c,f,h,d,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),w,E),h.paint.get("text-opacity").constantOr(1)!==0&&zs(c,f,h,d,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),w,E),f.map.showCollisionBoxes&&(Sl(c,f,h,d,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Sl(c,f,h,d,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))}},circle:function(c,f,h,d){if(c.renderPass==="translucent"){var _=h.paint.get("circle-opacity"),w=h.paint.get("circle-stroke-width"),E=h.paint.get("circle-stroke-opacity"),A=h.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)!==0||w.constantOr(1)!==0&&E.constantOr(1)!==0){for(var k=c.context,z=k.gl,Z=c.depthModeForSublayer(0,J.ReadOnly),Y=ie.disabled,$=c.colorModeForRenderPass(),oe=[],re=0;re<d.length;re++){var ue=d[re],ee=f.getTile(ue),le=ee.getBucket(h);if(le){var ge=le.programConfigurations.get(h.id),be={programConfiguration:ge,program:c.useProgram("circle",ge),layoutVertexBuffer:le.layoutVertexBuffer,indexBuffer:le.indexBuffer,uniformValues:kf(c,ue,ee,h)};if(A)for(var Ce=0,Pe=le.segments.get();Ce<Pe.length;Ce+=1){var ke=Pe[Ce];oe.push({segments:new s.SegmentVector([ke]),sortKey:ke.sortKey,state:be})}else oe.push({segments:le.segments,sortKey:0,state:be})}}A&&oe.sort(function(dt,vt){return dt.sortKey-vt.sortKey});for(var ze=0,He=oe;ze<He.length;ze+=1){var We=He[ze],nt=We.state;nt.program.draw(k,z.TRIANGLES,Z,Y,$,me.disabled,nt.uniformValues,h.id,nt.layoutVertexBuffer,nt.indexBuffer,We.segments,h.paint,c.transform.zoom,nt.programConfiguration)}}}},heatmap:function(c,f,h,d){if(h.paint.get("heatmap-opacity")!==0)if(c.renderPass==="offscreen"){var _=c.context,w=_.gl,E=ie.disabled,A=new de([w.ONE,w.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(oe,re,ue){var ee=oe.gl;oe.activeTexture.set(ee.TEXTURE1),oe.viewport.set([0,0,re.width/4,re.height/4]);var le=ue.heatmapFbo;if(le)ee.bindTexture(ee.TEXTURE_2D,le.colorAttachment.get()),oe.bindFramebuffer.set(le.framebuffer);else{var ge=ee.createTexture();ee.bindTexture(ee.TEXTURE_2D,ge),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MAG_FILTER,ee.LINEAR),le=ue.heatmapFbo=oe.createFramebuffer(re.width/4,re.height/4,!1),function(be,Ce,Pe,ke){var ze=be.gl;ze.texImage2D(ze.TEXTURE_2D,0,ze.RGBA,Ce.width/4,Ce.height/4,0,ze.RGBA,be.extRenderToTextureHalfFloat?be.extTextureHalfFloat.HALF_FLOAT_OES:ze.UNSIGNED_BYTE,null),ke.colorAttachment.set(Pe)}(oe,re,ge,le)}})(_,c,h),_.clear({color:s.Color.transparent});for(var k=0;k<d.length;k++){var z=d[k];if(!f.hasRenderableParent(z)){var Z=f.getTile(z),Y=Z.getBucket(h);if(Y){var $=Y.programConfigurations.get(h.id);c.useProgram("heatmap",$).draw(_,w.TRIANGLES,J.disabled,E,A,me.disabled,lm(z.posMatrix,Z,c.transform.zoom,h.paint.get("heatmap-intensity")),h.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,h.paint,c.transform.zoom,$)}}}_.viewport.set([0,0,c.width,c.height])}else c.renderPass==="translucent"&&(c.context.setColorMode(c.colorModeForRenderPass()),function(oe,re){var ue=oe.context,ee=ue.gl,le=re.heatmapFbo;if(le){ue.activeTexture.set(ee.TEXTURE0),ee.bindTexture(ee.TEXTURE_2D,le.colorAttachment.get()),ue.activeTexture.set(ee.TEXTURE1);var ge=re.colorRampTexture;ge||(ge=re.colorRampTexture=new s.Texture(ue,re.colorRamp,ee.RGBA)),ge.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),oe.useProgram("heatmapTexture").draw(ue,ee.TRIANGLES,J.disabled,ie.disabled,oe.colorModeForRenderPass(),me.disabled,function(be,Ce,Pe,ke){var ze=s.create();s.ortho(ze,0,be.width,be.height,0,0,1);var He=be.context.gl;return{u_matrix:ze,u_world:[He.drawingBufferWidth,He.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ce.paint.get("heatmap-opacity")}}(oe,re),re.id,oe.viewportBuffer,oe.quadTriangleIndexBuffer,oe.viewportSegments,re.paint,oe.transform.zoom)}}(c,h))},line:function(c,f,h,d){if(c.renderPass==="translucent"){var _=h.paint.get("line-opacity"),w=h.paint.get("line-width");if(_.constantOr(1)!==0&&w.constantOr(1)!==0)for(var E=c.depthModeForSublayer(0,J.ReadOnly),A=c.colorModeForRenderPass(),k=h.paint.get("line-dasharray"),z=h.paint.get("line-pattern"),Z=z.constantOr(1),Y=h.paint.get("line-gradient"),$=h.getCrossfadeParameters(),oe=Z?"linePattern":k?"lineSDF":Y?"lineGradient":"line",re=c.context,ue=re.gl,ee=!0,le=0,ge=d;le<ge.length;le+=1){var be=ge[le],Ce=f.getTile(be);if(!Z||Ce.patternsLoaded()){var Pe=Ce.getBucket(h);if(Pe){var ke=Pe.programConfigurations.get(h.id),ze=c.context.program.get(),He=c.useProgram(oe,ke),We=ee||He.program!==ze,nt=z.constantOr(null);if(nt&&Ce.imageAtlas){var dt=Ce.imageAtlas,vt=dt.patternPositions[nt.to.toString()],yt=dt.patternPositions[nt.from.toString()];vt&&yt&&ke.setConstantPatternPositions(vt,yt)}var nn=Z?Ac(c,Ce,h,$):k?_v(c,Ce,h,k,$):Y?wn(c,Ce,h,Pe.lineClipsArray.length):bu(c,Ce,h);if(Z)re.activeTexture.set(ue.TEXTURE0),Ce.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),ke.updatePaintBuffers($);else if(k&&(We||c.lineAtlas.dirty))re.activeTexture.set(ue.TEXTURE0),c.lineAtlas.bind(re);else if(Y){var it=Pe.gradients[h.id],It=it.texture;if(h.gradientVersion!==it.version){var Ut=256;if(h.stepInterpolant){var Pt=f.getSource().maxzoom,At=be.canonical.z===Pt?Math.ceil(1<<c.transform.maxZoom-be.canonical.z):1;Ut=s.clamp(s.nextPowerOfTwo(Pe.maxLineLength/s.EXTENT*1024*At),256,re.maxTextureSize)}it.gradient=s.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:Ut,image:it.gradient||void 0,clips:Pe.lineClipsArray}),it.texture?it.texture.update(it.gradient):it.texture=new s.Texture(re,it.gradient,ue.RGBA),it.version=h.gradientVersion,It=it.texture}re.activeTexture.set(ue.TEXTURE0),It.bind(h.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}He.draw(re,ue.TRIANGLES,E,c.stencilModeForClipping(be),A,me.disabled,nn,h.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,h.paint,c.transform.zoom,ke,Pe.layoutVertexBuffer2),ee=!1}}}}},fill:function(c,f,h,d){var _=h.paint.get("fill-color"),w=h.paint.get("fill-opacity");if(w.constantOr(1)!==0){var E=c.colorModeForRenderPass(),A=h.paint.get("fill-pattern"),k=c.opaquePassEnabledForLayer()&&!A.constantOr(1)&&_.constantOr(s.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(c.renderPass===k){var z=c.depthModeForSublayer(1,c.renderPass==="opaque"?J.ReadWrite:J.ReadOnly);Cc(c,f,h,d,z,E,!1)}if(c.renderPass==="translucent"&&h.paint.get("fill-antialias")){var Z=c.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,J.ReadOnly);Cc(c,f,h,d,Z,E,!0)}}},"fill-extrusion":function(c,f,h,d){var _=h.paint.get("fill-extrusion-opacity");if(_!==0&&c.renderPass==="translucent"){var w=new J(c.context.gl.LEQUAL,J.ReadWrite,c.depthRangeFor3D);if(_!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))Lf(c,f,h,d,w,ie.disabled,de.disabled),Lf(c,f,h,d,w,c.stencilModeFor3D(),c.colorModeForRenderPass());else{var E=c.colorModeForRenderPass();Lf(c,f,h,d,w,ie.disabled,E)}}},hillshade:function(c,f,h,d){if(c.renderPass==="offscreen"||c.renderPass==="translucent"){for(var _=c.context,w=c.depthModeForSublayer(0,J.ReadOnly),E=c.colorModeForRenderPass(),A=c.renderPass==="translucent"?c.stencilConfigForOverlap(d):[{},d],k=A[0],z=0,Z=A[1];z<Z.length;z+=1){var Y=Z[z],$=f.getTile(Y);$.needsHillshadePrepare&&c.renderPass==="offscreen"?bv(c,$,h,w,ie.disabled,E):c.renderPass==="translucent"&&Mc(c,$,h,w,k[Y.overscaledZ],E)}_.viewport.set([0,0,c.width,c.height])}},raster:function(c,f,h,d){if(c.renderPass==="translucent"&&h.paint.get("raster-opacity")!==0&&d.length)for(var _=c.context,w=_.gl,E=f.getSource(),A=c.useProgram("raster"),k=c.colorModeForRenderPass(),z=E instanceof en?[{},d]:c.stencilConfigForOverlap(d),Z=z[0],Y=z[1],$=Y[Y.length-1].overscaledZ,oe=!c.options.moving,re=0,ue=Y;re<ue.length;re+=1){var ee=ue[re],le=c.depthModeForSublayer(ee.overscaledZ-$,h.paint.get("raster-opacity")===1?J.ReadWrite:J.ReadOnly,w.LESS),ge=f.getTile(ee),be=c.transform.calculatePosMatrix(ee.toUnwrapped(),oe);ge.registerFadeDuration(h.paint.get("raster-fade-duration"));var Ce=f.findLoadedParent(ee,0),Pe=kc(ge,Ce,f,h,c.transform),ke=void 0,ze=void 0,He=h.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;_.activeTexture.set(w.TEXTURE0),ge.texture.bind(He,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(w.TEXTURE1),Ce?(Ce.texture.bind(He,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),ke=Math.pow(2,Ce.tileID.overscaledZ-ge.tileID.overscaledZ),ze=[ge.tileID.canonical.x*ke%1,ge.tileID.canonical.y*ke%1]):ge.texture.bind(He,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);var We=xv(be,ze||[0,0],ke||1,Pe,h);E instanceof en?A.draw(_,w.TRIANGLES,le,ie.disabled,k,me.disabled,We,h.id,E.boundsBuffer,c.quadTriangleIndexBuffer,E.boundsSegments):A.draw(_,w.TRIANGLES,le,Z[ee.overscaledZ],k,me.disabled,We,h.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments)}},background:function(c,f,h){var d=h.paint.get("background-color"),_=h.paint.get("background-opacity");if(_!==0){var w=c.context,E=w.gl,A=c.transform,k=A.tileSize,z=h.paint.get("background-pattern");if(!c.isPatternMissing(z)){var Z=!z&&d.a===1&&_===1&&c.opaquePassEnabledForLayer()?"opaque":"translucent";if(c.renderPass===Z){var Y=ie.disabled,$=c.depthModeForSublayer(0,Z==="opaque"?J.ReadWrite:J.ReadOnly),oe=c.colorModeForRenderPass(),re=c.useProgram(z?"backgroundPattern":"background"),ue=A.coveringTiles({tileSize:k});z&&(w.activeTexture.set(E.TEXTURE0),c.imageManager.bind(c.context));for(var ee=h.getCrossfadeParameters(),le=0,ge=ue;le<ge.length;le+=1){var be=ge[le],Ce=c.transform.calculatePosMatrix(be.toUnwrapped()),Pe=z?Tl(Ce,_,c,z,{tileID:be,tileSize:k},ee):Eu(Ce,_,d);re.draw(w,E.TRIANGLES,$,Y,oe,me.disabled,Pe,h.id,c.tileExtentBuffer,c.quadTriangleIndexBuffer,c.tileExtentSegments)}}}}},debug:function(c,f,h){for(var d=0;d<h.length;d++)ym(c,f,h[d])},custom:function(c,f,h){var d=c.context,_=h.implementation;if(c.renderPass==="offscreen"){var w=_.prerender;w&&(c.setCustomLayerDefaults(),d.setColorMode(c.colorModeForRenderPass()),w.call(_,d.gl,c.transform.customLayerMatrix()),d.setDirty(),c.setBaseState())}else if(c.renderPass==="translucent"){c.setCustomLayerDefaults(),d.setColorMode(c.colorModeForRenderPass()),d.setStencilMode(ie.disabled);var E=_.renderingMode==="3d"?new J(c.context.gl.LEQUAL,J.ReadWrite,c.depthRangeFor3D):c.depthModeForSublayer(0,J.ReadOnly);d.setDepthMode(E),_.render(d.gl,c.transform.customLayerMatrix()),d.setDirty(),c.setBaseState(),d.bindFramebuffer.set(null)}}},Cn=function(c,f){this.context=new X(c),this.transform=f,this._tileTextures={},this.setup(),this.numSublayers=ae.maxUnderzooming+ae.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Da,this.gpuTimers={}};Cn.prototype.resize=function(c,f){if(this.width=c*s.browser.devicePixelRatio,this.height=f*s.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var h=0,d=this.style._order;h<d.length;h+=1)this.style._layers[d[h]].resize()},Cn.prototype.setup=function(){var c=this.context,f=new s.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(s.EXTENT,0),f.emplaceBack(0,s.EXTENT),f.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(f,ar.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);var h=new s.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(s.EXTENT,0),h.emplaceBack(0,s.EXTENT),h.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=c.createVertexBuffer(h,ar.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);var d=new s.StructArrayLayout4i8;d.emplaceBack(0,0,0,0),d.emplaceBack(s.EXTENT,0,s.EXTENT,0),d.emplaceBack(0,s.EXTENT,0,s.EXTENT),d.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(d,Qt.members),this.rasterBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);var _=new s.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(_,ar.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);var w=new s.StructArrayLayout1ui2;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(w);var E=new s.StructArrayLayout3ui6;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(E),this.emptyTexture=new s.Texture(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);var A=this.context.gl;this.stencilClearMode=new ie({func:A.ALWAYS,mask:0},0,255,A.ZERO,A.ZERO,A.ZERO)},Cn.prototype.clearStencil=function(){var c=this.context,f=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var h=s.create();s.ortho(h,0,this.width,this.height,0,0,1),s.scale(h,h,[f.drawingBufferWidth,f.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,f.TRIANGLES,J.disabled,this.stencilClearMode,de.disabled,me.disabled,Ds(h),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Cn.prototype._renderTileClippingMasks=function(c,f){if(this.currentStencilSource!==c.source&&c.isTileClipped()&&f&&f.length){this.currentStencilSource=c.source;var h=this.context,d=h.gl;this.nextStencilID+f.length>256&&this.clearStencil(),h.setColorMode(de.disabled),h.setDepthMode(J.disabled);var _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var w=0,E=f;w<E.length;w+=1){var A=E[w],k=this._tileClippingMaskIDs[A.key]=this.nextStencilID++;_.draw(h,d.TRIANGLES,J.disabled,new ie({func:d.ALWAYS,mask:0},k,255,d.KEEP,d.KEEP,d.REPLACE),de.disabled,me.disabled,Ds(A.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Cn.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var c=this.nextStencilID++,f=this.context.gl;return new ie({func:f.NOTEQUAL,mask:255},c,255,f.KEEP,f.KEEP,f.REPLACE)},Cn.prototype.stencilModeForClipping=function(c){var f=this.context.gl;return new ie({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,f.KEEP,f.KEEP,f.REPLACE)},Cn.prototype.stencilConfigForOverlap=function(c){var f,h=this.context.gl,d=c.sort(function(k,z){return z.overscaledZ-k.overscaledZ}),_=d[d.length-1].overscaledZ,w=d[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();for(var E={},A=0;A<w;A++)E[A+_]=new ie({func:h.GEQUAL,mask:255},A+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=w,[E,d]}return[(f={},f[_]=ie.disabled,f),d]},Cn.prototype.colorModeForRenderPass=function(){var c=this.context.gl;return this._showOverdrawInspector?new de([c.CONSTANT_COLOR,c.ONE],new s.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?de.unblended:de.alphaBlended},Cn.prototype.depthModeForSublayer=function(c,f,h){if(!this.opaquePassEnabledForLayer())return J.disabled;var d=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new J(h||this.context.gl.LEQUAL,f,[d,d])},Cn.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Cn.prototype.render=function(c,f){var h=this;this.style=c,this.options=f,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(s.browser.now()),this.imageManager.beginFrame();var d=this.style._order,_=this.style.sourceCaches;for(var w in _){var E=_[w];E.used&&E.prepare(this.context)}var A,k,z={},Z={},Y={};for(var $ in _){var oe=_[$];z[$]=oe.getVisibleCoordinates(),Z[$]=z[$].slice().reverse(),Y[$]=oe.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var re=0;re<d.length;re++)if(this.style._layers[d[re]].is3D()){this.opaquePassCutoff=re;break}this.renderPass="offscreen";for(var ue=0,ee=d;ue<ee.length;ue+=1){var le=this.style._layers[ee[ue]];if(le.hasOffscreenPass()&&!le.isHidden(this.transform.zoom)){var ge=Z[le.source];(le.type==="custom"||ge.length)&&this.renderLayer(this,_[le.source],le,ge)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){var be=this.style._layers[d[this.currentLayer]],Ce=_[be.source],Pe=z[be.source];this._renderTileClippingMasks(be,Pe),this.renderLayer(this,Ce,be,Pe)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){var ke=this.style._layers[d[this.currentLayer]],ze=_[ke.source],He=(ke.type==="symbol"?Y:Z)[ke.source];this._renderTileClippingMasks(ke,z[ke.source]),this.renderLayer(this,ze,ke,He)}this.options.showTileBoundaries&&(s.values(this.style._layers).forEach(function(We){We.source&&!We.isHidden(h.transform.zoom)&&(We.source!==(k&&k.id)&&(k=h.style.sourceCaches[We.source]),(!A||A.getSource().maxzoom<k.getSource().maxzoom)&&(A=k))}),A&&Bs.debug(this,A,A.getVisibleCoordinates())),this.options.showPadding&&function(We){var nt=We.transform.padding;Df(We,We.transform.height-(nt.top||0),3,Rf),Df(We,nt.bottom||0,3,mm),zf(We,nt.left||0,3,gm),zf(We,We.transform.width-(nt.right||0),3,Lc);var dt=We.transform.centerPoint;(function(vt,yt,nn,it){Su(vt,yt-1,nn-10,2,20,it),Su(vt,yt-10,nn-1,20,2,it)})(We,dt.x,We.transform.height-dt.y,Of)}(this),this.context.setDefault()},Cn.prototype.renderLayer=function(c,f,h,d){h.isHidden(this.transform.zoom)||(h.type==="background"||h.type==="custom"||d.length)&&(this.id=h.id,this.gpuTimingStart(h),Bs[h.type](c,f,h,d,this.style.placement.variableOffsets),this.gpuTimingEnd())},Cn.prototype.gpuTimingStart=function(c){if(this.options.gpuTiming){var f=this.context.extTimerQuery,h=this.gpuTimers[c.id];h||(h=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),h.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,h.query)}},Cn.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}},Cn.prototype.collectGpuTimers=function(){var c=this.gpuTimers;return this.gpuTimers={},c},Cn.prototype.queryGpuTimers=function(c){var f={};for(var h in c){var d=c[h],_=this.context.extTimerQuery,w=_.getQueryObjectEXT(d.query,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(d.query),f[h]=w}return f},Cn.prototype.translatePosMatrix=function(c,f,h,d,_){if(!h[0]&&!h[1])return c;var w=_?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(w){var E=Math.sin(w),A=Math.cos(w);h=[h[0]*A-h[1]*E,h[0]*E+h[1]*A]}var k=[_?h[0]:bn(f,h[0],this.transform.zoom),_?h[1]:bn(f,h[1],this.transform.zoom),0],z=new Float32Array(16);return s.translate(z,c,k),z},Cn.prototype.saveTileTexture=function(c){var f=this._tileTextures[c.size[0]];f?f.push(c):this._tileTextures[c.size[0]]=[c]},Cn.prototype.getTileTexture=function(c){var f=this._tileTextures[c];return f&&f.length>0?f.pop():null},Cn.prototype.isPatternMissing=function(c){if(!c)return!1;if(!c.from||!c.to)return!0;var f=this.imageManager.getPattern(c.from.toString()),h=this.imageManager.getPattern(c.to.toString());return!f||!h},Cn.prototype.useProgram=function(c,f){this.cache=this.cache||{};var h=""+c+(f?f.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[h]||(this.cache[h]=new nm(this.context,c,vv[c],f,hm[c],this._showOverdrawInspector)),this.cache[h]},Cn.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Cn.prototype.setBaseState=function(){var c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)},Cn.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Cn.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Rc=function(c,f){this.points=c,this.planes=f};Rc.fromInvProjectionMatrix=function(c,f,h){var d=Math.pow(2,h),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(E){return s.transformMat4([],E,c)}).map(function(E){return s.scale$1([],E,1/E[3]/f*d)}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(E){var A=s.sub([],_[E[0]],_[E[1]]),k=s.sub([],_[E[2]],_[E[1]]),z=s.normalize([],s.cross([],A,k)),Z=-s.dot(z,_[E[1]]);return z.concat(Z)});return new Rc(_,w)};var Ns=function(c,f){this.min=c,this.max=f,this.center=s.scale$2([],s.add([],this.min,this.max),.5)};Ns.prototype.quadrant=function(c){for(var f=[c%2==0,c<2],h=s.clone$2(this.min),d=s.clone$2(this.max),_=0;_<f.length;_++)h[_]=f[_]?this.min[_]:this.center[_],d[_]=f[_]?this.center[_]:this.max[_];return d[2]=this.max[2],new Ns(h,d)},Ns.prototype.distanceX=function(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]},Ns.prototype.distanceY=function(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]},Ns.prototype.intersects=function(c){for(var f=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],h=!0,d=0;d<c.planes.length;d++){for(var _=c.planes[d],w=0,E=0;E<f.length;E++)w+=s.dot$1(_,f[E])>=0;if(w===0)return 0;w!==f.length&&(h=!1)}if(h)return 2;for(var A=0;A<3;A++){for(var k=Number.MAX_VALUE,z=-Number.MAX_VALUE,Z=0;Z<c.points.length;Z++){var Y=c.points[Z][A]-this.min[A];k=Math.min(k,Y),z=Math.max(z,Y)}if(z<0||k>this.max[A]-this.min[A])return 0}return 1};var Ga=function(c,f,h,d){if(c===void 0&&(c=0),f===void 0&&(f=0),h===void 0&&(h=0),d===void 0&&(d=0),isNaN(c)||c<0||isNaN(f)||f<0||isNaN(h)||h<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=f,this.left=h,this.right=d};Ga.prototype.interpolate=function(c,f,h){return f.top!=null&&c.top!=null&&(this.top=s.number(c.top,f.top,h)),f.bottom!=null&&c.bottom!=null&&(this.bottom=s.number(c.bottom,f.bottom,h)),f.left!=null&&c.left!=null&&(this.left=s.number(c.left,f.left,h)),f.right!=null&&c.right!=null&&(this.right=s.number(c.right,f.right,h)),this},Ga.prototype.getCenter=function(c,f){var h=s.clamp((this.left+c-this.right)/2,0,c),d=s.clamp((this.top+f-this.bottom)/2,0,f);return new s.Point(h,d)},Ga.prototype.equals=function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right},Ga.prototype.clone=function(){return new Ga(this.top,this.bottom,this.left,this.right)},Ga.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Kt=function(c,f,h,d,_){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=_===void 0||_,this._minZoom=c||0,this._maxZoom=f||22,this._minPitch=h??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ga,this._posMatrixCache={},this._alignedPosMatrixCache={}},En={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Kt.prototype.clone=function(){var c=new Kt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c},En.minZoom.get=function(){return this._minZoom},En.minZoom.set=function(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))},En.maxZoom.get=function(){return this._maxZoom},En.maxZoom.set=function(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))},En.minPitch.get=function(){return this._minPitch},En.minPitch.set=function(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))},En.maxPitch.get=function(){return this._maxPitch},En.maxPitch.set=function(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))},En.renderWorldCopies.get=function(){return this._renderWorldCopies},En.renderWorldCopies.set=function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c},En.worldSize.get=function(){return this.tileSize*this.scale},En.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},En.size.get=function(){return new s.Point(this.width,this.height)},En.bearing.get=function(){return-this.angle/Math.PI*180},En.bearing.set=function(c){var f=-s.wrap(c,-180,180)*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=s.create$2(),s.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},En.pitch.get=function(){return this._pitch/Math.PI*180},En.pitch.set=function(c){var f=s.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())},En.fov.get=function(){return this._fov/Math.PI*180},En.fov.set=function(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())},En.zoom.get=function(){return this._zoom},En.zoom.set=function(c){var f=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom,this._constrain(),this._calcMatrices())},En.center.get=function(){return this._center},En.center.set=function(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())},En.padding.get=function(){return this._edgeInsets.toJSON()},En.padding.set=function(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())},En.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Kt.prototype.isPaddingEqual=function(c){return this._edgeInsets.equals(c)},Kt.prototype.interpolatePadding=function(c,f,h){this._unmodified=!1,this._edgeInsets.interpolate(c,f,h),this._constrain(),this._calcMatrices()},Kt.prototype.coveringZoomLevel=function(c){var f=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,f)},Kt.prototype.getVisibleUnwrappedCoordinates=function(c){var f=[new s.UnwrappedTileID(0,c)];if(this._renderWorldCopies)for(var h=this.pointCoordinate(new s.Point(0,0)),d=this.pointCoordinate(new s.Point(this.width,0)),_=this.pointCoordinate(new s.Point(this.width,this.height)),w=this.pointCoordinate(new s.Point(0,this.height)),E=Math.floor(Math.min(h.x,d.x,_.x,w.x)),A=Math.floor(Math.max(h.x,d.x,_.x,w.x)),k=E-1;k<=A+1;k++)k!==0&&f.push(new s.UnwrappedTileID(k,c));return f},Kt.prototype.coveringTiles=function(c){var f=this.coveringZoomLevel(c),h=f;if(c.minzoom!==void 0&&f<c.minzoom)return[];c.maxzoom!==void 0&&f>c.maxzoom&&(f=c.maxzoom);var d=s.MercatorCoordinate.fromLngLat(this.center),_=Math.pow(2,f),w=[_*d.x,_*d.y,0],E=Rc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f),A=c.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(A=f);var k=function(We){return{aabb:new Ns([We*_,0,0],[(We+1)*_,_,0]),zoom:0,x:0,y:0,wrap:We,fullyVisible:!1}},z=[],Z=[],Y=f,$=c.reparseOverscaled?h:f;if(this._renderWorldCopies)for(var oe=1;oe<=3;oe++)z.push(k(-oe)),z.push(k(oe));for(z.push(k(0));z.length>0;){var re=z.pop(),ue=re.x,ee=re.y,le=re.fullyVisible;if(!le){var ge=re.aabb.intersects(E);if(ge===0)continue;le=ge===2}var be=re.aabb.distanceX(w),Ce=re.aabb.distanceY(w),Pe=Math.max(Math.abs(be),Math.abs(Ce));if(re.zoom===Y||Pe>3+(1<<Y-re.zoom)-2&&re.zoom>=A)Z.push({tileID:new s.OverscaledTileID(re.zoom===Y?$:re.zoom,re.wrap,re.zoom,ue,ee),distanceSq:s.sqrLen([w[0]-.5-ue,w[1]-.5-ee])});else for(var ke=0;ke<4;ke++){var ze=(ue<<1)+ke%2,He=(ee<<1)+(ke>>1);z.push({aabb:re.aabb.quadrant(ke),zoom:re.zoom+1,x:ze,y:He,wrap:re.wrap,fullyVisible:le})}}return Z.sort(function(We,nt){return We.distanceSq-nt.distanceSq}).map(function(We){return We.tileID})},Kt.prototype.resize=function(c,f){this.width=c,this.height=f,this.pixelsToGLUnits=[2/c,-2/f],this._constrain(),this._calcMatrices()},En.unmodified.get=function(){return this._unmodified},Kt.prototype.zoomScale=function(c){return Math.pow(2,c)},Kt.prototype.scaleZoom=function(c){return Math.log(c)/Math.LN2},Kt.prototype.project=function(c){var f=s.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new s.Point(s.mercatorXfromLng(c.lng)*this.worldSize,s.mercatorYfromLat(f)*this.worldSize)},Kt.prototype.unproject=function(c){return new s.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()},En.point.get=function(){return this.project(this.center)},Kt.prototype.setLocationAtPoint=function(c,f){var h=this.pointCoordinate(f),d=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(c),w=new s.MercatorCoordinate(_.x-(h.x-d.x),_.y-(h.y-d.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())},Kt.prototype.locationPoint=function(c){return this.coordinatePoint(this.locationCoordinate(c))},Kt.prototype.pointLocation=function(c){return this.coordinateLocation(this.pointCoordinate(c))},Kt.prototype.locationCoordinate=function(c){return s.MercatorCoordinate.fromLngLat(c)},Kt.prototype.coordinateLocation=function(c){return c.toLngLat()},Kt.prototype.pointCoordinate=function(c){var f=[c.x,c.y,0,1],h=[c.x,c.y,1,1];s.transformMat4(f,f,this.pixelMatrixInverse),s.transformMat4(h,h,this.pixelMatrixInverse);var d=f[3],_=h[3],w=f[1]/d,E=h[1]/_,A=f[2]/d,k=h[2]/_,z=A===k?0:(0-A)/(k-A);return new s.MercatorCoordinate(s.number(f[0]/d,h[0]/_,z)/this.worldSize,s.number(w,E,z)/this.worldSize)},Kt.prototype.coordinatePoint=function(c){var f=[c.x*this.worldSize,c.y*this.worldSize,0,1];return s.transformMat4(f,f,this.pixelMatrix),new s.Point(f[0]/f[3],f[1]/f[3])},Kt.prototype.getBounds=function(){return new s.LngLatBounds().extend(this.pointLocation(new s.Point(0,0))).extend(this.pointLocation(new s.Point(this.width,0))).extend(this.pointLocation(new s.Point(this.width,this.height))).extend(this.pointLocation(new s.Point(0,this.height)))},Kt.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new s.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Kt.prototype.setMaxBounds=function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Kt.prototype.calculatePosMatrix=function(c,f){f===void 0&&(f=!1);var h=c.key,d=f?this._alignedPosMatrixCache:this._posMatrixCache;if(d[h])return d[h];var _=c.canonical,w=this.worldSize/this.zoomScale(_.z),E=_.x+Math.pow(2,_.z)*c.wrap,A=s.identity(new Float64Array(16));return s.translate(A,A,[E*w,_.y*w,0]),s.scale(A,A,[w/s.EXTENT,w/s.EXTENT,1]),s.multiply(A,f?this.alignedProjMatrix:this.projMatrix,A),d[h]=new Float32Array(A),d[h]},Kt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Kt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var c,f,h,d,_=-90,w=90,E=-180,A=180,k=this.size,z=this._unmodified;if(this.latRange){var Z=this.latRange;_=s.mercatorYfromLat(Z[1])*this.worldSize,c=(w=s.mercatorYfromLat(Z[0])*this.worldSize)-_<k.y?k.y/(w-_):0}if(this.lngRange){var Y=this.lngRange;E=s.mercatorXfromLng(Y[0])*this.worldSize,f=(A=s.mercatorXfromLng(Y[1])*this.worldSize)-E<k.x?k.x/(A-E):0}var $=this.point,oe=Math.max(f||0,c||0);if(oe)return this.center=this.unproject(new s.Point(f?(A+E)/2:$.x,c?(w+_)/2:$.y)),this.zoom+=this.scaleZoom(oe),this._unmodified=z,void(this._constraining=!1);if(this.latRange){var re=$.y,ue=k.y/2;re-ue<_&&(d=_+ue),re+ue>w&&(d=w-ue)}if(this.lngRange){var ee=$.x,le=k.x/2;ee-le<E&&(h=E+le),ee+le>A&&(h=A-le)}h===void 0&&d===void 0||(this.center=this.unproject(new s.Point(h!==void 0?h:$.x,d!==void 0?d:$.y))),this._unmodified=z,this._constraining=!1}},Kt.prototype._calcMatrices=function(){if(this.height){var c=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var f=Math.PI/2+this._pitch,h=this._fov*(.5+c.y/this.height),d=Math.sin(h)*this.cameraToCenterDistance/Math.sin(s.clamp(Math.PI-f-h,.01,Math.PI-.01)),_=this.point,w=_.x,E=_.y,A=1.01*(Math.cos(Math.PI/2-this._pitch)*d+this.cameraToCenterDistance),k=this.height/50,z=new Float64Array(16);s.perspective(z,this._fov,this.width/this.height,k,A),z[8]=2*-c.x/this.width,z[9]=2*c.y/this.height,s.scale(z,z,[1,-1,1]),s.translate(z,z,[0,0,-this.cameraToCenterDistance]),s.rotateX(z,z,this._pitch),s.rotateZ(z,z,this.angle),s.translate(z,z,[-w,-E,0]),this.mercatorMatrix=s.scale([],z,[this.worldSize,this.worldSize,this.worldSize]),s.scale(z,z,[1,1,s.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=z,this.invProjMatrix=s.invert([],this.projMatrix);var Z=this.width%2/2,Y=this.height%2/2,$=Math.cos(this.angle),oe=Math.sin(this.angle),re=w-Math.round(w)+$*Z+oe*Y,ue=E-Math.round(E)+$*Y+oe*Z,ee=new Float64Array(z);if(s.translate(ee,ee,[re>.5?re-1:re,ue>.5?ue-1:ue,0]),this.alignedProjMatrix=ee,z=s.create(),s.scale(z,z,[this.width/2,-this.height/2,1]),s.translate(z,z,[1,-1,0]),this.labelPlaneMatrix=z,z=s.create(),s.scale(z,z,[1,-1,1]),s.translate(z,z,[-1,-1,0]),s.scale(z,z,[2/this.width,2/this.height,1]),this.glCoordMatrix=z,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(z=s.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=z,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Kt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new s.Point(0,0)),f=[c.x*this.worldSize,c.y*this.worldSize,0,1];return s.transformMat4(f,f,this.pixelMatrix)[3]/this.cameraToCenterDistance},Kt.prototype.getCameraPoint=function(){var c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,c))},Kt.prototype.getCameraQueryGeometry=function(c){var f=this.getCameraPoint();if(c.length===1)return[c[0],f];for(var h=f.x,d=f.y,_=f.x,w=f.y,E=0,A=c;E<A.length;E+=1){var k=A[E];h=Math.min(h,k.x),d=Math.min(d,k.y),_=Math.max(_,k.x),w=Math.max(w,k.y)}return[new s.Point(h,d),new s.Point(_,d),new s.Point(_,w),new s.Point(h,w),new s.Point(h,d)]},Object.defineProperties(Kt.prototype,En);var ji=function(c){var f,h,d,_;this._hashName=c&&encodeURIComponent(c),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(f=this._updateHashUnthrottled.bind(this),h=!1,d=null,_=function(){d=null,h&&(f(),d=setTimeout(_,300),h=!1)},function(){return h=!0,d||_(),d})};ji.prototype.addTo=function(c){return this._map=c,s.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ji.prototype.remove=function(){return s.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ji.prototype.getHashString=function(c){var f=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,d=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,d),w=Math.round(f.lng*_)/_,E=Math.round(f.lat*_)/_,A=this._map.getBearing(),k=this._map.getPitch(),z="";if(z+=c?"/"+w+"/"+E+"/"+h:h+"/"+E+"/"+w,(A||k)&&(z+="/"+Math.round(10*A)/10),k&&(z+="/"+Math.round(k)),this._hashName){var Z=this._hashName,Y=!1,$=s.window.location.hash.slice(1).split("&").map(function(oe){var re=oe.split("=")[0];return re===Z?(Y=!0,re+"="+z):oe}).filter(function(oe){return oe});return Y||$.push(Z+"="+z),"#"+$.join("&")}return"#"+z},ji.prototype._getCurrentHash=function(){var c,f=this,h=s.window.location.hash.replace("#","");return this._hashName?(h.split("&").map(function(d){return d.split("=")}).forEach(function(d){d[0]===f._hashName&&(c=d)}),(c&&c[1]||"").split("/")):h.split("/")},ji.prototype._onHashChange=function(){var c=this._getCurrentHash();if(c.length>=3&&!c.some(function(h){return isNaN(h)})){var f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:f,pitch:+(c[4]||0)}),!0}return!1},ji.prototype._updateHashUnthrottled=function(){var c=s.window.location.href.replace(/(#.+)?$/,this.getHashString());try{s.window.history.replaceState(s.window.history.state,null,c)}catch{}};var Au={linearity:.3,easing:s.bezier(0,0,.3,1)},Al=s.extend({deceleration:2500,maxSpeed:1400},Au),Pu=s.extend({deceleration:20,maxSpeed:1400},Au),wv=s.extend({deceleration:1e3,maxSpeed:360},Au),Ev=s.extend({deceleration:1e3,maxSpeed:90},Au),Iu=function(c){this._map=c,this.clear()};function Cu(c,f){(!c.duration||c.duration<f.duration)&&(c.duration=f.duration,c.easing=f.easing)}function sa(c,f,h){var d=h.maxSpeed,_=h.linearity,w=h.deceleration,E=s.clamp(c*_/(f/1e3),-d,d),A=Math.abs(E)/(w*_);return{easing:h.easing,duration:1e3*A,amount:E*(A/2)}}Iu.prototype.clear=function(){this._inertiaBuffer=[]},Iu.prototype.record=function(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.browser.now(),settings:c})},Iu.prototype._drainInertiaBuffer=function(){for(var c=this._inertiaBuffer,f=s.browser.now();c.length>0&&f-c[0].time>160;)c.shift()},Iu.prototype._onMoveEnd=function(c){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var f={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0},h=0,d=this._inertiaBuffer;h<d.length;h+=1){var _=d[h].settings;f.zoom+=_.zoomDelta||0,f.bearing+=_.bearingDelta||0,f.pitch+=_.pitchDelta||0,_.panDelta&&f.pan._add(_.panDelta),_.around&&(f.around=_.around),_.pinchAround&&(f.pinchAround=_.pinchAround)}var w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,E={};if(f.pan.mag()){var A=sa(f.pan.mag(),w,s.extend({},Al,c||{}));E.offset=f.pan.mult(A.amount/f.pan.mag()),E.center=this._map.transform.center,Cu(E,A)}if(f.zoom){var k=sa(f.zoom,w,Pu);E.zoom=this._map.transform.zoom+k.amount,Cu(E,k)}if(f.bearing){var z=sa(f.bearing,w,wv);E.bearing=this._map.transform.bearing+s.clamp(z.amount,-179,179),Cu(E,z)}if(f.pitch){var Z=sa(f.pitch,w,Ev);E.pitch=this._map.transform.pitch+Z.amount,Cu(E,Z)}if(E.zoom||E.bearing){var Y=f.pinchAround===void 0?f.around:f.pinchAround;E.around=Y?this._map.unproject(Y):this._map.getCenter()}return this.clear(),s.extend(E,{noMoveStart:!0})}};var fr=function(c){function f(d,_,w,E){E===void 0&&(E={});var A=y.mousePos(_.getCanvasContainer(),w),k=_.unproject(A);c.call(this,d,s.extend({point:A,lngLat:k,originalEvent:w},E)),this._defaultPrevented=!1,this.target=_}c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f;var h={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,h),f}(s.Event),Mu=function(c){function f(d,_,w){var E=d==="touchend"?w.changedTouches:w.touches,A=y.touchPos(_.getCanvasContainer(),E),k=A.map(function(Y){return _.unproject(Y)}),z=A.reduce(function(Y,$,oe,re){return Y.add($.div(re.length))},new s.Point(0,0)),Z=_.unproject(z);c.call(this,d,{points:A,point:z,lngLats:k,lngLat:Z,originalEvent:w}),this._defaultPrevented=!1}c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f;var h={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,h),f}(s.Event),vm=function(c){function f(d,_,w){c.call(this,d,{originalEvent:w}),this._defaultPrevented=!1}c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f;var h={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,h),f}(s.Event),sr=function(c,f){this._map=c,this._clickTolerance=f.clickTolerance};sr.prototype.reset=function(){delete this._mousedownPos},sr.prototype.wheel=function(c){return this._firePreventable(new vm(c.type,this._map,c))},sr.prototype.mousedown=function(c,f){return this._mousedownPos=f,this._firePreventable(new fr(c.type,this._map,c))},sr.prototype.mouseup=function(c){this._map.fire(new fr(c.type,this._map,c))},sr.prototype.click=function(c,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new fr(c.type,this._map,c))},sr.prototype.dblclick=function(c){return this._firePreventable(new fr(c.type,this._map,c))},sr.prototype.mouseover=function(c){this._map.fire(new fr(c.type,this._map,c))},sr.prototype.mouseout=function(c){this._map.fire(new fr(c.type,this._map,c))},sr.prototype.touchstart=function(c){return this._firePreventable(new Mu(c.type,this._map,c))},sr.prototype.touchmove=function(c){this._map.fire(new Mu(c.type,this._map,c))},sr.prototype.touchend=function(c){this._map.fire(new Mu(c.type,this._map,c))},sr.prototype.touchcancel=function(c){this._map.fire(new Mu(c.type,this._map,c))},sr.prototype._firePreventable=function(c){if(this._map.fire(c),c.defaultPrevented)return{}},sr.prototype.isEnabled=function(){return!0},sr.prototype.isActive=function(){return!1},sr.prototype.enable=function(){},sr.prototype.disable=function(){};var ot=function(c){this._map=c};ot.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ot.prototype.mousemove=function(c){this._map.fire(new fr(c.type,this._map,c))},ot.prototype.mousedown=function(){this._delayContextMenu=!0},ot.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ot.prototype.contextmenu=function(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new fr(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()},ot.prototype.isEnabled=function(){return!0},ot.prototype.isActive=function(){return!1},ot.prototype.enable=function(){},ot.prototype.disable=function(){};var Pi=function(c,f){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=f.clickTolerance||1};function Oc(c,f){for(var h={},d=0;d<c.length;d++)h[c[d].identifier]=f[d];return h}Pi.prototype.isEnabled=function(){return!!this._enabled},Pi.prototype.isActive=function(){return!!this._active},Pi.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Pi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Pi.prototype.mousedown=function(c,f){this.isEnabled()&&c.shiftKey&&c.button===0&&(y.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)},Pi.prototype.mousemoveWindow=function(c,f){if(this._active){var h=f;if(!(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)){var d=this._startPos;this._lastPos=h,this._box||(this._box=y.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));var _=Math.min(d.x,h.x),w=Math.max(d.x,h.x),E=Math.min(d.y,h.y),A=Math.max(d.y,h.y);y.setTransform(this._box,"translate("+_+"px,"+E+"px)"),this._box.style.width=w-_+"px",this._box.style.height=A-E+"px"}}},Pi.prototype.mouseupWindow=function(c,f){var h=this;if(this._active&&c.button===0){var d=this._startPos,_=f;if(this.reset(),y.suppressClick(),d.x!==_.x||d.y!==_.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:function(w){return w.fitScreenCoordinates(d,_,h._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",c)}},Pi.prototype.keydown=function(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))},Pi.prototype.blur=function(){this.reset()},Pi.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(y.remove(this._box),this._box=null),y.enableDrag(),delete this._startPos,delete this._lastPos},Pi.prototype._fireEvent=function(c,f){return this._map.fire(new s.Event(c,{originalEvent:f}))};var Pl=function(c){this.reset(),this.numTouches=c.numTouches};Pl.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Pl.prototype.touchstart=function(c,f,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),h.length===this.numTouches&&(this.centroid=function(d){for(var _=new s.Point(0,0),w=0,E=d;w<E.length;w+=1)_._add(E[w]);return _.div(d.length)}(f),this.touches=Oc(h,f)))},Pl.prototype.touchmove=function(c,f,h){if(!this.aborted&&this.centroid){var d=Oc(h,f);for(var _ in this.touches){var w=d[_];(!w||w.dist(this.touches[_])>30)&&(this.aborted=!0)}}},Pl.prototype.touchend=function(c,f,h){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){var d=!this.aborted&&this.centroid;if(this.reset(),d)return d}};var xo=function(c){this.singleTap=new Pl(c),this.numTaps=c.numTaps,this.reset()};xo.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},xo.prototype.touchstart=function(c,f,h){this.singleTap.touchstart(c,f,h)},xo.prototype.touchmove=function(c,f,h){this.singleTap.touchmove(c,f,h)},xo.prototype.touchend=function(c,f,h){var d=this.singleTap.touchend(c,f,h);if(d){var _=c.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(d)<30;if(_&&w||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}};var Ii=function(){this._zoomIn=new xo({numTouches:1,numTaps:2}),this._zoomOut=new xo({numTouches:2,numTaps:1}),this.reset()};Ii.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Ii.prototype.touchstart=function(c,f,h){this._zoomIn.touchstart(c,f,h),this._zoomOut.touchstart(c,f,h)},Ii.prototype.touchmove=function(c,f,h){this._zoomIn.touchmove(c,f,h),this._zoomOut.touchmove(c,f,h)},Ii.prototype.touchend=function(c,f,h){var d=this,_=this._zoomIn.touchend(c,f,h),w=this._zoomOut.touchend(c,f,h);return _?(this._active=!0,c.preventDefault(),setTimeout(function(){return d.reset()},0),{cameraAnimation:function(E){return E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(_)},{originalEvent:c})}}):w?(this._active=!0,c.preventDefault(),setTimeout(function(){return d.reset()},0),{cameraAnimation:function(E){return E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(w)},{originalEvent:c})}}):void 0},Ii.prototype.touchcancel=function(){this.reset()},Ii.prototype.enable=function(){this._enabled=!0},Ii.prototype.disable=function(){this._enabled=!1,this.reset()},Ii.prototype.isEnabled=function(){return this._enabled},Ii.prototype.isActive=function(){return this._active};var Bf={0:1,2:2},Ye=function(c){this.reset(),this._clickTolerance=c.clickTolerance||1};Ye.prototype.blur=function(){this.reset()},Ye.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ye.prototype._correctButton=function(c,f){return!1},Ye.prototype._move=function(c,f){return{}},Ye.prototype.mousedown=function(c,f){if(!this._lastPoint){var h=y.mouseButton(c);this._correctButton(c,h)&&(this._lastPoint=f,this._eventButton=h)}},Ye.prototype.mousemoveWindow=function(c,f){var h=this._lastPoint;if(h){if(c.preventDefault(),function(d,_){var w=Bf[_];return d.buttons===void 0||(d.buttons&w)!==w}(c,this._eventButton))this.reset();else if(this._moved||!(f.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(h,f)}},Ye.prototype.mouseupWindow=function(c){this._lastPoint&&y.mouseButton(c)===this._eventButton&&(this._moved&&y.suppressClick(),this.reset())},Ye.prototype.enable=function(){this._enabled=!0},Ye.prototype.disable=function(){this._enabled=!1,this.reset()},Ye.prototype.isEnabled=function(){return this._enabled},Ye.prototype.isActive=function(){return this._active};var Nf=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.mousedown=function(h,d){c.prototype.mousedown.call(this,h,d),this._lastPoint&&(this._active=!0)},f.prototype._correctButton=function(h,d){return d===0&&!h.ctrlKey},f.prototype._move=function(h,d){return{around:d,panDelta:d.sub(h)}},f}(Ye),Dc=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype._correctButton=function(h,d){return d===0&&h.ctrlKey||d===2},f.prototype._move=function(h,d){var _=.8*(d.x-h.x);if(_)return this._active=!0,{bearingDelta:_}},f.prototype.contextmenu=function(h){h.preventDefault()},f}(Ye),Ff=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype._correctButton=function(h,d){return d===0&&h.ctrlKey||d===2},f.prototype._move=function(h,d){var _=-.5*(d.y-h.y);if(_)return this._active=!0,{pitchDelta:_}},f.prototype.contextmenu=function(h){h.preventDefault()},f}(Ye),ro=function(c){this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset()};ro.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)},ro.prototype.touchstart=function(c,f,h){return this._calculateTransform(c,f,h)},ro.prototype.touchmove=function(c,f,h){if(this._active&&!(h.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,f,h)},ro.prototype.touchend=function(c,f,h){this._calculateTransform(c,f,h),this._active&&h.length<this._minTouches&&this.reset()},ro.prototype.touchcancel=function(){this.reset()},ro.prototype._calculateTransform=function(c,f,h){h.length>0&&(this._active=!0);var d=Oc(h,f),_=new s.Point(0,0),w=new s.Point(0,0),E=0;for(var A in d){var k=d[A],z=this._touches[A];z&&(_._add(k),w._add(k.sub(z)),E++,d[A]=k)}if(this._touches=d,!(E<this._minTouches)&&w.mag()){var Z=w.div(E);if(this._sum._add(Z),!(this._sum.mag()<this._clickTolerance))return{around:_.div(E),panDelta:Z}}},ro.prototype.enable=function(){this._enabled=!0},ro.prototype.disable=function(){this._enabled=!1,this.reset()},ro.prototype.isEnabled=function(){return this._enabled},ro.prototype.isActive=function(){return this._active};var Ci=function(){this.reset()};function zc(c,f,h){for(var d=0;d<c.length;d++)if(c[d].identifier===h)return f[d]}function Bc(c,f){return Math.log(c/f)/Math.LN2}Ci.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ci.prototype._start=function(c){},Ci.prototype._move=function(c,f,h){return{}},Ci.prototype.touchstart=function(c,f,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([f[0],f[1]]))},Ci.prototype.touchmove=function(c,f,h){if(this._firstTwoTouches){c.preventDefault();var d=this._firstTwoTouches,_=d[1],w=zc(h,f,d[0]),E=zc(h,f,_);if(w&&E){var A=this._aroundCenter?null:w.add(E).div(2);return this._move([w,E],A,c)}}},Ci.prototype.touchend=function(c,f,h){if(this._firstTwoTouches){var d=this._firstTwoTouches,_=d[1],w=zc(h,f,d[0]),E=zc(h,f,_);w&&E||(this._active&&y.suppressClick(),this.reset())}},Ci.prototype.touchcancel=function(){this.reset()},Ci.prototype.enable=function(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"},Ci.prototype.disable=function(){this._enabled=!1,this.reset()},Ci.prototype.isEnabled=function(){return this._enabled},Ci.prototype.isActive=function(){return this._active};var Mi=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.reset=function(){c.prototype.reset.call(this),delete this._distance,delete this._startDistance},f.prototype._start=function(h){this._startDistance=this._distance=h[0].dist(h[1])},f.prototype._move=function(h,d){var _=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(Bc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Bc(this._distance,_),pinchAround:d}},f}(Ci);function la(c,f){return 180*c.angleWith(f)/Math.PI}var _m=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.reset=function(){c.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},f.prototype._start=function(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])},f.prototype._move=function(h,d){var _=this._vector;if(this._vector=h[0].sub(h[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:la(this._vector,_),pinchAround:d}},f.prototype._isBelowThreshold=function(h){this._minDiameter=Math.min(this._minDiameter,h.mag());var d=25/(Math.PI*this._minDiameter)*360,_=la(h,this._startVector);return Math.abs(_)<d},f}(Ci);function ku(c){return Math.abs(c.y)>Math.abs(c.x)}var Uf=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.reset=function(){c.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},f.prototype._start=function(h){this._lastPoints=h,ku(h[0].sub(h[1]))&&(this._valid=!1)},f.prototype._move=function(h,d,_){var w=h[0].sub(this._lastPoints[0]),E=h[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(w,E,_.timeStamp),this._valid)return this._lastPoints=h,this._active=!0,{pitchDelta:(w.y+E.y)/2*-.5}},f.prototype.gestureBeginsVertically=function(h,d,_){if(this._valid!==void 0)return this._valid;var w=h.mag()>=2,E=d.mag()>=2;if(w||E){if(!w||!E)return this._firstMove===void 0&&(this._firstMove=_),_-this._firstMove<100&&void 0;var A=h.y>0==d.y>0;return ku(h)&&ku(d)&&A}},f}(Ci),jf={panStep:100,bearingStep:15,pitchStep:10},bo=function(){var c=jf;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1};function Vi(c){return c*(2-c)}bo.prototype.blur=function(){this.reset()},bo.prototype.reset=function(){this._active=!1},bo.prototype.keydown=function(c){var f=this;if(!(c.altKey||c.ctrlKey||c.metaKey)){var h=0,d=0,_=0,w=0,E=0;switch(c.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:c.shiftKey?d=-1:(c.preventDefault(),w=-1);break;case 39:c.shiftKey?d=1:(c.preventDefault(),w=1);break;case 38:c.shiftKey?_=1:(c.preventDefault(),E=-1);break;case 40:c.shiftKey?_=-1:(c.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(d=0,_=0),{cameraAnimation:function(A){var k=A.getZoom();A.easeTo({duration:300,easeId:"keyboardHandler",easing:Vi,zoom:h?Math.round(k)+h*(c.shiftKey?2:1):k,bearing:A.getBearing()+d*f._bearingStep,pitch:A.getPitch()+_*f._pitchStep,offset:[-w*f._panStep,-E*f._panStep],center:A.getCenter()},{originalEvent:c})}}}},bo.prototype.enable=function(){this._enabled=!0},bo.prototype.disable=function(){this._enabled=!1,this.reset()},bo.prototype.isEnabled=function(){return this._enabled},bo.prototype.isActive=function(){return this._active},bo.prototype.disableRotation=function(){this._rotationDisabled=!0},bo.prototype.enableRotation=function(){this._rotationDisabled=!1};var Zt=function(c,f){this._map=c,this._el=c.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,s.bindAll(["_onTimeout"],this)};Zt.prototype.setZoomRate=function(c){this._defaultZoomRate=c},Zt.prototype.setWheelZoomRate=function(c){this._wheelZoomRate=c},Zt.prototype.isEnabled=function(){return!!this._enabled},Zt.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Zt.prototype.isZooming=function(){return!!this._zooming},Zt.prototype.enable=function(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")},Zt.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Zt.prototype.wheel=function(c){if(this.isEnabled()){var f=c.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY,h=s.browser.now(),d=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,f!==0&&f%4.000244140625==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(d*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),c.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=c,this._delta-=f,this._active||this._start(c)),c.preventDefault()}},Zt.prototype._onTimeout=function(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},Zt.prototype._start=function(c){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var f=y.mousePos(this._el,c);this._around=s.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(f)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Zt.prototype.renderFrame=function(){var c=this;if(this._frameId&&(this._frameId=null,this.isActive())){var f=this._map.transform;if(this._delta!==0){var h=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,d=2/(1+Math.exp(-Math.abs(this._delta*h)));this._delta<0&&d!==0&&(d=1/d);var _=typeof this._targetZoom=="number"?f.zoomScale(this._targetZoom):f.scale;this._targetZoom=Math.min(f.maxZoom,Math.max(f.minZoom,f.scaleZoom(_*d))),this._type==="wheel"&&(this._startZoom=f.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var w,E=typeof this._targetZoom=="number"?this._targetZoom:f.zoom,A=this._startZoom,k=this._easing,z=!1;if(this._type==="wheel"&&A&&k){var Z=Math.min((s.browser.now()-this._lastWheelEventTime)/200,1),Y=k(Z);w=s.number(A,E,Y),Z<1?this._frameId||(this._frameId=!0):z=!0}else w=E,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout(function(){c._zooming=!1,c._handler._triggerRenderFrame(),delete c._targetZoom,delete c._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:w-f.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Zt.prototype._smoothOutEasing=function(c){var f=s.ease;if(this._prevEase){var h=this._prevEase,d=(s.browser.now()-h.start)/h.duration,_=h.easing(d+.01)-h.easing(d),w=.27/Math.sqrt(_*_+1e-4)*.01,E=Math.sqrt(.0729-w*w);f=s.bezier(w,E,.25,1)}return this._prevEase={start:s.browser.now(),duration:c,easing:f},f},Zt.prototype.blur=function(){this.reset()},Zt.prototype.reset=function(){this._active=!1};var Uo=function(c,f){this._clickZoom=c,this._tapZoom=f};Uo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Uo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Uo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Uo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var io=function(){this.reset()};io.prototype.reset=function(){this._active=!1},io.prototype.blur=function(){this.reset()},io.prototype.dblclick=function(c,f){return c.preventDefault(),{cameraAnimation:function(h){h.easeTo({duration:300,zoom:h.getZoom()+(c.shiftKey?-1:1),around:h.unproject(f)},{originalEvent:c})}}},io.prototype.enable=function(){this._enabled=!0},io.prototype.disable=function(){this._enabled=!1,this.reset()},io.prototype.isEnabled=function(){return this._enabled},io.prototype.isActive=function(){return this._active};var Fr=function(){this._tap=new xo({numTouches:1,numTaps:1}),this.reset()};Fr.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Fr.prototype.touchstart=function(c,f,h){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=f[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(c,f,h))},Fr.prototype.touchmove=function(c,f,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;var d=f[0],_=d.y-this._swipePoint.y;return this._swipePoint=d,c.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(c,f,h)},Fr.prototype.touchend=function(c,f,h){this._tapTime?this._swipePoint&&h.length===0&&this.reset():this._tap.touchend(c,f,h)&&(this._tapTime=c.timeStamp)},Fr.prototype.touchcancel=function(){this.reset()},Fr.prototype.enable=function(){this._enabled=!0},Fr.prototype.disable=function(){this._enabled=!1,this.reset()},Fr.prototype.isEnabled=function(){return this._enabled},Fr.prototype.isActive=function(){return this._active};var Fs=function(c,f,h){this._el=c,this._mousePan=f,this._touchPan=h};Fs.prototype.enable=function(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Fs.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Fs.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Fs.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Wa=function(c,f,h){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=f,this._mousePitch=h};Wa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Wa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Wa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Wa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var wo=function(c,f,h,d){this._el=c,this._touchZoom=f,this._touchRotate=h,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0};wo.prototype.enable=function(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},wo.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},wo.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},wo.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},wo.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},wo.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var ti=function(c){return c.zoom||c.drag||c.pitch||c.rotate},Lu=function(c){function f(){c.apply(this,arguments)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f}(s.Event);function pt(c){return c.panDelta&&c.panDelta.mag()||c.zoomDelta||c.bearingDelta||c.pitchDelta}var st=function(c,f){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Iu(c),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(f),s.bindAll(["handleEvent","handleWindowEvent"],this);var h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[s.window,"blur",void 0]];for(var d=0,_=this._listeners;d<_.length;d+=1){var w=_[d],E=w[0];y.addEventListener(E,w[1],E===s.window.document?this.handleWindowEvent:this.handleEvent,w[2])}};st.prototype.destroy=function(){for(var c=0,f=this._listeners;c<f.length;c+=1){var h=f[c],d=h[0];y.removeEventListener(d,h[1],d===s.window.document?this.handleWindowEvent:this.handleEvent,h[2])}},st.prototype._addDefaultHandlers=function(c){var f=this._map,h=f.getCanvasContainer();this._add("mapEvent",new sr(f,c));var d=f.boxZoom=new Pi(f,c);this._add("boxZoom",d);var _=new Ii,w=new io;f.doubleClickZoom=new Uo(w,_),this._add("tapZoom",_),this._add("clickZoom",w);var E=new Fr;this._add("tapDragZoom",E);var A=f.touchPitch=new Uf;this._add("touchPitch",A);var k=new Dc(c),z=new Ff(c);f.dragRotate=new Wa(c,k,z),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);var Z=new Nf(c),Y=new ro(c);f.dragPan=new Fs(h,Z,Y),this._add("mousePan",Z),this._add("touchPan",Y,["touchZoom","touchRotate"]);var $=new _m,oe=new Mi;f.touchZoomRotate=new wo(h,oe,$,E),this._add("touchRotate",$,["touchPan","touchZoom"]),this._add("touchZoom",oe,["touchPan","touchRotate"]);var re=f.scrollZoom=new Zt(f,this);this._add("scrollZoom",re,["mousePan"]);var ue=f.keyboard=new bo;this._add("keyboard",ue),this._add("blockableMapEvent",new ot(f));for(var ee=0,le=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];ee<le.length;ee+=1){var ge=le[ee];c.interactive&&c[ge]&&f[ge].enable(c[ge])}},st.prototype._add=function(c,f,h){this._handlers.push({handlerName:c,handler:f,allowed:h}),this._handlersById[c]=f},st.prototype.stop=function(c){if(!this._updatingCamera){for(var f=0,h=this._handlers;f<h.length;f+=1)h[f].handler.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}},st.prototype.isActive=function(){for(var c=0,f=this._handlers;c<f.length;c+=1)if(f[c].handler.isActive())return!0;return!1},st.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},st.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},st.prototype.isMoving=function(){return!!ti(this._eventsInProgress)||this.isZooming()},st.prototype._blockedByActive=function(c,f,h){for(var d in c)if(d!==h&&(!f||f.indexOf(d)<0))return!0;return!1},st.prototype.handleWindowEvent=function(c){this.handleEvent(c,c.type+"Window")},st.prototype._getMapTouches=function(c){for(var f=[],h=0,d=c;h<d.length;h+=1){var _=d[h];this._el.contains(_.target)&&f.push(_)}return f},st.prototype.handleEvent=function(c,f){this._updatingCamera=!0;for(var h=c.type==="renderFrame"?void 0:c,d={needsRenderFrame:!1},_={},w={},E=c.touches?this._getMapTouches(c.touches):void 0,A=E?y.touchPos(this._el,E):y.mousePos(this._el,c),k=0,z=this._handlers;k<z.length;k+=1){var Z=z[k],Y=Z.handlerName,$=Z.handler,oe=Z.allowed;if($.isEnabled()){var re=void 0;this._blockedByActive(w,oe,Y)?$.reset():$[f||c.type]&&(re=$[f||c.type](c,A,E),this.mergeHandlerResult(d,_,re,Y,h),re&&re.needsRenderFrame&&this._triggerRenderFrame()),(re||$.isActive())&&(w[Y]=$)}}var ue={};for(var ee in this._previousActiveHandlers)w[ee]||(ue[ee]=h);this._previousActiveHandlers=w,(Object.keys(ue).length||pt(d))&&(this._changes.push([d,_,ue]),this._triggerRenderFrame()),(Object.keys(w).length||pt(d))&&this._map._stop(!0),this._updatingCamera=!1;var le=d.cameraAnimation;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))},st.prototype.mergeHandlerResult=function(c,f,h,d,_){if(h){s.extend(c,h);var w={handlerName:d,originalEvent:h.originalEvent||_};h.zoomDelta!==void 0&&(f.zoom=w),h.panDelta!==void 0&&(f.drag=w),h.pitchDelta!==void 0&&(f.pitch=w),h.bearingDelta!==void 0&&(f.rotate=w)}},st.prototype._applyChanges=function(){for(var c={},f={},h={},d=0,_=this._changes;d<_.length;d+=1){var w=_[d],E=w[0],A=w[1],k=w[2];E.panDelta&&(c.panDelta=(c.panDelta||new s.Point(0,0))._add(E.panDelta)),E.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+E.zoomDelta),E.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+E.bearingDelta),E.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+E.pitchDelta),E.around!==void 0&&(c.around=E.around),E.pinchAround!==void 0&&(c.pinchAround=E.pinchAround),E.noInertia&&(c.noInertia=E.noInertia),s.extend(f,A),s.extend(h,k)}this._updateMapTransform(c,f,h),this._changes=[]},st.prototype._updateMapTransform=function(c,f,h){var d=this._map,_=d.transform;if(!pt(c))return this._fireEvents(f,h,!0);var w=c.panDelta,E=c.zoomDelta,A=c.bearingDelta,k=c.pitchDelta,z=c.around,Z=c.pinchAround;Z!==void 0&&(z=Z),d._stop(!0),z=z||d.transform.centerPoint;var Y=_.pointLocation(w?z.sub(w):z);A&&(_.bearing+=A),k&&(_.pitch+=k),E&&(_.zoom+=E),_.setLocationAtPoint(Y,z),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(f,h,!0)},st.prototype._fireEvents=function(c,f,h){var d=this,_=ti(this._eventsInProgress),w=ti(c),E={};for(var A in c)this._eventsInProgress[A]||(E[A+"start"]=c[A].originalEvent),this._eventsInProgress[A]=c[A];for(var k in!_&&w&&this._fireEvent("movestart",w.originalEvent),E)this._fireEvent(k,E[k]);for(var z in w&&this._fireEvent("move",w.originalEvent),c)this._fireEvent(z,c[z].originalEvent);var Z,Y={};for(var $ in this._eventsInProgress){var oe=this._eventsInProgress[$],re=oe.handlerName,ue=oe.originalEvent;this._handlersById[re].isActive()||(delete this._eventsInProgress[$],Y[$+"end"]=Z=f[re]||ue)}for(var ee in Y)this._fireEvent(ee,Y[ee]);var le=ti(this._eventsInProgress);if(h&&(_||w)&&!le){this._updatingCamera=!0;var ge=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),be=function(Ce){return Ce!==0&&-d._bearingSnap<Ce&&Ce<d._bearingSnap};ge?(be(ge.bearing||this._map.getBearing())&&(ge.bearing=0),this._map.easeTo(ge,{originalEvent:Z})):(this._map.fire(new s.Event("moveend",{originalEvent:Z})),be(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},st.prototype._fireEvent=function(c,f){this._map.fire(new s.Event(c,f?{originalEvent:f}:{}))},st.prototype._requestFrame=function(){var c=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(f){delete c._frameId,c.handleEvent(new Lu("renderFrame",{timeStamp:f})),c._applyChanges()})},st.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Nc=function(c){function f(h,d){c.call(this),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=d.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.getCenter=function(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)},f.prototype.setCenter=function(h,d){return this.jumpTo({center:h},d)},f.prototype.panBy=function(h,d,_){return h=s.Point.convert(h).mult(-1),this.panTo(this.transform.center,s.extend({offset:h},d),_)},f.prototype.panTo=function(h,d,_){return this.easeTo(s.extend({center:h},d),_)},f.prototype.getZoom=function(){return this.transform.zoom},f.prototype.setZoom=function(h,d){return this.jumpTo({zoom:h},d),this},f.prototype.zoomTo=function(h,d,_){return this.easeTo(s.extend({zoom:h},d),_)},f.prototype.zoomIn=function(h,d){return this.zoomTo(this.getZoom()+1,h,d),this},f.prototype.zoomOut=function(h,d){return this.zoomTo(this.getZoom()-1,h,d),this},f.prototype.getBearing=function(){return this.transform.bearing},f.prototype.setBearing=function(h,d){return this.jumpTo({bearing:h},d),this},f.prototype.getPadding=function(){return this.transform.padding},f.prototype.setPadding=function(h,d){return this.jumpTo({padding:h},d),this},f.prototype.rotateTo=function(h,d,_){return this.easeTo(s.extend({bearing:h},d),_)},f.prototype.resetNorth=function(h,d){return this.rotateTo(0,s.extend({duration:1e3},h),d),this},f.prototype.resetNorthPitch=function(h,d){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},h),d),this},f.prototype.snapToNorth=function(h,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,d):this},f.prototype.getPitch=function(){return this.transform.pitch},f.prototype.setPitch=function(h,d){return this.jumpTo({pitch:h},d),this},f.prototype.cameraForBounds=function(h,d){h=s.LngLatBounds.convert(h);var _=d&&d.bearing||0;return this._cameraForBoxAndBearing(h.getNorthWest(),h.getSouthEast(),_,d)},f.prototype._cameraForBoxAndBearing=function(h,d,_,w){var E={top:0,bottom:0,right:0,left:0};if(typeof(w=s.extend({padding:E,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){var A=w.padding;w.padding={top:A,bottom:A,right:A,left:A}}w.padding=s.extend(E,w.padding);var k=this.transform,z=k.padding,Z=k.project(s.LngLat.convert(h)),Y=k.project(s.LngLat.convert(d)),$=Z.rotate(-_*Math.PI/180),oe=Y.rotate(-_*Math.PI/180),re=new s.Point(Math.max($.x,oe.x),Math.max($.y,oe.y)),ue=new s.Point(Math.min($.x,oe.x),Math.min($.y,oe.y)),ee=re.sub(ue),le=(k.width-(z.left+z.right+w.padding.left+w.padding.right))/ee.x,ge=(k.height-(z.top+z.bottom+w.padding.top+w.padding.bottom))/ee.y;if(!(ge<0||le<0)){var be=Math.min(k.scaleZoom(k.scale*Math.min(le,ge)),w.maxZoom),Ce=typeof w.offset.x=="number"?new s.Point(w.offset.x,w.offset.y):s.Point.convert(w.offset),Pe=new s.Point((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(_*Math.PI/180),ke=Ce.add(Pe).mult(k.scale/k.zoomScale(be));return{center:k.unproject(Z.add(Y).div(2).sub(ke)),zoom:be,bearing:_}}s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},f.prototype.fitBounds=function(h,d,_){return this._fitInternal(this.cameraForBounds(h,d),d,_)},f.prototype.fitScreenCoordinates=function(h,d,_,w,E){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(s.Point.convert(h)),this.transform.pointLocation(s.Point.convert(d)),_,w),w,E)},f.prototype._fitInternal=function(h,d,_){return h?(delete(d=s.extend(h,d)).padding,d.linear?this.easeTo(d,_):this.flyTo(d,_)):this},f.prototype.jumpTo=function(h,d){this.stop();var _=this.transform,w=!1,E=!1,A=!1;return"zoom"in h&&_.zoom!==+h.zoom&&(w=!0,_.zoom=+h.zoom),h.center!==void 0&&(_.center=s.LngLat.convert(h.center)),"bearing"in h&&_.bearing!==+h.bearing&&(E=!0,_.bearing=+h.bearing),"pitch"in h&&_.pitch!==+h.pitch&&(A=!0,_.pitch=+h.pitch),h.padding==null||_.isPaddingEqual(h.padding)||(_.padding=h.padding),this.fire(new s.Event("movestart",d)).fire(new s.Event("move",d)),w&&this.fire(new s.Event("zoomstart",d)).fire(new s.Event("zoom",d)).fire(new s.Event("zoomend",d)),E&&this.fire(new s.Event("rotatestart",d)).fire(new s.Event("rotate",d)).fire(new s.Event("rotateend",d)),A&&this.fire(new s.Event("pitchstart",d)).fire(new s.Event("pitch",d)).fire(new s.Event("pitchend",d)),this.fire(new s.Event("moveend",d))},f.prototype.easeTo=function(h,d){var _=this;this._stop(!1,h.easeId),((h=s.extend({offset:[0,0],duration:500,easing:s.ease},h)).animate===!1||!h.essential&&s.browser.prefersReducedMotion)&&(h.duration=0);var w=this.transform,E=this.getZoom(),A=this.getBearing(),k=this.getPitch(),z=this.getPadding(),Z="zoom"in h?+h.zoom:E,Y="bearing"in h?this._normalizeBearing(h.bearing,A):A,$="pitch"in h?+h.pitch:k,oe="padding"in h?h.padding:w.padding,re=s.Point.convert(h.offset),ue=w.centerPoint.add(re),ee=w.pointLocation(ue),le=s.LngLat.convert(h.center||ee);this._normalizeCenter(le);var ge,be,Ce=w.project(ee),Pe=w.project(le).sub(Ce),ke=w.zoomScale(Z-E);h.around&&(ge=s.LngLat.convert(h.around),be=w.locationPoint(ge));var ze={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Z!==E,this._rotating=this._rotating||A!==Y,this._pitching=this._pitching||$!==k,this._padding=!w.isPaddingEqual(oe),this._easeId=h.easeId,this._prepareEase(d,h.noMoveStart,ze),this._ease(function(He){if(_._zooming&&(w.zoom=s.number(E,Z,He)),_._rotating&&(w.bearing=s.number(A,Y,He)),_._pitching&&(w.pitch=s.number(k,$,He)),_._padding&&(w.interpolatePadding(z,oe,He),ue=w.centerPoint.add(re)),ge)w.setLocationAtPoint(ge,be);else{var We=w.zoomScale(w.zoom-E),nt=Z>E?Math.min(2,ke):Math.max(.5,ke),dt=Math.pow(nt,1-He),vt=w.unproject(Ce.add(Pe.mult(He*dt)).mult(We));w.setLocationAtPoint(w.renderWorldCopies?vt.wrap():vt,ue)}_._fireMoveEvents(d)},function(He){_._afterEase(d,He)},h),this},f.prototype._prepareEase=function(h,d,_){_===void 0&&(_={}),this._moving=!0,d||_.moving||this.fire(new s.Event("movestart",h)),this._zooming&&!_.zooming&&this.fire(new s.Event("zoomstart",h)),this._rotating&&!_.rotating&&this.fire(new s.Event("rotatestart",h)),this._pitching&&!_.pitching&&this.fire(new s.Event("pitchstart",h))},f.prototype._fireMoveEvents=function(h){this.fire(new s.Event("move",h)),this._zooming&&this.fire(new s.Event("zoom",h)),this._rotating&&this.fire(new s.Event("rotate",h)),this._pitching&&this.fire(new s.Event("pitch",h))},f.prototype._afterEase=function(h,d){if(!this._easeId||!d||this._easeId!==d){delete this._easeId;var _=this._zooming,w=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new s.Event("zoomend",h)),w&&this.fire(new s.Event("rotateend",h)),E&&this.fire(new s.Event("pitchend",h)),this.fire(new s.Event("moveend",h))}},f.prototype.flyTo=function(h,d){var _=this;if(!h.essential&&s.browser.prefersReducedMotion){var w=s.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(w,d)}this.stop(),h=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},h);var E=this.transform,A=this.getZoom(),k=this.getBearing(),z=this.getPitch(),Z=this.getPadding(),Y="zoom"in h?s.clamp(+h.zoom,E.minZoom,E.maxZoom):A,$="bearing"in h?this._normalizeBearing(h.bearing,k):k,oe="pitch"in h?+h.pitch:z,re="padding"in h?h.padding:E.padding,ue=E.zoomScale(Y-A),ee=s.Point.convert(h.offset),le=E.centerPoint.add(ee),ge=E.pointLocation(le),be=s.LngLat.convert(h.center||ge);this._normalizeCenter(be);var Ce=E.project(ge),Pe=E.project(be).sub(Ce),ke=h.curve,ze=Math.max(E.width,E.height),He=ze/ue,We=Pe.mag();if("minZoom"in h){var nt=s.clamp(Math.min(h.minZoom,A,Y),E.minZoom,E.maxZoom),dt=ze/E.zoomScale(nt-A);ke=Math.sqrt(dt/We*2)}var vt=ke*ke;function yt(St){var Et=(He*He-ze*ze+(St?-1:1)*vt*vt*We*We)/(2*(St?He:ze)*vt*We);return Math.log(Math.sqrt(Et*Et+1)-Et)}function nn(St){return(Math.exp(St)-Math.exp(-St))/2}function it(St){return(Math.exp(St)+Math.exp(-St))/2}var It=yt(0),Ut=function(St){return it(It)/it(It+ke*St)},Pt=function(St){return ze*((it(It)*(nn(Et=It+ke*St)/it(Et))-nn(It))/vt)/We;var Et},At=(yt(1)-It)/ke;if(Math.abs(We)<1e-6||!isFinite(At)){if(Math.abs(ze-He)<1e-6)return this.easeTo(h,d);var Nt=He<ze?-1:1;At=Math.abs(Math.log(He/ze))/ke,Pt=function(){return 0},Ut=function(St){return Math.exp(Nt*ke*St)}}return h.duration="duration"in h?+h.duration:1e3*At/("screenSpeed"in h?+h.screenSpeed/ke:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0),this._zooming=!0,this._rotating=k!==$,this._pitching=oe!==z,this._padding=!E.isPaddingEqual(re),this._prepareEase(d,!1),this._ease(function(St){var Et=St*At,br=1/Ut(Et);E.zoom=St===1?Y:A+E.scaleZoom(br),_._rotating&&(E.bearing=s.number(k,$,St)),_._pitching&&(E.pitch=s.number(z,oe,St)),_._padding&&(E.interpolatePadding(Z,re,St),le=E.centerPoint.add(ee));var Vn=St===1?be:E.unproject(Ce.add(Pe.mult(Pt(Et))).mult(br));E.setLocationAtPoint(E.renderWorldCopies?Vn.wrap():Vn,le),_._fireMoveEvents(d)},function(){return _._afterEase(d)},h),this},f.prototype.isEasing=function(){return!!this._easeFrameId},f.prototype.stop=function(){return this._stop()},f.prototype._stop=function(h,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,d)}if(!h){var w=this.handlers;w&&w.stop(!1)}return this},f.prototype._ease=function(h,d,_){_.animate===!1||_.duration===0?(h(1),d()):(this._easeStart=s.browser.now(),this._easeOptions=_,this._onEaseFrame=h,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},f.prototype._renderFrameCallback=function(){var h=Math.min((s.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},f.prototype._normalizeBearing=function(h,d){h=s.wrap(h,-180,180);var _=Math.abs(h-d);return Math.abs(h-360-d)<_&&(h-=360),Math.abs(h+360-d)<_&&(h+=360),h},f.prototype._normalizeCenter=function(h){var d=this.transform;if(d.renderWorldCopies&&!d.lngRange){var _=h.lng-d.center.lng;h.lng+=_>180?-360:_<-180?360:0}},f}(s.Evented),ni=function(c){c===void 0&&(c={}),this.options=c,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};ni.prototype.getDefaultPosition=function(){return"bottom-right"},ni.prototype.onAdd=function(c){var f=this.options&&this.options.compact;return this._map=c,this._container=y.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=y.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=y.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ni.prototype.onRemove=function(){y.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ni.prototype._setElementTitle=function(c,f){var h=this._map._getUIString("AttributionControl."+f);c.title=h,c.setAttribute("aria-label",h)},ni.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},ni.prototype._updateEditLink=function(){var c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));var f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(c){var h=f.reduce(function(d,_,w){return _.value&&(d+=_.key+"="+_.value+(w<f.length-1?"&":"")),d},"?");c.href=s.config.FEEDBACK_URL+"/"+h+(this._map._hash?this._map._hash.getHashString(!0):""),c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}},ni.prototype._updateData=function(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},ni.prototype._updateAttributions=function(){if(this._map.style){var c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(function(A){return typeof A!="string"?"":A})):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){var f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}var h=this._map.style.sourceCaches;for(var d in h){var _=h[d];if(_.used){var w=_.getSource();w.attribution&&c.indexOf(w.attribution)<0&&c.push(w.attribution)}}c.sort(function(A,k){return A.length-k.length});var E=(c=c.filter(function(A,k){for(var z=k+1;z<c.length;z++)if(c[z].indexOf(A)>=0)return!1;return!0})).join(" | ");E!==this._attribHTML&&(this._attribHTML=E,c.length?(this._innerContainer.innerHTML=E,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ni.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Eo=function(){s.bindAll(["_updateLogo"],this),s.bindAll(["_updateCompact"],this)};Eo.prototype.onAdd=function(c){this._map=c,this._container=y.create("div","mapboxgl-ctrl");var f=y.create("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Eo.prototype.onRemove=function(){y.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Eo.prototype.getDefaultPosition=function(){return"bottom-left"},Eo.prototype._updateLogo=function(c){c&&c.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Eo.prototype._logoRequired=function(){if(this._map.style){var c=this._map.style.sourceCaches;for(var f in c)if(c[f].getSource().mapbox_logo)return!0;return!1}},Eo.prototype._updateCompact=function(){var c=this._container.children;if(c.length){var f=c[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}};var Ur=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ur.prototype.add=function(c){var f=++this._id;return this._queue.push({callback:c,id:f,cancelled:!1}),f},Ur.prototype.remove=function(c){for(var f=this._currentlyRunning,h=0,d=f?this._queue.concat(f):this._queue;h<d.length;h+=1){var _=d[h];if(_.id===c)return void(_.cancelled=!0)}},Ur.prototype.run=function(c){c===void 0&&(c=0);var f=this._currentlyRunning=this._queue;this._queue=[];for(var h=0,d=f;h<d.length;h+=1){var _=d[h];if(!_.cancelled&&(_.callback(c),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ur.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var jo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Vf=s.window.HTMLImageElement,Fc=s.window.HTMLElement,cn=s.window.ImageBitmap,Mr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},xm=function(c){function f(d){var _=this;if((d=s.extend({},Mr,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var w=new Kt(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies);if(c.call(this,w,d),this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._renderTaskQueue=new Ur,this._controls=[],this._mapId=s.uniqueId(),this._locale=s.extend({},jo,d.locale),this._clickTolerance=d.clickTolerance,this._requestManager=new s.RequestManager(d.transformRequest,d.accessToken),typeof d.container=="string"){if(this._container=s.window.document.getElementById(d.container),!this._container)throw new Error("Container '"+d.container+"' not found.")}else{if(!(d.container instanceof Fc))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return _._update(!1)}),this.on("moveend",function(){return _._update(!1)}),this.on("zoom",function(){return _._update(!0)}),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new st(this,d),this._hash=d.hash&&new ji(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,s.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new ni({customAttribution:d.customAttribution})),this.addControl(new Eo,d.logoPosition),this.on("style.load",function(){_.transform.unmodified&&_.jumpTo(_.style.stylesheet)}),this.on("data",function(E){_._update(E.dataType==="style"),_.fire(new s.Event(E.dataType+"data",E))}),this.on("dataloading",function(E){_.fire(new s.Event(E.dataType+"dataloading",E))})}c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f;var h={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return f.prototype._getMapId=function(){return this._mapId},f.prototype.addControl=function(d,_){if(_===void 0&&(_=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var w=d.onAdd(this);this._controls.push(d);var E=this._controlPositions[_];return _.indexOf("bottom")!==-1?E.insertBefore(w,E.firstChild):E.appendChild(w),this},f.prototype.removeControl=function(d){if(!d||!d.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var _=this._controls.indexOf(d);return _>-1&&this._controls.splice(_,1),d.onRemove(this),this},f.prototype.hasControl=function(d){return this._controls.indexOf(d)>-1},f.prototype.resize=function(d){var _=this._containerDimensions(),w=_[0],E=_[1];if(w===this.transform.width&&E===this.transform.height)return this;this._resizeCanvas(w,E),this.transform.resize(w,E),this.painter.resize(w,E);var A=!this._moving;return A&&this.fire(new s.Event("movestart",d)).fire(new s.Event("move",d)),this.fire(new s.Event("resize",d)),A&&this.fire(new s.Event("moveend",d)),this},f.prototype.getBounds=function(){return this.transform.getBounds()},f.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},f.prototype.setMaxBounds=function(d){return this.transform.setMaxBounds(s.LngLatBounds.convert(d)),this._update()},f.prototype.setMinZoom=function(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d&&this.setZoom(d),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},f.prototype.getMinZoom=function(){return this.transform.minZoom},f.prototype.setMaxZoom=function(d){if((d=d??22)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d&&this.setZoom(d),this;throw new Error("maxZoom must be greater than the current minZoom")},f.prototype.getMaxZoom=function(){return this.transform.maxZoom},f.prototype.setMinPitch=function(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d&&this.setPitch(d),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},f.prototype.getMinPitch=function(){return this.transform.minPitch},f.prototype.setMaxPitch=function(d){if((d=d??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d&&this.setPitch(d),this;throw new Error("maxPitch must be greater than the current minPitch")},f.prototype.getMaxPitch=function(){return this.transform.maxPitch},f.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},f.prototype.setRenderWorldCopies=function(d){return this.transform.renderWorldCopies=d,this._update()},f.prototype.project=function(d){return this.transform.locationPoint(s.LngLat.convert(d))},f.prototype.unproject=function(d){return this.transform.pointLocation(s.Point.convert(d))},f.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},f.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},f.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},f.prototype._createDelegatedListener=function(d,_,w){var E,A=this;if(d==="mouseenter"||d==="mouseover"){var k=!1;return{layer:_,listener:w,delegates:{mousemove:function(Z){var Y=A.getLayer(_)?A.queryRenderedFeatures(Z.point,{layers:[_]}):[];Y.length?k||(k=!0,w.call(A,new fr(d,A,Z.originalEvent,{features:Y}))):k=!1},mouseout:function(){k=!1}}}}if(d==="mouseleave"||d==="mouseout"){var z=!1;return{layer:_,listener:w,delegates:{mousemove:function(Z){(A.getLayer(_)?A.queryRenderedFeatures(Z.point,{layers:[_]}):[]).length?z=!0:z&&(z=!1,w.call(A,new fr(d,A,Z.originalEvent)))},mouseout:function(Z){z&&(z=!1,w.call(A,new fr(d,A,Z.originalEvent)))}}}}return{layer:_,listener:w,delegates:(E={},E[d]=function(Z){var Y=A.getLayer(_)?A.queryRenderedFeatures(Z.point,{layers:[_]}):[];Y.length&&(Z.features=Y,w.call(A,Z),delete Z.features)},E)}},f.prototype.on=function(d,_,w){if(w===void 0)return c.prototype.on.call(this,d,_);var E=this._createDelegatedListener(d,_,w);for(var A in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(E),E.delegates)this.on(A,E.delegates[A]);return this},f.prototype.once=function(d,_,w){if(w===void 0)return c.prototype.once.call(this,d,_);var E=this._createDelegatedListener(d,_,w);for(var A in E.delegates)this.once(A,E.delegates[A]);return this},f.prototype.off=function(d,_,w){var E=this;return w===void 0?c.prototype.off.call(this,d,_):(this._delegatedListeners&&this._delegatedListeners[d]&&function(A){for(var k=A[d],z=0;z<k.length;z++){var Z=k[z];if(Z.layer===_&&Z.listener===w){for(var Y in Z.delegates)E.off(Y,Z.delegates[Y]);return k.splice(z,1),E}}}(this._delegatedListeners),this)},f.prototype.queryRenderedFeatures=function(d,_){if(!this.style)return[];var w;if(_!==void 0||d===void 0||d instanceof s.Point||Array.isArray(d)||(_=d,d=void 0),_=_||{},(d=d||[[0,0],[this.transform.width,this.transform.height]])instanceof s.Point||typeof d[0]=="number")w=[s.Point.convert(d)];else{var E=s.Point.convert(d[0]),A=s.Point.convert(d[1]);w=[E,new s.Point(A.x,E.y),A,new s.Point(E.x,A.y),E]}return this.style.queryRenderedFeatures(w,_,this.transform)},f.prototype.querySourceFeatures=function(d,_){return this.style.querySourceFeatures(d,_)},f.prototype.setStyle=function(d,_){return(_=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},_)).diff!==!1&&_.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&d?(this._diffStyle(d,_),this):(this._localIdeographFontFamily=_.localIdeographFontFamily,this._updateStyle(d,_))},f.prototype._getUIString=function(d){var _=this._locale[d];if(_==null)throw new Error("Missing UI string '"+d+"'");return _},f.prototype._updateStyle=function(d,_){return this.style&&(this.style.setEventedParent(null),this.style._remove()),d?(this.style=new Ai(this,_||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d),this):(delete this.style,this)},f.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ai(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},f.prototype._diffStyle=function(d,_){var w=this;if(typeof d=="string"){var E=this._requestManager.normalizeStyleURL(d),A=this._requestManager.transformRequest(E,s.ResourceType.Style);s.getJSON(A,function(k,z){k?w.fire(new s.ErrorEvent(k)):z&&w._updateDiff(z,_)})}else typeof d=="object"&&this._updateDiff(d,_)},f.prototype._updateDiff=function(d,_){try{this.style.setState(d)&&this._update(!0)}catch(w){s.warnOnce("Unable to perform style diff: "+(w.message||w.error||w)+".  Rebuilding the style from scratch."),this._updateStyle(d,_)}},f.prototype.getStyle=function(){if(this.style)return this.style.serialize()},f.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():s.warnOnce("There is no style added to the map.")},f.prototype.addSource=function(d,_){return this._lazyInitEmptyStyle(),this.style.addSource(d,_),this._update(!0)},f.prototype.isSourceLoaded=function(d){var _=this.style&&this.style.sourceCaches[d];if(_!==void 0)return _.loaded();this.fire(new s.ErrorEvent(new Error("There is no source with ID '"+d+"'")))},f.prototype.areTilesLoaded=function(){var d=this.style&&this.style.sourceCaches;for(var _ in d){var w=d[_]._tiles;for(var E in w){var A=w[E];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0},f.prototype.addSourceType=function(d,_,w){return this._lazyInitEmptyStyle(),this.style.addSourceType(d,_,w)},f.prototype.removeSource=function(d){return this.style.removeSource(d),this._update(!0)},f.prototype.getSource=function(d){return this.style.getSource(d)},f.prototype.addImage=function(d,_,w){w===void 0&&(w={});var E=w.pixelRatio;E===void 0&&(E=1);var A=w.sdf;A===void 0&&(A=!1);var k=w.stretchX,z=w.stretchY,Z=w.content;if(this._lazyInitEmptyStyle(),_ instanceof Vf||cn&&_ instanceof cn){var Y=s.browser.getImageData(_);this.style.addImage(d,{data:new s.RGBAImage({width:Y.width,height:Y.height},Y.data),pixelRatio:E,stretchX:k,stretchY:z,content:Z,sdf:A,version:0})}else{if(_.width===void 0||_.height===void 0)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var $=_;this.style.addImage(d,{data:new s.RGBAImage({width:_.width,height:_.height},new Uint8Array(_.data)),pixelRatio:E,stretchX:k,stretchY:z,content:Z,sdf:A,version:0,userImage:$}),$.onAdd&&$.onAdd(this,d)}},f.prototype.updateImage=function(d,_){var w=this.style.getImage(d);if(!w)return this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var E=_ instanceof Vf||cn&&_ instanceof cn?s.browser.getImageData(_):_,A=E.width,k=E.height,z=E.data;return A===void 0||k===void 0?this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):A!==w.data.width||k!==w.data.height?this.fire(new s.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(w.data.replace(z,!(_ instanceof Vf||cn&&_ instanceof cn)),void this.style.updateImage(d,w))},f.prototype.hasImage=function(d){return d?!!this.style.getImage(d):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)},f.prototype.removeImage=function(d){this.style.removeImage(d)},f.prototype.loadImage=function(d,_){s.getImage(this._requestManager.transformRequest(d,s.ResourceType.Image),_)},f.prototype.listImages=function(){return this.style.listImages()},f.prototype.addLayer=function(d,_){return this._lazyInitEmptyStyle(),this.style.addLayer(d,_),this._update(!0)},f.prototype.moveLayer=function(d,_){return this.style.moveLayer(d,_),this._update(!0)},f.prototype.removeLayer=function(d){return this.style.removeLayer(d),this._update(!0)},f.prototype.getLayer=function(d){return this.style.getLayer(d)},f.prototype.setLayerZoomRange=function(d,_,w){return this.style.setLayerZoomRange(d,_,w),this._update(!0)},f.prototype.setFilter=function(d,_,w){return w===void 0&&(w={}),this.style.setFilter(d,_,w),this._update(!0)},f.prototype.getFilter=function(d){return this.style.getFilter(d)},f.prototype.setPaintProperty=function(d,_,w,E){return E===void 0&&(E={}),this.style.setPaintProperty(d,_,w,E),this._update(!0)},f.prototype.getPaintProperty=function(d,_){return this.style.getPaintProperty(d,_)},f.prototype.setLayoutProperty=function(d,_,w,E){return E===void 0&&(E={}),this.style.setLayoutProperty(d,_,w,E),this._update(!0)},f.prototype.getLayoutProperty=function(d,_){return this.style.getLayoutProperty(d,_)},f.prototype.setLight=function(d,_){return _===void 0&&(_={}),this._lazyInitEmptyStyle(),this.style.setLight(d,_),this._update(!0)},f.prototype.getLight=function(){return this.style.getLight()},f.prototype.setFeatureState=function(d,_){return this.style.setFeatureState(d,_),this._update()},f.prototype.removeFeatureState=function(d,_){return this.style.removeFeatureState(d,_),this._update()},f.prototype.getFeatureState=function(d){return this.style.getFeatureState(d)},f.prototype.getContainer=function(){return this._container},f.prototype.getCanvasContainer=function(){return this._canvasContainer},f.prototype.getCanvas=function(){return this._canvas},f.prototype._containerDimensions=function(){var d=0,_=0;return this._container&&(d=this._container.clientWidth||400,_=this._container.clientHeight||300),[d,_]},f.prototype._detectMissingCSS=function(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},f.prototype._setupContainer=function(){var d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=y.create("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();var _=this._canvasContainer=y.create("div","mapboxgl-canvas-container",d);this._interactive&&_.classList.add("mapboxgl-interactive"),this._canvas=y.create("canvas","mapboxgl-canvas",_),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var w=this._containerDimensions();this._resizeCanvas(w[0],w[1]);var E=this._controlContainer=y.create("div","mapboxgl-control-container",d),A=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(k){A[k]=y.create("div","mapboxgl-ctrl-"+k,E)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},f.prototype._resizeCanvas=function(d,_){var w=s.browser.devicePixelRatio||1;this._canvas.width=w*d,this._canvas.height=w*_,this._canvas.style.width=d+"px",this._canvas.style.height=_+"px"},f.prototype._setupPainter=function(){var d=s.extend({},g.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),_=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);_?(this.painter=new Cn(_,this.transform),s.webpSupported.testSupport(_)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))},f.prototype._contextLost=function(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:d}))},f.prototype._contextRestored=function(d){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:d}))},f.prototype._onMapScroll=function(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},f.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},f.prototype._update=function(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this},f.prototype._requestRenderFrame=function(d){return this._update(),this._renderTaskQueue.add(d)},f.prototype._cancelRenderFrame=function(d){this._renderTaskQueue.remove(d)},f.prototype._render=function(d){var _,w=this,E=0,A=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(_=A.createQueryEXT(),A.beginQueryEXT(A.TIME_ELAPSED_EXT,_),E=s.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),!this._removed){var k=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var z=this.transform.zoom,Z=s.browser.now();this.style.zoomHistory.update(z,Z);var Y=new s.EvaluationParameters(z,{now:Z,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),$=Y.crossFadingFactor();$===1&&$===this._crossFadingFactor||(k=!0,this._crossFadingFactor=$),this.style.update(Y)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||k)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var oe=s.browser.now()-E;A.endQueryEXT(A.TIME_ELAPSED_EXT,_),setTimeout(function(){var ee=A.getQueryObjectEXT(_,A.QUERY_RESULT_EXT)/1e6;A.deleteQueryEXT(_),w.fire(new s.Event("gpu-timing-frame",{cpuTime:oe,gpuTime:ee}))},50)}if(this.listens("gpu-timing-layer")){var re=this.painter.collectGpuTimers();setTimeout(function(){var ee=w.painter.queryGpuTimers(re);w.fire(new s.Event("gpu-timing-layer",{layerTimes:ee}))},50)}var ue=this._sourcesDirty||this._styleDirty||this._placementDirty;return ue||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.Event("idle")),!this._loaded||this._fullyLoaded||ue||(this._fullyLoaded=!0),this}},f.prototype.remove=function(){this._hash&&this._hash.remove();for(var d=0,_=this._controls;d<_.length;d+=1)_[d].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));var w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),Us(this._canvasContainer),Us(this._controlContainer),Us(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new s.Event("remove"))},f.prototype.triggerRepaint=function(){var d=this;this.style&&!this._frame&&(this._frame=s.browser.frame(function(_){d._frame=null,d._render(_)}))},f.prototype._onWindowOnline=function(){this._update()},f.prototype._onWindowResize=function(d){this._trackResize&&this.resize({originalEvent:d})._update()},h.showTileBoundaries.get=function(){return!!this._showTileBoundaries},h.showTileBoundaries.set=function(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())},h.showPadding.get=function(){return!!this._showPadding},h.showPadding.set=function(d){this._showPadding!==d&&(this._showPadding=d,this._update())},h.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},h.showCollisionBoxes.set=function(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())},h.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},h.showOverdrawInspector.set=function(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())},h.repaint.get=function(){return!!this._repaint},h.repaint.set=function(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())},h.vertices.get=function(){return!!this._vertices},h.vertices.set=function(d){this._vertices=d,this._update()},f.prototype._setCacheLimits=function(d,_){s.setCacheLimits(d,_)},h.version.get=function(){return s.version},Object.defineProperties(f.prototype,h),f}(Nc);function Us(c){c.parentNode&&c.parentNode.removeChild(c)}var Gf={showCompass:!0,showZoom:!0,visualizePitch:!1},ua=function(c){var f=this;this.options=s.extend({},Gf,c),this._container=y.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(h){return h.preventDefault()}),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(h){return f._map.zoomIn({},{originalEvent:h})}),y.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(h){return f._map.zoomOut({},{originalEvent:h})}),y.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(h){f.options.visualizePitch?f._map.resetNorthPitch({},{originalEvent:h}):f._map.resetNorth({},{originalEvent:h})}),this._compassIcon=y.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ua.prototype._updateZoomButtons=function(){var c=this._map.getZoom(),f=c===this._map.getMaxZoom(),h=c===this._map.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},ua.prototype._rotateCompassArrow=function(){var c=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=c},ua.prototype.onAdd=function(c){return this._map=c,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ki(this._map,this._compass,this.options.visualizePitch)),this._container},ua.prototype.onRemove=function(){y.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ua.prototype._createButton=function(c,f){var h=y.create("button",c,this._container);return h.type="button",h.addEventListener("click",f),h},ua.prototype._setButtonTitle=function(c,f){var h=this._map._getUIString("NavigationControl."+f);c.title=h,c.setAttribute("aria-label",h)};var ki=function(c,f,h){h===void 0&&(h=!1),this._clickTolerance=10,this.element=f,this.mouseRotate=new Dc({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,h&&(this.mousePitch=new Ff({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),y.addEventListener(f,"mousedown",this.mousedown),y.addEventListener(f,"touchstart",this.touchstart,{passive:!1}),y.addEventListener(f,"touchmove",this.touchmove),y.addEventListener(f,"touchend",this.touchend),y.addEventListener(f,"touchcancel",this.reset)};function Il(c,f,h){if(c=new s.LngLat(c.lng,c.lat),f){var d=new s.LngLat(c.lng-360,c.lat),_=new s.LngLat(c.lng+360,c.lat),w=h.locationPoint(c).distSqr(f);h.locationPoint(d).distSqr(f)<w?c=d:h.locationPoint(_).distSqr(f)<w&&(c=_)}for(;Math.abs(c.lng-h.center.lng)>180;){var E=h.locationPoint(c);if(E.x>=0&&E.y>=0&&E.x<=h.width&&E.y<=h.height)break;c.lng>h.center.lng?c.lng-=360:c.lng+=360}return c}ki.prototype.down=function(c,f){this.mouseRotate.mousedown(c,f),this.mousePitch&&this.mousePitch.mousedown(c,f),y.disableDrag()},ki.prototype.move=function(c,f){var h=this.map,d=this.mouseRotate.mousemoveWindow(c,f);if(d&&d.bearingDelta&&h.setBearing(h.getBearing()+d.bearingDelta),this.mousePitch){var _=this.mousePitch.mousemoveWindow(c,f);_&&_.pitchDelta&&h.setPitch(h.getPitch()+_.pitchDelta)}},ki.prototype.off=function(){var c=this.element;y.removeEventListener(c,"mousedown",this.mousedown),y.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),y.removeEventListener(c,"touchmove",this.touchmove),y.removeEventListener(c,"touchend",this.touchend),y.removeEventListener(c,"touchcancel",this.reset),this.offTemp()},ki.prototype.offTemp=function(){y.enableDrag(),y.removeEventListener(s.window,"mousemove",this.mousemove),y.removeEventListener(s.window,"mouseup",this.mouseup)},ki.prototype.mousedown=function(c){this.down(s.extend({},c,{ctrlKey:!0,preventDefault:function(){return c.preventDefault()}}),y.mousePos(this.element,c)),y.addEventListener(s.window,"mousemove",this.mousemove),y.addEventListener(s.window,"mouseup",this.mouseup)},ki.prototype.mousemove=function(c){this.move(c,y.mousePos(this.element,c))},ki.prototype.mouseup=function(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()},ki.prototype.touchstart=function(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=y.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return c.preventDefault()}},this._startPos))},ki.prototype.touchmove=function(c){c.targetTouches.length!==1?this.reset():(this._lastPos=y.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:function(){return c.preventDefault()}},this._lastPos))},ki.prototype.touchend=function(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},ki.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Vo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Uc(c,f,h){var d=c.classList;for(var _ in Vo)d.remove("mapboxgl-"+h+"-anchor-"+_);d.add("mapboxgl-"+h+"-anchor-"+f)}var Cl,Ru=function(c){function f(h,d){if(c.call(this),(h instanceof s.window.HTMLElement||d)&&(h=s.extend({element:h},d)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment!=="auto"?h.pitchAlignment:this._rotationAlignment,h&&h.element)this._element=h.element,this._offset=s.Point.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=y.create("div"),this._element.setAttribute("aria-label","Map marker");var _=y.createNS("http://www.w3.org/2000/svg","svg");_.setAttributeNS(null,"display","block"),_.setAttributeNS(null,"height","41px"),_.setAttributeNS(null,"width","27px"),_.setAttributeNS(null,"viewBox","0 0 27 41");var w=y.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");var E=y.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");var A=y.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"transform","translate(3.0, 29.0)"),A.setAttributeNS(null,"fill","#000000");for(var k=0,z=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];k<z.length;k+=1){var Z=z[k],Y=y.createNS("http://www.w3.org/2000/svg","ellipse");Y.setAttributeNS(null,"opacity","0.04"),Y.setAttributeNS(null,"cx","10.5"),Y.setAttributeNS(null,"cy","5.80029008"),Y.setAttributeNS(null,"rx",Z.rx),Y.setAttributeNS(null,"ry",Z.ry),A.appendChild(Y)}var $=y.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"fill",this._color);var oe=y.createNS("http://www.w3.org/2000/svg","path");oe.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),$.appendChild(oe);var re=y.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"opacity","0.25"),re.setAttributeNS(null,"fill","#000000");var ue=y.createNS("http://www.w3.org/2000/svg","path");ue.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),re.appendChild(ue);var ee=y.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ee.setAttributeNS(null,"fill","#FFFFFF");var le=y.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ge=y.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#000000"),ge.setAttributeNS(null,"opacity","0.25"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962");var be=y.createNS("http://www.w3.org/2000/svg","circle");be.setAttributeNS(null,"fill","#FFFFFF"),be.setAttributeNS(null,"cx","5.5"),be.setAttributeNS(null,"cy","5.5"),be.setAttributeNS(null,"r","5.4999962"),le.appendChild(ge),le.appendChild(be),E.appendChild(A),E.appendChild($),E.appendChild(re),E.appendChild(ee),E.appendChild(le),_.appendChild(E),_.setAttributeNS(null,"height",41*this._scale+"px"),_.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(_),this._offset=s.Point.convert(h&&h.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ce){Ce.preventDefault()}),this._element.addEventListener("mousedown",function(Ce){Ce.preventDefault()}),Uc(this._element,this._anchor,"marker"),this._popup=null}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.addTo=function(h){return this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._update),h.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},f.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),y.remove(this._element),this._popup&&this._popup.remove(),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(h){return this._lngLat=s.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},f.prototype.getElement=function(){return this._element},f.prototype.setPopup=function(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){var d=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(24.6+d)],"bottom-right":[-d,-1*(24.6+d)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=h,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},f.prototype._onKeyPress=function(h){var d=h.code,_=h.charCode||h.keyCode;d!=="Space"&&d!=="Enter"&&_!==32&&_!==13||this.togglePopup()},f.prototype._onMapClick=function(h){var d=h.originalEvent.target,_=this._element;this._popup&&(d===_||_.contains(d))&&this.togglePopup()},f.prototype.getPopup=function(){return this._popup},f.prototype.togglePopup=function(){var h=this._popup;return h?(h.isOpen()?h.remove():h.addTo(this._map),this):this},f.prototype._update=function(h){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Il(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(d="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_="rotateX("+this._map.getPitch()+"deg)"),h&&h.type!=="moveend"||(this._pos=this._pos.round()),y.setTransform(this._element,Vo[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+_+" "+d)}},f.prototype.getOffset=function(){return this._offset},f.prototype.setOffset=function(h){return this._offset=s.Point.convert(h),this._update(),this},f.prototype._onMove=function(h){if(!this._isDragging){var d=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))},f.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"},f.prototype._addDragHandler=function(h){this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},f.prototype.setDraggable=function(h){return this._draggable=!!h,this._map&&(h?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},f.prototype.isDraggable=function(){return this._draggable},f.prototype.setRotation=function(h){return this._rotation=h||0,this._update(),this},f.prototype.getRotation=function(){return this._rotation},f.prototype.setRotationAlignment=function(h){return this._rotationAlignment=h||"auto",this._update(),this},f.prototype.getRotationAlignment=function(){return this._rotationAlignment},f.prototype.setPitchAlignment=function(h){return this._pitchAlignment=h&&h!=="auto"?h:this._rotationAlignment,this._update(),this},f.prototype.getPitchAlignment=function(){return this._pitchAlignment},f}(s.Evented),Wf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ml=0,js=!1,Hf=function(c){function f(h){c.call(this),this.options=s.extend({},Wf,h),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.onAdd=function(h){var d;return this._map=h,this._container=y.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),d=this._setupUI,Cl!==void 0?d(Cl):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(function(_){d(Cl=_.state!=="denied")}):d(Cl=!!s.window.navigator.geolocation),this._container},f.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),y.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ml=0,js=!1},f.prototype._isOutOfMapMaxBounds=function(h){var d=this._map.getMaxBounds(),_=h.coords;return d&&(_.longitude<d.getWest()||_.longitude>d.getEast()||_.latitude<d.getSouth()||_.latitude>d.getNorth())},f.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},f.prototype._onSuccess=function(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",h)),this._finish()}},f.prototype._updateCamera=function(h){var d=new s.LngLat(h.coords.longitude,h.coords.latitude),_=h.coords.accuracy,w=this._map.getBearing(),E=s.extend({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(d.toBounds(_),E,{geolocateSource:!0})},f.prototype._updateMarker=function(h){if(h){var d=new s.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},f.prototype._updateCircleRadius=function(){var h=this._map._container.clientHeight/2,d=this._map.unproject([0,h]),_=this._map.unproject([1,h]),w=d.distanceTo(_),E=Math.ceil(2*this._accuracy/w);this._circleElement.style.width=E+"px",this._circleElement.style.height=E+"px"},f.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},f.prototype._onError=function(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&js)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",h)),this._finish()}},f.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},f.prototype._setupUI=function(h){var d=this;if(this._container.addEventListener("contextmenu",function(E){return E.preventDefault()}),this._geolocateButton=y.create("button","mapboxgl-ctrl-geolocate",this._container),y.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",h===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var _=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)}else{var w=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=y.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ru(this._dotElement),this._circleElement=y.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ru({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(E){E.geolocateSource||d._watchState!=="ACTIVE_LOCK"||E.originalEvent&&E.originalEvent.type==="resize"||(d._watchState="BACKGROUND",d._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),d._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),d.fire(new s.Event("trackuserlocationend")))})},f.prototype.trigger=function(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ml--,js=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ml>1?(h={maximumAge:6e5,timeout:0},js=!0):(h=this.options.positionOptions,js=!1),this._geolocationWatchID=s.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else s.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},f.prototype._clearWatch=function(){s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},f}(s.Evented),Ha={maxWidth:100,unit:"metric"},qa=function(c){this.options=s.extend({},Ha,c),s.bindAll(["_onMove","setUnit"],this)};function jc(c,f,h){var d=h&&h.maxWidth||100,_=c._container.clientHeight/2,w=c.unproject([0,_]),E=c.unproject([d,_]),A=w.distanceTo(E);if(h&&h.unit==="imperial"){var k=3.2808*A;k>5280?Za(f,d,k/5280,c._getUIString("ScaleControl.Miles")):Za(f,d,k,c._getUIString("ScaleControl.Feet"))}else h&&h.unit==="nautical"?Za(f,d,A/1852,c._getUIString("ScaleControl.NauticalMiles")):A>=1e3?Za(f,d,A/1e3,c._getUIString("ScaleControl.Kilometers")):Za(f,d,A,c._getUIString("ScaleControl.Meters"))}function Za(c,f,h,d){var _,w,E,A=(_=h,(w=Math.pow(10,(""+Math.floor(_)).length-1))*(E=(E=_/w)>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:function(k){var z=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*z)/z}(E)));c.style.width=f*(A/h)+"px",c.innerHTML=A+"&nbsp;"+d}qa.prototype.getDefaultPosition=function(){return"bottom-left"},qa.prototype._onMove=function(){jc(this._map,this._container,this.options)},qa.prototype.onAdd=function(c){return this._map=c,this._container=y.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",c.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},qa.prototype.onRemove=function(){y.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},qa.prototype.setUnit=function(c){this.options.unit=c,jc(this._map,this._container,this.options)};var oo=function(c){this._fullscreen=!1,c&&c.container&&(c.container instanceof s.window.HTMLElement?this._container=c.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in s.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in s.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in s.window.document&&(this._fullscreenchange="MSFullscreenChange")};oo.prototype.onAdd=function(c){return this._map=c,this._container||(this._container=this._map.getContainer()),this._controlContainer=y.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},oo.prototype.onRemove=function(){y.remove(this._controlContainer),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},oo.prototype._checkFullscreenSupport=function(){return!!(s.window.document.fullscreenEnabled||s.window.document.mozFullScreenEnabled||s.window.document.msFullscreenEnabled||s.window.document.webkitFullscreenEnabled)},oo.prototype._setupUI=function(){var c=this._fullscreenButton=y.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);y.create("span","mapboxgl-ctrl-icon",c).setAttribute("aria-hidden",!0),c.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},oo.prototype._updateTitle=function(){var c=this._getTitle();this._fullscreenButton.setAttribute("aria-label",c),this._fullscreenButton.title=c},oo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},oo.prototype._isFullscreen=function(){return this._fullscreen},oo.prototype._changeIcon=function(){(s.window.document.fullscreenElement||s.window.document.mozFullScreenElement||s.window.document.webkitFullscreenElement||s.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},oo.prototype._onClickFullscreen=function(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.mozCancelFullScreen?s.window.document.mozCancelFullScreen():s.window.document.msExitFullscreen?s.window.document.msExitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var qf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ou=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Zf=function(c){function f(h){c.call(this),this.options=s.extend(Object.create(qf),h),s.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return c&&(f.__proto__=c),(f.prototype=Object.create(c&&c.prototype)).constructor=f,f.prototype.addTo=function(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new s.Event("open")),this},f.prototype.isOpen=function(){return!!this._map},f.prototype.remove=function(){return this._content&&y.remove(this._content),this._container&&(y.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new s.Event("close")),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(h){return this._lngLat=s.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},f.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},f.prototype.getElement=function(){return this._container},f.prototype.setText=function(h){return this.setDOMContent(s.window.document.createTextNode(h))},f.prototype.setHTML=function(h){var d,_=s.window.document.createDocumentFragment(),w=s.window.document.createElement("body");for(w.innerHTML=h;d=w.firstChild;)_.appendChild(d);return this.setDOMContent(_)},f.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},f.prototype.setMaxWidth=function(h){return this.options.maxWidth=h,this._update(),this},f.prototype.setDOMContent=function(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=y.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this},f.prototype.addClassName=function(h){this._container&&this._container.classList.add(h)},f.prototype.removeClassName=function(h){this._container&&this._container.classList.remove(h)},f.prototype.setOffset=function(h){return this.options.offset=h,this._update(),this},f.prototype.toggleClassName=function(h){if(this._container)return this._container.classList.toggle(h)},f.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=y.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},f.prototype._onMouseUp=function(h){this._update(h.point)},f.prototype._onMouseMove=function(h){this._update(h.point)},f.prototype._onDrag=function(h){this._update(h.point)},f.prototype._update=function(h){var d=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=y.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=y.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Y){return d._container.classList.add(Y)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Il(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||h)){var _=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat),w=this.options.anchor,E=function Y($){if($){if(typeof $=="number"){var oe=Math.round(Math.sqrt(.5*Math.pow($,2)));return{center:new s.Point(0,0),top:new s.Point(0,$),"top-left":new s.Point(oe,oe),"top-right":new s.Point(-oe,oe),bottom:new s.Point(0,-$),"bottom-left":new s.Point(oe,-oe),"bottom-right":new s.Point(-oe,-oe),left:new s.Point($,0),right:new s.Point(-$,0)}}if($ instanceof s.Point||Array.isArray($)){var re=s.Point.convert($);return{center:re,top:re,"top-left":re,"top-right":re,bottom:re,"bottom-left":re,"bottom-right":re,left:re,right:re}}return{center:s.Point.convert($.center||[0,0]),top:s.Point.convert($.top||[0,0]),"top-left":s.Point.convert($["top-left"]||[0,0]),"top-right":s.Point.convert($["top-right"]||[0,0]),bottom:s.Point.convert($.bottom||[0,0]),"bottom-left":s.Point.convert($["bottom-left"]||[0,0]),"bottom-right":s.Point.convert($["bottom-right"]||[0,0]),left:s.Point.convert($.left||[0,0]),right:s.Point.convert($.right||[0,0])}}return Y(new s.Point(0,0))}(this.options.offset);if(!w){var A,k=this._container.offsetWidth,z=this._container.offsetHeight;A=_.y+E.bottom.y<z?["top"]:_.y>this._map.transform.height-z?["bottom"]:[],_.x<k/2?A.push("left"):_.x>this._map.transform.width-k/2&&A.push("right"),w=A.length===0?"bottom":A.join("-")}var Z=_.add(E[w]).round();y.setTransform(this._container,Vo[w]+" translate("+Z.x+"px,"+Z.y+"px)"),Uc(this._container,w,"popup")}},f.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var h=this._container.querySelector(Ou);h&&h.focus()}},f.prototype._onClose=function(){this.remove()},f}(s.Evented),Vc={version:s.version,supported:g,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:xm,NavigationControl:ua,GeolocateControl:Hf,AttributionControl:ni,ScaleControl:qa,FullscreenControl:oo,Popup:Zf,Marker:Ru,Style:Ai,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,Evented:s.Evented,config:s.config,prewarm:function(){Le().acquire(Me)},clearPrewarmedResources:function(){var c=at;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(Me),at=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(c){s.config.ACCESS_TOKEN=c},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(c){s.config.API_URL=c},get workerCount(){return Ne.workerCount},set workerCount(c){Ne.workerCount=c},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(c){s.config.MAX_PARALLEL_IMAGE_REQUESTS=c},clearStorage:function(c){s.clearTileCache(c)},workerUrl:""};return Vc}),o})})(QC);var xV=QC.exports;const _s=z1(xV);var bV=1e-7;function M1(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function eM(t,e){if(t===e)return!0;if(M1(t)&&M1(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!eM(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=bV}function Mg(t,e,n){return Math.max(e,Math.min(n,t))}function Vy(t,e,n){return M1(t)?t.map(function(r,o){return Vy(r,e[o],n)}):n*e+(1-n)*t}function va(t,e){if(!t)throw new Error(e||"react-map-gl: assertion failed.")}function eS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function tS(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?eS(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):eS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var rc={minZoom:0,maxZoom:24,minPitch:0,maxPitch:60},i0={pitch:0,bearing:0,altitude:1.5},nS=5,wV=1.2,Kh=function(){function t(e){var n=e.width,r=e.height,o=e.latitude,l=e.longitude,s=e.zoom,g=e.bearing,y=g===void 0?i0.bearing:g,b=e.pitch,S=b===void 0?i0.pitch:b,I=e.altitude,C=I===void 0?i0.altitude:I,B=e.maxZoom,G=B===void 0?rc.maxZoom:B,W=e.minZoom,he=W===void 0?rc.minZoom:W,H=e.maxPitch,U=H===void 0?rc.maxPitch:H,K=e.minPitch,fe=K===void 0?rc.minPitch:K,ye=e.transitionDuration,xe=e.transitionEasing,Te=e.transitionInterpolator,De=e.transitionInterruption,Fe=e.startPanLngLat,Ve=e.startZoomLngLat,tt=e.startRotatePos,Bt=e.startBearing,ft=e.startPitch,wt=e.startZoom;pu(this,t),va(Number.isFinite(n),"`width` must be supplied"),va(Number.isFinite(r),"`height` must be supplied"),va(Number.isFinite(l),"`longitude` must be supplied"),va(Number.isFinite(o),"`latitude` must be supplied"),va(Number.isFinite(s),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:r,latitude:o,longitude:l,zoom:s,bearing:y,pitch:S,altitude:C,maxZoom:G,minZoom:he,maxPitch:U,minPitch:fe,transitionDuration:ye,transitionEasing:xe,transitionInterpolator:Te,transitionInterruption:De}),this._state={startPanLngLat:Fe,startZoomLngLat:Ve,startRotatePos:tt,startBearing:Bt,startPitch:ft,startZoom:wt}}return du(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getState",value:function(){return this._state}},{key:"panStart",value:function(n){var r=n.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(r)})}},{key:"pan",value:function(n){var r=n.pos,o=n.startPos,l=this._state.startPanLngLat||this._unproject(o);if(!l)return this;var s=this._calculateNewLngLat({startPanLngLat:l,pos:r}),g=Gr(s,2),y=g[0],b=g[1];return this._getUpdatedMapState({longitude:y,latitude:b})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(n){var r=n.pos;return this._getUpdatedMapState({startRotatePos:r,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(n){var r=n.pos,o=n.deltaAngleX,l=o===void 0?0:o,s=n.deltaAngleY,g=s===void 0?0:s,y=this._state,b=y.startRotatePos,S=y.startBearing,I=y.startPitch;if(!Number.isFinite(S)||!Number.isFinite(I))return this;var C;return r?C=this._calculateNewPitchAndBearing(tS(tS({},this._getRotationParams(r,b)),{},{startBearing:S,startPitch:I})):C={bearing:S+l,pitch:I+g},this._getUpdatedMapState(C)}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(n){var r=n.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(r),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(n){var r=n.pos,o=n.startPos,l=n.scale;va(l>0,"`scale` must be a positive number");var s=this._state,g=s.startZoom,y=s.startZoomLngLat;Number.isFinite(g)||(g=this._viewportProps.zoom,y=this._unproject(o)||this._unproject(r)),va(y,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var b=this._calculateNewZoom({scale:l,startZoom:g||0}),S=new ic(Object.assign({},this._viewportProps,{zoom:b})),I=S.getMapCenterByLngLatPosition({lngLat:y,pos:r}),C=Gr(I,2),B=C[0],G=C[1];return this._getUpdatedMapState({zoom:b,longitude:B,latitude:G})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(n){return new t(Object.assign({},this._viewportProps,this._state,n))}},{key:"_applyConstraints",value:function(n){var r=n.maxZoom,o=n.minZoom,l=n.zoom;n.zoom=Mg(l,o,r);var s=n.maxPitch,g=n.minPitch,y=n.pitch;return n.pitch=Mg(y,g,s),Object.assign(n,uP(n)),n}},{key:"_unproject",value:function(n){var r=new ic(this._viewportProps);return n&&r.unproject(n)}},{key:"_calculateNewLngLat",value:function(n){var r=n.startPanLngLat,o=n.pos,l=new ic(this._viewportProps);return l.getMapCenterByLngLatPosition({lngLat:r,pos:o})}},{key:"_calculateNewZoom",value:function(n){var r=n.scale,o=n.startZoom,l=this._viewportProps,s=l.maxZoom,g=l.minZoom,y=o+Math.log2(r);return Mg(y,g,s)}},{key:"_calculateNewPitchAndBearing",value:function(n){var r=n.deltaScaleX,o=n.deltaScaleY,l=n.startBearing,s=n.startPitch;o=Mg(o,-1,1);var g=this._viewportProps,y=g.minPitch,b=g.maxPitch,S=l+180*r,I=s;return o>0?I=s+o*(b-s):o<0&&(I=s-o*(y-s)),{pitch:I,bearing:S}}},{key:"_getRotationParams",value:function(n,r){var o=n[0]-r[0],l=n[1]-r[1],s=n[1],g=r[1],y=this._viewportProps,b=y.width,S=y.height,I=o/b,C=0;return l>0?Math.abs(S-g)>nS&&(C=l/(g-S)*wV):l<0&&g>nS&&(C=1-s/g),C=Math.min(1,Math.max(-1,C)),{deltaScaleX:I,deltaScaleY:C}}}]),t}();function EV(t){return t[0].toLowerCase()+t.slice(1)}function TV(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rc;for(var n in e){var r=n.slice(0,3),o=EV(n.slice(3));if(r==="min"&&t[o]<e[n]||r==="max"&&t[o]>e[n])return!1}return!0}function rS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function iS(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rS(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Ef=Re.createContext({viewport:null,map:null,container:null,onViewportChange:null,onViewStateChange:null,eventManager:null}),ab=Ef.Provider;function SV(t){var e=t.value,n=t.children,r=Re.useState(null),o=Gr(r,2),l=o[0],s=o[1],g=Re.useContext(Ef);return e=iS(iS({setMap:s},g),{},{map:g&&g.map||l},e),Re.createElement(ab,{value:e},n)}Ef.Provider=SV;var k1=typeof window<"u"?Re.useLayoutEffect:Re.useEffect;function oS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ga(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?oS(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var AV="https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens",tM="A valid API access token is required to use Mapbox data";function PV(){}function nM(t){var e=t.props,n=t.width,r=t.height;return new ic(ga(ga(ga({},e),e.viewState),{},{width:n,height:r}))}var IV=401,aS={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},CV=Object.assign({},wc.propTypes,{width:Ee.oneOfType([Ee.number,Ee.string]),height:Ee.oneOfType([Ee.number,Ee.string]),onResize:Ee.func,disableTokenWarning:Ee.bool,visible:Ee.bool,className:Ee.string,style:Ee.object,visibilityConstraints:Ee.object}),MV=Object.assign({},wc.defaultProps,{disableTokenWarning:!1,visible:!0,onResize:PV,className:"",style:null,visibilityConstraints:rc});function kV(){var t={position:"absolute",left:0,top:0};return Re.createElement("div",{key:"warning",id:"no-token-warning",style:t},Re.createElement("h3",{key:"header"},tM),Re.createElement("div",{key:"text"},"For information on setting up your basemap, read"),Re.createElement("a",{key:"link",href:AV},"Note on Map Tokens"))}function LV(t){return{getMap:function(){return t.current&&t.current.getMap()},queryRenderedFeatures:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=t.current&&t.current.getMap();return o&&o.queryRenderedFeatures(n,r)}}}var vl=Re.forwardRef(function(t,e){var n=Re.useState(!0),r=Gr(n,2),o=r[0],l=r[1],s=Re.useState({width:0,height:0}),g=Gr(s,2),y=g[0],b=g[1],S=Re.useRef(null),I=Re.useRef(null),C=Re.useRef(null),B=Re.useRef(null),G=Re.useContext(Ef);k1(function(){if(vl.supported()){var Ve=new wc(ga(ga(ga({},t),y),{},{mapboxgl:_s,container:I.current,onError:function(ft){var wt=ft.error&&ft.error.status||ft.status;wt===IV&&o&&(console.error(tM),l(!1)),t.onError(ft)}}));S.current=Ve,G&&G.setMap&&G.setMap(Ve.getMap());var tt=new dV(function(Bt){if(Bt[0].contentRect){var ft=Bt[0].contentRect,wt=ft.width,nr=ft.height;b({width:wt,height:nr}),t.onResize({width:wt,height:nr})}});return tt.observe(C.current),function(){Ve.finalize(),S.current=null,tt.disconnect()}}},[]),k1(function(){S.current&&S.current.setProps(ga(ga({},t),y))});var W=S.current&&S.current.getMap();Re.useImperativeHandle(e,function(){return LV(S)},[]);var he=Re.useCallback(function(Ve){var tt=Ve.target;tt===B.current&&tt.scrollTo(0,0)},[]),H=W&&Re.createElement(ab,{value:ga(ga({},G),{},{viewport:G.viewport||nM(ga({map:W,props:t},y)),map:W,container:G.container||C.current})},Re.createElement("div",{key:"map-overlays",className:"overlays",ref:B,style:aS,onScroll:he},t.children)),U=t.className,K=t.width,fe=t.height,ye=t.style,xe=t.visibilityConstraints,Te=Object.assign({position:"relative"},ye,{width:K,height:fe}),De=t.visible&&TV(t.viewState||t,xe),Fe=Object.assign({},aS,{visibility:De?"inherit":"hidden"});return Re.createElement("div",{key:"map-container",ref:C,style:Te},Re.createElement("div",{key:"map-mapbox",ref:I,style:Fe,className:U}),H,!o&&!t.disableTokenWarning&&Re.createElement(kV,null))});vl.supported=function(){return _s&&_s.supported()};vl.propTypes=CV;vl.defaultProps=MV;function RV(t,e){var n;if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(n=OV(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(b){throw b},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l=!0,s=!1,g;return{s:function(){n=t[Symbol.iterator]()},n:function(){var b=n.next();return l=b.done,b},e:function(b){s=!0,g=b},f:function(){try{!l&&n.return!=null&&n.return()}finally{if(s)throw g}}}}function OV(t,e){if(t){if(typeof t=="string")return sS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sS(t,e)}}function sS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var rM=function(){function t(){pu(this,t),D(this,"propNames",[])}return du(t,[{key:"arePropsEqual",value:function(n,r){var o=RV(this.propNames||[]),l;try{for(o.s();!(l=o.n()).done;){var s=l.value;if(!eM(n[s],r[s]))return!1}}catch(g){o.e(g)}finally{o.f()}return!0}},{key:"initializeProps",value:function(n,r){return{start:n,end:r}}},{key:"interpolateProps",value:function(n,r,o){va(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(n,r){return r.transitionDuration}}]),t}();function Qs(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L1(t,e){return L1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},L1(t,e)}function sb(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L1(t,e)}function lb(t,e){if(e&&(Jh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qs(t)}function uu(t){return uu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},uu(t)}var DV={longitude:1,bearing:1};function Gy(t){return Number.isFinite(t)||Array.isArray(t)}function zV(t){return t in DV}function R1(t,e,n){return zV(t)&&Math.abs(n-e)>180&&(n=n<0?n+360:n-360),n}function o0(t,e){var n;if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(n=BV(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(b){throw b},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l=!0,s=!1,g;return{s:function(){n=t[Symbol.iterator]()},n:function(){var b=n.next();return l=b.done,b},e:function(b){s=!0,g=b},f:function(){try{!l&&n.return!=null&&n.return()}finally{if(s)throw g}}}}function BV(t,e){if(t){if(typeof t=="string")return lS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lS(t,e)}}function lS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function NV(t){var e=FV();return function(){var r=uu(t),o;if(e){var l=uu(this).constructor;o=Reflect.construct(r,arguments,l)}else o=r.apply(this,arguments);return lb(this,o)}}function FV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var UV=["longitude","latitude","zoom","bearing","pitch"],jV=["latitude","longitude","zoom","width","height"],uS=["bearing","pitch"],VV={speed:1.2,curve:1.414};(function(t){sb(n,t);var e=NV(n);function n(){var r,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return pu(this,n),r=e.call(this),D(Qs(r),"propNames",UV),r.props=Object.assign({},VV,o),r}return du(n,[{key:"initializeProps",value:function(o,l){var s={},g={},y=o0(jV),b;try{for(y.s();!(b=y.n()).done;){var S=b.value,I=o[S],C=l[S];va(Gy(I)&&Gy(C),"".concat(S," must be supplied for transition")),s[S]=I,g[S]=R1(S,I,C)}}catch(U){y.e(U)}finally{y.f()}var B=o0(uS),G;try{for(B.s();!(G=B.n()).done;){var W=G.value,he=o[W]||0,H=l[W]||0;s[W]=he,g[W]=R1(W,he,H)}}catch(U){B.e(U)}finally{B.f()}return{start:s,end:g}}},{key:"interpolateProps",value:function(o,l,s){var g=vF(o,l,s,this.props),y=o0(uS),b;try{for(y.s();!(b=y.n()).done;){var S=b.value;g[S]=Vy(o[S],l[S],s)}}catch(I){y.e(I)}finally{y.f()}return g}},{key:"getDuration",value:function(o,l){var s=l.transitionDuration;return s==="auto"&&(s=_F(o,l,this.props)),s}}]),n})(rM);function cS(t,e){var n;if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(n=GV(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(b){throw b},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l=!0,s=!1,g;return{s:function(){n=t[Symbol.iterator]()},n:function(){var b=n.next();return l=b.done,b},e:function(b){s=!0,g=b},f:function(){try{!l&&n.return!=null&&n.return()}finally{if(s)throw g}}}}function GV(t,e){if(t){if(typeof t=="string")return hS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hS(t,e)}}function hS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function WV(t){var e=HV();return function(){var r=uu(t),o;if(e){var l=uu(this).constructor;o=Reflect.construct(r,arguments,l)}else o=r.apply(this,arguments);return lb(this,o)}}function HV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var qV=["longitude","latitude","zoom","bearing","pitch"],Qp=function(t){sb(n,t);var e=WV(n);function n(){var r,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return pu(this,n),r=e.call(this),Array.isArray(o)&&(o={transitionProps:o}),r.propNames=o.transitionProps||qV,o.around&&(r.around=o.around),r}return du(n,[{key:"initializeProps",value:function(o,l){var s={},g={};if(this.around){s.around=this.around;var y=new ic(o).unproject(this.around);Object.assign(g,l,{around:new ic(l).project(y),aroundLngLat:y})}var b=cS(this.propNames),S;try{for(b.s();!(S=b.n()).done;){var I=S.value,C=o[I],B=l[I];va(Gy(C)&&Gy(B),"".concat(I," must be supplied for transition")),s[I]=C,g[I]=R1(I,C,B)}}catch(G){b.e(G)}finally{b.f()}return{start:s,end:g}}},{key:"interpolateProps",value:function(o,l,s){var g={},y=cS(this.propNames),b;try{for(y.s();!(b=y.n()).done;){var S=b.value;g[S]=Vy(o[S],l[S],s)}}catch(W){y.e(W)}finally{y.f()}if(l.around){var I=new ic(Object.assign({},l,g)).getMapCenterByLngLatPosition({lngLat:l.aroundLngLat,pos:Vy(o.around,l.around,s)}),C=Gr(I,2),B=C[0],G=C[1];g.longitude=B,g.latitude=G}return g}}]),n}(rM),ed=function(){};function ZV(t,e){var n=t(e);return function(r){return 1/(1-n)*(t(r*(1-e)+e)-n)}}var td={BREAK:1,SNAP_TO_END:2,IGNORE:3,UPDATE:4},XV={transitionDuration:0,transitionEasing:function(e){return e},transitionInterpolator:new Qp,transitionInterruption:td.BREAK,onTransitionStart:ed,onTransitionInterrupt:ed,onTransitionEnd:ed},ub=function(){function t(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};pu(this,t),D(this,"_animationFrame",null),D(this,"_onTransitionFrame",function(){e._animationFrame=requestAnimationFrame(e._onTransitionFrame),e._updateViewport()}),this.props=null,this.onViewportChange=n.onViewportChange||ed,this.onStateChange=n.onStateChange||ed,this.time=n.getTime||Date.now}return du(t,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(n){var r=this.props;if(this.props=n,!r||this._shouldIgnoreViewportChange(r,n))return!1;if(this._isTransitionEnabled(n)){var o=Object.assign({},r),l=Object.assign({},n);if(this._isTransitionInProgress()&&(r.onTransitionInterrupt(),this.state.interruption===td.SNAP_TO_END?Object.assign(o,this.state.endProps):Object.assign(o,this.state.propsInTransition),this.state.interruption===td.UPDATE)){var s=this.time(),g=(s-this.state.startTime)/this.state.duration;l.transitionDuration=this.state.duration-(s-this.state.startTime),l.transitionEasing=ZV(this.state.easing,g),l.transitionInterpolator=o.transitionInterpolator}return l.onTransitionStart(),this._triggerTransition(o,l),!0}return this._isTransitionInProgress()&&(r.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return!!this._animationFrame}},{key:"_isTransitionEnabled",value:function(n){var r=n.transitionDuration,o=n.transitionInterpolator;return(r>0||r==="auto")&&!!o}},{key:"_isUpdateDueToCurrentTransition",value:function(n){return this.state.propsInTransition?this.state.interpolator.arePropsEqual(n,this.state.propsInTransition):!1}},{key:"_shouldIgnoreViewportChange",value:function(n,r){return n?this._isTransitionInProgress()?this.state.interruption===td.IGNORE||this._isUpdateDueToCurrentTransition(r):this._isTransitionEnabled(r)?r.transitionInterpolator.arePropsEqual(n,r):!0:!0}},{key:"_triggerTransition",value:function(n,r){va(this._isTransitionEnabled(r)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var o=r.transitionInterpolator,l=o.getDuration?o.getDuration(n,r):r.transitionDuration;if(l!==0){var s=r.transitionInterpolator.initializeProps(n,r),g={inTransition:!0,isZooming:n.zoom!==r.zoom,isPanning:n.longitude!==r.longitude||n.latitude!==r.latitude,isRotating:n.bearing!==r.bearing||n.pitch!==r.pitch};this.state={duration:l,easing:r.transitionEasing,interpolator:r.transitionInterpolator,interruption:r.transitionInterruption,startTime:this.time(),startProps:s.start,endProps:s.end,animation:null,propsInTransition:{}},this._onTransitionFrame(),this.onStateChange(g)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var n=this.time(),r=this.state,o=r.startTime,l=r.duration,s=r.easing,g=r.interpolator,y=r.startProps,b=r.endProps,S=!1,I=(n-o)/l;I>=1&&(I=1,S=!0),I=s(I);var C=g.interpolateProps(y,b,I),B=new Kh(Object.assign({},this.props,C));this.state.propsInTransition=B.getViewportProps(),this.onViewportChange(this.state.propsInTransition,this.props),S&&(this._endTransition(),this.props.onTransitionEnd())}}]),t}();D(ub,"defaultProps",XV);function fS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Hi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?fS(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Yu={transitionDuration:0},el={transitionDuration:300,transitionEasing:function(e){return e},transitionInterpolator:new Qp,transitionInterruption:td.BREAK},kg=300,Lg=function(e){return 1-(1-e)*(1-e)},Ah={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},iM=function(){function t(){var e=this;pu(this,t),D(this,"events",[]),D(this,"scrollZoom",!0),D(this,"dragPan",!0),D(this,"dragRotate",!0),D(this,"doubleClickZoom",!0),D(this,"touchZoom",!0),D(this,"touchRotate",!1),D(this,"keyboard",!0),D(this,"_interactionState",{isDragging:!1}),D(this,"_events",{}),D(this,"_setInteractionState",function(n){Object.assign(e._interactionState,n),e.onStateChange&&e.onStateChange(e._interactionState)}),D(this,"_onTransition",function(n,r){e.onViewportChange(n,e._interactionState,r)}),this.handleEvent=this.handleEvent.bind(this),this._transitionManager=new ub({onViewportChange:this._onTransition,onStateChange:this._setInteractionState})}return du(t,[{key:"handleEvent",value:function(n){this.mapState=this.getMapState();var r=this._eventStartBlocked;switch(n.type){case"panstart":return r?!1:this._onPanStart(n);case"panmove":return this._onPan(n);case"panend":return this._onPanEnd(n);case"pinchstart":return r?!1:this._onPinchStart(n);case"pinchmove":return this._onPinch(n);case"pinchend":return this._onPinchEnd(n);case"tripanstart":return r?!1:this._onTriplePanStart(n);case"tripanmove":return this._onTriplePan(n);case"tripanend":return this._onTriplePanEnd(n);case"doubletap":return this._onDoubleTap(n);case"wheel":return this._onWheel(n);case"keydown":return this._onKeyDown(n);default:return!1}}},{key:"getCenter",value:function(n){var r=n.offsetCenter,o=r.x,l=r.y;return[o,l]}},{key:"isFunctionKeyPressed",value:function(n){var r=n.srcEvent;return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}},{key:"blockEvents",value:function(n){var r=this,o=setTimeout(function(){r._eventStartBlocked===o&&(r._eventStartBlocked=null)},n);this._eventStartBlocked=o}},{key:"updateViewport",value:function(n,r,o){var l=this.mapState instanceof Kh?this.mapState.getViewportProps():this.mapState,s=Hi(Hi({},n.getViewportProps()),r),g=Object.keys(s).some(function(y){return l[y]!==s[y]});this._state=n.getState(),this._setInteractionState(o),g&&this.onViewportChange(s,this._interactionState,l)}},{key:"getMapState",value:function(n){return new Kh(Hi(Hi(Hi({},this.mapStateProps),this._state),n))}},{key:"isDragging",value:function(){return this._interactionState.isDragging}},{key:"setOptions",value:function(n){var r=n.onViewportChange,o=n.onStateChange,l=n.eventManager,s=l===void 0?this.eventManager:l,g=n.isInteractive,y=g===void 0?!0:g,b=n.scrollZoom,S=b===void 0?this.scrollZoom:b,I=n.dragPan,C=I===void 0?this.dragPan:I,B=n.dragRotate,G=B===void 0?this.dragRotate:B,W=n.doubleClickZoom,he=W===void 0?this.doubleClickZoom:W,H=n.touchZoom,U=H===void 0?this.touchZoom:H,K=n.touchRotate,fe=K===void 0?this.touchRotate:K,ye=n.keyboard,xe=ye===void 0?this.keyboard:ye;this.onViewportChange=r,this.onStateChange=o;var Te=this.mapStateProps||{},De=Te.height!==n.height||Te.width!==n.width;this.mapStateProps=n,De&&(this.mapState=Te,this.updateViewport(new Kh(n))),this._transitionManager.processViewportChange(n),this.eventManager!==s&&(this.eventManager=s,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(Ah.WHEEL,y&&!!S),this.toggleEvents(Ah.PAN,y&&!!(C||G)),this.toggleEvents(Ah.PINCH,y&&!!(U||fe)),this.toggleEvents(Ah.TRIPLE_PAN,y&&!!fe),this.toggleEvents(Ah.DOUBLE_TAP,y&&!!he),this.toggleEvents(Ah.KEYBOARD,y&&!!xe),this.scrollZoom=S,this.dragPan=C,this.dragRotate=G,this.doubleClickZoom=he,this.touchZoom=U,this.touchRotate=fe,this.keyboard=xe}},{key:"toggleEvents",value:function(n,r){var o=this;this.eventManager&&n.forEach(function(l){o._events[l]!==r&&(o._events[l]=r,r?o.eventManager.on(l,o.handleEvent):o.eventManager.off(l,o.handleEvent))})}},{key:"_onPanStart",value:function(n){var r=this.getCenter(n);this._panRotate=this.isFunctionKeyPressed(n)||n.rightButton;var o=this._panRotate?this.mapState.rotateStart({pos:r}):this.mapState.panStart({pos:r});return this.updateViewport(o,Yu,{isDragging:!0}),!0}},{key:"_onPan",value:function(n){return this.isDragging()?this._panRotate?this._onPanRotate(n):this._onPanMove(n):!1}},{key:"_onPanEnd",value:function(n){return this.isDragging()?this._panRotate?this._onPanRotateEnd(n):this._onPanMoveEnd(n):!1}},{key:"_onPanMove",value:function(n){if(!this.dragPan)return!1;var r=this.getCenter(n),o=this.mapState.pan({pos:r});return this.updateViewport(o,Yu,{isPanning:!0}),!0}},{key:"_onPanMoveEnd",value:function(n){if(this.dragPan){var r=this.dragPan.inertia,o=r===void 0?kg:r;if(o&&n.velocity){var l=this.getCenter(n),s=[l[0]+n.velocityX*o/2,l[1]+n.velocityY*o/2],g=this.mapState.pan({pos:s}).panEnd();return this.updateViewport(g,Hi(Hi({},el),{},{transitionDuration:o,transitionEasing:Lg}),{isDragging:!1,isPanning:!0}),!0}}var y=this.mapState.panEnd();return this.updateViewport(y,null,{isDragging:!1,isPanning:!1}),!0}},{key:"_onPanRotate",value:function(n){if(!this.dragRotate)return!1;var r=this.getCenter(n),o=this.mapState.rotate({pos:r});return this.updateViewport(o,Yu,{isRotating:!0}),!0}},{key:"_onPanRotateEnd",value:function(n){if(this.dragRotate){var r=this.dragRotate.inertia,o=r===void 0?kg:r;if(o&&n.velocity){var l=this.getCenter(n),s=[l[0]+n.velocityX*o/2,l[1]+n.velocityY*o/2],g=this.mapState.rotate({pos:s}).rotateEnd();return this.updateViewport(g,Hi(Hi({},el),{},{transitionDuration:o,transitionEasing:Lg}),{isDragging:!1,isRotating:!0}),!0}}var y=this.mapState.panEnd();return this.updateViewport(y,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onWheel",value:function(n){if(!this.scrollZoom)return!1;var r=this.scrollZoom,o=r.speed,l=o===void 0?.01:o,s=r.smooth,g=s===void 0?!1:s;n.preventDefault();var y=this.getCenter(n),b=n.delta,S=2/(1+Math.exp(-Math.abs(b*l)));b<0&&S!==0&&(S=1/S);var I=this.mapState.zoom({pos:y,scale:S});return I.getViewportProps().zoom===this.mapStateProps.zoom?!1:(this.updateViewport(I,Hi(Hi({},el),{},{transitionInterpolator:new Qp({around:y}),transitionDuration:g?250:1}),{isPanning:!0,isZooming:!0}),!0)}},{key:"_onPinchStart",value:function(n){var r=this.getCenter(n),o=this.mapState.zoomStart({pos:r}).rotateStart({pos:r});return this._startPinchRotation=n.rotation,this._lastPinchEvent=n,this.updateViewport(o,Yu,{isDragging:!0}),!0}},{key:"_onPinch",value:function(n){if(!this.isDragging()||!this.touchZoom&&!this.touchRotate)return!1;var r=this.mapState;if(this.touchZoom){var o=n.scale,l=this.getCenter(n);r=r.zoom({pos:l,scale:o})}if(this.touchRotate){var s=n.rotation;r=r.rotate({deltaAngleX:this._startPinchRotation-s})}return this.updateViewport(r,Yu,{isDragging:!0,isPanning:!!this.touchZoom,isZooming:!!this.touchZoom,isRotating:!!this.touchRotate}),this._lastPinchEvent=n,!0}},{key:"_onPinchEnd",value:function(n){if(!this.isDragging())return!1;if(this.touchZoom){var r=this.touchZoom.inertia,o=r===void 0?kg:r,l=this._lastPinchEvent;if(o&&l&&n.scale!==l.scale){var s=this.getCenter(n),g=this.mapState.rotateEnd(),y=Math.log2(n.scale),b=(y-Math.log2(l.scale))/(n.deltaTime-l.deltaTime),S=Math.pow(2,y+b*o/2);return g=g.zoom({pos:s,scale:S}).zoomEnd(),this.updateViewport(g,Hi(Hi({},el),{},{transitionInterpolator:new Qp({around:s}),transitionDuration:o,transitionEasing:Lg}),{isDragging:!1,isPanning:!!this.touchZoom,isZooming:!!this.touchZoom,isRotating:!1}),this.blockEvents(o),!0}}var I=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(I,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),this._startPinchRotation=null,this._lastPinchEvent=null,!0}},{key:"_onTriplePanStart",value:function(n){var r=this.getCenter(n),o=this.mapState.rotateStart({pos:r});return this.updateViewport(o,Yu,{isDragging:!0}),!0}},{key:"_onTriplePan",value:function(n){if(!this.isDragging()||!this.touchRotate)return!1;var r=this.getCenter(n);r[0]-=n.deltaX;var o=this.mapState.rotate({pos:r});return this.updateViewport(o,Yu,{isRotating:!0}),!0}},{key:"_onTriplePanEnd",value:function(n){if(!this.isDragging())return!1;if(this.touchRotate){var r=this.touchRotate.inertia,o=r===void 0?kg:r;if(o&&n.velocityY){var l=this.getCenter(n),s=[l[0],l[1]+=n.velocityY*o/2],g=this.mapState.rotate({pos:s});return this.updateViewport(g,Hi(Hi({},el),{},{transitionDuration:o,transitionEasing:Lg}),{isDragging:!1,isRotating:!0}),this.blockEvents(o),!1}}var y=this.mapState.rotateEnd();return this.updateViewport(y,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(n){if(!this.doubleClickZoom)return!1;var r=this.getCenter(n),o=this.isFunctionKeyPressed(n),l=this.mapState.zoom({pos:r,scale:o?.5:2});return this.updateViewport(l,Object.assign({},el,{transitionInterpolator:new Qp({around:r})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(n){if(!this.keyboard)return!1;var r=this.isFunctionKeyPressed(n),o=this.keyboard,l=o.zoomSpeed,s=l===void 0?2:l,g=o.moveSpeed,y=g===void 0?100:g,b=o.rotateSpeedX,S=b===void 0?15:b,I=o.rotateSpeedY,C=I===void 0?10:I,B=this.mapStateProps,G;switch(n.srcEvent.keyCode){case 189:r?G=this.getMapState({zoom:B.zoom-Math.log2(s)-1}):G=this.getMapState({zoom:B.zoom-Math.log2(s)});break;case 187:r?G=this.getMapState({zoom:B.zoom+Math.log2(s)+1}):G=this.getMapState({zoom:B.zoom+Math.log2(s)});break;case 37:r?G=this.getMapState({bearing:B.bearing-S}):G=this.mapState.pan({pos:[y,0],startPos:[0,0]});break;case 39:r?G=this.getMapState({bearing:B.bearing+S}):G=this.mapState.pan({pos:[-y,0],startPos:[0,0]});break;case 38:r?G=this.getMapState({pitch:B.pitch+C}):G=this.mapState.pan({pos:[0,y],startPos:[0,0]});break;case 40:r?G=this.getMapState({pitch:B.pitch-C}):G=this.mapState.pan({pos:[0,-y],startPos:[0,0]});break;default:return!1}return this.updateViewport(G,el)}}]),t}();function pS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Ks(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?pS(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var YV=Object.assign({},vl.propTypes,{maxZoom:Ee.number,minZoom:Ee.number,maxPitch:Ee.number,minPitch:Ee.number,onViewStateChange:Ee.func,onViewportChange:Ee.func,onInteractionStateChange:Ee.func,transitionDuration:Ee.oneOfType([Ee.number,Ee.string]),transitionInterpolator:Ee.object,transitionInterruption:Ee.number,transitionEasing:Ee.func,onTransitionStart:Ee.func,onTransitionInterrupt:Ee.func,onTransitionEnd:Ee.func,scrollZoom:Ee.oneOfType([Ee.bool,Ee.object]),dragPan:Ee.oneOfType([Ee.bool,Ee.object]),dragRotate:Ee.oneOfType([Ee.bool,Ee.object]),doubleClickZoom:Ee.bool,touchZoom:Ee.oneOfType([Ee.bool,Ee.object]),touchRotate:Ee.oneOfType([Ee.bool,Ee.object]),keyboard:Ee.oneOfType([Ee.bool,Ee.object]),onHover:Ee.func,onClick:Ee.func,onDblClick:Ee.func,onContextMenu:Ee.func,onMouseDown:Ee.func,onMouseMove:Ee.func,onMouseUp:Ee.func,onTouchStart:Ee.func,onTouchMove:Ee.func,onTouchEnd:Ee.func,onMouseEnter:Ee.func,onMouseLeave:Ee.func,onMouseOut:Ee.func,onWheel:Ee.func,touchAction:Ee.string,eventRecognizerOptions:Ee.object,clickRadius:Ee.number,interactiveLayerIds:Ee.array,getCursor:Ee.func,controller:Ee.instanceOf(iM)}),$V=function(e){var n=e.isDragging,r=e.isHovering;return n?"grabbing":r?"pointer":"grab"},KV=Object.assign({},vl.defaultProps,rc,ub.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(e){return e.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",eventRecognizerOptions:{},clickRadius:0,getCursor:$V});function cb(t){if(t.lngLat||!t.offsetCenter)return t;var e=t.offsetCenter,n=e.x,r=e.y;if(!Number.isFinite(n)||!Number.isFinite(r))return t;var o=[n,r];return t.point=o,t.lngLat=this.viewport.unproject(o),t}function oM(t){var e=this.map;if(!e||!t)return null;var n={},r=this.props.clickRadius;this.props.interactiveLayerIds&&(n.layers=this.props.interactiveLayerIds);try{return e.queryRenderedFeatures(r?[[t[0]-r,t[1]+r],[t[0]+r,t[1]-r]]:t,n)}catch{return null}}function al(t,e){var n=this.props[t];n&&n(cb.call(this,e))}function JV(t){al.call(this,t.pointerType==="touch"?"onTouchStart":"onMouseDown",t)}function QV(t){al.call(this,t.pointerType==="touch"?"onTouchEnd":"onMouseUp",t)}function e8(t){if(al.call(this,t.pointerType==="touch"?"onTouchMove":"onMouseMove",t),!this.state.isDragging){var e=this.props,n=e.onHover,r=e.interactiveLayerIds,o;t=cb.call(this,t),(r||n)&&(o=oM.call(this,t.point));var l=!!(r&&o&&o.length>0),s=l&&!this.state.isHovering,g=!l&&this.state.isHovering;(n||s)&&(t.features=o,n&&n(t)),s&&al.call(this,"onMouseEnter",t),g&&al.call(this,"onMouseLeave",t),(s||g)&&this.setState({isHovering:l})}}function dS(t){var e=this.props,n=e.onClick,r=e.onNativeClick,o=e.onDblClick,l=e.doubleClickZoom,s=[],g=o||l;switch(t.type){case"anyclick":s.push(r),g||s.push(n);break;case"click":g&&s.push(n);break}s=s.filter(Boolean),s.length&&(t=cb.call(this,t),t.features=oM.call(this,t.point),s.forEach(function(y){return y(t)}))}function t8(t){return{getMap:t.current&&t.current.getMap,queryRenderedFeatures:t.current&&t.current.queryRenderedFeatures}}var hb=Re.forwardRef(function(t,e){var n=Re.useContext(Ef),r=Re.useMemo(function(){return t.controller||new iM},[]),o=Re.useMemo(function(){return new SP(null,{touchAction:t.touchAction,recognizerOptions:t.eventRecognizerOptions})},[]),l=Re.useRef(null),s=Re.useRef(null),g=Re.useRef({width:0,height:0,state:{isHovering:!1,isDragging:!1}}),y=g.current;y.props=t,y.map=s.current&&s.current.getMap(),y.setState=function(xe){y.state=Ks(Ks({},y.state),xe),l.current.style.cursor=t.getCursor(y.state)};var b=!0,S,I,C=function(Te,De,Fe){if(b){S=[Te,De,Fe];return}var Ve=y.props,tt=Ve.onViewStateChange,Bt=Ve.onViewportChange;tt&&tt({viewState:Te,interactionState:De,oldViewState:Fe}),Bt&&Bt(Te,De,Fe)};Re.useImperativeHandle(e,function(){return t8(s)},[]);var B=Re.useMemo(function(){return Ks(Ks({},n),{},{eventManager:o,container:n.container||l.current})},[n,l.current]);B.onViewportChange=C,B.viewport=n.viewport||nM(y),y.viewport=B.viewport;var G=function(Te){var De=Te.isDragging,Fe=De===void 0?!1:De;if(Fe!==y.state.isDragging&&y.setState({isDragging:Fe}),b){I=Te;return}var Ve=y.props.onInteractionStateChange;Ve&&Ve(Te)},W=function(){y.width&&y.height&&r.setOptions(Ks(Ks(Ks({},y.props),y.props.viewState),{},{isInteractive:!!(y.props.onViewStateChange||y.props.onViewportChange),onViewportChange:C,onStateChange:G,eventManager:o,width:y.width,height:y.height}))},he=function(Te){var De=Te.width,Fe=Te.height;y.width=De,y.height=Fe,W(),y.props.onResize({width:De,height:Fe})};Re.useEffect(function(){return o.setElement(l.current),o.on({pointerdown:JV.bind(y),pointermove:e8.bind(y),pointerup:QV.bind(y),pointerleave:al.bind(y,"onMouseOut"),click:dS.bind(y),anyclick:dS.bind(y),dblclick:al.bind(y,"onDblClick"),wheel:al.bind(y,"onWheel"),contextmenu:al.bind(y,"onContextMenu")}),function(){o.destroy()}},[]),k1(function(){S&&C.apply(void 0,Gj(S)),I&&G(I)}),W();var H=t.width,U=t.height,K=t.style,fe=t.getCursor,ye=Re.useMemo(function(){return Ks(Ks({position:"relative"},K),{},{width:H,height:U,cursor:fe(y.state)})},[K,H,U,fe,y.state]);return(!S||!y._child)&&(y._child=Re.createElement(ab,{value:B},Re.createElement("div",{key:"event-canvas",ref:l,style:ye},Re.createElement(vl,Fy({},t,{width:"100%",height:"100%",style:null,onResize:he,ref:s}))))),b=!1,y._child});hb.supported=vl.supported;hb.propTypes=YV;hb.defaultProps=KV;Ee.string.isRequired,Ee.string;var n8=["fill","line","symbol","circle","fill-extrusion","raster","background","heatmap","hillshade"];Ee.oneOf(n8).isRequired,Ee.string,Ee.string,Ee.string;var mu={captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!1},Sa={captureScroll:Ee.bool,captureDrag:Ee.bool,captureClick:Ee.bool,captureDoubleClick:Ee.bool,capturePointerMove:Ee.bool};function r8(t){var e=t.containerRef.current,n=t.context.eventManager;if(!(!e||!n)){var r={wheel:function(l){var s=t.props;s.captureScroll&&l.stopPropagation(),s.onScroll&&s.onScroll(l,t)},panstart:function(l){var s=t.props;s.captureDrag&&l.stopPropagation(),s.onDragStart&&s.onDragStart(l,t)},anyclick:function(l){var s=t.props;s.captureClick&&l.stopPropagation(),s.onNativeClick&&s.onNativeClick(l,t)},click:function(l){var s=t.props;s.captureClick&&l.stopPropagation(),s.onClick&&s.onClick(l,t)},dblclick:function(l){var s=t.props;s.captureDoubleClick&&l.stopPropagation(),s.onDoubleClick&&s.onDoubleClick(l,t)},pointermove:function(l){var s=t.props;s.capturePointerMove&&l.stopPropagation(),s.onPointerMove&&s.onPointerMove(l,t)}};return n.watch(r,e),function(){n.off(r)}}}function gu(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=Re.useContext(Ef),n=Re.useRef(null),r=Re.useRef({props:t,state:{},context:e,containerRef:n}),o=r.current;return o.props=t,o.context=e,Re.useEffect(function(){return r8(o)},[e.eventManager]),o}function i8(t){var e=o8();return function(){var r=uu(t),o;if(e){var l=uu(this).constructor;o=Reflect.construct(r,arguments,l)}else o=r.apply(this,arguments);return lb(this,o)}}function o8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function a8(t){var e=t.instance,n=gu(t),r=n.context,o=n.containerRef;return e._context=r,e._containerRef=o,e._render()}var aM=function(t){sb(n,t);var e=i8(n);function n(){var r;pu(this,n);for(var o=arguments.length,l=new Array(o),s=0;s<o;s++)l[s]=arguments[s];return r=e.call.apply(e,[this].concat(l)),D(Qs(r),"_context",{}),D(Qs(r),"_containerRef",Re.createRef()),D(Qs(r),"_onScroll",function(g){}),D(Qs(r),"_onDragStart",function(g){}),D(Qs(r),"_onDblClick",function(g){}),D(Qs(r),"_onClick",function(g){}),D(Qs(r),"_onPointerMove",function(g){}),r}return du(n,[{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){return Re.createElement(a8,Fy({instance:this},this.props,{onScroll:this._onScroll,onDragStart:this._onDragStart,onDblClick:this._onDblClick,onClick:this._onClick,onPointerMove:this._onPointerMove}))}}]),n}(Re.PureComponent);D(aM,"propTypes",Sa);D(aM,"defaultProps",mu);function mS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function gS(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?mS(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var s8=Object.assign({},Sa,{draggable:Ee.bool,onDrag:Ee.func,onDragEnd:Ee.func,onDragStart:Ee.func,offsetLeft:Ee.number,offsetTop:Ee.number}),l8=Object.assign({},mu,{draggable:!1,offsetLeft:0,offsetTop:0});function sM(t){var e=t.offsetCenter,n=e.x,r=e.y;return[n,r]}function u8(t,e){var n=t.center,r=n.x,o=n.y;if(e){var l=e.getBoundingClientRect();return[l.left-r,l.top-o]}return null}function fb(t,e,n,r){var o=t[0]+e[0]-n.offsetLeft,l=t[1]+e[1]-n.offsetTop;return r.viewport.unproject([o,l])}function c8(t,e){var n=e.props,r=e.callbacks,o=e.state,l=e.context,s=e.containerRef,g=n.draggable;if(g){t.stopPropagation();var y=sM(t),b=u8(t,s.current);if(o.setDragPos(y),o.setDragOffset(b),r.onDragStart&&b){var S=Object.assign({},t);S.lngLat=fb(y,b,n,l),r.onDragStart(S)}}}function h8(t,e){var n=e.props,r=e.callbacks,o=e.state,l=e.context;t.stopPropagation();var s=sM(t);o.setDragPos(s);var g=o.dragOffset;if(r.onDrag&&g){var y=Object.assign({},t);y.lngLat=fb(s,g,n,l),r.onDrag(y)}}function f8(t,e){var n=e.props,r=e.callbacks,o=e.state,l=e.context;t.stopPropagation();var s=o.dragPos,g=o.dragOffset;if(o.setDragPos(null),o.setDragOffset(null),r.onDragEnd&&s&&g){var y=Object.assign({},t);y.lngLat=fb(s,g,n,l),r.onDragEnd(y)}}function p8(t,e){var n=e.state;t.stopPropagation(),n.setDragPos(null),n.setDragOffset(null)}function d8(t){var e=t.context.eventManager;if(!(!e||!t.state.dragPos)){var n={panmove:function(o){return h8(o,t)},panend:function(o){return f8(o,t)},pancancel:function(o){return p8(o,t)}};return e.watch(n),function(){e.off(n)}}}function m8(t){var e=Re.useState(null),n=Gr(e,2),r=n[0],o=n[1],l=Re.useState(null),s=Gr(l,2),g=s[0],y=s[1],b=gu(gS(gS({},t),{},{onDragStart:c8}));return b.callbacks=t,b.state.dragPos=r,b.state.setDragPos=o,b.state.dragOffset=g,b.state.setDragOffset=y,Re.useEffect(function(){return d8(b)},[b.context.eventManager,!!r]),b}var yS=typeof window<"u"&&window.devicePixelRatio||1,Pd=function(e){return Math.round(e*yS)/yS},vS=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"x";if(e===null)return n;var o=r==="x"?e.offsetWidth:e.offsetHeight;return Pd(n/100*o)/o*100};function _S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function g8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_S(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_S(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var y8=Object.assign({},s8,{className:Ee.string,longitude:Ee.number.isRequired,latitude:Ee.number.isRequired,style:Ee.object}),v8=Object.assign({},l8,{className:""});function _8(t){var e=t.props,n=t.state,r=t.context,o=e.longitude,l=e.latitude,s=e.offsetLeft,g=e.offsetTop,y=n.dragPos,b=n.dragOffset;if(y&&b)return[y[0]+b[0],y[1]+b[1]];var S=r.viewport.project([o,l]),I=Gr(S,2),C=I[0],B=I[1];return C+=s,B+=g,[C,B]}function pb(t){var e=m8(t),n=e.state,r=e.containerRef,o=t.children,l=t.className,s=t.draggable,g=t.style,y=n.dragPos,b=_8(e),S=Gr(b,2),I=S[0],C=S[1],B="translate(".concat(Pd(I),"px, ").concat(Pd(C),"px)"),G=s?y?"grabbing":"grab":"auto",W=Re.useMemo(function(){var H=g8({position:"absolute",left:0,top:0,transform:B,cursor:G},g);return Re.createElement("div",{className:"mapboxgl-marker ".concat(l),ref:e.containerRef,style:H},o)},[o,l]),he=r.current;return he&&(he.style.transform=B,he.style.cursor=G),W}pb.defaultProps=v8;pb.propTypes=y8;Re.memo(pb);var Id={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},x8=Object.keys(Id);function b8(t){var e=t.x,n=t.y,r=t.width,o=t.height,l=t.selfWidth,s=t.selfHeight,g=t.anchor,y=t.padding,b=y===void 0?0:y,S=Id[g],I=S.x,C=S.y,B=n-C*s,G=B+s,W=Math.max(0,b-B)+Math.max(0,G-o+b);if(W>0){var he=C,H=W;for(C=0;C<=1;C+=.5)B=n-C*s,G=B+s,W=Math.max(0,b-B)+Math.max(0,G-o+b),W<H&&(H=W,he=C);C=he}var U=.5;C===.5&&(I=Math.floor(I),U=1);var K=e-I*l,fe=K+l,ye=Math.max(0,b-K)+Math.max(0,fe-r+b);if(ye>0){var xe=I,Te=ye;for(I=0;I<=1;I+=U)K=e-I*l,fe=K+l,ye=Math.max(0,b-K)+Math.max(0,fe-r+b),ye<Te&&(Te=ye,xe=I);I=xe}return x8.find(function(De){var Fe=Id[De];return Fe.x===I&&Fe.y===C})||g}var w8=Object.assign({},Sa,{className:Ee.string,longitude:Ee.number.isRequired,latitude:Ee.number.isRequired,altitude:Ee.number,offsetLeft:Ee.number,offsetTop:Ee.number,tipSize:Ee.number,closeButton:Ee.bool,closeOnClick:Ee.bool,anchor:Ee.oneOf(Object.keys(Id)),dynamicPosition:Ee.bool,sortByDepth:Ee.bool,onClose:Ee.func}),E8=Object.assign({},mu,{className:"",altitude:0,offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}});function T8(t,e,n,r){var o=Gr(r,2),l=o[0],s=o[1],g=t.anchor,y=t.dynamicPosition,b=t.tipSize;return n&&y?b8({x:l,y:s,anchor:g,padding:b,width:e.width,height:e.height,selfWidth:n.clientWidth,selfHeight:n.clientHeight}):g}function S8(t,e,n,r,o){var l=Gr(r,3),s=l[0],g=l[1],y=l[2],b=t.offsetLeft,S=t.offsetTop,I=t.sortByDepth,C=Id[o],B=s+b,G=g+S,W=vS(n,-C.x*100),he=vS(n,-C.y*100,"y"),H={position:"absolute",transform:`
      translate(`.concat(W,"%, ").concat(he,`%)
      translate(`).concat(Pd(B),"px, ").concat(Pd(G),`px)
    `),display:void 0,zIndex:void 0};return I&&(y>1||y<-1||s<0||s>e.width||g<0||g>e.height?H.display="none":H.zIndex=Math.floor((1-y)/2*1e5)),H}function db(t){var e=Re.useRef(null),n=gu(t),r=n.context,o=n.containerRef,l=Re.useState(!1),s=Gr(l,2),g=s[1];Re.useEffect(function(){g(!0)},[e.current]),Re.useEffect(function(){if(r.eventManager&&t.closeOnClick){var fe=function(){return n.props.onClose()};return r.eventManager.on("anyclick",fe),function(){r.eventManager.off("anyclick",fe)}}},[r.eventManager,t.closeOnClick]);var y=r.viewport,b=t.className,S=t.longitude,I=t.latitude,C=t.altitude,B=t.tipSize,G=t.closeButton,W=t.children,he=y.project([S,I,C]),H=T8(t,y,e.current,he),U=S8(t,y,o.current,he,H),K=Re.useCallback(function(fe){n.props.onClose();var ye=n.context.eventManager;ye&&ye.once("click",function(xe){return xe.stopPropagation()},fe.target)},[]);return Re.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(H," ").concat(b),style:U,ref:o},Re.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:B}}),Re.createElement("div",{key:"content",ref:e,className:"mapboxgl-popup-content"},G&&Re.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button",onClick:K},"×"),W))}db.propTypes=w8;db.defaultProps=E8;Re.memo(db);function xS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function A8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xS(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var P8=Object.assign({},Sa,{toggleLabel:Ee.string,className:Ee.string,style:Ee.object,compact:Ee.bool,customAttribution:Ee.oneOfType([Ee.string,Ee.arrayOf(Ee.string)])}),I8=Object.assign({},mu,{className:"",toggleLabel:"Toggle Attribution"});function C8(t,e,n,r){var o=new _s.AttributionControl(t);return o._map=e,o._container=n,o._innerContainer=r,o._updateAttributions(),o._updateEditLink(),e.on("styledata",o._updateData),e.on("sourcedata",o._updateData),o}function M8(t){t._map.off("styledata",t._updateData),t._map.off("sourcedata",t._updateData)}function mb(t){var e=gu(t),n=e.context,r=e.containerRef,o=Re.useRef(null),l=Re.useState(!1),s=Gr(l,2),g=s[0],y=s[1];Re.useEffect(function(){var C;return n.map&&(C=C8({customAttribution:t.customAttribution},n.map,r.current,o.current)),function(){return C&&M8(C)}},[n.map]);var b=t.compact===void 0?n.viewport.width<=640:t.compact;Re.useEffect(function(){!b&&g&&y(!1)},[b]);var S=Re.useCallback(function(){return y(function(C){return!C})},[]),I=Re.useMemo(function(){return A8({position:"absolute"},t.style)},[t.style]);return Re.createElement("div",{style:I,className:t.className},Re.createElement("div",{ref:r,"aria-pressed":g,className:"mapboxgl-ctrl mapboxgl-ctrl-attrib ".concat(b?"mapboxgl-compact":""," ").concat(g?"mapboxgl-compact-show":"")},Re.createElement("button",{type:"button",className:"mapboxgl-ctrl-attrib-button",title:t.toggleLabel,onClick:S}),Re.createElement("div",{ref:o,className:"mapboxgl-ctrl-attrib-inner",role:"list"})))}mb.propTypes=P8;mb.defaultProps=I8;Re.memo(mb);function bS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function k8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?bS(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var L8=Object.assign({},Sa,{className:Ee.string,style:Ee.object,container:Ee.object,label:Ee.string}),R8=Object.assign({},mu,{className:"",container:null,label:"Toggle fullscreen"});function gb(t){var e=gu(t),n=e.context,r=e.containerRef,o=Re.useState(!1),l=Gr(o,2),s=l[0],g=l[1],y=Re.useState(!1),b=Gr(y,2),S=b[0],I=b[1],C=Re.useState(null),B=Gr(C,2),G=B[0],W=B[1];Re.useEffect(function(){var ye=new _s.FullscreenControl;W(ye),I(ye._checkFullscreenSupport());var xe=function(){var De=!ye._fullscreen;ye._fullscreen=De,g(De)};return rl.addEventListener(ye._fullscreenchange,xe),function(){rl.removeEventListener(ye._fullscreenchange,xe)}},[]);var he=function(){G&&(G._container=t.container||n.container,G._onClickFullscreen())},H=Re.useMemo(function(){return k8({position:"absolute"},t.style)},[t.style]);if(!S)return null;var U=t.className,K=t.label,fe=s?"shrink":"fullscreen";return Re.createElement("div",{style:H,className:U},Re.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},Re.createElement("button",{key:fe,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(fe),type:"button",title:K,onClick:he},Re.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}gb.propTypes=L8;gb.defaultProps=R8;Re.memo(gb);var Ph;function O8(){return Ph!==void 0?Promise.resolve(Ph):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(function(t){return Ph=t.state!=="denied",Ph}):(Ph=!!window.navigator.geolocation,Promise.resolve(Ph))}function wS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function D8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?wS(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var ES=function(){},z8=Object.assign({},Sa,{className:Ee.string,style:Ee.object,label:Ee.string,disabledLabel:Ee.string,auto:Ee.bool,positionOptions:Ee.object,fitBoundsOptions:Ee.object,trackUserLocation:Ee.bool,showUserLocation:Ee.bool,showAccuracyCircle:Ee.bool,showUserHeading:Ee.bool,onViewStateChange:Ee.func,onViewportChange:Ee.func,onGeolocate:Ee.func}),B8=Object.assign({},mu,{className:"",label:"Find My Location",disabledLabel:"Location Not Available",auto:!1,positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0,showUserHeading:!1,showAccuracyCircle:!0,onGeolocate:function(){}});function N8(t){var e=new _s.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,r=e.toBounds(n);return[[r._ne.lng,r._ne.lat],[r._sw.lng,r._sw.lat]]}function F8(t,e,n){var r=new _s.GeolocateControl(e);r._container=rl.createElement("div"),r._map={on:function(){},_getUIString:function(){return""}},r._setupUI(!0),r._map=t.map,r._geolocateButton=n;var o=t.eventManager;return r.options.trackUserLocation&&o&&o.on("panstart",function(){r._watchState==="ACTIVE_LOCK"&&(r._watchState="BACKGROUND",n.classList.add("mapboxgl-ctrl-geolocate-background"),n.classList.remove("mapboxgl-ctrl-geolocate-active"))}),r.on("geolocate",e.onGeolocate),r}function U8(t,e){var n=e.context,r=e.props,o=N8(t),l=n.viewport.fitBounds(o,r.fitBoundsOptions),s=l.longitude,g=l.latitude,y=l.zoom,b=Object.assign({},n.viewport,{longitude:s,latitude:g,zoom:y}),S=new Kh(b),I=Object.assign({},S.getViewportProps(),el),C=r.onViewportChange||n.onViewportChange||ES,B=r.onViewStateChange||n.onViewStateChange||ES;B({viewState:I}),C(I)}function yb(t){var e=gu(t),n=e.context,r=e.containerRef,o=Re.useRef(null),l=Re.useState(null),s=Gr(l,2),g=s[0],y=s[1],b=Re.useState(!1),S=Gr(b,2),I=S[0],C=S[1];Re.useEffect(function(){var K;return n.map&&O8().then(function(fe){C(fe),o.current&&(K=F8(n,t,o.current),K._updateCamera=function(ye){return U8(ye,e)},y(K))}),function(){K&&K._clearWatch()}},[n.map]);var B=Re.useCallback(function(){g&&(g.options=e.props,g.trigger())},[g]);Re.useEffect(function(){t.auto&&B()},[g,t.auto]),Re.useEffect(function(){g&&g._onZoom()},[n.viewport.zoom]);var G=t.className,W=t.label,he=t.disabledLabel,H=t.trackUserLocation,U=Re.useMemo(function(){return D8({position:"absolute"},t.style)},[t.style]);return Re.createElement("div",{style:U,className:G},Re.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},Re.createElement("button",{key:"geolocate",className:"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",ref:o,disabled:!I,"aria-pressed":!H,type:"button",title:I?W:he,"aria-label":I?W:he,onClick:B},Re.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}yb.propTypes=z8;yb.defaultProps=B8;Re.memo(yb);function j8(t,e){for(var n=(t||"").split(".").map(Number),r=(e||"").split(".").map(Number),o=0;o<3;o++){var l=n[o]||0,s=r[o]||0;if(l<s)return-1;if(l>s)return 1}return 0}function TS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function V8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?TS(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):TS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var SS=function(){},G8=Object.assign({},Sa,{className:Ee.string,style:Ee.object,onViewStateChange:Ee.func,onViewportChange:Ee.func,showCompass:Ee.bool,showZoom:Ee.bool,zoomInLabel:Ee.string,zoomOutLabel:Ee.string,compassLabel:Ee.string}),W8=Object.assign({},mu,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"}),H8=1,O1=2;function q8(t){return j8(t,"1.6.0")>=0?O1:H8}function a0(t,e,n){var r=t.viewport,o=new Kh(Object.assign({},r,n)),l=Object.assign({},o.getViewportProps(),el),s=e.onViewportChange||t.onViewportChange||SS,g=e.onViewStateChange||t.onViewStateChange||SS;g({viewState:l}),s(l)}function s0(t,e,n,r){return Re.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:n},r||Re.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}function Z8(t){var e=Re.useMemo(function(){return t.map?q8(t.map.version):O1},[t.map]),n=t.viewport.bearing,r={transform:"rotate(".concat(-n,"deg)")};return e===O1?Re.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:r}):Re.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:r})}function vb(t){var e=gu(t),n=e.context,r=e.containerRef,o=function(){a0(n,t,{zoom:n.viewport.zoom+1})},l=function(){a0(n,t,{zoom:n.viewport.zoom-1})},s=function(){a0(n,t,{bearing:0,pitch:0})},g=t.className,y=t.showCompass,b=t.showZoom,S=t.zoomInLabel,I=t.zoomOutLabel,C=t.compassLabel,B=Re.useMemo(function(){return V8({position:"absolute"},t.style)},[t.style]);return Re.createElement("div",{style:B,className:g},Re.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},b&&s0("zoom-in",S,o),b&&s0("zoom-out",I,l),y&&s0("compass",C,s,Z8(n))))}vb.propTypes=G8;vb.defaultProps=W8;Re.memo(vb);function AS(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function X8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?AS(Object(n),!0).forEach(function(r){D(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):AS(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Y8=Object.assign({},Sa,{className:Ee.string,style:Ee.object,maxWidth:Ee.number,unit:Ee.oneOf(["imperial","metric","nautical"])}),$8=Object.assign({},mu,{className:"",maxWidth:100,unit:"metric"});function _b(t){var e=gu(t),n=e.context,r=e.containerRef,o=Re.useState(null),l=Gr(o,2),s=l[0],g=l[1];Re.useEffect(function(){if(n.map){var b=new _s.ScaleControl;b._map=n.map,b._container=r.current,g(b)}},[n.map]),s&&(s.options=t,s._onMove&&s._onMove());var y=Re.useMemo(function(){return X8({position:"absolute"},t.style)},[t.style]);return Re.createElement("div",{style:y,className:t.className},Re.createElement("div",{ref:r,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}))}_b.propTypes=Y8;_b.defaultProps=$8;Re.memo(_b);Object.assign({},Sa,{redraw:Ee.func.isRequired});Object.assign({},Sa,{redraw:Ee.func.isRequired,style:Ee.object});Object.assign({},Sa,{redraw:Ee.func.isRequired,style:Ee.object});_s&&_s.setRTLTextPlugin;function K8(t,e){try{var n;const r=JSON.parse(t);return(n=e.json)!==null&&n!==void 0&&n.table&&lM(r)||r}catch{throw new Error("JSONLoader: failed to parse JSON")}}function lM(t){if(Array.isArray(t))return t;if(t&&typeof t=="object")for(const e of Object.values(t)){const n=lM(e);if(n)return n}return null}const PS=100;let J8=class{constructor(e,n){if(D(this,"schema",void 0),D(this,"options",void 0),D(this,"length",0),D(this,"rows",null),D(this,"cursor",0),D(this,"_headers",[]),this.options=n,this.schema=e,!Array.isArray(e)){this._headers=[];for(const r in e)this._headers[e[r].index]=e[r].name}}rowCount(){return this.length}addArrayRow(e,n){Number.isFinite(n)&&(this.cursor=n),this.rows=this.rows||new Array(PS),this.rows[this.length]=e,this.length++}addObjectRow(e,n){Number.isFinite(n)&&(this.cursor=n),this.rows=this.rows||new Array(PS),this.rows[this.length]=e,this.length++}getBatch(){let e=this.rows;return e?(e=e.slice(0,this.length),this.rows=null,{shape:this.options.shape,batchType:"data",data:e,length:this.length,schema:this.schema,cursor:this.cursor}):null}};function Q8(t,e){if(!t)throw new Error("null row");if(!e)throw new Error("no headers");const n={};for(let r=0;r<e.length;r++)n[e[r]]=t[r];return n}function e9(t,e){if(!t)throw new Error("null row");if(!e)throw new Error("no headers");const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=t[e[r]];return n}const IS=100;class t9{constructor(e,n){if(D(this,"schema",void 0),D(this,"options",void 0),D(this,"length",0),D(this,"objectRows",null),D(this,"arrayRows",null),D(this,"cursor",0),D(this,"_headers",[]),this.options=n,this.schema=e,!Array.isArray(e)){this._headers=[];for(const r in e)this._headers[e[r].index]=e[r].name}}rowCount(){return this.length}addArrayRow(e,n){switch(Number.isFinite(n)&&(this.cursor=n),this.options.shape){case"object-row-table":const r=Q8(e,this._headers);this.addObjectRow(r,n);break;case"array-row-table":this.arrayRows=this.arrayRows||new Array(IS),this.arrayRows[this.length]=e,this.length++;break}}addObjectRow(e,n){switch(Number.isFinite(n)&&(this.cursor=n),this.options.shape){case"array-row-table":const r=e9(e,this._headers);this.addArrayRow(r,n);break;case"object-row-table":this.objectRows=this.objectRows||new Array(IS),this.objectRows[this.length]=e,this.length++;break}}getBatch(){let e=this.arrayRows||this.objectRows;return e?(e=e.slice(0,this.length),this.arrayRows=null,this.objectRows=null,{shape:this.options.shape,batchType:"data",data:e,length:this.length,schema:this.schema,cursor:this.cursor}):null}}const n9=100;class r9{constructor(e,n){D(this,"schema",void 0),D(this,"length",0),D(this,"allocated",0),D(this,"columns",{}),this.schema=e,this._reallocateColumns()}rowCount(){return this.length}addArrayRow(e){this._reallocateColumns();let n=0;for(const r in this.columns)this.columns[r][this.length]=e[n++];this.length++}addObjectRow(e){this._reallocateColumns();for(const n in e)this.columns[n][this.length]=e[n];this.length++}getBatch(){this._pruneColumns();const e=Array.isArray(this.schema)?this.columns:{};if(!Array.isArray(this.schema))for(const r in this.schema){const o=this.schema[r];e[o.name]=this.columns[o.index]}return this.columns={},{shape:"columnar-table",batchType:"data",data:e,schema:this.schema,length:this.length}}_reallocateColumns(){if(!(this.length<this.allocated)){this.allocated=this.allocated>0?this.allocated*=2:n9,this.columns={};for(const e in this.schema){const n=this.schema[e],r=n.type||Float32Array,o=this.columns[n.index];if(o&&ArrayBuffer.isView(o)){const l=new r(this.allocated);l.set(o),this.columns[n.index]=l}else o?(o.length=this.allocated,this.columns[n.index]=o):this.columns[n.index]=new r(this.allocated)}}}_pruneColumns(){for(const[e,n]of Object.entries(this.columns))this.columns[e]=n.slice(0,this.length)}}const i9={shape:"array-row-table",batchSize:"auto",batchDebounceMs:0,limit:0,_limitMB:0},CS="TableBatchBuilder";class Cd{constructor(e,n){D(this,"schema",void 0),D(this,"options",void 0),D(this,"aggregator",null),D(this,"batchCount",0),D(this,"bytesUsed",0),D(this,"isChunkComplete",!1),D(this,"lastBatchEmittedMs",Date.now()),D(this,"totalLength",0),D(this,"totalBytes",0),D(this,"rowBytes",0),this.schema=e,this.options={...i9,...n}}limitReached(){var e,n;return!!(!((e=this.options)===null||e===void 0)&&e.limit&&this.totalLength>=this.options.limit||!((n=this.options)===null||n===void 0)&&n._limitMB&&this.totalBytes/1e6>=this.options._limitMB)}addRow(e){this.limitReached()||(this.totalLength++,this.rowBytes=this.rowBytes||this._estimateRowMB(e),this.totalBytes+=this.rowBytes,Array.isArray(e)?this.addArrayRow(e):this.addObjectRow(e))}addArrayRow(e){if(!this.aggregator){const n=this._getTableBatchType();this.aggregator=new n(this.schema,this.options)}this.aggregator.addArrayRow(e)}addObjectRow(e){if(!this.aggregator){const n=this._getTableBatchType();this.aggregator=new n(this.schema,this.options)}this.aggregator.addObjectRow(e)}chunkComplete(e){e instanceof ArrayBuffer&&(this.bytesUsed+=e.byteLength),typeof e=="string"&&(this.bytesUsed+=e.length),this.isChunkComplete=!0}getFullBatch(e){return this._isFull()?this._getBatch(e):null}getFinalBatch(e){return this._getBatch(e)}_estimateRowMB(e){return Array.isArray(e)?e.length*8:Object.keys(e).length*8}_isFull(){if(!this.aggregator||this.aggregator.rowCount()===0)return!1;if(this.options.batchSize==="auto"){if(!this.isChunkComplete)return!1}else if(this.options.batchSize>this.aggregator.rowCount())return!1;return this.options.batchDebounceMs>Date.now()-this.lastBatchEmittedMs?!1:(this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),!0)}_getBatch(e){if(!this.aggregator)return null;e!=null&&e.bytesUsed&&(this.bytesUsed=e.bytesUsed);const n=this.aggregator.getBatch();return n.count=this.batchCount,n.bytesUsed=this.bytesUsed,Object.assign(n,e),this.batchCount++,this.aggregator=null,n}_getTableBatchType(){switch(this.options.shape){case"row-table":return J8;case"array-row-table":case"object-row-table":return t9;case"columnar-table":return r9;case"arrow-table":if(!Cd.ArrowBatch)throw new Error(CS);return Cd.ArrowBatch;default:throw new Error(CS)}}}D(Cd,"ArrowBatch",void 0);const D1=Number.MAX_SAFE_INTEGER;var bt=function(t){return t[t.BEGIN=0]="BEGIN",t[t.VALUE=1]="VALUE",t[t.OPEN_OBJECT=2]="OPEN_OBJECT",t[t.CLOSE_OBJECT=3]="CLOSE_OBJECT",t[t.OPEN_ARRAY=4]="OPEN_ARRAY",t[t.CLOSE_ARRAY=5]="CLOSE_ARRAY",t[t.TEXT_ESCAPE=6]="TEXT_ESCAPE",t[t.STRING=7]="STRING",t[t.BACKSLASH=8]="BACKSLASH",t[t.END=9]="END",t[t.OPEN_KEY=10]="OPEN_KEY",t[t.CLOSE_KEY=11]="CLOSE_KEY",t[t.TRUE=12]="TRUE",t[t.TRUE2=13]="TRUE2",t[t.TRUE3=14]="TRUE3",t[t.FALSE=15]="FALSE",t[t.FALSE2=16]="FALSE2",t[t.FALSE3=17]="FALSE3",t[t.FALSE4=18]="FALSE4",t[t.NULL=19]="NULL",t[t.NULL2=20]="NULL2",t[t.NULL3=21]="NULL3",t[t.NUMBER_DECIMAL_POINT=22]="NUMBER_DECIMAL_POINT",t[t.NUMBER_DIGIT=23]="NUMBER_DIGIT",t}(bt||{});const Ft={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125},MS=/[\\"\n]/g,kS={onready:()=>{},onopenobject:()=>{},onkey:()=>{},oncloseobject:()=>{},onopenarray:()=>{},onclosearray:()=>{},onvalue:()=>{},onerror:()=>{},onend:()=>{},onchunkparsed:()=>{}};class o9{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};D(this,"options",kS),D(this,"bufferCheckPosition",D1),D(this,"q",""),D(this,"c",""),D(this,"p",""),D(this,"closed",!1),D(this,"closedRoot",!1),D(this,"sawRoot",!1),D(this,"error",null),D(this,"state",bt.BEGIN),D(this,"stack",[]),D(this,"position",0),D(this,"column",0),D(this,"line",1),D(this,"slashed",!1),D(this,"unicodeI",0),D(this,"unicodeS",null),D(this,"depth",0),D(this,"textNode",void 0),D(this,"numberNode",void 0),this.options={...kS,...e},this.textNode=void 0,this.numberNode="",this.emit("onready")}end(){return(this.state!==bt.VALUE||this.depth!==0)&&this._error("Unexpected end"),this._closeValue(),this.c="",this.closed=!0,this.emit("onend"),this}resume(){return this.error=null,this}close(){return this.write(null)}emit(e,n){var r,o;(r=(o=this.options)[e])===null||r===void 0||r.call(o,n,this)}emitNode(e,n){this._closeValue(),this.emit(e,n)}write(e){if(this.error)throw this.error;if(this.closed)return this._error("Cannot write after close. Assign an onready handler.");if(e===null)return this.end();let n=0,r=e.charCodeAt(0),o=this.p;for(;r&&(o=r,this.c=r=e.charCodeAt(n++),o!==r?this.p=o:o=this.p,!!r);)switch(this.position++,r===Ft.lineFeed?(this.line++,this.column=0):this.column++,this.state){case bt.BEGIN:r===Ft.openBrace?this.state=bt.OPEN_OBJECT:r===Ft.openBracket?this.state=bt.OPEN_ARRAY:Op(r)||this._error("Non-whitespace before {[.");continue;case bt.OPEN_KEY:case bt.OPEN_OBJECT:if(Op(r))continue;if(this.state===bt.OPEN_KEY)this.stack.push(bt.CLOSE_KEY);else if(r===Ft.closeBrace){this.emit("onopenobject"),this.depth++,this.emit("oncloseobject"),this.depth--,this.state=this.stack.pop()||bt.VALUE;continue}else this.stack.push(bt.CLOSE_OBJECT);r===Ft.doubleQuote?this.state=bt.STRING:this._error('Malformed object key should start with "');continue;case bt.CLOSE_KEY:case bt.CLOSE_OBJECT:if(Op(r))continue;r===Ft.colon?(this.state===bt.CLOSE_OBJECT?(this.stack.push(bt.CLOSE_OBJECT),this._closeValue("onopenobject"),this.depth++):this._closeValue("onkey"),this.state=bt.VALUE):r===Ft.closeBrace?(this.emitNode("oncloseobject"),this.depth--,this.state=this.stack.pop()||bt.VALUE):r===Ft.comma?(this.state===bt.CLOSE_OBJECT&&this.stack.push(bt.CLOSE_OBJECT),this._closeValue(),this.state=bt.OPEN_KEY):this._error("Bad object");continue;case bt.OPEN_ARRAY:case bt.VALUE:if(Op(r))continue;if(this.state===bt.OPEN_ARRAY)if(this.emit("onopenarray"),this.depth++,this.state=bt.VALUE,r===Ft.closeBracket){this.emit("onclosearray"),this.depth--,this.state=this.stack.pop()||bt.VALUE;continue}else this.stack.push(bt.CLOSE_ARRAY);r===Ft.doubleQuote?this.state=bt.STRING:r===Ft.openBrace?this.state=bt.OPEN_OBJECT:r===Ft.openBracket?this.state=bt.OPEN_ARRAY:r===Ft.t?this.state=bt.TRUE:r===Ft.f?this.state=bt.FALSE:r===Ft.n?this.state=bt.NULL:r===Ft.minus?this.numberNode+="-":Ft._0<=r&&r<=Ft._9?(this.numberNode+=String.fromCharCode(r),this.state=bt.NUMBER_DIGIT):this._error("Bad value");continue;case bt.CLOSE_ARRAY:if(r===Ft.comma)this.stack.push(bt.CLOSE_ARRAY),this._closeValue("onvalue"),this.state=bt.VALUE;else if(r===Ft.closeBracket)this.emitNode("onclosearray"),this.depth--,this.state=this.stack.pop()||bt.VALUE;else{if(Op(r))continue;this._error("Bad array")}continue;case bt.STRING:this.textNode===void 0&&(this.textNode="");let l=n-1,s=this.slashed,g=this.unicodeI;e:for(;;){for(;g>0;)if(this.unicodeS+=String.fromCharCode(r),r=e.charCodeAt(n++),this.position++,g===4?(this.textNode+=String.fromCharCode(parseInt(this.unicodeS,16)),g=0,l=n-1):g++,!r)break e;if(r===Ft.doubleQuote&&!s){this.state=this.stack.pop()||bt.VALUE,this.textNode+=e.substring(l,n-1),this.position+=n-1-l;break}if(r===Ft.backslash&&!s&&(s=!0,this.textNode+=e.substring(l,n-1),this.position+=n-1-l,r=e.charCodeAt(n++),this.position++,!r))break;if(s){if(s=!1,r===Ft.n?this.textNode+=`
`:r===Ft.r?this.textNode+="\r":r===Ft.t?this.textNode+="	":r===Ft.f?this.textNode+="\f":r===Ft.b?this.textNode+="\b":r===Ft.u?(g=1,this.unicodeS=""):this.textNode+=String.fromCharCode(r),r=e.charCodeAt(n++),this.position++,l=n-1,r)continue;break}MS.lastIndex=n;const y=MS.exec(e);if(y===null){n=e.length+1,this.textNode+=e.substring(l,n-1),this.position+=n-1-l;break}if(n=y.index+1,r=e.charCodeAt(y.index),!r){this.textNode+=e.substring(l,n-1),this.position+=n-1-l;break}}this.slashed=s,this.unicodeI=g;continue;case bt.TRUE:r===Ft.r?this.state=bt.TRUE2:this._error("Invalid true started with t".concat(r));continue;case bt.TRUE2:r===Ft.u?this.state=bt.TRUE3:this._error("Invalid true started with tr".concat(r));continue;case bt.TRUE3:r===Ft.e?(this.emit("onvalue",!0),this.state=this.stack.pop()||bt.VALUE):this._error("Invalid true started with tru".concat(r));continue;case bt.FALSE:r===Ft.a?this.state=bt.FALSE2:this._error("Invalid false started with f".concat(r));continue;case bt.FALSE2:r===Ft.l?this.state=bt.FALSE3:this._error("Invalid false started with fa".concat(r));continue;case bt.FALSE3:r===Ft.s?this.state=bt.FALSE4:this._error("Invalid false started with fal".concat(r));continue;case bt.FALSE4:r===Ft.e?(this.emit("onvalue",!1),this.state=this.stack.pop()||bt.VALUE):this._error("Invalid false started with fals".concat(r));continue;case bt.NULL:r===Ft.u?this.state=bt.NULL2:this._error("Invalid null started with n".concat(r));continue;case bt.NULL2:r===Ft.l?this.state=bt.NULL3:this._error("Invalid null started with nu".concat(r));continue;case bt.NULL3:r===Ft.l?(this.emit("onvalue",null),this.state=this.stack.pop()||bt.VALUE):this._error("Invalid null started with nul".concat(r));continue;case bt.NUMBER_DECIMAL_POINT:r===Ft.period?(this.numberNode+=".",this.state=bt.NUMBER_DIGIT):this._error("Leading zero not followed by .");continue;case bt.NUMBER_DIGIT:Ft._0<=r&&r<=Ft._9?this.numberNode+=String.fromCharCode(r):r===Ft.period?(this.numberNode.indexOf(".")!==-1&&this._error("Invalid number has two dots"),this.numberNode+="."):r===Ft.e||r===Ft.E?((this.numberNode.indexOf("e")!==-1||this.numberNode.indexOf("E")!==-1)&&this._error("Invalid number has two exponential"),this.numberNode+="e"):r===Ft.plus||r===Ft.minus?(o===Ft.e||o===Ft.E||this._error("Invalid symbol in number"),this.numberNode+=String.fromCharCode(r)):(this._closeNumber(),n--,this.state=this.stack.pop()||bt.VALUE);continue;default:this._error("Unknown state: ".concat(this.state))}return this.position>=this.bufferCheckPosition&&a9(this),this.emit("onchunkparsed"),this}_closeValue(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"onvalue";this.textNode!==void 0&&this.emit(e,this.textNode),this.textNode=void 0}_closeNumber(){this.numberNode&&this.emit("onvalue",parseFloat(this.numberNode)),this.numberNode=""}_error(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this._closeValue(),e+=`
Line: `.concat(this.line,`
Column: `).concat(this.column,`
Char: `).concat(this.c);const n=new Error(e);this.error=n,this.emit("onerror",n)}}function Op(t){return t===Ft.carriageReturn||t===Ft.lineFeed||t===Ft.space||t===Ft.tab}function a9(t){const e=Math.max(D1,10);let n=0;for(const r of["textNode","numberNode"]){const o=t[r]===void 0?0:t[r].length;if(o>e)switch(r){case"text":break;default:t._error("Max buffer length exceeded: ".concat(r))}n=Math.max(n,o)}t.bufferCheckPosition=D1-n+t.position}class lc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(D(this,"path",void 0),this.path=["$"],e instanceof lc){this.path=[...e.path];return}if(Array.isArray(e)){this.path.push(...e);return}if(typeof e=="string"&&(this.path=e.split("."),this.path[0]!=="$"))throw new Error("JSONPaths must start with $")}clone(){return new lc(this)}toString(){return this.path.join(".")}push(e){this.path.push(e)}pop(){return this.path.pop()}set(e){this.path[this.path.length-1]=e}equals(e){if(!this||!e||this.path.length!==e.path.length)return!1;for(let n=0;n<this.path.length;++n)if(this.path[n]!==e.path[n])return!1;return!0}setFieldAtPath(e,n){const r=[...this.path];r.shift();const o=r.pop();for(const l of r)e=e[l];e[o]=n}getFieldAtPath(e){const n=[...this.path];n.shift();const r=n.pop();for(const o of n)e=e[o];return e[r]}}class s9{constructor(e){D(this,"parser",void 0),D(this,"result",void 0),D(this,"previousStates",[]),D(this,"currentState",Object.freeze({container:[],key:null})),D(this,"jsonpath",new lc),this.reset(),this.parser=new o9({onready:()=>{this.jsonpath=new lc,this.previousStates.length=0,this.currentState.container.length=0},onopenobject:n=>{this._openObject({}),typeof n<"u"&&this.parser.emit("onkey",n)},onkey:n=>{this.jsonpath.set(n),this.currentState.key=n},oncloseobject:()=>{this._closeObject()},onopenarray:()=>{this._openArray()},onclosearray:()=>{this._closeArray()},onvalue:n=>{this._pushOrSet(n)},onerror:n=>{throw n},onend:()=>{this.result=this.currentState.container.pop()},...e})}reset(){this.result=void 0,this.previousStates=[],this.currentState=Object.freeze({container:[],key:null}),this.jsonpath=new lc}write(e){this.parser.write(e)}close(){this.parser.close()}_pushOrSet(e){const{container:n,key:r}=this.currentState;r!==null?(n[r]=e,this.currentState.key=null):n.push(e)}_openArray(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.jsonpath.push(null),this._pushOrSet(e),this.previousStates.push(this.currentState),this.currentState={container:e,isArray:!0,key:null}}_closeArray(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}_openObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.jsonpath.push(null),this._pushOrSet(e),this.previousStates.push(this.currentState),this.currentState={container:e,isArray:!1,key:null}}_closeObject(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}}class l9 extends s9{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super({onopenarray:()=>{if(!this.streamingArray&&this._matchJSONPath()){this.streamingJsonPath=this.getJsonPath().clone(),this.streamingArray=[],this._openArray(this.streamingArray);return}this._openArray()},onopenobject:r=>{this.topLevelObject?this._openObject({}):(this.topLevelObject={},this._openObject(this.topLevelObject)),typeof r<"u"&&this.parser.emit("onkey",r)}}),D(this,"jsonPaths",void 0),D(this,"streamingJsonPath",null),D(this,"streamingArray",null),D(this,"topLevelObject",null);const n=e.jsonpaths||[];this.jsonPaths=n.map(r=>new lc(r))}write(e){super.write(e);let n=[];return this.streamingArray&&(n=[...this.streamingArray],this.streamingArray.length=0),n}getPartialResult(){return this.topLevelObject}getStreamingJsonPath(){return this.streamingJsonPath}getStreamingJsonPathAsString(){return this.streamingJsonPath&&this.streamingJsonPath.toString()}getJsonPath(){return this.jsonpath}_matchJSONPath(){const e=this.getJsonPath();if(this.jsonPaths.length===0)return!0;for(const n of this.jsonPaths)if(n.equals(e))return!0;return!1}}async function*u9(t,e){var n;const r=EL(t),{metadata:o}=e,{jsonpaths:l}=e.json||{};let s=!0;const g=null,y=(e==null||(n=e.json)===null||n===void 0?void 0:n.shape)||"row-table",b=new Cd(g,{...e,shape:y}),S=new l9({jsonpaths:l});for await(const B of r){const G=S.write(B),W=G.length>0&&S.getStreamingJsonPathAsString();G.length>0&&s&&(o&&(yield{shape:y,batchType:"partial-result",data:[],length:0,bytesUsed:0,container:S.getPartialResult(),jsonpath:W}),s=!1);for(const H of G){b.addRow(H);const U=b.getFullBatch({jsonpath:W});U&&(yield U)}b.chunkComplete(B);const he=b.getFullBatch({jsonpath:W});he&&(yield he)}const I=S.getStreamingJsonPathAsString(),C=b.getFinalBatch({jsonpath:I});C&&(yield C),o&&(yield{shape:y,batchType:"final-result",container:S.getPartialResult(),jsonpath:S.getStreamingJsonPathAsString(),data:[],length:0})}const c9="3.4.14",xb={json:{shape:"row-table",table:!1,jsonpaths:[]}},h9={name:"JSON",id:"json",module:"json",version:c9,extensions:["json","geojson"],mimeTypes:["application/json"],category:"table",text:!0,parse:f9,parseTextSync:uM,parseInBatches:p9,options:xb};async function f9(t,e){return uM(new TextDecoder().decode(t),e)}function uM(t,e){const n={...e,json:{...xb.json,...e==null?void 0:e.json}};return K8(t,n)}function p9(t,e){const n={...e,json:{...xb.json,...e==null?void 0:e.json}};return u9(t,n)}const d9=`
varying vec3 vColor;

void main() {
    gl_FragColor = vec4(vColor, 0.6);
}
`,m9=`
attribute vec3 position;
attribute vec3 color;
varying vec3 vColor;

void main() {
    vColor = color;
    gl_Position = project_common_position_to_clipspace(project_position(vec4(position, 1.0)));
}
`,g9={scale:{type:"number",value:1e3},getColor:{type:"accessor",value:()=>[0,0,.9]}};class bb extends _c{initializeState(){const{gl:e}=this.context,n=this.getModel(e);this.setState({model:n}),this.getAttributeManager().add({color:{size:3,accessor:"getColor"}})}getModel(e){return new Nd(e,{vs:m9,fs:d9,id:this.props.id,drawMode:e.LINES})}updateState({oldProps:e,props:n,changeFlags:r}){if(super.updateState({props:n,oldProps:e,changeFlags:r}),r.dataChanged){const{data:o}=this.props,{model:l}=this.state;l.vertexCount=o.length}}updateBuffers(){const{gl:e}=this.context,{model:n}=this.state,{data:r,scale:o,valueBuffer:l}=this.props;if(n&&r.length>0&&l.length>0){const s=new Float32Array(r.length*3);r.forEach((y,b)=>{s[b*3+0]=r[b].coordinates[0],s[b*3+1]=r[b].coordinates[1],s[b*3+2]=1e3+l[b]*o/1e3});const g=e.getAttribLocation(n.getProgram().handle,"position");n.vertexArray.setBuffer(g,new gn(e,{usage:e.DYNAMIC_DRAW,data:s}))}}draw(){const{model:e}=this.state;this.updateBuffers(),this.setNeedsRedraw(),e&&e.draw()}}bb.layerName="CustomLinesLayer";bb.defaultProps=g9;function Wy(t){let r=t*-240+240;return y9(r,1,.5)}function y9(t,e,n){if(t<0||360<t)throw new Error("Invalid hue value");if(e<0||1<e)throw new Error("Invalid saturation value.");if(n<0||1<n)throw new Error("Invalid lightness value.");const r=(1-Math.abs(2*n-1))*e,o=r*(1-Math.abs(t/60%2-1)),l=n-r/2;let s;return t<60?s=[r+l,o+l,0+l]:t<120?s=[o+l,r+l,0+l]:t<180?s=[0+l,r+l,o+l]:t<240?s=[0+l,o+l,r+l]:t<300?s=[o+l,0+l,r+l]:t<360&&(s=[r+l,0+l,o+l]),s}function v9(t,e){let n,r,o,l;return t.forEach(s=>{const g=s.properties[e];g!=null&&((!n||g<n)&&(n=g),(!r||r<g)&&(r=g),(!l||Math.abs(g)<l)&&(l=Math.abs(g)))}),o=Math.max(Math.abs(n),Math.abs(r)),{minValue:n,maxValue:r,minAbsValue:l,maxAbsValue:o}}const _9=function(t,e,n){const r=document.getElementById("legend"),o=r.getContext("2d");o.fillStyle="#FFFFFF";const l=12.5,s=12.5,g=20.5,y=40,b=20,S=16,I=20,C=r.height-l-y-s;n&&(o.fillStyle="#000000",o.font=`${b}px san-serif`,o.textBaseline="middle",o.fillText(n,r.width/2-o.measureText(n).width/2,s+b/2));const B=o.createLinearGradient(0,l+y,0,l+y+C);B.addColorStop(0,"#FF0000"),B.addColorStop(.25,"#FFFF00"),B.addColorStop(.5,"#00FF00"),B.addColorStop(.75,"#00FFFF"),B.addColorStop(1,"#0000FF"),o.fillStyle=B,o.fillRect(g,l+y,I,C),o.beginPath(),o.lineWidth=1,o.strokeStyle="black",o.rect(g,l+y,I,C),o.stroke(),o.fillStyle="#000000",o.font=`${S}px san-serif`,o.textBaseline="middle";const G=g+I+15;for(let W=0;W<=1;W+=.25)o.beginPath(),o.moveTo(g+I,l+y+C*W),o.lineTo(g+I+5,l+y+C*W),o.stroke(),o.fillText(Math.round(((t-e)*W+e+Number.EPSILON)*100)/100,G,l+y+C*W)};function x9(t,e=!1){let n=new Set;t.forEach(l=>{for(const[s,g]of Object.entries(l.properties))if(g!==null&&s.startsWith("d_")){const y=new Number(s.substring(2,6)),b=new Number(s.substring(6,8)),S=new Number(s.substring(8,10)),C=new Date(y,b-1,S).getTime();n.add(C)}});const r=Array.from(n);n=null,r.sort((l,s)=>l-s);const o=[];return t.forEach(l=>{let s={id:l.properties.id,coordinates:l.geometry.coordinates,h:l.properties.h,relMovements:[]};r.forEach(g=>{const y=new Date(g),b=`${y.getFullYear()}`,S=y.getMonth()+1<10?`0${y.getMonth()+1}`:`${y.getMonth()+1}`,I=y.getDate()<10?`0${y.getDate()}`:`${y.getDate()}`,C=l.properties[`d_${b}${S}${I}`];s.relMovements.push({timestamp:g,value:C})}),o.push(s)}),o.forEach(l=>{l.relMovements.forEach((s,g,y)=>{if(s.value===void 0||s.value===null)if(g===0)s.value=y.find(b=>b.value!==void 0&&b.value!==null);else if(g===y.length-1)s.value=y.slice().reverse().find(b=>b.value!==void 0&&b.value!==null);else{const b=y.slice(0,g).reverse().find(I=>I.value!==void 0&&I.value!==null),S=y.slice(g+1).find(I=>I.value!==void 0&&I.value!==null);s.value=(S.value-b.value)/(S.timestamp-b.timestamp)*(s.timestamp-b.timestamp)+b.value}})}),o}function b9(t,e){const n=new Float32Array(t.length);if(e<t[0].relMovements[0].timestamp)t.forEach((r,o)=>{n[o]=r.relMovements[0].value});else if(t[0].relMovements[t[0].relMovements.length-1].timestamp<e)t.forEach((r,o)=>{n[o]=r.relMovements[r.relMovements.length-1].value});else{let r=0,o=t[0].relMovements.length-1;for(;o-r>1;){let l=Math.floor((r+o)/2),s=t[0].relMovements[r].timestamp,g=t[0].relMovements[l].timestamp,y=t[0].relMovements[o].timestamp;s<=e&&e<g?o=l:g<=e&&e<=y&&(r=l)}t.forEach((l,s)=>{const g=l.relMovements[r].timestamp,y=l.relMovements[o].timestamp,b=l.relMovements[r].value,I=(l.relMovements[o].value-b)/(y-g)*(e-g)+b;n[s]=I})}return n}function w9(t){let e,n;return t.forEach(r=>{r.relMovements.forEach(o=>{const l=o.timestamp;(!e||l<e)&&(e=l),(!n||n<l)&&(n=l)})}),{minTime:e,maxTime:n}}function wb(t){let e,n,r,o;return t.forEach(l=>{l.relMovements.forEach(s=>{(!e||s.value<e)&&(e=s.value),(!n||n<s.value)&&(n=s.value),(!r||Math.abs(s.value)<r)&&(r=Math.abs(s.value))})}),o=Math.max(Math.abs(e),Math.abs(n)),{minValue:e,maxValue:n,minAbsValue:r,maxAbsValue:o}}const E9=`
uniform sampler2D uSampler;
varying vec2 vTexCoord;
varying vec3 vColor;

void main() {
    vec4 textureColor = texture2D(uSampler, vTexCoord);

    if(textureColor.x > 0.1){
        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
    } else {
        gl_FragColor = vec4( min(1.0, vColor.x), min(1.0, vColor.y), min(1.0, vColor.z), 1.0);
    }
}
`,T9=`
attribute vec3 position;
attribute vec2 textureCoord;
attribute vec3 color;

varying vec3 vColor;
varying vec2 vTexCoord;

void main() {
    vColor = color;
    vTexCoord = textureCoord;

    gl_Position = project_common_position_to_clipspace(project_position(vec4(position, 1.0)));
}
`,S9={scale:{type:"number",value:1e3}};class Eb extends _c{initializeState(){const{gl:e}=this.context,n=this.getModel(e);this.setState({model:n}),Qh("textures/spring.png",[Y1]).then(r=>{const o=new Do(e,{data:r,parameters:{[e.TEXTURE_MAG_FILTER]:e.NEAREST,[e.TEXTURE_MIN_FILTER]:e.NEAREST}});n.uniforms.uSampler=o,this.setNeedsRedraw()})}getModel(e){return new Nd(e,{vs:T9,fs:E9,id:this.props.id,drawMode:e.TRIANGLES})}getTextureCoordinates(e){const n=new Float32Array(e.length);for(let o=0;o<n.length;o+=8){let l=[e[o],e[o+1]],s=[e[o+4],e[o+5]],g=[s[0]-l[0],s[1]-l[1]],b=Math.pow(Math.pow(g[0],2)+Math.pow(g[1],2),.5)/this.props.springLength;n[o+0]=0,n[o+1]=0,n[o+2]=0,n[o+3]=1,n[o+4]=b,n[o+5]=0,n[o+6]=b,n[o+7]=1}const r=new Float32Array(this.props.data.length*6);for(let o=0;o<n.length;o+=8)r[o*1.5+0]=n[o],r[o*1.5+1]=n[o+1],r[o*1.5+2]=n[o+2],r[o*1.5+3]=n[o+3],r[o*1.5+4]=n[o+4],r[o*1.5+5]=n[o+5],r[o*1.5+6]=n[o+2],r[o*1.5+7]=n[o+3],r[o*1.5+8]=n[o+4],r[o*1.5+9]=n[o+5],r[o*1.5+10]=n[o+6],r[o*1.5+11]=n[o+7];return r}getPositions(e){if(e.length>0){const n=new Float32Array(e.length*4);for(let r=0;r<e.length;r+=2){let o=e[r].coordinates,l=e[r+1].coordinates,s=[-1*(l[1]-o[1]),l[0]-o[0]],y=5e-5/Math.pow(Math.pow(s[0],2)+Math.pow(s[1],2),.5),b=[y*s[0],y*s[1]],S=[o[0]-b[0],o[1]-b[1]],I=[o[0]+b[0],o[1]+b[1]],C=[l[0]-b[0],l[1]-b[1]],B=[l[0]+b[0],l[1]+b[1]],G=4;n[r*G+0]=S[0],n[r*G+1]=S[1],n[r*G+2]=I[0],n[r*G+3]=I[1],n[r*G+4]=C[0],n[r*G+5]=C[1],n[r*G+6]=B[0],n[r*G+7]=B[1]}return n}}updateState({oldProps:e,props:n,changeFlags:r}){if(super.updateState({props:n,oldProps:e,changeFlags:r}),r.dataChanged){const{data:o}=this.props,{model:l}=this.state;l.vertexCount=o.length*3;const{maxAbsValue:s}=wb(o),g=this.getPositions(o),y=this.getTextureCoordinates(g);this.setState({maxAbsValue:s,positionsBuffer:g,textureCoordBuffer:y})}if(n.springLength!==e.springLength){const o=this.getTextureCoordinates(this.state.positionsBuffer);this.setState({textureCoordBuffer:o})}}updateBuffers(){const{gl:e}=this.context,{model:n}=this.state,{data:r,scale:o,valueBuffer:l}=this.props,s=this.state.maxAbsValue,g=this.state.positionsBuffer,y=new Float32Array(r.length*9);let b=[1,0,0],S=[0,0,1];const I=new Float32Array(r.length*9);for(let W=0;W<r.length;W+=2){const he=Math.abs(l[W])/s;he&&(b=Wy(he));const H=Math.abs(l[W+1])/s;H&&(S=Wy(H));let U=9;I[W*U+0]=b[0],I[W*U+1]=b[1],I[W*U+2]=b[2],I[W*U+3]=b[0],I[W*U+4]=b[1],I[W*U+5]=b[2],I[W*U+6]=S[0],I[W*U+7]=S[1],I[W*U+8]=S[2],I[W*U+9]=b[0],I[W*U+10]=b[1],I[W*U+11]=b[2],I[W*U+12]=S[0],I[W*U+13]=S[1],I[W*U+14]=S[2],I[W*U+15]=S[0],I[W*U+16]=S[1],I[W*U+17]=S[2];let K=[g[W*4+0],g[W*4+1]],fe=[g[W*4+2],g[W*4+3]],ye=[g[W*4+4],g[W*4+5]],xe=[g[W*4+6],g[W*4+7]],Te=9;y[W*Te+0]=K[0],y[W*Te+1]=K[1],y[W*Te+2]=1e3+l[W]*o/1e3,y[W*Te+3]=fe[0],y[W*Te+4]=fe[1],y[W*Te+5]=1e3+l[W]*o/1e3,y[W*Te+6]=ye[0],y[W*Te+7]=ye[1],y[W*Te+8]=1e3+l[W+1]*o/1e3,y[W*Te+9]=fe[0],y[W*Te+10]=fe[1],y[W*Te+11]=1e3+l[W]*o/1e3,y[W*Te+12]=ye[0],y[W*Te+13]=ye[1],y[W*Te+14]=1e3+l[W+1]*o/1e3,y[W*Te+15]=xe[0],y[W*Te+16]=xe[1],y[W*Te+17]=1e3+l[W+1]*o/1e3}const C=e.getAttribLocation(n.getProgram().handle,"position");n.vertexArray.setBuffer(C,new gn(e,{usage:e.DYNAMIC_DRAW,data:y}));const B=e.getAttribLocation(n.getProgram().handle,"color");n.vertexArray.setBuffer(B,new gn(e,{usage:e.DYNAMIC_DRAW,data:I}));const G=e.getAttribLocation(n.getProgram().handle,"textureCoord");n.vertexArray.setBuffer(G,new gn(e,{usage:e.DYNAMIC_DRAW,data:this.state.textureCoordBuffer}))}draw(){const{model:e}=this.state;this.updateBuffers(),this.setNeedsRedraw(),e&&e.draw()}}Eb.layerName="CustomSpringsLayer";Eb.defaultProps=S9;const A9=`
varying vec3 vColor;

void main() {
    gl_FragColor = vec4(vColor, 0.6);
}
`,P9=`
attribute vec3 position;
attribute vec3 color;
varying vec3 vColor;

void main() {
    vColor = color;
    gl_Position = project_common_position_to_clipspace(project_position(vec4(position, 1.0)));
}
`,I9={scale:{type:"number",value:1e3}};class Tb extends _c{initializeState(){const{gl:e}=this.context,n=this.getModel(e);this.setState({model:n})}getModel(e){return new Nd(e,{vs:P9,fs:A9,id:this.props.id,drawMode:e.TRIANGLES})}updateState({oldProps:e,props:n,changeFlags:r}){if(super.updateState({props:n,oldProps:e,changeFlags:r}),r.dataChanged){const{data:o}=this.props,{model:l}=this.state;l.vertexCount=o.length;const{maxAbsValue:s}=wb(o);this.setState({maxAbsValue:s})}}updateBuffers(){const{gl:e}=this.context,{model:n}=this.state,{data:r,scale:o,valueBuffer:l}=this.props,s=this.state.maxAbsValue;if(n&&r.length>0){let g=[.5,.5,.5];const y=new Float32Array(r.length*3),b=new Float32Array(r.length*3);r.forEach((C,B)=>{const G=Math.abs(l[B])/s;G&&(g=Wy(G)),y[B*3+0]=g[0],y[B*3+1]=g[1],y[B*3+2]=g[2],b[B*3+0]=r[B].coordinates[0],b[B*3+1]=r[B].coordinates[1],b[B*3+2]=1e3+l[B]*o/1e3});const S=e.getAttribLocation(n.getProgram().handle,"color");n.vertexArray.setBuffer(S,new gn(e,{usage:e.DYNAMIC_DRAW,data:y}));const I=e.getAttribLocation(n.getProgram().handle,"position");n.vertexArray.setBuffer(I,new gn(e,{usage:e.DYNAMIC_DRAW,data:b}))}}draw(){const{model:e}=this.state;this.updateBuffers(),this.setNeedsRedraw(),e&&e.draw()}}Tb.layerName="CustomTrianglesLayer";Tb.defaultProps=I9;const C9=`
uniform sampler2D uSampler;
varying vec2 vTexCoord;

varying vec3 vColor;

void main() {
    vec4 textureColor = texture2D(uSampler, vTexCoord);

    gl_FragColor = vec4( 
        min(1.0, vColor.x + textureColor.x), 
        min(1.0, vColor.y + textureColor.y), 
        min(1.0, vColor.z + textureColor.z), 
    0.7);
}
`,M9=`
attribute vec3 position;
attribute vec2 textureCoord;
attribute vec3 color;

varying vec3 vColor;
varying vec2 vTexCoord;

void main() {
    vColor = color;
    vTexCoord = textureCoord;
  
    gl_Position = project_common_position_to_clipspace(project_position(vec4(position, 1.0)));
}
`,k9={scale:{type:"number",value:1e3},textureSize:{type:"number",value:1e3}};class Sb extends _c{initializeState(){const{gl:e}=this.context,n=this.getModel(e);this.setState({model:n}),Qh("textures/checker.png",[Y1]).then(o=>{const l=new Do(e,{data:o,parameters:{[e.TEXTURE_MAG_FILTER]:e.NEAREST,[e.TEXTURE_MIN_FILTER]:e.NEAREST}});n.uniforms.uSampler=l,this.setNeedsRedraw()}),this.getAttributeManager().add({textureCoord:{size:2,type:e.FLOAT,update:this.getTextureCoordinates}})}getModel(e){return new Nd(e,{vs:M9,fs:C9,id:this.props.id,drawMode:e.TRIANGLES})}getTextureCoordinates(e){const{data:n}=this.props;if(n.length>0){let[r,o,l,s]=[1/0,1/0,-1/0,-1/0];n.forEach(S=>{r=Math.min(r,S.coordinates[0]),o=Math.min(o,S.coordinates[1]),l=Math.max(l,S.coordinates[0]),s=Math.max(s,S.coordinates[1])});let g=l-r>s-o?l-r:s-o;const y=new Float32Array(n.length*2);let{textureSize:b}=this.props;n.forEach((S,I)=>{let C=S.coordinates,B=(C[0]-r)*b/g,G=(C[1]-o)*b/g;y[I*2+0]=B,y[I*2+1]=G}),e.value=y}}updateState({oldProps:e,props:n,changeFlags:r}){if(super.updateState({props:n,oldProps:e,changeFlags:r}),r.dataChanged){const{data:o}=this.props,{model:l}=this.state;l.vertexCount=o.length;const{maxAbsValue:s}=wb(o);this.setState({maxAbsValue:s})}n.textureSize!==e.textureSize&&this.getAttributeManager().invalidate("textureCoord")}updateBuffers(){const{gl:e}=this.context,{model:n}=this.state,{data:r,scale:o,valueBuffer:l}=this.props,s=this.state.maxAbsValue;if(l.length>0&&n&&r.length>0){let g=[.5,.5,.5];const y=new Float32Array(r.length*3),b=new Float32Array(r.length*3);r.forEach((C,B)=>{const G=Math.abs(l[B])/s;G&&(g=Wy(G)),y[B*3+0]=g[0],y[B*3+1]=g[1],y[B*3+2]=g[2],b[B*3+0]=r[B].coordinates[0],b[B*3+1]=r[B].coordinates[1],b[B*3+2]=1e3+l[B]*o/1e3});const S=e.getAttribLocation(n.getProgram().handle,"color");n.vertexArray.setBuffer(S,new gn(e,{usage:e.DYNAMIC_DRAW,data:y}));const I=e.getAttribLocation(n.getProgram().handle,"position");n.vertexArray.setBuffer(I,new gn(e,{usage:e.DYNAMIC_DRAW,data:b}))}}draw(){const{model:e}=this.state;this.updateBuffers(),this.setNeedsRedraw(),e&&e.draw()}}Sb.layerName="CustomTrianglesTexLayer";Sb.defaultProps=k9;function L9(t){let e=[],n=[];return t.forEach(o=>n.push(o.coordinates)),cM(n).forEach(o=>{o.forEach(l=>{for(const s of t){let g=s.coordinates;if(g[0]===l[0]&&g[1]===l[1]){e.push(s);break}}})}),e}function R9(t){let e=[],n=[];return t.forEach(o=>n.push(o.coordinates)),cM(n).forEach(o=>{o.forEach(l=>{for(const[s,g]of t.entries()){let y=g.coordinates;if(y[0]===l[0]&&y[1]===l[1]){e.push(s);break}}})}),e}function O9(t){let e=[];return t.forEach((n,r)=>{switch((r+1)%3){case 1:e.push(n);break;case 2:e.push(n,n);break;case 0:e.push(n,n,t[r-2]);break}}),e}function D9(t){let e=[];return t.forEach((n,r)=>{switch((r+1)%3){case 1:e.push(n);break;case 2:e.push(n),e.push(n);break;case 0:e.push(n),e.push(n),e.push(t[r-2]);break}}),e}function cM(t){let e=z9(t),n=[e];return t.forEach(r=>{let o=[];n.forEach(s=>{B9(r,s)&&o.push(s)}),o.forEach(s=>{n.forEach((g,y)=>{s.every((b,S)=>b===g[S])&&delete n[y]}),n=n.filter(g=>g!==void 0)});let l=[];o.forEach(s=>{[[s[0],s[1]],[s[1],s[2]],[s[0],s[2]]].forEach(y=>{F9(y,o)||l.push(y)})}),l.forEach(s=>n.push([...s,r]))}),n.forEach((r,o)=>{U9(r,e)&&delete n[o]}),n=n.filter(r=>r!==void 0),n}function z9(t){let[e,n,r,o]=[1/0,1/0,-1/0,-1/0];t.forEach(g=>{e=Math.min(e,g[0]),n=Math.min(e,g[1]),r=Math.max(r,g[0]),o=Math.max(r,g[1])});let l=r-e,s=o-n;return[[e-l,n-s],[e+l*10,n-s],[e-l,n+s*10]]}function B9(t,e){let[n,r]=t,[o,l]=e[0],[s,g]=e[1],[y,b]=e[2],S;N9(o,l,s,g,y,b)||(S=s,s=y,y=S,S=g,g=b,b=S);let I=o-n,C=l-r,B=s-n,G=g-r,W=y-n,he=b-r;return(I*I+C*C)*(B*he-W*G)-(B*B+G*G)*(I*he-W*C)+(W*W+he*he)*(I*G-B*C)>0}function N9(t,e,n,r,o,l){return(n-t)*(l-e)-(o-t)*(r-e)>0}function F9(t,e){let n=0;return e.forEach(r=>{[[r[0],r[1]],[r[1],r[2]],[r[0],r[2]]].forEach(l=>{t[0][0]===l[0][0]&&t[0][1]===l[0][1]&&t[1][0]===l[1][0]&&t[1][1]===l[1][1]&&n++,t[1][0]===l[0][0]&&t[1][1]===l[0][1]&&t[0][0]===l[1][0]&&t[0][1]===l[1][1]&&n++})}),n>1}function U9(t,e){let n=!1;return e.forEach(r=>{t.forEach(o=>{r[0]===o[0]&&r[1]===o[1]&&(n=!0)})}),n}function j9({props:t}){const[e,n]=Re.useState(!0),r={height:"20px",width:"20px",accentColor:"RoyalBlue"},o={display:"flex",alignItems:"center"},l={width:"100%",cursor:"pointer",backgroundColor:"white",accentColor:"RoyalBlue"},s={margin:"5px",fontSize:"20px",fontWeight:"bold",color:"white",border:"none",cursor:"pointer",backgroundColor:e?"grey":"RoyalBlue"},g={textAlign:"center"},y={display:"flex",flexDirection:"column",alignItems:"start"},b={position:"absolute",zIndex:1,background:"white",boxShadow:"5px 5px 5px 5px rgba(0, 0, 0, 0.2)",margin:"10px",padding:"5px",display:"flex",flexDirection:"column",alignItems:"center"};return Sn.createElement("div",{style:b},Sn.createElement("button",{style:s,onClick:()=>(n(!t.isAnimationOn),t.setAnimation(!t.isAnimationOn))},e?"Stop":"Start"),Sn.createElement("input",{style:l,type:"range",min:t.minTime,max:t.maxTime,step:"100000000",value:t.time,onChange:S=>{t.setTime(Number(S.target.value))},onMouseDown:()=>(n(t.isAnimationOn),t.setAnimation(!1)),onMouseUp:()=>t.setAnimation(e)}),Sn.createElement("h3",null,new Date(t.time).toLocaleDateString("cs-CZ")," "),Sn.createElement("h3",null,"Layers"),Sn.createElement("div",{style:y},Sn.createElement("label",{style:o},Sn.createElement("input",{style:r,type:"checkbox",checked:t.showTriLayer,onChange:()=>t.setShowTriLayer(!t.showTriLayer)}),"Triangles"),Sn.createElement("label",{style:o},Sn.createElement("input",{style:r,type:"checkbox",checked:t.showTriTexLayer,onChange:()=>t.setShowTriTexLayer(!t.showTriTexLayer)}),"Triangles texture"),Sn.createElement("label",{style:o},Sn.createElement("input",{style:r,type:"checkbox",checked:t.showLinesLayer,onChange:()=>t.setShowLinesLayer(!t.showLinesLayer)}),"Lines"),Sn.createElement("label",{style:o},Sn.createElement("input",{style:r,type:"checkbox",checked:t.showSpringsLayer,onChange:()=>t.setShowSpringsLayer(!t.showSpringsLayer)}),"Springs")),(t.showTriTexLayer||t.showTriLayer||t.showLinesLayer||t.showSpringsLayer)&&Sn.createElement("span",{style:g},Sn.createElement("h3",null,"Deformation scale"),Sn.createElement("input",{style:l,type:"range",min:"0",max:"5000",step:"100",value:t.scale,onChange:S=>{t.setScale(S.target.value==="0"?1:Number(S.target.value))}}),Sn.createElement("h3",null,"1 : ",t.scale)),t.showTriTexLayer&&Sn.createElement("span",{style:g},Sn.createElement("h3",null,"Texture size"),Sn.createElement("input",{style:l,type:"range",min:"0",max:"500",step:"1",value:t.textureSize,onChange:S=>t.setTextureSize(S.target.value==="0"?1:Number(S.target.value))}),Sn.createElement("h3",null,t.textureSize," x ",t.textureSize)),t.showSpringsLayer&&Sn.createElement("span",{style:g},Sn.createElement("h3",null,"Spring length"),Sn.createElement("input",{style:l,type:"range",min:"0.00005",max:"0.001",step:"0.00001",value:t.springLength,onChange:S=>t.setSpringLength(Number(S.target.value))}),Sn.createElement("h3",null,t.springLength)))}const V9="data/drr_wbbhu_114_ps_los.json",G9="https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json",W9={latitude:27.454355,longitude:90.449541,zoom:14,bearing:0,pitch:30};function H9({data:t,minTime:e,maxTime:n,trianglesIndexes:r,trianglesData:o,linesData:l,linesIndexes:s}){const[g,y]=Re.useState(e),[b,S]=Re.useState(1e3),[I,C]=Re.useState(100),[B,G]=Re.useState(1e-4),[W,he]=Re.useState(new Float32Array),[H,U]=Re.useState(new Float32Array),[K,fe]=Re.useState(new Float32Array),[ye,xe]=Re.useState(!0),[Te,De]=Re.useState(!0),[Fe,Ve]=Re.useState(!1),[tt,Bt]=Re.useState(!1),ft=Re.useRef(0),[wt,nr]=Re.useState(!0),rr=1e8,Pr=()=>{y(Mt=>n<Mt?e:Mt+rr),ft.current=requestAnimationFrame(Pr)};Re.useEffect(()=>(wt&&(ft.current=requestAnimationFrame(Pr)),()=>cancelAnimationFrame(ft.current)),[wt]),Re.useEffect(()=>{if(he(b9(t,g)),W){const Mt=new Float32Array(r.length);r.forEach((Qt,en)=>{Mt[en]=W[Qt]}),U(Mt);const Ot=new Float32Array(s.length);s.forEach((Qt,en)=>{Ot[en]=W[Qt]}),fe(Ot)}},[g]);const ut=[new Sb({id:"customTrianglesTex",data:o,scale:b,textureSize:I,valueBuffer:H,getPolygonOffset:()=>[0,2e7],visible:Te}),new Tb({id:"customTriangles",data:o,scale:b,valueBuffer:H,getPolygonOffset:()=>[0,2e7],visible:Fe}),new bb({id:"customLines",data:l,scale:b,valueBuffer:K,getPolygonOffset:()=>[0,0],visible:ye}),new Eb({id:"customSprings",data:l,scale:b,valueBuffer:K,springLength:B,parameters:{depthTest:!1},visible:tt})];return Sn.createElement("div",null,Sn.createElement(D6,{layers:ut,initialViewState:W9,controller:!0},Sn.createElement(vl,{mapStyle:G9})),Sn.createElement(j9,{props:{isAnimationOn:wt,setAnimation:nr,minTime:e,maxTime:n,time:g,textureSize:I,springLength:B,scale:b,setScale:S,setTime:y,setTextureSize:C,setSpringLength:G,setShowLinesLayer:xe,setShowTriTexLayer:De,setShowTriLayer:Ve,setShowSpringsLayer:Bt,showLinesLayer:ye,showTriTexLayer:Te,showTriLayer:Fe,showSpringsLayer:tt}}))}function q9(t){Qh(V9,h9).then(e=>{const n="vel_cum",{minAbsValue:r,maxAbsValue:o}=v9(e.features,n);return _9(r,o,n),x9(e.features)}).then(e=>{const{minTime:n,maxTime:r}=w9(e),o=L9(e),l=R9(e),s=O9(o),g=D9(l);return VC(t).render(Sn.createElement(H9,{data:e,minTime:n,maxTime:r,trianglesData:o,trianglesIndexes:l,linesData:s,linesIndexes:g}))})}q9(document.getElementById("app"));
